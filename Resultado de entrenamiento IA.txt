
C:\Users\wille\Downloads\trading-bot-IA-claude-ai-trading-system-011CUVidbtpAcFVHqnwhWMeG\trading-bot-IA-claude-ai-trading-system-011CUVidbtpAcFVHqnwhWMeG>python train_models.py
2025-10-31 01:42:37.615682: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-10-31 01:43:07.135541: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-10-31 01:43:13.661 | INFO     | __main__:main:128 - ============================== Starting AI Model Training (Per-File) ==============================
2025-10-31 01:43:13.688 | INFO     | __main__:get_historical_data_files:81 - Scanning for historical data files in 'historical_data'...
2025-10-31 01:43:13.691 | INFO     | __main__:get_historical_data_files:89 - Found 60 historical data files to process.
2025-10-31 01:43:13.692 | INFO     | __main__:main:140 - --- Starting training for Symbol: GainX 1200, Timeframe: 15m ---
2025-10-31 01:43:13.822 | SUCCESS  | __main__:main:148 - Loaded 28898 records.
2025-10-31 01:43:13.823 | INFO     | __main__:prepare_training_data:32 - Preparing data for training with Meta-Labeling...
2025-10-31 01:43:15.487 | DEBUG    | src.ai_engine.technical_indicators:calculate_all:47 - Calculated 63 technical indicators
2025-10-31 01:43:20.352 | DEBUG    | src.ai_engine.feature_engineering:extract_features:66 - Extracted 116 features
2025-10-31 01:43:20.354 | INFO     | __main__:prepare_training_data:39 - Generating signals from primary model (SimplePatternModel)...
2025-10-31 01:43:20.432 | WARNING  | src.ai_engine.feature_engineering:prepare_for_model:230 - Se perdieron todos los datos al eliminar los NaN. Se conservarán los datos rellenados.
2025-10-31 01:43:25.061 | INFO     | src.ai_engine.ai_models:calculate_optimal_threshold:549 - Calculated optimal threshold: 0.0010 (volatility: 0.0002, avg_movement: 0.0010)
2025-10-31 01:43:25.062 | INFO     | src.ai_engine.ai_models:create_meta_labels:577 - Creating meta-labels for secondary model...
2025-10-31 01:43:29.251 | INFO     | src.ai_engine.ai_models:create_meta_labels:629 - Meta-Label distribution - Profitable: 1628 (24.3%), Unprofitable: 5058 (75.7%)
2025-10-31 01:43:29.344 | WARNING  | src.ai_engine.feature_engineering:prepare_for_model:230 - Se perdieron todos los datos al eliminar los NaN. Se conservarán los datos rellenados.
2025-10-31 01:43:29.385 | INFO     | __main__:prepare_training_data:75 - Data preparation complete. Shape of X: (20581, 116), Shape of y: (20581,)
2025-10-31 01:43:29.400 | INFO     | src.ai_engine.feature_engineering:create_sequences:261 - Creating sequences with length 50 from 20581 data points.
2025-10-31 01:43:29.698 | INFO     | src.ai_engine.feature_engineering:create_sequences:270 - Created 20531 sequences.
2025-10-31 01:43:29.701 | INFO     | __main__:main:164 - Initializing and training Ensemble model...
2025-10-31 01:43:29.702 | INFO     | src.ai_engine.ai_models:__init__:304 - Initialized Stacking Ensemble with Logistic Regression as meta-model.
2025-10-31 01:43:29.702 | INFO     | src.ai_engine.ai_models:fit:359 - Creating LSTM model...
2025-10-31 01:43:29.703 | INFO     | src.ai_engine.ai_models:fit:364 - Training base models...
2025-10-31 01:43:29.739 | INFO     | src.ai_engine.ai_models:fit:373 - Training random_forest...
2025-10-31 01:43:37.108 | INFO     | src.ai_engine.ai_models:fit:98 - RandomForest trained successfully on 20581 samples with 2 classes
2025-10-31 01:43:37.110 | INFO     | src.ai_engine.ai_models:fit:373 - Training gradient_boosting...
2025-10-31 01:47:19.121 | INFO     | src.ai_engine.ai_models:fit:157 - GradientBoosting trained successfully on 20581 samples with 2 classes
2025-10-31 01:47:19.123 | INFO     | src.ai_engine.ai_models:fit:373 - Training pattern_based...
2025-10-31 01:47:19.123 | INFO     | src.ai_engine.ai_models:fit:373 - Training lstm...
2025-10-31 01:47:19.536651: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: SSE3 SSE4.1 SSE4.2 AVX AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\keras\src\layers\rnn\rnn.py:199: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(**kwargs)
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1108: RuntimeWarning: invalid value encountered in divide
  updated_mean = (last_sum + new_sum) / updated_sample_count
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1113: RuntimeWarning: invalid value encountered in divide
  T = new_sum / new_sample_count
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1133: RuntimeWarning: invalid value encountered in divide
  new_unnormalized_variance -= correction**2 / new_sample_count
Epoch 1/50
578/578 ━━━━━━━━━━━━━━━━━━━━ 21s 22ms/step - accuracy: 0.9203 - loss: 0.5914 - val_accuracy: 0.9270 - val_loss: 0.5025
Epoch 2/50
578/578 ━━━━━━━━━━━━━━━━━━━━ 12s 21ms/step - accuracy: 0.9203 - loss: 0.4477 - val_accuracy: 0.9270 - val_loss: 0.3931
Epoch 3/50
578/578 ━━━━━━━━━━━━━━━━━━━━ 12s 20ms/step - accuracy: 0.9203 - loss: 0.3673 - val_accuracy: 0.9270 - val_loss: 0.3320
Epoch 4/50
578/578 ━━━━━━━━━━━━━━━━━━━━ 21s 20ms/step - accuracy: 0.9203 - loss: 0.3235 - val_accuracy: 0.9270 - val_loss: 0.2983
Epoch 5/50
578/578 ━━━━━━━━━━━━━━━━━━━━ 12s 20ms/step - accuracy: 0.9203 - loss: 0.2999 - val_accuracy: 0.9270 - val_loss: 0.2799
Epoch 6/50
578/578 ━━━━━━━━━━━━━━━━━━━━ 12s 20ms/step - accuracy: 0.9203 - loss: 0.2878 - val_accuracy: 0.9270 - val_loss: 0.2704
Epoch 7/50
578/578 ━━━━━━━━━━━━━━━━━━━━ 12s 20ms/step - accuracy: 0.9203 - loss: 0.2820 - val_accuracy: 0.9270 - val_loss: 0.2656
Epoch 8/50
578/578 ━━━━━━━━━━━━━━━━━━━━ 12s 20ms/step - accuracy: 0.9203 - loss: 0.2795 - val_accuracy: 0.9270 - val_loss: 0.2634
Epoch 9/50
578/578 ━━━━━━━━━━━━━━━━━━━━ 12s 20ms/step - accuracy: 0.9203 - loss: 0.2785 - val_accuracy: 0.9270 - val_loss: 0.2624
Epoch 10/50
578/578 ━━━━━━━━━━━━━━━━━━━━ 12s 21ms/step - accuracy: 0.9203 - loss: 0.2782 - val_accuracy: 0.9270 - val_loss: 0.2620
Epoch 11/50
578/578 ━━━━━━━━━━━━━━━━━━━━ 12s 20ms/step - accuracy: 0.9203 - loss: 0.2781 - val_accuracy: 0.9270 - val_loss: 0.2618
Epoch 12/50
578/578 ━━━━━━━━━━━━━━━━━━━━ 12s 20ms/step - accuracy: 0.9203 - loss: 0.2781 - val_accuracy: 0.9270 - val_loss: 0.2618
Epoch 13/50
578/578 ━━━━━━━━━━━━━━━━━━━━ 12s 20ms/step - accuracy: 0.9203 - loss: 0.2781 - val_accuracy: 0.9270 - val_loss: 0.2618
Epoch 14/50
578/578 ━━━━━━━━━━━━━━━━━━━━ 12s 20ms/step - accuracy: 0.9203 - loss: 0.2781 - val_accuracy: 0.9270 - val_loss: 0.2617
Epoch 15/50
578/578 ━━━━━━━━━━━━━━━━━━━━ 12s 20ms/step - accuracy: 0.9203 - loss: 0.2781 - val_accuracy: 0.9270 - val_loss: 0.2617
Epoch 16/50
578/578 ━━━━━━━━━━━━━━━━━━━━ 12s 20ms/step - accuracy: 0.9203 - loss: 0.2781 - val_accuracy: 0.9270 - val_loss: 0.2617
Epoch 17/50
578/578 ━━━━━━━━━━━━━━━━━━━━ 12s 20ms/step - accuracy: 0.9203 - loss: 0.2781 - val_accuracy: 0.9270 - val_loss: 0.2617
Epoch 18/50
578/578 ━━━━━━━━━━━━━━━━━━━━ 12s 20ms/step - accuracy: 0.9203 - loss: 0.2781 - val_accuracy: 0.9270 - val_loss: 0.2617
Epoch 19/50
578/578 ━━━━━━━━━━━━━━━━━━━━ 12s 20ms/step - accuracy: 0.9203 - loss: 0.2781 - val_accuracy: 0.9270 - val_loss: 0.2617
Epoch 20/50
578/578 ━━━━━━━━━━━━━━━━━━━━ 12s 20ms/step - accuracy: 0.9203 - loss: 0.2781 - val_accuracy: 0.9270 - val_loss: 0.2617
Epoch 21/50
578/578 ━━━━━━━━━━━━━━━━━━━━ 12s 20ms/step - accuracy: 0.9203 - loss: 0.2781 - val_accuracy: 0.9270 - val_loss: 0.2616
Epoch 22/50
578/578 ━━━━━━━━━━━━━━━━━━━━ 11s 20ms/step - accuracy: 0.9203 - loss: 0.2781 - val_accuracy: 0.9270 - val_loss: 0.2617
Epoch 23/50
578/578 ━━━━━━━━━━━━━━━━━━━━ 11s 20ms/step - accuracy: 0.9203 - loss: 0.2781 - val_accuracy: 0.9270 - val_loss: 0.2617
Epoch 24/50
578/578 ━━━━━━━━━━━━━━━━━━━━ 11s 20ms/step - accuracy: 0.9203 - loss: 0.2781 - val_accuracy: 0.9270 - val_loss: 0.2617
Epoch 25/50
578/578 ━━━━━━━━━━━━━━━━━━━━ 12s 20ms/step - accuracy: 0.9203 - loss: 0.2781 - val_accuracy: 0.9270 - val_loss: 0.2618
Epoch 26/50
578/578 ━━━━━━━━━━━━━━━━━━━━ 11s 20ms/step - accuracy: 0.9203 - loss: 0.2781 - val_accuracy: 0.9270 - val_loss: 0.2617
Epoch 27/50
578/578 ━━━━━━━━━━━━━━━━━━━━ 21s 20ms/step - accuracy: 0.9203 - loss: 0.2781 - val_accuracy: 0.9270 - val_loss: 0.2617
Epoch 28/50
578/578 ━━━━━━━━━━━━━━━━━━━━ 11s 20ms/step - accuracy: 0.9203 - loss: 0.2781 - val_accuracy: 0.9270 - val_loss: 0.2617
Epoch 29/50
578/578 ━━━━━━━━━━━━━━━━━━━━ 12s 20ms/step - accuracy: 0.9203 - loss: 0.2781 - val_accuracy: 0.9270 - val_loss: 0.2617
Epoch 30/50
578/578 ━━━━━━━━━━━━━━━━━━━━ 11s 20ms/step - accuracy: 0.9203 - loss: 0.2781 - val_accuracy: 0.9270 - val_loss: 0.2617
Epoch 31/50
578/578 ━━━━━━━━━━━━━━━━━━━━ 11s 20ms/step - accuracy: 0.9203 - loss: 0.2781 - val_accuracy: 0.9270 - val_loss: 0.2617
2025-10-31 01:53:56.058 | INFO     | src.ai_engine.ai_models:fit:685 - LSTM trained successfully.
2025-10-31 01:53:56.105 | INFO     | src.ai_engine.ai_models:fit:381 - Generating base model predictions for meta-model training...
2025-10-31 01:53:57.429 | INFO     | src.ai_engine.feature_engineering:create_sequences:261 - Creating sequences with length 50 from 20581 data points.
2025-10-31 01:53:57.666 | INFO     | src.ai_engine.feature_engineering:create_sequences:270 - Created 20531 sequences.
642/642 ━━━━━━━━━━━━━━━━━━━━ 5s 8ms/step
2025-10-31 01:54:04.870 | INFO     | src.ai_engine.ai_models:fit:396 - Training meta-model...
2025-10-31 01:54:05.038 | SUCCESS  | src.ai_engine.ai_models:fit:399 - Stacking Ensemble trained successfully.
2025-10-31 01:54:05.040 | SUCCESS  | __main__:main:167 - Final Ensemble model trained.
2025-10-31 01:54:05.041 | INFO     | __main__:main:171 - Saving models to 'models\GainX_1200\15m'...
2025-10-31 01:54:05.074 | INFO     | src.ai_engine.ai_models:save:52 - Model RandomForest saved to models\GainX_1200\15m\random_forest.pkl
2025-10-31 01:54:05.113 | INFO     | src.ai_engine.ai_models:save:52 - Model GradientBoosting saved to models\GainX_1200\15m\gradient_boosting.pkl
2025-10-31 01:54:05.410 | INFO     | src.ai_engine.ai_models:save:731 - LSTM model saved to models\GainX_1200\15m\lstm.keras, models\GainX_1200\15m\lstm_scaler.pkl and marker file models\GainX_1200\15m\lstm.pkl
2025-10-31 01:54:05.411 | INFO     | src.ai_engine.ai_models:save_all:463 - Meta-model saved to models\GainX_1200\15m\meta_model.pkl
2025-10-31 01:54:05.413 | SUCCESS  | __main__:main:174 - --- Finished training for Symbol: GainX 1200, Timeframe: 15m ---
2025-10-31 01:54:05.413 | INFO     | __main__:main:140 - --- Starting training for Symbol: GainX 1200, Timeframe: 1d ---
2025-10-31 01:54:05.466 | SUCCESS  | __main__:main:148 - Loaded 302 records.
2025-10-31 01:54:05.466 | INFO     | __main__:prepare_training_data:32 - Preparing data for training with Meta-Labeling...
2025-10-31 01:54:05.527 | DEBUG    | src.ai_engine.technical_indicators:calculate_all:47 - Calculated 62 technical indicators
2025-10-31 01:54:05.583 | DEBUG    | src.ai_engine.feature_engineering:extract_features:66 - Extracted 116 features
2025-10-31 01:54:05.584 | INFO     | __main__:prepare_training_data:39 - Generating signals from primary model (SimplePatternModel)...
2025-10-31 01:54:05.588 | WARNING  | src.ai_engine.feature_engineering:prepare_for_model:230 - Se perdieron todos los datos al eliminar los NaN. Se conservarán los datos rellenados.
2025-10-31 01:54:05.640 | INFO     | src.ai_engine.ai_models:calculate_optimal_threshold:549 - Calculated optimal threshold: 0.0070 (volatility: 0.0023, avg_movement: 0.0097)
2025-10-31 01:54:05.641 | INFO     | src.ai_engine.ai_models:create_meta_labels:577 - Creating meta-labels for secondary model...
2025-10-31 01:54:05.668 | INFO     | src.ai_engine.ai_models:create_meta_labels:629 - Meta-Label distribution - Profitable: 23 (19.0%), Unprofitable: 98 (81.0%)
2025-10-31 01:54:05.673 | WARNING  | src.ai_engine.feature_engineering:prepare_for_model:230 - Se perdieron todos los datos al eliminar los NaN. Se conservarán los datos rellenados.
2025-10-31 01:54:05.674 | INFO     | __main__:prepare_training_data:75 - Data preparation complete. Shape of X: (157, 116), Shape of y: (157,)
2025-10-31 01:54:05.680 | INFO     | src.ai_engine.feature_engineering:create_sequences:261 - Creating sequences with length 50 from 157 data points.
2025-10-31 01:54:05.682 | INFO     | src.ai_engine.feature_engineering:create_sequences:270 - Created 107 sequences.
2025-10-31 01:54:05.756 | INFO     | __main__:main:164 - Initializing and training Ensemble model...
2025-10-31 01:54:05.757 | INFO     | src.ai_engine.ai_models:__init__:304 - Initialized Stacking Ensemble with Logistic Regression as meta-model.
2025-10-31 01:54:05.759 | INFO     | src.ai_engine.ai_models:fit:359 - Creating LSTM model...
2025-10-31 01:54:05.761 | INFO     | src.ai_engine.ai_models:fit:364 - Training base models...
2025-10-31 01:54:05.762 | INFO     | src.ai_engine.ai_models:fit:373 - Training random_forest...
2025-10-31 01:54:06.268 | INFO     | src.ai_engine.ai_models:fit:98 - RandomForest trained successfully on 157 samples with 2 classes
2025-10-31 01:54:06.269 | INFO     | src.ai_engine.ai_models:fit:373 - Training gradient_boosting...
2025-10-31 01:54:07.361 | INFO     | src.ai_engine.ai_models:fit:157 - GradientBoosting trained successfully on 157 samples with 2 classes
2025-10-31 01:54:07.362 | INFO     | src.ai_engine.ai_models:fit:373 - Training pattern_based...
2025-10-31 01:54:07.363 | INFO     | src.ai_engine.ai_models:fit:373 - Training lstm...
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\keras\src\layers\rnn\rnn.py:199: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(**kwargs)
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1108: RuntimeWarning: invalid value encountered in divide
  updated_mean = (last_sum + new_sum) / updated_sample_count
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1113: RuntimeWarning: invalid value encountered in divide
  T = new_sum / new_sample_count
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1133: RuntimeWarning: invalid value encountered in divide
  new_unnormalized_variance -= correction**2 / new_sample_count
Epoch 1/50
3/3 ━━━━━━━━━━━━━━━━━━━━ 3s 235ms/step - accuracy: 0.9167 - loss: 0.6928 - val_accuracy: 0.7273 - val_loss: 0.6925
Epoch 2/50
3/3 ━━━━━━━━━━━━━━━━━━━━ 0s 48ms/step - accuracy: 0.9167 - loss: 0.6915 - val_accuracy: 0.7273 - val_loss: 0.6918
Epoch 3/50
3/3 ━━━━━━━━━━━━━━━━━━━━ 0s 47ms/step - accuracy: 0.9167 - loss: 0.6902 - val_accuracy: 0.7273 - val_loss: 0.6911
Epoch 4/50
3/3 ━━━━━━━━━━━━━━━━━━━━ 0s 47ms/step - accuracy: 0.9167 - loss: 0.6890 - val_accuracy: 0.7273 - val_loss: 0.6905
Epoch 5/50
3/3 ━━━━━━━━━━━━━━━━━━━━ 0s 48ms/step - accuracy: 0.9167 - loss: 0.6878 - val_accuracy: 0.7273 - val_loss: 0.6898
Epoch 6/50
3/3 ━━━━━━━━━━━━━━━━━━━━ 0s 48ms/step - accuracy: 0.9167 - loss: 0.6866 - val_accuracy: 0.7273 - val_loss: 0.6891
Epoch 7/50
3/3 ━━━━━━━━━━━━━━━━━━━━ 0s 46ms/step - accuracy: 0.9167 - loss: 0.6853 - val_accuracy: 0.7273 - val_loss: 0.6885
Epoch 8/50
3/3 ━━━━━━━━━━━━━━━━━━━━ 0s 46ms/step - accuracy: 0.9167 - loss: 0.6841 - val_accuracy: 0.7273 - val_loss: 0.6878
Epoch 9/50
3/3 ━━━━━━━━━━━━━━━━━━━━ 0s 46ms/step - accuracy: 0.9167 - loss: 0.6829 - val_accuracy: 0.7273 - val_loss: 0.6871
Epoch 10/50
3/3 ━━━━━━━━━━━━━━━━━━━━ 0s 46ms/step - accuracy: 0.9167 - loss: 0.6816 - val_accuracy: 0.7273 - val_loss: 0.6865
Epoch 11/50
3/3 ━━━━━━━━━━━━━━━━━━━━ 0s 46ms/step - accuracy: 0.9167 - loss: 0.6804 - val_accuracy: 0.7273 - val_loss: 0.6858
Epoch 12/50
3/3 ━━━━━━━━━━━━━━━━━━━━ 0s 45ms/step - accuracy: 0.9167 - loss: 0.6792 - val_accuracy: 0.7273 - val_loss: 0.6852
Epoch 13/50
3/3 ━━━━━━━━━━━━━━━━━━━━ 0s 45ms/step - accuracy: 0.9167 - loss: 0.6780 - val_accuracy: 0.7273 - val_loss: 0.6845
Epoch 14/50
3/3 ━━━━━━━━━━━━━━━━━━━━ 0s 45ms/step - accuracy: 0.9167 - loss: 0.6768 - val_accuracy: 0.7273 - val_loss: 0.6839
Epoch 15/50
3/3 ━━━━━━━━━━━━━━━━━━━━ 0s 45ms/step - accuracy: 0.9167 - loss: 0.6756 - val_accuracy: 0.7273 - val_loss: 0.6833
Epoch 16/50
3/3 ━━━━━━━━━━━━━━━━━━━━ 0s 46ms/step - accuracy: 0.9167 - loss: 0.6744 - val_accuracy: 0.7273 - val_loss: 0.6826
Epoch 17/50
3/3 ━━━━━━━━━━━━━━━━━━━━ 0s 46ms/step - accuracy: 0.9167 - loss: 0.6732 - val_accuracy: 0.7273 - val_loss: 0.6820
Epoch 18/50
3/3 ━━━━━━━━━━━━━━━━━━━━ 0s 46ms/step - accuracy: 0.9167 - loss: 0.6720 - val_accuracy: 0.7273 - val_loss: 0.6813
Epoch 19/50
3/3 ━━━━━━━━━━━━━━━━━━━━ 0s 46ms/step - accuracy: 0.9167 - loss: 0.6708 - val_accuracy: 0.7273 - val_loss: 0.6807
Epoch 20/50
3/3 ━━━━━━━━━━━━━━━━━━━━ 0s 45ms/step - accuracy: 0.9167 - loss: 0.6696 - val_accuracy: 0.7273 - val_loss: 0.6801
Epoch 21/50
3/3 ━━━━━━━━━━━━━━━━━━━━ 0s 45ms/step - accuracy: 0.9167 - loss: 0.6685 - val_accuracy: 0.7273 - val_loss: 0.6794
Epoch 22/50
3/3 ━━━━━━━━━━━━━━━━━━━━ 0s 46ms/step - accuracy: 0.9167 - loss: 0.6672 - val_accuracy: 0.7273 - val_loss: 0.6788
Epoch 23/50
3/3 ━━━━━━━━━━━━━━━━━━━━ 0s 45ms/step - accuracy: 0.9167 - loss: 0.6661 - val_accuracy: 0.7273 - val_loss: 0.6782
Epoch 24/50
3/3 ━━━━━━━━━━━━━━━━━━━━ 0s 47ms/step - accuracy: 0.9167 - loss: 0.6649 - val_accuracy: 0.7273 - val_loss: 0.6776
Epoch 25/50
3/3 ━━━━━━━━━━━━━━━━━━━━ 0s 47ms/step - accuracy: 0.9167 - loss: 0.6637 - val_accuracy: 0.7273 - val_loss: 0.6770
Epoch 26/50
3/3 ━━━━━━━━━━━━━━━━━━━━ 0s 47ms/step - accuracy: 0.9167 - loss: 0.6626 - val_accuracy: 0.7273 - val_loss: 0.6764
Epoch 27/50
3/3 ━━━━━━━━━━━━━━━━━━━━ 0s 47ms/step - accuracy: 0.9167 - loss: 0.6614 - val_accuracy: 0.7273 - val_loss: 0.6758
Epoch 28/50
3/3 ━━━━━━━━━━━━━━━━━━━━ 0s 46ms/step - accuracy: 0.9167 - loss: 0.6602 - val_accuracy: 0.7273 - val_loss: 0.6752
Epoch 29/50
3/3 ━━━━━━━━━━━━━━━━━━━━ 0s 45ms/step - accuracy: 0.9167 - loss: 0.6591 - val_accuracy: 0.7273 - val_loss: 0.6746
Epoch 30/50
3/3 ━━━━━━━━━━━━━━━━━━━━ 0s 46ms/step - accuracy: 0.9167 - loss: 0.6579 - val_accuracy: 0.7273 - val_loss: 0.6740
Epoch 31/50
3/3 ━━━━━━━━━━━━━━━━━━━━ 0s 45ms/step - accuracy: 0.9167 - loss: 0.6567 - val_accuracy: 0.7273 - val_loss: 0.6734
Epoch 32/50
3/3 ━━━━━━━━━━━━━━━━━━━━ 0s 45ms/step - accuracy: 0.9167 - loss: 0.6556 - val_accuracy: 0.7273 - val_loss: 0.6728
Epoch 33/50
3/3 ━━━━━━━━━━━━━━━━━━━━ 0s 47ms/step - accuracy: 0.9167 - loss: 0.6545 - val_accuracy: 0.7273 - val_loss: 0.6722
Epoch 34/50
3/3 ━━━━━━━━━━━━━━━━━━━━ 0s 45ms/step - accuracy: 0.9167 - loss: 0.6533 - val_accuracy: 0.7273 - val_loss: 0.6716
Epoch 35/50
3/3 ━━━━━━━━━━━━━━━━━━━━ 0s 45ms/step - accuracy: 0.9167 - loss: 0.6522 - val_accuracy: 0.7273 - val_loss: 0.6710
Epoch 36/50
3/3 ━━━━━━━━━━━━━━━━━━━━ 0s 45ms/step - accuracy: 0.9167 - loss: 0.6510 - val_accuracy: 0.7273 - val_loss: 0.6704
Epoch 37/50
3/3 ━━━━━━━━━━━━━━━━━━━━ 0s 47ms/step - accuracy: 0.9167 - loss: 0.6499 - val_accuracy: 0.7273 - val_loss: 0.6698
Epoch 38/50
3/3 ━━━━━━━━━━━━━━━━━━━━ 0s 46ms/step - accuracy: 0.9167 - loss: 0.6487 - val_accuracy: 0.7273 - val_loss: 0.6692
Epoch 39/50
3/3 ━━━━━━━━━━━━━━━━━━━━ 0s 45ms/step - accuracy: 0.9167 - loss: 0.6476 - val_accuracy: 0.7273 - val_loss: 0.6687
Epoch 40/50
3/3 ━━━━━━━━━━━━━━━━━━━━ 0s 46ms/step - accuracy: 0.9167 - loss: 0.6465 - val_accuracy: 0.7273 - val_loss: 0.6681
Epoch 41/50
3/3 ━━━━━━━━━━━━━━━━━━━━ 0s 46ms/step - accuracy: 0.9167 - loss: 0.6454 - val_accuracy: 0.7273 - val_loss: 0.6675
Epoch 42/50
3/3 ━━━━━━━━━━━━━━━━━━━━ 0s 45ms/step - accuracy: 0.9167 - loss: 0.6443 - val_accuracy: 0.7273 - val_loss: 0.6670
Epoch 43/50
3/3 ━━━━━━━━━━━━━━━━━━━━ 0s 46ms/step - accuracy: 0.9167 - loss: 0.6432 - val_accuracy: 0.7273 - val_loss: 0.6664
Epoch 44/50
3/3 ━━━━━━━━━━━━━━━━━━━━ 0s 46ms/step - accuracy: 0.9167 - loss: 0.6420 - val_accuracy: 0.7273 - val_loss: 0.6658
Epoch 45/50
3/3 ━━━━━━━━━━━━━━━━━━━━ 0s 45ms/step - accuracy: 0.9167 - loss: 0.6409 - val_accuracy: 0.7273 - val_loss: 0.6653
Epoch 46/50
3/3 ━━━━━━━━━━━━━━━━━━━━ 0s 46ms/step - accuracy: 0.9167 - loss: 0.6398 - val_accuracy: 0.7273 - val_loss: 0.6647
Epoch 47/50
3/3 ━━━━━━━━━━━━━━━━━━━━ 0s 45ms/step - accuracy: 0.9167 - loss: 0.6387 - val_accuracy: 0.7273 - val_loss: 0.6641
Epoch 48/50
3/3 ━━━━━━━━━━━━━━━━━━━━ 0s 45ms/step - accuracy: 0.9167 - loss: 0.6376 - val_accuracy: 0.7273 - val_loss: 0.6636
Epoch 49/50
3/3 ━━━━━━━━━━━━━━━━━━━━ 0s 47ms/step - accuracy: 0.9167 - loss: 0.6366 - val_accuracy: 0.7273 - val_loss: 0.6630
Epoch 50/50
3/3 ━━━━━━━━━━━━━━━━━━━━ 0s 47ms/step - accuracy: 0.9167 - loss: 0.6355 - val_accuracy: 0.7273 - val_loss: 0.6625
2025-10-31 01:54:16.966 | INFO     | src.ai_engine.ai_models:fit:685 - LSTM trained successfully.
2025-10-31 01:54:16.967 | INFO     | src.ai_engine.ai_models:fit:381 - Generating base model predictions for meta-model training...
2025-10-31 01:54:16.980 | INFO     | src.ai_engine.feature_engineering:create_sequences:261 - Creating sequences with length 50 from 157 data points.
2025-10-31 01:54:16.982 | INFO     | src.ai_engine.feature_engineering:create_sequences:270 - Created 107 sequences.
4/4 ━━━━━━━━━━━━━━━━━━━━ 1s 89ms/step
2025-10-31 01:54:17.544 | INFO     | src.ai_engine.ai_models:fit:396 - Training meta-model...
2025-10-31 01:54:17.549 | SUCCESS  | src.ai_engine.ai_models:fit:399 - Stacking Ensemble trained successfully.
2025-10-31 01:54:17.549 | SUCCESS  | __main__:main:167 - Final Ensemble model trained.
2025-10-31 01:54:17.550 | INFO     | __main__:main:171 - Saving models to 'models\GainX_1200\1d'...
2025-10-31 01:54:17.593 | INFO     | src.ai_engine.ai_models:save:52 - Model RandomForest saved to models\GainX_1200\1d\random_forest.pkl
2025-10-31 01:54:17.600 | INFO     | src.ai_engine.ai_models:save:52 - Model GradientBoosting saved to models\GainX_1200\1d\gradient_boosting.pkl
2025-10-31 01:54:17.632 | INFO     | src.ai_engine.ai_models:save:731 - LSTM model saved to models\GainX_1200\1d\lstm.keras, models\GainX_1200\1d\lstm_scaler.pkl and marker file models\GainX_1200\1d\lstm.pkl
2025-10-31 01:54:17.633 | INFO     | src.ai_engine.ai_models:save_all:463 - Meta-model saved to models\GainX_1200\1d\meta_model.pkl
2025-10-31 01:54:17.637 | SUCCESS  | __main__:main:174 - --- Finished training for Symbol: GainX 1200, Timeframe: 1d ---
2025-10-31 01:54:17.637 | INFO     | __main__:main:140 - --- Starting training for Symbol: GainX 1200, Timeframe: 1h ---
2025-10-31 01:54:17.702 | SUCCESS  | __main__:main:148 - Loaded 7227 records.
2025-10-31 01:54:17.703 | INFO     | __main__:prepare_training_data:32 - Preparing data for training with Meta-Labeling...
2025-10-31 01:54:18.142 | DEBUG    | src.ai_engine.technical_indicators:calculate_all:47 - Calculated 63 technical indicators
2025-10-31 01:54:19.399 | DEBUG    | src.ai_engine.feature_engineering:extract_features:66 - Extracted 116 features
2025-10-31 01:54:19.400 | INFO     | __main__:prepare_training_data:39 - Generating signals from primary model (SimplePatternModel)...
2025-10-31 01:54:19.418 | WARNING  | src.ai_engine.feature_engineering:prepare_for_model:230 - Se perdieron todos los datos al eliminar los NaN. Se conservarán los datos rellenados.
2025-10-31 01:54:20.574 | INFO     | src.ai_engine.ai_models:calculate_optimal_threshold:549 - Calculated optimal threshold: 0.0014 (volatility: 0.0005, avg_movement: 0.0020)
2025-10-31 01:54:20.575 | INFO     | src.ai_engine.ai_models:create_meta_labels:577 - Creating meta-labels for secondary model...
2025-10-31 01:54:21.496 | INFO     | src.ai_engine.ai_models:create_meta_labels:629 - Meta-Label distribution - Profitable: 1119 (33.3%), Unprofitable: 2245 (66.7%)
2025-10-31 01:54:21.520 | WARNING  | src.ai_engine.feature_engineering:prepare_for_model:230 - Se perdieron todos los datos al eliminar los NaN. Se conservarán los datos rellenados.
2025-10-31 01:54:21.530 | INFO     | __main__:prepare_training_data:75 - Data preparation complete. Shape of X: (5303, 116), Shape of y: (5303,)
2025-10-31 01:54:21.534 | INFO     | src.ai_engine.feature_engineering:create_sequences:261 - Creating sequences with length 50 from 5303 data points.
2025-10-31 01:54:21.596 | INFO     | src.ai_engine.feature_engineering:create_sequences:270 - Created 5253 sequences.
2025-10-31 01:54:21.598 | INFO     | __main__:main:164 - Initializing and training Ensemble model...
2025-10-31 01:54:21.599 | INFO     | src.ai_engine.ai_models:__init__:304 - Initialized Stacking Ensemble with Logistic Regression as meta-model.
2025-10-31 01:54:21.603 | INFO     | src.ai_engine.ai_models:fit:359 - Creating LSTM model...
2025-10-31 01:54:21.603 | INFO     | src.ai_engine.ai_models:fit:364 - Training base models...
2025-10-31 01:54:21.612 | INFO     | src.ai_engine.ai_models:fit:373 - Training random_forest...
2025-10-31 01:54:23.507 | INFO     | src.ai_engine.ai_models:fit:98 - RandomForest trained successfully on 5303 samples with 2 classes
2025-10-31 01:54:23.508 | INFO     | src.ai_engine.ai_models:fit:373 - Training gradient_boosting...
2025-10-31 01:55:16.607 | INFO     | src.ai_engine.ai_models:fit:157 - GradientBoosting trained successfully on 5303 samples with 2 classes
2025-10-31 01:55:16.608 | INFO     | src.ai_engine.ai_models:fit:373 - Training pattern_based...
2025-10-31 01:55:16.609 | INFO     | src.ai_engine.ai_models:fit:373 - Training lstm...
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\keras\src\layers\rnn\rnn.py:199: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(**kwargs)
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1108: RuntimeWarning: invalid value encountered in divide
  updated_mean = (last_sum + new_sum) / updated_sample_count
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1113: RuntimeWarning: invalid value encountered in divide
  T = new_sum / new_sample_count
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1133: RuntimeWarning: invalid value encountered in divide
  new_unnormalized_variance -= correction**2 / new_sample_count
Epoch 1/50
148/148 ━━━━━━━━━━━━━━━━━━━━ 6s 23ms/step - accuracy: 0.7868 - loss: 0.6739 - val_accuracy: 0.7966 - val_loss: 0.6543
Epoch 2/50
148/148 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7868 - loss: 0.6398 - val_accuracy: 0.7966 - val_loss: 0.6221
Epoch 3/50
148/148 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7868 - loss: 0.6120 - val_accuracy: 0.7966 - val_loss: 0.5963
Epoch 4/50
148/148 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7868 - loss: 0.5898 - val_accuracy: 0.7966 - val_loss: 0.5754
Epoch 5/50
148/148 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7868 - loss: 0.5723 - val_accuracy: 0.7966 - val_loss: 0.5589
Epoch 6/50
148/148 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7868 - loss: 0.5585 - val_accuracy: 0.7966 - val_loss: 0.5459
Epoch 7/50
148/148 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7868 - loss: 0.5479 - val_accuracy: 0.7966 - val_loss: 0.5358
Epoch 8/50
148/148 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7868 - loss: 0.5398 - val_accuracy: 0.7966 - val_loss: 0.5279
Epoch 9/50
148/148 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7868 - loss: 0.5337 - val_accuracy: 0.7966 - val_loss: 0.5221
Epoch 10/50
148/148 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7868 - loss: 0.5291 - val_accuracy: 0.7966 - val_loss: 0.5177
Epoch 11/50
148/148 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7868 - loss: 0.5258 - val_accuracy: 0.7966 - val_loss: 0.5143
Epoch 12/50
148/148 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7868 - loss: 0.5235 - val_accuracy: 0.7966 - val_loss: 0.5118
Epoch 13/50
148/148 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7868 - loss: 0.5218 - val_accuracy: 0.7966 - val_loss: 0.5100
Epoch 14/50
148/148 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7868 - loss: 0.5206 - val_accuracy: 0.7966 - val_loss: 0.5087
Epoch 15/50
148/148 ━━━━━━━━━━━━━━━━━━━━ 3s 20ms/step - accuracy: 0.7868 - loss: 0.5198 - val_accuracy: 0.7966 - val_loss: 0.5078
Epoch 16/50
148/148 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7868 - loss: 0.5192 - val_accuracy: 0.7966 - val_loss: 0.5071
Epoch 17/50
148/148 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7868 - loss: 0.5189 - val_accuracy: 0.7966 - val_loss: 0.5066
Epoch 18/50
148/148 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7868 - loss: 0.5186 - val_accuracy: 0.7966 - val_loss: 0.5063
Epoch 19/50
148/148 ━━━━━━━━━━━━━━━━━━━━ 3s 20ms/step - accuracy: 0.7868 - loss: 0.5185 - val_accuracy: 0.7966 - val_loss: 0.5060
Epoch 20/50
148/148 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7868 - loss: 0.5184 - val_accuracy: 0.7966 - val_loss: 0.5058
Epoch 21/50
148/148 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7868 - loss: 0.5183 - val_accuracy: 0.7966 - val_loss: 0.5057
Epoch 22/50
148/148 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7868 - loss: 0.5183 - val_accuracy: 0.7966 - val_loss: 0.5056
Epoch 23/50
148/148 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7868 - loss: 0.5183 - val_accuracy: 0.7966 - val_loss: 0.5056
Epoch 24/50
148/148 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7868 - loss: 0.5183 - val_accuracy: 0.7966 - val_loss: 0.5055
Epoch 25/50
148/148 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7868 - loss: 0.5183 - val_accuracy: 0.7966 - val_loss: 0.5055
Epoch 26/50
148/148 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7868 - loss: 0.5183 - val_accuracy: 0.7966 - val_loss: 0.5055
Epoch 27/50
148/148 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7868 - loss: 0.5183 - val_accuracy: 0.7966 - val_loss: 0.5054
Epoch 28/50
148/148 ━━━━━━━━━━━━━━━━━━━━ 5s 21ms/step - accuracy: 0.7868 - loss: 0.5183 - val_accuracy: 0.7966 - val_loss: 0.5054
Epoch 29/50
148/148 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7868 - loss: 0.5182 - val_accuracy: 0.7966 - val_loss: 0.5054
Epoch 30/50
148/148 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7868 - loss: 0.5183 - val_accuracy: 0.7966 - val_loss: 0.5054
Epoch 31/50
148/148 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7868 - loss: 0.5183 - val_accuracy: 0.7966 - val_loss: 0.5054
Epoch 32/50
148/148 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7868 - loss: 0.5183 - val_accuracy: 0.7966 - val_loss: 0.5054
Epoch 33/50
148/148 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7868 - loss: 0.5182 - val_accuracy: 0.7966 - val_loss: 0.5054
Epoch 34/50
148/148 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7868 - loss: 0.5183 - val_accuracy: 0.7966 - val_loss: 0.5054
Epoch 35/50
148/148 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7868 - loss: 0.5182 - val_accuracy: 0.7966 - val_loss: 0.5054
Epoch 36/50
148/148 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7868 - loss: 0.5182 - val_accuracy: 0.7966 - val_loss: 0.5054
Epoch 37/50
148/148 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7868 - loss: 0.5183 - val_accuracy: 0.7966 - val_loss: 0.5054
Epoch 38/50
148/148 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7868 - loss: 0.5182 - val_accuracy: 0.7966 - val_loss: 0.5054
Epoch 39/50
148/148 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7868 - loss: 0.5182 - val_accuracy: 0.7966 - val_loss: 0.5054
Epoch 40/50
148/148 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7868 - loss: 0.5182 - val_accuracy: 0.7966 - val_loss: 0.5054
Epoch 41/50
148/148 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7868 - loss: 0.5183 - val_accuracy: 0.7966 - val_loss: 0.5054
Epoch 42/50
148/148 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7868 - loss: 0.5183 - val_accuracy: 0.7966 - val_loss: 0.5054
Epoch 43/50
148/148 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7868 - loss: 0.5182 - val_accuracy: 0.7966 - val_loss: 0.5054
Epoch 44/50
148/148 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7868 - loss: 0.5182 - val_accuracy: 0.7966 - val_loss: 0.5054
Epoch 45/50
148/148 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7868 - loss: 0.5182 - val_accuracy: 0.7966 - val_loss: 0.5054
Epoch 46/50
148/148 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7868 - loss: 0.5183 - val_accuracy: 0.7966 - val_loss: 0.5054
Epoch 47/50
148/148 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7868 - loss: 0.5183 - val_accuracy: 0.7966 - val_loss: 0.5054
Epoch 48/50
148/148 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7868 - loss: 0.5183 - val_accuracy: 0.7966 - val_loss: 0.5053
Epoch 49/50
148/148 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7868 - loss: 0.5183 - val_accuracy: 0.7966 - val_loss: 0.5054
Epoch 50/50
148/148 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7868 - loss: 0.5182 - val_accuracy: 0.7966 - val_loss: 0.5054
2025-10-31 01:57:58.164 | INFO     | src.ai_engine.ai_models:fit:685 - LSTM trained successfully.
2025-10-31 01:57:58.173 | INFO     | src.ai_engine.ai_models:fit:381 - Generating base model predictions for meta-model training...
2025-10-31 01:57:58.518 | INFO     | src.ai_engine.feature_engineering:create_sequences:261 - Creating sequences with length 50 from 5303 data points.
2025-10-31 01:57:58.580 | INFO     | src.ai_engine.feature_engineering:create_sequences:270 - Created 5253 sequences.
WARNING:tensorflow:5 out of the last 647 calls to <function TensorFlowTrainer.make_predict_function.<locals>.one_step_on_data_distributed at 0x000001C807062C00> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has reduce_retracing=True option that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
165/165 ━━━━━━━━━━━━━━━━━━━━ 2s 9ms/step
2025-10-31 01:58:00.714 | INFO     | src.ai_engine.ai_models:fit:396 - Training meta-model...
2025-10-31 01:58:00.721 | SUCCESS  | src.ai_engine.ai_models:fit:399 - Stacking Ensemble trained successfully.
2025-10-31 01:58:00.722 | SUCCESS  | __main__:main:167 - Final Ensemble model trained.
2025-10-31 01:58:00.722 | INFO     | __main__:main:171 - Saving models to 'models\GainX_1200\1h'...
2025-10-31 01:58:00.740 | INFO     | src.ai_engine.ai_models:save:52 - Model RandomForest saved to models\GainX_1200\1h\random_forest.pkl
2025-10-31 01:58:00.749 | INFO     | src.ai_engine.ai_models:save:52 - Model GradientBoosting saved to models\GainX_1200\1h\gradient_boosting.pkl
2025-10-31 01:58:00.781 | INFO     | src.ai_engine.ai_models:save:731 - LSTM model saved to models\GainX_1200\1h\lstm.keras, models\GainX_1200\1h\lstm_scaler.pkl and marker file models\GainX_1200\1h\lstm.pkl
2025-10-31 01:58:00.782 | INFO     | src.ai_engine.ai_models:save_all:463 - Meta-model saved to models\GainX_1200\1h\meta_model.pkl
2025-10-31 01:58:00.783 | SUCCESS  | __main__:main:174 - --- Finished training for Symbol: GainX 1200, Timeframe: 1h ---
2025-10-31 01:58:00.786 | INFO     | __main__:main:140 - --- Starting training for Symbol: GainX 1200, Timeframe: 1m ---
2025-10-31 01:58:00.979 | SUCCESS  | __main__:main:148 - Loaded 100001 records.
2025-10-31 01:58:00.980 | INFO     | __main__:prepare_training_data:32 - Preparing data for training with Meta-Labeling...
2025-10-31 01:58:06.465 | DEBUG    | src.ai_engine.technical_indicators:calculate_all:47 - Calculated 63 technical indicators
2025-10-31 01:58:23.311 | DEBUG    | src.ai_engine.feature_engineering:extract_features:66 - Extracted 116 features
2025-10-31 01:58:23.315 | INFO     | __main__:prepare_training_data:39 - Generating signals from primary model (SimplePatternModel)...
2025-10-31 01:58:23.536 | WARNING  | src.ai_engine.feature_engineering:prepare_for_model:230 - Se perdieron todos los datos al eliminar los NaN. Se conservarán los datos rellenados.
2025-10-31 01:58:39.354 | INFO     | src.ai_engine.ai_models:calculate_optimal_threshold:549 - Calculated optimal threshold: 0.0010 (volatility: 0.0001, avg_movement: 0.0002)
2025-10-31 01:58:39.356 | INFO     | src.ai_engine.ai_models:create_meta_labels:577 - Creating meta-labels for secondary model...
2025-10-31 01:58:50.922 | INFO     | src.ai_engine.ai_models:create_meta_labels:629 - Meta-Label distribution - Profitable: 2 (2.2%), Unprofitable: 91 (97.8%)
2025-10-31 01:58:51.145 | WARNING  | src.ai_engine.feature_engineering:prepare_for_model:230 - Se perdieron todos los datos al eliminar los NaN. Se conservarán los datos rellenados.
2025-10-31 01:58:51.225 | INFO     | __main__:prepare_training_data:75 - Data preparation complete. Shape of X: (51299, 116), Shape of y: (51299,)
2025-10-31 01:58:51.260 | INFO     | src.ai_engine.feature_engineering:create_sequences:261 - Creating sequences with length 50 from 51299 data points.
2025-10-31 01:58:51.849 | INFO     | src.ai_engine.feature_engineering:create_sequences:270 - Created 51249 sequences.
2025-10-31 01:58:51.864 | INFO     | __main__:main:164 - Initializing and training Ensemble model...
2025-10-31 01:58:51.865 | INFO     | src.ai_engine.ai_models:__init__:304 - Initialized Stacking Ensemble with Logistic Regression as meta-model.
2025-10-31 01:58:51.868 | INFO     | src.ai_engine.ai_models:fit:359 - Creating LSTM model...
2025-10-31 01:58:51.870 | INFO     | src.ai_engine.ai_models:fit:364 - Training base models...
2025-10-31 01:58:51.961 | INFO     | src.ai_engine.ai_models:fit:373 - Training random_forest...
2025-10-31 01:58:52.083 | ERROR    | src.ai_engine.ai_models:fit:379 - Error training random_forest: Requesting 3-fold cross-validation but provided less than 3 examples for at least one class.
2025-10-31 01:58:52.087 | INFO     | src.ai_engine.ai_models:fit:373 - Training gradient_boosting...
2025-10-31 01:58:52.211 | ERROR    | src.ai_engine.ai_models:fit:379 - Error training gradient_boosting: Requesting 3-fold cross-validation but provided less than 3 examples for at least one class.
2025-10-31 01:58:52.215 | INFO     | src.ai_engine.ai_models:fit:373 - Training pattern_based...
2025-10-31 01:58:52.216 | INFO     | src.ai_engine.ai_models:fit:373 - Training lstm...
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\keras\src\layers\rnn\rnn.py:199: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(**kwargs)
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1108: RuntimeWarning: invalid value encountered in divide
  updated_mean = (last_sum + new_sum) / updated_sample_count
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1113: RuntimeWarning: invalid value encountered in divide
  T = new_sum / new_sample_count
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1133: RuntimeWarning: invalid value encountered in divide
  new_unnormalized_variance -= correction**2 / new_sample_count
Epoch 1/50
1442/1442 ━━━━━━━━━━━━━━━━━━━━ 112s 23ms/step - accuracy: 1.0000 - loss: 0.4363 - val_accuracy: 1.0000 - val_loss: 0.2598
Epoch 2/50
1442/1442 ━━━━━━━━━━━━━━━━━━━━ 30s 21ms/step - accuracy: 1.0000 - loss: 0.1754 - val_accuracy: 1.0000 - val_loss: 0.1145
Epoch 3/50
1442/1442 ━━━━━━━━━━━━━━━━━━━━ 30s 21ms/step - accuracy: 1.0000 - loss: 0.0815 - val_accuracy: 1.0000 - val_loss: 0.0561
Epoch 4/50
1442/1442 ━━━━━━━━━━━━━━━━━━━━ 30s 21ms/step - accuracy: 1.0000 - loss: 0.0412 - val_accuracy: 1.0000 - val_loss: 0.0291
Epoch 5/50
1442/1442 ━━━━━━━━━━━━━━━━━━━━ 29s 20ms/step - accuracy: 1.0000 - loss: 0.0218 - val_accuracy: 1.0000 - val_loss: 0.0156
Epoch 6/50
1442/1442 ━━━━━━━━━━━━━━━━━━━━ 29s 20ms/step - accuracy: 1.0000 - loss: 0.0118 - val_accuracy: 1.0000 - val_loss: 0.0084
Epoch 7/50
1442/1442 ━━━━━━━━━━━━━━━━━━━━ 29s 20ms/step - accuracy: 1.0000 - loss: 0.0065 - val_accuracy: 1.0000 - val_loss: 0.0046
Epoch 8/50
1442/1442 ━━━━━━━━━━━━━━━━━━━━ 29s 20ms/step - accuracy: 1.0000 - loss: 0.0037 - val_accuracy: 1.0000 - val_loss: 0.0025
Epoch 9/50
1442/1442 ━━━━━━━━━━━━━━━━━━━━ 29s 20ms/step - accuracy: 1.0000 - loss: 0.0022 - val_accuracy: 1.0000 - val_loss: 0.0014
Epoch 10/50
1442/1442 ━━━━━━━━━━━━━━━━━━━━ 29s 20ms/step - accuracy: 1.0000 - loss: 0.0014 - val_accuracy: 1.0000 - val_loss: 8.2845e-04
Epoch 11/50
1442/1442 ━━━━━━━━━━━━━━━━━━━━ 29s 20ms/step - accuracy: 1.0000 - loss: 9.6997e-04 - val_accuracy: 1.0000 - val_loss: 5.0922e-04
Epoch 12/50
1442/1442 ━━━━━━━━━━━━━━━━━━━━ 29s 20ms/step - accuracy: 1.0000 - loss: 7.5623e-04 - val_accuracy: 1.0000 - val_loss: 3.4530e-04
Epoch 13/50
1442/1442 ━━━━━━━━━━━━━━━━━━━━ 29s 20ms/step - accuracy: 1.0000 - loss: 6.4369e-04 - val_accuracy: 1.0000 - val_loss: 2.4843e-04
Epoch 14/50
1442/1442 ━━━━━━━━━━━━━━━━━━━━ 29s 20ms/step - accuracy: 1.0000 - loss: 5.8543e-04 - val_accuracy: 1.0000 - val_loss: 1.9471e-04
Epoch 15/50
1442/1442 ━━━━━━━━━━━━━━━━━━━━ 29s 20ms/step - accuracy: 1.0000 - loss: 5.5385e-04 - val_accuracy: 1.0000 - val_loss: 1.6564e-04
Epoch 16/50
1442/1442 ━━━━━━━━━━━━━━━━━━━━ 29s 20ms/step - accuracy: 1.0000 - loss: 5.3461e-04 - val_accuracy: 1.0000 - val_loss: 1.4273e-04
Epoch 17/50
1442/1442 ━━━━━━━━━━━━━━━━━━━━ 29s 20ms/step - accuracy: 1.0000 - loss: 5.2145e-04 - val_accuracy: 1.0000 - val_loss: 1.2683e-04
Epoch 18/50
1442/1442 ━━━━━━━━━━━━━━━━━━━━ 29s 20ms/step - accuracy: 1.0000 - loss: 5.1151e-04 - val_accuracy: 1.0000 - val_loss: 1.1000e-04
Epoch 19/50
1442/1442 ━━━━━━━━━━━━━━━━━━━━ 29s 20ms/step - accuracy: 1.0000 - loss: 5.0314e-04 - val_accuracy: 1.0000 - val_loss: 1.0137e-04
Epoch 20/50
1442/1442 ━━━━━━━━━━━━━━━━━━━━ 29s 20ms/step - accuracy: 1.0000 - loss: 4.9854e-04 - val_accuracy: 1.0000 - val_loss: 9.4070e-05
Epoch 21/50
1442/1442 ━━━━━━━━━━━━━━━━━━━━ 29s 20ms/step - accuracy: 1.0000 - loss: 4.9490e-04 - val_accuracy: 1.0000 - val_loss: 8.8174e-05
Epoch 22/50
1442/1442 ━━━━━━━━━━━━━━━━━━━━ 29s 20ms/step - accuracy: 1.0000 - loss: 4.9205e-04 - val_accuracy: 1.0000 - val_loss: 8.2700e-05
Epoch 23/50
1442/1442 ━━━━━━━━━━━━━━━━━━━━ 29s 20ms/step - accuracy: 1.0000 - loss: 4.8976e-04 - val_accuracy: 1.0000 - val_loss: 7.7582e-05
Epoch 24/50
1442/1442 ━━━━━━━━━━━━━━━━━━━━ 29s 20ms/step - accuracy: 1.0000 - loss: 4.8751e-04 - val_accuracy: 1.0000 - val_loss: 7.3981e-05
Epoch 25/50
1442/1442 ━━━━━━━━━━━━━━━━━━━━ 29s 20ms/step - accuracy: 1.0000 - loss: 4.8612e-04 - val_accuracy: 1.0000 - val_loss: 7.0614e-05
Epoch 26/50
1442/1442 ━━━━━━━━━━━━━━━━━━━━ 29s 20ms/step - accuracy: 1.0000 - loss: 4.8503e-04 - val_accuracy: 1.0000 - val_loss: 6.7194e-05
Epoch 27/50
1442/1442 ━━━━━━━━━━━━━━━━━━━━ 29s 20ms/step - accuracy: 1.0000 - loss: 4.8372e-04 - val_accuracy: 1.0000 - val_loss: 6.4788e-05
Epoch 28/50
1442/1442 ━━━━━━━━━━━━━━━━━━━━ 29s 20ms/step - accuracy: 1.0000 - loss: 4.8334e-04 - val_accuracy: 1.0000 - val_loss: 6.1478e-05
Epoch 29/50
1442/1442 ━━━━━━━━━━━━━━━━━━━━ 29s 20ms/step - accuracy: 1.0000 - loss: 4.8227e-04 - val_accuracy: 1.0000 - val_loss: 5.9456e-05
Epoch 30/50
1442/1442 ━━━━━━━━━━━━━━━━━━━━ 29s 20ms/step - accuracy: 1.0000 - loss: 4.8143e-04 - val_accuracy: 1.0000 - val_loss: 5.7789e-05
Epoch 31/50
1442/1442 ━━━━━━━━━━━━━━━━━━━━ 29s 20ms/step - accuracy: 1.0000 - loss: 4.8119e-04 - val_accuracy: 1.0000 - val_loss: 5.6170e-05
Epoch 32/50
1442/1442 ━━━━━━━━━━━━━━━━━━━━ 29s 20ms/step - accuracy: 1.0000 - loss: 4.8107e-04 - val_accuracy: 1.0000 - val_loss: 5.4306e-05
Epoch 33/50
1442/1442 ━━━━━━━━━━━━━━━━━━━━ 29s 20ms/step - accuracy: 1.0000 - loss: 4.8070e-04 - val_accuracy: 1.0000 - val_loss: 5.2918e-05
Epoch 34/50
1442/1442 ━━━━━━━━━━━━━━━━━━━━ 29s 20ms/step - accuracy: 1.0000 - loss: 4.8031e-04 - val_accuracy: 1.0000 - val_loss: 5.1916e-05
Epoch 35/50
1442/1442 ━━━━━━━━━━━━━━━━━━━━ 29s 20ms/step - accuracy: 1.0000 - loss: 4.7999e-04 - val_accuracy: 1.0000 - val_loss: 5.0935e-05
Epoch 36/50
1442/1442 ━━━━━━━━━━━━━━━━━━━━ 29s 20ms/step - accuracy: 1.0000 - loss: 4.8001e-04 - val_accuracy: 1.0000 - val_loss: 4.9831e-05
Epoch 37/50
1442/1442 ━━━━━━━━━━━━━━━━━━━━ 29s 20ms/step - accuracy: 1.0000 - loss: 4.7984e-04 - val_accuracy: 1.0000 - val_loss: 4.8938e-05
Epoch 38/50
1442/1442 ━━━━━━━━━━━━━━━━━━━━ 29s 20ms/step - accuracy: 1.0000 - loss: 4.7988e-04 - val_accuracy: 1.0000 - val_loss: 4.7970e-05
Epoch 39/50
1442/1442 ━━━━━━━━━━━━━━━━━━━━ 29s 20ms/step - accuracy: 1.0000 - loss: 4.7970e-04 - val_accuracy: 1.0000 - val_loss: 4.7239e-05
Epoch 40/50
1442/1442 ━━━━━━━━━━━━━━━━━━━━ 29s 20ms/step - accuracy: 1.0000 - loss: 4.7979e-04 - val_accuracy: 1.0000 - val_loss: 4.6400e-05
Epoch 41/50
1442/1442 ━━━━━━━━━━━━━━━━━━━━ 29s 20ms/step - accuracy: 1.0000 - loss: 4.7941e-04 - val_accuracy: 1.0000 - val_loss: 4.5766e-05
Epoch 42/50
1442/1442 ━━━━━━━━━━━━━━━━━━━━ 29s 20ms/step - accuracy: 1.0000 - loss: 4.7962e-04 - val_accuracy: 1.0000 - val_loss: 4.5056e-05
Epoch 43/50
1442/1442 ━━━━━━━━━━━━━━━━━━━━ 29s 20ms/step - accuracy: 1.0000 - loss: 4.7945e-04 - val_accuracy: 1.0000 - val_loss: 4.4601e-05
Epoch 44/50
1442/1442 ━━━━━━━━━━━━━━━━━━━━ 29s 20ms/step - accuracy: 1.0000 - loss: 4.7950e-04 - val_accuracy: 1.0000 - val_loss: 4.4099e-05
Epoch 45/50
1442/1442 ━━━━━━━━━━━━━━━━━━━━ 29s 20ms/step - accuracy: 1.0000 - loss: 4.7999e-04 - val_accuracy: 1.0000 - val_loss: 4.2408e-05
Epoch 46/50
1442/1442 ━━━━━━━━━━━━━━━━━━━━ 29s 20ms/step - accuracy: 1.0000 - loss: 4.7934e-04 - val_accuracy: 1.0000 - val_loss: 4.2801e-05
Epoch 47/50
1442/1442 ━━━━━━━━━━━━━━━━━━━━ 29s 20ms/step - accuracy: 1.0000 - loss: 4.7955e-04 - val_accuracy: 1.0000 - val_loss: 4.2343e-05
Epoch 48/50
1442/1442 ━━━━━━━━━━━━━━━━━━━━ 29s 20ms/step - accuracy: 1.0000 - loss: 4.7944e-04 - val_accuracy: 1.0000 - val_loss: 4.2039e-05
Epoch 49/50
1442/1442 ━━━━━━━━━━━━━━━━━━━━ 29s 20ms/step - accuracy: 1.0000 - loss: 4.7948e-04 - val_accuracy: 1.0000 - val_loss: 4.1676e-05
Epoch 50/50
1442/1442 ━━━━━━━━━━━━━━━━━━━━ 29s 20ms/step - accuracy: 1.0000 - loss: 4.7947e-04 - val_accuracy: 1.0000 - val_loss: 4.1393e-05
2025-10-31 02:39:03.025 | INFO     | src.ai_engine.ai_models:fit:685 - LSTM trained successfully.
2025-10-31 02:39:03.885 | INFO     | src.ai_engine.ai_models:fit:381 - Generating base model predictions for meta-model training...
2025-10-31 02:39:11.312 | INFO     | src.ai_engine.feature_engineering:create_sequences:261 - Creating sequences with length 50 from 51299 data points.
2025-10-31 02:39:12.033 | INFO     | src.ai_engine.feature_engineering:create_sequences:270 - Created 51249 sequences.
1602/1602 ━━━━━━━━━━━━━━━━━━━━ 170s 18ms/step
2025-10-31 02:52:51.873 | INFO     | src.ai_engine.ai_models:fit:396 - Training meta-model...
2025-10-31 02:53:02.425 | SUCCESS  | src.ai_engine.ai_models:fit:399 - Stacking Ensemble trained successfully.
2025-10-31 02:53:02.828 | SUCCESS  | __main__:main:167 - Final Ensemble model trained.
2025-10-31 02:53:02.852 | INFO     | __main__:main:171 - Saving models to 'models\GainX_1200\1m'...
2025-10-31 02:53:04.276 | INFO     | src.ai_engine.ai_models:save:52 - Model RandomForest saved to models\GainX_1200\1m\random_forest.pkl
2025-10-31 02:53:04.833 | INFO     | src.ai_engine.ai_models:save:52 - Model GradientBoosting saved to models\GainX_1200\1m\gradient_boosting.pkl
2025-10-31 02:53:13.051 | INFO     | src.ai_engine.ai_models:save:731 - LSTM model saved to models\GainX_1200\1m\lstm.keras, models\GainX_1200\1m\lstm_scaler.pkl and marker file models\GainX_1200\1m\lstm.pkl
2025-10-31 02:53:13.074 | INFO     | src.ai_engine.ai_models:save_all:463 - Meta-model saved to models\GainX_1200\1m\meta_model.pkl
2025-10-31 02:53:13.093 | SUCCESS  | __main__:main:174 - --- Finished training for Symbol: GainX 1200, Timeframe: 1m ---
2025-10-31 02:53:13.123 | INFO     | __main__:main:140 - --- Starting training for Symbol: GainX 1200, Timeframe: 4h ---
2025-10-31 02:53:15.675 | SUCCESS  | __main__:main:148 - Loaded 1809 records.
2025-10-31 02:53:15.678 | INFO     | __main__:prepare_training_data:32 - Preparing data for training with Meta-Labeling...
2025-10-31 02:53:17.277 | DEBUG    | src.ai_engine.technical_indicators:calculate_all:47 - Calculated 63 technical indicators
2025-10-31 02:53:18.776 | DEBUG    | src.ai_engine.feature_engineering:extract_features:66 - Extracted 116 features
2025-10-31 02:53:18.796 | INFO     | __main__:prepare_training_data:39 - Generating signals from primary model (SimplePatternModel)...
2025-10-31 02:53:18.880 | WARNING  | src.ai_engine.feature_engineering:prepare_for_model:230 - Se perdieron todos los datos al eliminar los NaN. Se conservarán los datos rellenados.
2025-10-31 02:53:20.182 | INFO     | src.ai_engine.ai_models:calculate_optimal_threshold:549 - Calculated optimal threshold: 0.0027 (volatility: 0.0009, avg_movement: 0.0039)
2025-10-31 02:53:20.184 | INFO     | src.ai_engine.ai_models:create_meta_labels:577 - Creating meta-labels for secondary model...
2025-10-31 02:53:20.425 | INFO     | src.ai_engine.ai_models:create_meta_labels:629 - Meta-Label distribution - Profitable: 310 (37.8%), Unprofitable: 510 (62.2%)
2025-10-31 02:53:20.551 | WARNING  | src.ai_engine.feature_engineering:prepare_for_model:230 - Se perdieron todos los datos al eliminar los NaN. Se conservarán los datos rellenados.
2025-10-31 02:53:20.557 | INFO     | __main__:prepare_training_data:75 - Data preparation complete. Shape of X: (1220, 116), Shape of y: (1220,)
2025-10-31 02:53:20.996 | INFO     | src.ai_engine.feature_engineering:create_sequences:261 - Creating sequences with length 50 from 1220 data points.
2025-10-31 02:53:21.066 | INFO     | src.ai_engine.feature_engineering:create_sequences:270 - Created 1170 sequences.
2025-10-31 02:53:21.573 | INFO     | __main__:main:164 - Initializing and training Ensemble model...
2025-10-31 02:53:21.627 | INFO     | src.ai_engine.ai_models:__init__:304 - Initialized Stacking Ensemble with Logistic Regression as meta-model.
2025-10-31 02:53:21.710 | INFO     | src.ai_engine.ai_models:fit:359 - Creating LSTM model...
2025-10-31 02:53:21.728 | INFO     | src.ai_engine.ai_models:fit:364 - Training base models...
2025-10-31 02:53:21.735 | INFO     | src.ai_engine.ai_models:fit:373 - Training random_forest...
2025-10-31 02:53:25.944 | INFO     | src.ai_engine.ai_models:fit:98 - RandomForest trained successfully on 1220 samples with 2 classes
2025-10-31 02:53:26.012 | INFO     | src.ai_engine.ai_models:fit:373 - Training gradient_boosting...
2025-10-31 02:53:39.332 | INFO     | src.ai_engine.ai_models:fit:157 - GradientBoosting trained successfully on 1220 samples with 2 classes
2025-10-31 02:53:39.332 | INFO     | src.ai_engine.ai_models:fit:373 - Training pattern_based...
2025-10-31 02:53:39.334 | INFO     | src.ai_engine.ai_models:fit:373 - Training lstm...
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\keras\src\layers\rnn\rnn.py:199: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(**kwargs)
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1108: RuntimeWarning: invalid value encountered in divide
  updated_mean = (last_sum + new_sum) / updated_sample_count
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1113: RuntimeWarning: invalid value encountered in divide
  T = new_sum / new_sample_count
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1133: RuntimeWarning: invalid value encountered in divide
  new_unnormalized_variance -= correction**2 / new_sample_count
Epoch 1/50
33/33 ━━━━━━━━━━━━━━━━━━━━ 21s 90ms/step - accuracy: 0.7369 - loss: 0.6897 - val_accuracy: 0.8718 - val_loss: 0.6818
Epoch 2/50
33/33 ━━━━━━━━━━━━━━━━━━━━ 1s 28ms/step - accuracy: 0.7369 - loss: 0.6827 - val_accuracy: 0.8718 - val_loss: 0.6709
Epoch 3/50
33/33 ━━━━━━━━━━━━━━━━━━━━ 1s 26ms/step - accuracy: 0.7369 - loss: 0.6759 - val_accuracy: 0.8718 - val_loss: 0.6603
Epoch 4/50
33/33 ━━━━━━━━━━━━━━━━━━━━ 1s 22ms/step - accuracy: 0.7369 - loss: 0.6695 - val_accuracy: 0.8718 - val_loss: 0.6499
Epoch 5/50
33/33 ━━━━━━━━━━━━━━━━━━━━ 1s 22ms/step - accuracy: 0.7369 - loss: 0.6633 - val_accuracy: 0.8718 - val_loss: 0.6403
Epoch 6/50
33/33 ━━━━━━━━━━━━━━━━━━━━ 1s 26ms/step - accuracy: 0.7369 - loss: 0.6577 - val_accuracy: 0.8718 - val_loss: 0.6305
Epoch 7/50
33/33 ━━━━━━━━━━━━━━━━━━━━ 1s 23ms/step - accuracy: 0.7369 - loss: 0.6521 - val_accuracy: 0.8718 - val_loss: 0.6216
Epoch 8/50
33/33 ━━━━━━━━━━━━━━━━━━━━ 1s 24ms/step - accuracy: 0.7369 - loss: 0.6470 - val_accuracy: 0.8718 - val_loss: 0.6128
Epoch 9/50
33/33 ━━━━━━━━━━━━━━━━━━━━ 1s 32ms/step - accuracy: 0.7369 - loss: 0.6421 - val_accuracy: 0.8718 - val_loss: 0.6045
Epoch 10/50
33/33 ━━━━━━━━━━━━━━━━━━━━ 1s 23ms/step - accuracy: 0.7369 - loss: 0.6376 - val_accuracy: 0.8718 - val_loss: 0.5966
Epoch 11/50
33/33 ━━━━━━━━━━━━━━━━━━━━ 1s 25ms/step - accuracy: 0.7369 - loss: 0.6333 - val_accuracy: 0.8718 - val_loss: 0.5892
Epoch 12/50
33/33 ━━━━━━━━━━━━━━━━━━━━ 1s 22ms/step - accuracy: 0.7369 - loss: 0.6293 - val_accuracy: 0.8718 - val_loss: 0.5816
Epoch 13/50
33/33 ━━━━━━━━━━━━━━━━━━━━ 1s 23ms/step - accuracy: 0.7369 - loss: 0.6255 - val_accuracy: 0.8718 - val_loss: 0.5748
Epoch 14/50
33/33 ━━━━━━━━━━━━━━━━━━━━ 1s 23ms/step - accuracy: 0.7369 - loss: 0.6219 - val_accuracy: 0.8718 - val_loss: 0.5682
Epoch 15/50
33/33 ━━━━━━━━━━━━━━━━━━━━ 1s 22ms/step - accuracy: 0.7369 - loss: 0.6186 - val_accuracy: 0.8718 - val_loss: 0.5616
Epoch 16/50
33/33 ━━━━━━━━━━━━━━━━━━━━ 1s 22ms/step - accuracy: 0.7369 - loss: 0.6155 - val_accuracy: 0.8718 - val_loss: 0.5556
Epoch 17/50
33/33 ━━━━━━━━━━━━━━━━━━━━ 1s 23ms/step - accuracy: 0.7369 - loss: 0.6126 - val_accuracy: 0.8718 - val_loss: 0.5498
Epoch 18/50
33/33 ━━━━━━━━━━━━━━━━━━━━ 1s 23ms/step - accuracy: 0.7369 - loss: 0.6099 - val_accuracy: 0.8718 - val_loss: 0.5440
Epoch 19/50
33/33 ━━━━━━━━━━━━━━━━━━━━ 1s 23ms/step - accuracy: 0.7369 - loss: 0.6072 - val_accuracy: 0.8718 - val_loss: 0.5389
Epoch 20/50
33/33 ━━━━━━━━━━━━━━━━━━━━ 1s 22ms/step - accuracy: 0.7369 - loss: 0.6049 - val_accuracy: 0.8718 - val_loss: 0.5336
Epoch 21/50
33/33 ━━━━━━━━━━━━━━━━━━━━ 1s 22ms/step - accuracy: 0.7369 - loss: 0.6026 - val_accuracy: 0.8718 - val_loss: 0.5291
Epoch 22/50
33/33 ━━━━━━━━━━━━━━━━━━━━ 1s 22ms/step - accuracy: 0.7369 - loss: 0.6006 - val_accuracy: 0.8718 - val_loss: 0.5247
Epoch 23/50
33/33 ━━━━━━━━━━━━━━━━━━━━ 1s 22ms/step - accuracy: 0.7369 - loss: 0.5987 - val_accuracy: 0.8718 - val_loss: 0.5200
Epoch 24/50
33/33 ━━━━━━━━━━━━━━━━━━━━ 1s 22ms/step - accuracy: 0.7369 - loss: 0.5968 - val_accuracy: 0.8718 - val_loss: 0.5161
Epoch 25/50
33/33 ━━━━━━━━━━━━━━━━━━━━ 1s 23ms/step - accuracy: 0.7369 - loss: 0.5952 - val_accuracy: 0.8718 - val_loss: 0.5119
Epoch 26/50
33/33 ━━━━━━━━━━━━━━━━━━━━ 1s 22ms/step - accuracy: 0.7369 - loss: 0.5936 - val_accuracy: 0.8718 - val_loss: 0.5081
Epoch 27/50
33/33 ━━━━━━━━━━━━━━━━━━━━ 1s 23ms/step - accuracy: 0.7369 - loss: 0.5922 - val_accuracy: 0.8718 - val_loss: 0.5041
Epoch 28/50
33/33 ━━━━━━━━━━━━━━━━━━━━ 1s 22ms/step - accuracy: 0.7369 - loss: 0.5908 - val_accuracy: 0.8718 - val_loss: 0.5010
Epoch 29/50
33/33 ━━━━━━━━━━━━━━━━━━━━ 1s 22ms/step - accuracy: 0.7369 - loss: 0.5896 - val_accuracy: 0.8718 - val_loss: 0.4977
Epoch 30/50
33/33 ━━━━━━━━━━━━━━━━━━━━ 1s 22ms/step - accuracy: 0.7369 - loss: 0.5884 - val_accuracy: 0.8718 - val_loss: 0.4944
Epoch 31/50
33/33 ━━━━━━━━━━━━━━━━━━━━ 1s 22ms/step - accuracy: 0.7369 - loss: 0.5874 - val_accuracy: 0.8718 - val_loss: 0.4913
Epoch 32/50
33/33 ━━━━━━━━━━━━━━━━━━━━ 1s 22ms/step - accuracy: 0.7369 - loss: 0.5864 - val_accuracy: 0.8718 - val_loss: 0.4888
Epoch 33/50
33/33 ━━━━━━━━━━━━━━━━━━━━ 1s 22ms/step - accuracy: 0.7369 - loss: 0.5855 - val_accuracy: 0.8718 - val_loss: 0.4856
Epoch 34/50
33/33 ━━━━━━━━━━━━━━━━━━━━ 1s 22ms/step - accuracy: 0.7369 - loss: 0.5846 - val_accuracy: 0.8718 - val_loss: 0.4833
Epoch 35/50
33/33 ━━━━━━━━━━━━━━━━━━━━ 1s 24ms/step - accuracy: 0.7369 - loss: 0.5839 - val_accuracy: 0.8718 - val_loss: 0.4810
Epoch 36/50
33/33 ━━━━━━━━━━━━━━━━━━━━ 1s 22ms/step - accuracy: 0.7369 - loss: 0.5832 - val_accuracy: 0.8718 - val_loss: 0.4786
Epoch 37/50
33/33 ━━━━━━━━━━━━━━━━━━━━ 1s 22ms/step - accuracy: 0.7369 - loss: 0.5825 - val_accuracy: 0.8718 - val_loss: 0.4763
Epoch 38/50
33/33 ━━━━━━━━━━━━━━━━━━━━ 1s 22ms/step - accuracy: 0.7369 - loss: 0.5820 - val_accuracy: 0.8718 - val_loss: 0.4741
Epoch 39/50
33/33 ━━━━━━━━━━━━━━━━━━━━ 1s 22ms/step - accuracy: 0.7369 - loss: 0.5814 - val_accuracy: 0.8718 - val_loss: 0.4719
Epoch 40/50
33/33 ━━━━━━━━━━━━━━━━━━━━ 1s 22ms/step - accuracy: 0.7369 - loss: 0.5809 - val_accuracy: 0.8718 - val_loss: 0.4699
Epoch 41/50
33/33 ━━━━━━━━━━━━━━━━━━━━ 1s 22ms/step - accuracy: 0.7369 - loss: 0.5804 - val_accuracy: 0.8718 - val_loss: 0.4686
Epoch 42/50
33/33 ━━━━━━━━━━━━━━━━━━━━ 1s 22ms/step - accuracy: 0.7369 - loss: 0.5801 - val_accuracy: 0.8718 - val_loss: 0.4666
Epoch 43/50
33/33 ━━━━━━━━━━━━━━━━━━━━ 1s 22ms/step - accuracy: 0.7369 - loss: 0.5797 - val_accuracy: 0.8718 - val_loss: 0.4648
Epoch 44/50
33/33 ━━━━━━━━━━━━━━━━━━━━ 1s 23ms/step - accuracy: 0.7369 - loss: 0.5793 - val_accuracy: 0.8718 - val_loss: 0.4634
Epoch 45/50
33/33 ━━━━━━━━━━━━━━━━━━━━ 1s 22ms/step - accuracy: 0.7369 - loss: 0.5790 - val_accuracy: 0.8718 - val_loss: 0.4621
Epoch 46/50
33/33 ━━━━━━━━━━━━━━━━━━━━ 1s 22ms/step - accuracy: 0.7369 - loss: 0.5788 - val_accuracy: 0.8718 - val_loss: 0.4605
Epoch 47/50
33/33 ━━━━━━━━━━━━━━━━━━━━ 1s 22ms/step - accuracy: 0.7369 - loss: 0.5785 - val_accuracy: 0.8718 - val_loss: 0.4594
Epoch 48/50
33/33 ━━━━━━━━━━━━━━━━━━━━ 1s 22ms/step - accuracy: 0.7369 - loss: 0.5783 - val_accuracy: 0.8718 - val_loss: 0.4581
Epoch 49/50
33/33 ━━━━━━━━━━━━━━━━━━━━ 1s 22ms/step - accuracy: 0.7369 - loss: 0.5781 - val_accuracy: 0.8718 - val_loss: 0.4567
Epoch 50/50
33/33 ━━━━━━━━━━━━━━━━━━━━ 1s 22ms/step - accuracy: 0.7369 - loss: 0.5779 - val_accuracy: 0.8718 - val_loss: 0.4559
2025-10-31 02:54:44.427 | INFO     | src.ai_engine.ai_models:fit:685 - LSTM trained successfully.
2025-10-31 02:54:44.432 | INFO     | src.ai_engine.ai_models:fit:381 - Generating base model predictions for meta-model training...
2025-10-31 02:55:04.022 | INFO     | src.ai_engine.feature_engineering:create_sequences:261 - Creating sequences with length 50 from 1220 data points.
2025-10-31 02:55:04.037 | INFO     | src.ai_engine.feature_engineering:create_sequences:270 - Created 1170 sequences.
37/37 ━━━━━━━━━━━━━━━━━━━━ 1s 25ms/step
2025-10-31 02:55:05.321 | INFO     | src.ai_engine.ai_models:fit:396 - Training meta-model...
2025-10-31 02:55:05.328 | SUCCESS  | src.ai_engine.ai_models:fit:399 - Stacking Ensemble trained successfully.
2025-10-31 02:55:05.329 | SUCCESS  | __main__:main:167 - Final Ensemble model trained.
2025-10-31 02:55:05.329 | INFO     | __main__:main:171 - Saving models to 'models\GainX_1200\4h'...
2025-10-31 02:55:05.398 | INFO     | src.ai_engine.ai_models:save:52 - Model RandomForest saved to models\GainX_1200\4h\random_forest.pkl
2025-10-31 02:55:05.473 | INFO     | src.ai_engine.ai_models:save:52 - Model GradientBoosting saved to models\GainX_1200\4h\gradient_boosting.pkl
2025-10-31 02:55:05.659 | INFO     | src.ai_engine.ai_models:save:731 - LSTM model saved to models\GainX_1200\4h\lstm.keras, models\GainX_1200\4h\lstm_scaler.pkl and marker file models\GainX_1200\4h\lstm.pkl
2025-10-31 02:55:05.724 | INFO     | src.ai_engine.ai_models:save_all:463 - Meta-model saved to models\GainX_1200\4h\meta_model.pkl
2025-10-31 02:55:05.725 | SUCCESS  | __main__:main:174 - --- Finished training for Symbol: GainX 1200, Timeframe: 4h ---
2025-10-31 02:55:05.731 | INFO     | __main__:main:140 - --- Starting training for Symbol: GainX 1200, Timeframe: 5m ---
2025-10-31 02:55:06.065 | SUCCESS  | __main__:main:148 - Loaded 86685 records.
2025-10-31 02:55:06.065 | INFO     | __main__:prepare_training_data:32 - Preparing data for training with Meta-Labeling...
2025-10-31 02:55:10.848 | DEBUG    | src.ai_engine.technical_indicators:calculate_all:47 - Calculated 63 technical indicators
2025-10-31 02:55:25.628 | DEBUG    | src.ai_engine.feature_engineering:extract_features:66 - Extracted 116 features
2025-10-31 02:55:25.632 | INFO     | __main__:prepare_training_data:39 - Generating signals from primary model (SimplePatternModel)...
2025-10-31 02:55:25.832 | WARNING  | src.ai_engine.feature_engineering:prepare_for_model:230 - Se perdieron todos los datos al eliminar los NaN. Se conservarán los datos rellenados.
2025-10-31 02:55:39.599 | INFO     | src.ai_engine.ai_models:calculate_optimal_threshold:549 - Calculated optimal threshold: 0.0010 (volatility: 0.0001, avg_movement: 0.0006)
2025-10-31 02:55:39.600 | INFO     | src.ai_engine.ai_models:create_meta_labels:577 - Creating meta-labels for secondary model...
2025-10-31 02:55:52.879 | INFO     | src.ai_engine.ai_models:create_meta_labels:629 - Meta-Label distribution - Profitable: 422 (16.6%), Unprofitable: 2127 (83.4%)
2025-10-31 02:55:53.109 | WARNING  | src.ai_engine.feature_engineering:prepare_for_model:230 - Se perdieron todos los datos al eliminar los NaN. Se conservarán los datos rellenados.
2025-10-31 02:55:53.202 | INFO     | __main__:prepare_training_data:75 - Data preparation complete. Shape of X: (60254, 116), Shape of y: (60254,)
2025-10-31 02:55:53.237 | INFO     | src.ai_engine.feature_engineering:create_sequences:261 - Creating sequences with length 50 from 60254 data points.
2025-10-31 02:55:53.928 | INFO     | src.ai_engine.feature_engineering:create_sequences:270 - Created 60204 sequences.
2025-10-31 02:55:53.939 | INFO     | __main__:main:164 - Initializing and training Ensemble model...
2025-10-31 02:55:53.940 | INFO     | src.ai_engine.ai_models:__init__:304 - Initialized Stacking Ensemble with Logistic Regression as meta-model.
2025-10-31 02:55:53.975 | INFO     | src.ai_engine.ai_models:fit:359 - Creating LSTM model...
2025-10-31 02:55:53.975 | INFO     | src.ai_engine.ai_models:fit:364 - Training base models...
2025-10-31 02:55:54.083 | INFO     | src.ai_engine.ai_models:fit:373 - Training random_forest...
2025-10-31 02:56:13.551 | INFO     | src.ai_engine.ai_models:fit:98 - RandomForest trained successfully on 60254 samples with 2 classes
2025-10-31 02:56:13.554 | INFO     | src.ai_engine.ai_models:fit:373 - Training gradient_boosting...
2025-10-31 03:07:32.363 | INFO     | src.ai_engine.ai_models:fit:157 - GradientBoosting trained successfully on 60254 samples with 2 classes
2025-10-31 03:07:32.366 | INFO     | src.ai_engine.ai_models:fit:373 - Training pattern_based...
2025-10-31 03:07:32.367 | INFO     | src.ai_engine.ai_models:fit:373 - Training lstm...
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\keras\src\layers\rnn\rnn.py:199: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(**kwargs)
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1108: RuntimeWarning: invalid value encountered in divide
  updated_mean = (last_sum + new_sum) / updated_sample_count
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1113: RuntimeWarning: invalid value encountered in divide
  T = new_sum / new_sample_count
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1133: RuntimeWarning: invalid value encountered in divide
  new_unnormalized_variance -= correction**2 / new_sample_count
Epoch 1/50
1694/1694 ━━━━━━━━━━━━━━━━━━━━ 164s 26ms/step - accuracy: 0.9930 - loss: 0.4132 - val_accuracy: 0.9927 - val_loss: 0.2343
Epoch 2/50
1694/1694 ━━━━━━━━━━━━━━━━━━━━ 38s 22ms/step - accuracy: 0.9930 - loss: 0.1586 - val_accuracy: 0.9927 - val_loss: 0.1080
Epoch 3/50
1694/1694 ━━━━━━━━━━━━━━━━━━━━ 35s 21ms/step - accuracy: 0.9930 - loss: 0.0822 - val_accuracy: 0.9927 - val_loss: 0.0653
Epoch 4/50
1694/1694 ━━━━━━━━━━━━━━━━━━━━ 35s 21ms/step - accuracy: 0.9930 - loss: 0.0551 - val_accuracy: 0.9927 - val_loss: 0.0499
Epoch 5/50
1694/1694 ━━━━━━━━━━━━━━━━━━━━ 35s 20ms/step - accuracy: 0.9930 - loss: 0.0454 - val_accuracy: 0.9927 - val_loss: 0.0447
Epoch 6/50
1694/1694 ━━━━━━━━━━━━━━━━━━━━ 34s 20ms/step - accuracy: 0.9930 - loss: 0.0424 - val_accuracy: 0.9927 - val_loss: 0.0435
Epoch 7/50
1694/1694 ━━━━━━━━━━━━━━━━━━━━ 34s 20ms/step - accuracy: 0.9930 - loss: 0.0418 - val_accuracy: 0.9927 - val_loss: 0.0433
Epoch 8/50
1694/1694 ━━━━━━━━━━━━━━━━━━━━ 34s 20ms/step - accuracy: 0.9930 - loss: 0.0416 - val_accuracy: 0.9927 - val_loss: 0.0432
Epoch 9/50
1694/1694 ━━━━━━━━━━━━━━━━━━━━ 34s 20ms/step - accuracy: 0.9930 - loss: 0.0416 - val_accuracy: 0.9927 - val_loss: 0.0432
Epoch 10/50
1694/1694 ━━━━━━━━━━━━━━━━━━━━ 36s 21ms/step - accuracy: 0.9930 - loss: 0.0416 - val_accuracy: 0.9927 - val_loss: 0.0432
Epoch 11/50
1694/1694 ━━━━━━━━━━━━━━━━━━━━ 41s 24ms/step - accuracy: 0.9930 - loss: 0.0416 - val_accuracy: 0.9927 - val_loss: 0.0432
Epoch 12/50
1694/1694 ━━━━━━━━━━━━━━━━━━━━ 34s 20ms/step - accuracy: 0.9930 - loss: 0.0416 - val_accuracy: 0.9927 - val_loss: 0.0432
Epoch 13/50
1694/1694 ━━━━━━━━━━━━━━━━━━━━ 34s 20ms/step - accuracy: 0.9930 - loss: 0.0416 - val_accuracy: 0.9927 - val_loss: 0.0432
Epoch 14/50
1694/1694 ━━━━━━━━━━━━━━━━━━━━ 34s 20ms/step - accuracy: 0.9930 - loss: 0.0416 - val_accuracy: 0.9927 - val_loss: 0.0432
Epoch 15/50
1694/1694 ━━━━━━━━━━━━━━━━━━━━ 34s 20ms/step - accuracy: 0.9930 - loss: 0.0416 - val_accuracy: 0.9927 - val_loss: 0.0432
Epoch 16/50
1694/1694 ━━━━━━━━━━━━━━━━━━━━ 34s 20ms/step - accuracy: 0.9930 - loss: 0.0416 - val_accuracy: 0.9927 - val_loss: 0.0432
Epoch 17/50
1694/1694 ━━━━━━━━━━━━━━━━━━━━ 34s 20ms/step - accuracy: 0.9930 - loss: 0.0416 - val_accuracy: 0.9927 - val_loss: 0.0432
Epoch 18/50
1694/1694 ━━━━━━━━━━━━━━━━━━━━ 34s 20ms/step - accuracy: 0.9930 - loss: 0.0416 - val_accuracy: 0.9927 - val_loss: 0.0432
Epoch 19/50
1694/1694 ━━━━━━━━━━━━━━━━━━━━ 34s 20ms/step - accuracy: 0.9930 - loss: 0.0416 - val_accuracy: 0.9927 - val_loss: 0.0432
2025-10-31 03:57:00.929 | INFO     | src.ai_engine.ai_models:fit:685 - LSTM trained successfully.
2025-10-31 03:57:01.602 | INFO     | src.ai_engine.ai_models:fit:381 - Generating base model predictions for meta-model training...
2025-10-31 03:57:28.532 | INFO     | src.ai_engine.feature_engineering:create_sequences:261 - Creating sequences with length 50 from 60254 data points.
2025-10-31 03:57:29.352 | INFO     | src.ai_engine.feature_engineering:create_sequences:270 - Created 60204 sequences.
1882/1882 ━━━━━━━━━━━━━━━━━━━━ 210s 24ms/step
2025-10-31 04:11:52.758 | INFO     | src.ai_engine.ai_models:fit:396 - Training meta-model...
2025-10-31 04:11:58.112 | SUCCESS  | src.ai_engine.ai_models:fit:399 - Stacking Ensemble trained successfully.
2025-10-31 04:11:58.672 | SUCCESS  | __main__:main:167 - Final Ensemble model trained.
2025-10-31 04:11:58.745 | INFO     | __main__:main:171 - Saving models to 'models\GainX_1200\5m'...
2025-10-31 04:12:06.437 | INFO     | src.ai_engine.ai_models:save:52 - Model RandomForest saved to models\GainX_1200\5m\random_forest.pkl
2025-10-31 04:12:07.984 | INFO     | src.ai_engine.ai_models:save:52 - Model GradientBoosting saved to models\GainX_1200\5m\gradient_boosting.pkl
2025-10-31 04:12:27.163 | INFO     | src.ai_engine.ai_models:save:731 - LSTM model saved to models\GainX_1200\5m\lstm.keras, models\GainX_1200\5m\lstm_scaler.pkl and marker file models\GainX_1200\5m\lstm.pkl
2025-10-31 04:12:27.242 | INFO     | src.ai_engine.ai_models:save_all:463 - Meta-model saved to models\GainX_1200\5m\meta_model.pkl
2025-10-31 04:12:27.275 | SUCCESS  | __main__:main:174 - --- Finished training for Symbol: GainX 1200, Timeframe: 5m ---
2025-10-31 04:12:27.494 | INFO     | __main__:main:140 - --- Starting training for Symbol: GainX 400, Timeframe: 15m ---
2025-10-31 04:12:40.974 | SUCCESS  | __main__:main:148 - Loaded 28898 records.
2025-10-31 04:12:40.975 | INFO     | __main__:prepare_training_data:32 - Preparing data for training with Meta-Labeling...
2025-10-31 04:12:46.656 | DEBUG    | src.ai_engine.technical_indicators:calculate_all:47 - Calculated 63 technical indicators
2025-10-31 04:12:52.806 | DEBUG    | src.ai_engine.feature_engineering:extract_features:66 - Extracted 116 features
2025-10-31 04:12:52.846 | INFO     | __main__:prepare_training_data:39 - Generating signals from primary model (SimplePatternModel)...
2025-10-31 04:12:53.061 | WARNING  | src.ai_engine.feature_engineering:prepare_for_model:230 - Se perdieron todos los datos al eliminar los NaN. Se conservarán los datos rellenados.
2025-10-31 04:12:59.188 | INFO     | src.ai_engine.ai_models:calculate_optimal_threshold:549 - Calculated optimal threshold: 0.0012 (volatility: 0.0004, avg_movement: 0.0017)
2025-10-31 04:12:59.189 | INFO     | src.ai_engine.ai_models:create_meta_labels:577 - Creating meta-labels for secondary model...
2025-10-31 04:13:02.742 | INFO     | src.ai_engine.ai_models:create_meta_labels:629 - Meta-Label distribution - Profitable: 4507 (34.5%), Unprofitable: 8563 (65.5%)
2025-10-31 04:13:02.828 | WARNING  | src.ai_engine.feature_engineering:prepare_for_model:230 - Se perdieron todos los datos al eliminar los NaN. Se conservarán los datos rellenados.
2025-10-31 04:13:02.867 | INFO     | __main__:prepare_training_data:75 - Data preparation complete. Shape of X: (20535, 116), Shape of y: (20535,)
2025-10-31 04:13:03.499 | INFO     | src.ai_engine.feature_engineering:create_sequences:261 - Creating sequences with length 50 from 20535 data points.
2025-10-31 04:13:03.795 | INFO     | src.ai_engine.feature_engineering:create_sequences:270 - Created 20485 sequences.
2025-10-31 04:13:04.102 | INFO     | __main__:main:164 - Initializing and training Ensemble model...
2025-10-31 04:13:04.103 | INFO     | src.ai_engine.ai_models:__init__:304 - Initialized Stacking Ensemble with Logistic Regression as meta-model.
2025-10-31 04:13:05.192 | INFO     | src.ai_engine.ai_models:fit:359 - Creating LSTM model...
2025-10-31 04:13:05.193 | INFO     | src.ai_engine.ai_models:fit:364 - Training base models...
2025-10-31 04:13:05.231 | INFO     | src.ai_engine.ai_models:fit:373 - Training random_forest...
2025-10-31 04:13:15.001 | INFO     | src.ai_engine.ai_models:fit:98 - RandomForest trained successfully on 20535 samples with 2 classes
2025-10-31 04:13:15.048 | INFO     | src.ai_engine.ai_models:fit:373 - Training gradient_boosting...
2025-10-31 04:17:05.681 | INFO     | src.ai_engine.ai_models:fit:157 - GradientBoosting trained successfully on 20535 samples with 2 classes
2025-10-31 04:17:05.682 | INFO     | src.ai_engine.ai_models:fit:373 - Training pattern_based...
2025-10-31 04:17:05.711 | INFO     | src.ai_engine.ai_models:fit:373 - Training lstm...
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\keras\src\layers\rnn\rnn.py:199: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(**kwargs)
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1108: RuntimeWarning: invalid value encountered in divide
  updated_mean = (last_sum + new_sum) / updated_sample_count
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1113: RuntimeWarning: invalid value encountered in divide
  T = new_sum / new_sample_count
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1133: RuntimeWarning: invalid value encountered in divide
  new_unnormalized_variance -= correction**2 / new_sample_count
Epoch 1/50
577/577 ━━━━━━━━━━━━━━━━━━━━ 47s 26ms/step - accuracy: 0.7782 - loss: 0.6314 - val_accuracy: 0.7965 - val_loss: 0.5767
Epoch 2/50
577/577 ━━━━━━━━━━━━━━━━━━━━ 13s 23ms/step - accuracy: 0.7782 - loss: 0.5623 - val_accuracy: 0.7965 - val_loss: 0.5303
Epoch 3/50
577/577 ━━━━━━━━━━━━━━━━━━━━ 12s 21ms/step - accuracy: 0.7782 - loss: 0.5380 - val_accuracy: 0.7965 - val_loss: 0.5139
Epoch 4/50
577/577 ━━━━━━━━━━━━━━━━━━━━ 13s 22ms/step - accuracy: 0.7782 - loss: 0.5311 - val_accuracy: 0.7965 - val_loss: 0.5083
Epoch 5/50
577/577 ━━━━━━━━━━━━━━━━━━━━ 12s 21ms/step - accuracy: 0.7782 - loss: 0.5295 - val_accuracy: 0.7965 - val_loss: 0.5067
Epoch 6/50
577/577 ━━━━━━━━━━━━━━━━━━━━ 12s 21ms/step - accuracy: 0.7782 - loss: 0.5293 - val_accuracy: 0.7965 - val_loss: 0.5065
Epoch 7/50
577/577 ━━━━━━━━━━━━━━━━━━━━ 12s 21ms/step - accuracy: 0.7782 - loss: 0.5293 - val_accuracy: 0.7965 - val_loss: 0.5064
Epoch 8/50
577/577 ━━━━━━━━━━━━━━━━━━━━ 12s 21ms/step - accuracy: 0.7782 - loss: 0.5293 - val_accuracy: 0.7965 - val_loss: 0.5063
Epoch 9/50
577/577 ━━━━━━━━━━━━━━━━━━━━ 12s 21ms/step - accuracy: 0.7782 - loss: 0.5293 - val_accuracy: 0.7965 - val_loss: 0.5062
Epoch 10/50
577/577 ━━━━━━━━━━━━━━━━━━━━ 12s 21ms/step - accuracy: 0.7782 - loss: 0.5293 - val_accuracy: 0.7965 - val_loss: 0.5061
Epoch 11/50
577/577 ━━━━━━━━━━━━━━━━━━━━ 12s 21ms/step - accuracy: 0.7782 - loss: 0.5293 - val_accuracy: 0.7965 - val_loss: 0.5062
Epoch 12/50
577/577 ━━━━━━━━━━━━━━━━━━━━ 12s 21ms/step - accuracy: 0.7782 - loss: 0.5293 - val_accuracy: 0.7965 - val_loss: 0.5060
Epoch 13/50
577/577 ━━━━━━━━━━━━━━━━━━━━ 12s 21ms/step - accuracy: 0.7782 - loss: 0.5293 - val_accuracy: 0.7965 - val_loss: 0.5061
Epoch 14/50
577/577 ━━━━━━━━━━━━━━━━━━━━ 12s 21ms/step - accuracy: 0.7782 - loss: 0.5293 - val_accuracy: 0.7965 - val_loss: 0.5062
Epoch 15/50
577/577 ━━━━━━━━━━━━━━━━━━━━ 12s 21ms/step - accuracy: 0.7782 - loss: 0.5293 - val_accuracy: 0.7965 - val_loss: 0.5063
Epoch 16/50
577/577 ━━━━━━━━━━━━━━━━━━━━ 12s 21ms/step - accuracy: 0.7782 - loss: 0.5293 - val_accuracy: 0.7965 - val_loss: 0.5061
Epoch 17/50
577/577 ━━━━━━━━━━━━━━━━━━━━ 12s 21ms/step - accuracy: 0.7782 - loss: 0.5293 - val_accuracy: 0.7965 - val_loss: 0.5061
Epoch 18/50
577/577 ━━━━━━━━━━━━━━━━━━━━ 12s 21ms/step - accuracy: 0.7782 - loss: 0.5293 - val_accuracy: 0.7965 - val_loss: 0.5061
Epoch 19/50
577/577 ━━━━━━━━━━━━━━━━━━━━ 12s 21ms/step - accuracy: 0.7782 - loss: 0.5293 - val_accuracy: 0.7965 - val_loss: 0.5062
Epoch 20/50
577/577 ━━━━━━━━━━━━━━━━━━━━ 12s 21ms/step - accuracy: 0.7782 - loss: 0.5293 - val_accuracy: 0.7965 - val_loss: 0.5063
Epoch 21/50
577/577 ━━━━━━━━━━━━━━━━━━━━ 12s 21ms/step - accuracy: 0.7782 - loss: 0.5293 - val_accuracy: 0.7965 - val_loss: 0.5062
Epoch 22/50
577/577 ━━━━━━━━━━━━━━━━━━━━ 12s 21ms/step - accuracy: 0.7782 - loss: 0.5293 - val_accuracy: 0.7965 - val_loss: 0.5062
2025-10-31 04:22:17.219 | INFO     | src.ai_engine.ai_models:fit:685 - LSTM trained successfully.
2025-10-31 04:22:17.266 | INFO     | src.ai_engine.ai_models:fit:381 - Generating base model predictions for meta-model training...
2025-10-31 04:22:18.602 | INFO     | src.ai_engine.feature_engineering:create_sequences:261 - Creating sequences with length 50 from 20535 data points.
2025-10-31 04:22:18.837 | INFO     | src.ai_engine.feature_engineering:create_sequences:270 - Created 20485 sequences.
641/641 ━━━━━━━━━━━━━━━━━━━━ 7s 11ms/step
2025-10-31 04:22:27.685 | INFO     | src.ai_engine.ai_models:fit:396 - Training meta-model...
2025-10-31 04:22:27.699 | SUCCESS  | src.ai_engine.ai_models:fit:399 - Stacking Ensemble trained successfully.
2025-10-31 04:22:27.700 | SUCCESS  | __main__:main:167 - Final Ensemble model trained.
2025-10-31 04:22:27.701 | INFO     | __main__:main:171 - Saving models to 'models\GainX_400\15m'...
2025-10-31 04:22:27.965 | INFO     | src.ai_engine.ai_models:save:52 - Model RandomForest saved to models\GainX_400\15m\random_forest.pkl
2025-10-31 04:22:27.988 | INFO     | src.ai_engine.ai_models:save:52 - Model GradientBoosting saved to models\GainX_400\15m\gradient_boosting.pkl
2025-10-31 04:22:28.217 | INFO     | src.ai_engine.ai_models:save:731 - LSTM model saved to models\GainX_400\15m\lstm.keras, models\GainX_400\15m\lstm_scaler.pkl and marker file models\GainX_400\15m\lstm.pkl
2025-10-31 04:22:28.261 | INFO     | src.ai_engine.ai_models:save_all:463 - Meta-model saved to models\GainX_400\15m\meta_model.pkl
2025-10-31 04:22:28.263 | SUCCESS  | __main__:main:174 - --- Finished training for Symbol: GainX 400, Timeframe: 15m ---
2025-10-31 04:22:28.271 | INFO     | __main__:main:140 - --- Starting training for Symbol: GainX 400, Timeframe: 1d ---
2025-10-31 04:22:28.418 | SUCCESS  | __main__:main:148 - Loaded 302 records.
2025-10-31 04:22:28.420 | INFO     | __main__:prepare_training_data:32 - Preparing data for training with Meta-Labeling...
2025-10-31 04:22:28.505 | DEBUG    | src.ai_engine.technical_indicators:calculate_all:47 - Calculated 62 technical indicators
2025-10-31 04:22:28.563 | DEBUG    | src.ai_engine.feature_engineering:extract_features:66 - Extracted 116 features
2025-10-31 04:22:28.564 | INFO     | __main__:prepare_training_data:39 - Generating signals from primary model (SimplePatternModel)...
2025-10-31 04:22:28.570 | WARNING  | src.ai_engine.feature_engineering:prepare_for_model:230 - Se perdieron todos los datos al eliminar los NaN. Se conservarán los datos rellenados.
2025-10-31 04:22:28.623 | INFO     | src.ai_engine.ai_models:calculate_optimal_threshold:549 - Calculated optimal threshold: 0.0109 (volatility: 0.0038, avg_movement: 0.0150)
2025-10-31 04:22:28.623 | INFO     | src.ai_engine.ai_models:create_meta_labels:577 - Creating meta-labels for secondary model...
2025-10-31 04:22:28.660 | INFO     | src.ai_engine.ai_models:create_meta_labels:629 - Meta-Label distribution - Profitable: 72 (52.9%), Unprofitable: 64 (47.1%)
2025-10-31 04:22:28.666 | WARNING  | src.ai_engine.feature_engineering:prepare_for_model:230 - Se perdieron todos los datos al eliminar los NaN. Se conservarán los datos rellenados.
2025-10-31 04:22:28.686 | INFO     | __main__:prepare_training_data:75 - Data preparation complete. Shape of X: (195, 116), Shape of y: (195,)
2025-10-31 04:22:28.691 | INFO     | src.ai_engine.feature_engineering:create_sequences:261 - Creating sequences with length 50 from 195 data points.
2025-10-31 04:22:28.693 | INFO     | src.ai_engine.feature_engineering:create_sequences:270 - Created 145 sequences.
2025-10-31 04:22:28.767 | INFO     | __main__:main:164 - Initializing and training Ensemble model...
2025-10-31 04:22:28.768 | INFO     | src.ai_engine.ai_models:__init__:304 - Initialized Stacking Ensemble with Logistic Regression as meta-model.
2025-10-31 04:22:28.858 | INFO     | src.ai_engine.ai_models:fit:359 - Creating LSTM model...
2025-10-31 04:22:28.860 | INFO     | src.ai_engine.ai_models:fit:364 - Training base models...
2025-10-31 04:22:28.867 | INFO     | src.ai_engine.ai_models:fit:373 - Training random_forest...
2025-10-31 04:22:29.605 | INFO     | src.ai_engine.ai_models:fit:98 - RandomForest trained successfully on 195 samples with 2 classes
2025-10-31 04:22:29.605 | INFO     | src.ai_engine.ai_models:fit:373 - Training gradient_boosting...
2025-10-31 04:22:31.385 | INFO     | src.ai_engine.ai_models:fit:157 - GradientBoosting trained successfully on 195 samples with 2 classes
2025-10-31 04:22:31.385 | INFO     | src.ai_engine.ai_models:fit:373 - Training pattern_based...
2025-10-31 04:22:31.386 | INFO     | src.ai_engine.ai_models:fit:373 - Training lstm...
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\keras\src\layers\rnn\rnn.py:199: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(**kwargs)
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1108: RuntimeWarning: invalid value encountered in divide
  updated_mean = (last_sum + new_sum) / updated_sample_count
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1113: RuntimeWarning: invalid value encountered in divide
  T = new_sum / new_sample_count
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1133: RuntimeWarning: invalid value encountered in divide
  new_unnormalized_variance -= correction**2 / new_sample_count
Epoch 1/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 5s 142ms/step - accuracy: 0.6231 - loss: 0.6929 - val_accuracy: 0.5333 - val_loss: 0.6930
Epoch 2/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 70ms/step - accuracy: 0.6231 - loss: 0.6924 - val_accuracy: 0.5333 - val_loss: 0.6929
Epoch 3/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 46ms/step - accuracy: 0.6231 - loss: 0.6920 - val_accuracy: 0.5333 - val_loss: 0.6928
Epoch 4/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 50ms/step - accuracy: 0.6231 - loss: 0.6916 - val_accuracy: 0.5333 - val_loss: 0.6927
Epoch 5/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 35ms/step - accuracy: 0.6231 - loss: 0.6912 - val_accuracy: 0.5333 - val_loss: 0.6926
Epoch 6/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 35ms/step - accuracy: 0.6231 - loss: 0.6907 - val_accuracy: 0.5333 - val_loss: 0.6925
Epoch 7/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 41ms/step - accuracy: 0.6231 - loss: 0.6904 - val_accuracy: 0.5333 - val_loss: 0.6924
Epoch 8/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 34ms/step - accuracy: 0.6231 - loss: 0.6899 - val_accuracy: 0.5333 - val_loss: 0.6923
Epoch 9/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 34ms/step - accuracy: 0.6231 - loss: 0.6895 - val_accuracy: 0.5333 - val_loss: 0.6922
Epoch 10/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 35ms/step - accuracy: 0.6231 - loss: 0.6891 - val_accuracy: 0.5333 - val_loss: 0.6921
Epoch 11/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 38ms/step - accuracy: 0.6231 - loss: 0.6887 - val_accuracy: 0.5333 - val_loss: 0.6920
Epoch 12/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 34ms/step - accuracy: 0.6231 - loss: 0.6883 - val_accuracy: 0.5333 - val_loss: 0.6919
Epoch 13/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 34ms/step - accuracy: 0.6231 - loss: 0.6879 - val_accuracy: 0.5333 - val_loss: 0.6918
Epoch 14/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 34ms/step - accuracy: 0.6231 - loss: 0.6875 - val_accuracy: 0.5333 - val_loss: 0.6918
Epoch 15/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 34ms/step - accuracy: 0.6231 - loss: 0.6870 - val_accuracy: 0.5333 - val_loss: 0.6917
Epoch 16/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 34ms/step - accuracy: 0.6231 - loss: 0.6866 - val_accuracy: 0.5333 - val_loss: 0.6916
Epoch 17/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 34ms/step - accuracy: 0.6231 - loss: 0.6862 - val_accuracy: 0.5333 - val_loss: 0.6915
Epoch 18/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 34ms/step - accuracy: 0.6231 - loss: 0.6858 - val_accuracy: 0.5333 - val_loss: 0.6915
Epoch 19/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 35ms/step - accuracy: 0.6231 - loss: 0.6855 - val_accuracy: 0.5333 - val_loss: 0.6914
Epoch 20/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 35ms/step - accuracy: 0.6231 - loss: 0.6852 - val_accuracy: 0.5333 - val_loss: 0.6914
Epoch 21/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 34ms/step - accuracy: 0.6231 - loss: 0.6849 - val_accuracy: 0.5333 - val_loss: 0.6914
Epoch 22/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 39ms/step - accuracy: 0.6231 - loss: 0.6847 - val_accuracy: 0.5333 - val_loss: 0.6913
Epoch 23/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 34ms/step - accuracy: 0.6231 - loss: 0.6844 - val_accuracy: 0.5333 - val_loss: 0.6913
Epoch 24/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 35ms/step - accuracy: 0.6231 - loss: 0.6842 - val_accuracy: 0.5333 - val_loss: 0.6913
Epoch 25/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 35ms/step - accuracy: 0.6231 - loss: 0.6839 - val_accuracy: 0.5333 - val_loss: 0.6912
Epoch 26/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 35ms/step - accuracy: 0.6231 - loss: 0.6838 - val_accuracy: 0.5333 - val_loss: 0.6912
Epoch 27/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 34ms/step - accuracy: 0.6231 - loss: 0.6836 - val_accuracy: 0.5333 - val_loss: 0.6912
Epoch 28/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 34ms/step - accuracy: 0.6231 - loss: 0.6835 - val_accuracy: 0.5333 - val_loss: 0.6912
Epoch 29/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 34ms/step - accuracy: 0.6231 - loss: 0.6832 - val_accuracy: 0.5333 - val_loss: 0.6912
Epoch 30/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 35ms/step - accuracy: 0.6231 - loss: 0.6830 - val_accuracy: 0.5333 - val_loss: 0.6911
Epoch 31/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 34ms/step - accuracy: 0.6231 - loss: 0.6826 - val_accuracy: 0.5333 - val_loss: 0.6911
Epoch 32/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 34ms/step - accuracy: 0.6231 - loss: 0.6824 - val_accuracy: 0.5333 - val_loss: 0.6911
Epoch 33/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 35ms/step - accuracy: 0.6231 - loss: 0.6821 - val_accuracy: 0.5333 - val_loss: 0.6911
Epoch 34/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 35ms/step - accuracy: 0.6231 - loss: 0.6819 - val_accuracy: 0.5333 - val_loss: 0.6910
Epoch 35/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 35ms/step - accuracy: 0.6231 - loss: 0.6817 - val_accuracy: 0.5333 - val_loss: 0.6910
Epoch 36/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 35ms/step - accuracy: 0.6231 - loss: 0.6815 - val_accuracy: 0.5333 - val_loss: 0.6910
Epoch 37/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 35ms/step - accuracy: 0.6231 - loss: 0.6811 - val_accuracy: 0.5333 - val_loss: 0.6910
Epoch 38/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 35ms/step - accuracy: 0.6231 - loss: 0.6809 - val_accuracy: 0.5333 - val_loss: 0.6910
Epoch 39/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 34ms/step - accuracy: 0.6231 - loss: 0.6807 - val_accuracy: 0.5333 - val_loss: 0.6910
Epoch 40/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 34ms/step - accuracy: 0.6231 - loss: 0.6805 - val_accuracy: 0.5333 - val_loss: 0.6910
Epoch 41/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 35ms/step - accuracy: 0.6231 - loss: 0.6803 - val_accuracy: 0.5333 - val_loss: 0.6909
Epoch 42/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 34ms/step - accuracy: 0.6231 - loss: 0.6802 - val_accuracy: 0.5333 - val_loss: 0.6909
Epoch 43/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 35ms/step - accuracy: 0.6231 - loss: 0.6800 - val_accuracy: 0.5333 - val_loss: 0.6909
Epoch 44/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 35ms/step - accuracy: 0.6231 - loss: 0.6799 - val_accuracy: 0.5333 - val_loss: 0.6909
Epoch 45/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 35ms/step - accuracy: 0.6231 - loss: 0.6798 - val_accuracy: 0.5333 - val_loss: 0.6909
Epoch 46/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 34ms/step - accuracy: 0.6231 - loss: 0.6796 - val_accuracy: 0.5333 - val_loss: 0.6909
Epoch 47/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 34ms/step - accuracy: 0.6231 - loss: 0.6796 - val_accuracy: 0.5333 - val_loss: 0.6909
Epoch 48/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 34ms/step - accuracy: 0.6231 - loss: 0.6794 - val_accuracy: 0.5333 - val_loss: 0.6909
Epoch 49/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 34ms/step - accuracy: 0.6231 - loss: 0.6793 - val_accuracy: 0.5333 - val_loss: 0.6909
Epoch 50/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 35ms/step - accuracy: 0.6231 - loss: 0.6792 - val_accuracy: 0.5333 - val_loss: 0.6909
2025-10-31 04:22:46.246 | INFO     | src.ai_engine.ai_models:fit:685 - LSTM trained successfully.
2025-10-31 04:22:46.247 | INFO     | src.ai_engine.ai_models:fit:381 - Generating base model predictions for meta-model training...
2025-10-31 04:22:46.262 | INFO     | src.ai_engine.feature_engineering:create_sequences:261 - Creating sequences with length 50 from 195 data points.
2025-10-31 04:22:46.265 | INFO     | src.ai_engine.feature_engineering:create_sequences:270 - Created 145 sequences.
5/5 ━━━━━━━━━━━━━━━━━━━━ 1s 115ms/step
2025-10-31 04:22:47.026 | INFO     | src.ai_engine.ai_models:fit:396 - Training meta-model...
2025-10-31 04:22:47.030 | SUCCESS  | src.ai_engine.ai_models:fit:399 - Stacking Ensemble trained successfully.
2025-10-31 04:22:47.031 | SUCCESS  | __main__:main:167 - Final Ensemble model trained.
2025-10-31 04:22:47.031 | INFO     | __main__:main:171 - Saving models to 'models\GainX_400\1d'...
2025-10-31 04:22:47.062 | INFO     | src.ai_engine.ai_models:save:52 - Model RandomForest saved to models\GainX_400\1d\random_forest.pkl
2025-10-31 04:22:47.098 | INFO     | src.ai_engine.ai_models:save:52 - Model GradientBoosting saved to models\GainX_400\1d\gradient_boosting.pkl
2025-10-31 04:22:47.170 | INFO     | src.ai_engine.ai_models:save:731 - LSTM model saved to models\GainX_400\1d\lstm.keras, models\GainX_400\1d\lstm_scaler.pkl and marker file models\GainX_400\1d\lstm.pkl
2025-10-31 04:22:47.207 | INFO     | src.ai_engine.ai_models:save_all:463 - Meta-model saved to models\GainX_400\1d\meta_model.pkl
2025-10-31 04:22:47.209 | SUCCESS  | __main__:main:174 - --- Finished training for Symbol: GainX 400, Timeframe: 1d ---
2025-10-31 04:22:47.214 | INFO     | __main__:main:140 - --- Starting training for Symbol: GainX 400, Timeframe: 1h ---
2025-10-31 04:22:47.292 | SUCCESS  | __main__:main:148 - Loaded 7227 records.
2025-10-31 04:22:47.292 | INFO     | __main__:prepare_training_data:32 - Preparing data for training with Meta-Labeling...
2025-10-31 04:22:47.732 | DEBUG    | src.ai_engine.technical_indicators:calculate_all:47 - Calculated 63 technical indicators
2025-10-31 04:22:48.974 | DEBUG    | src.ai_engine.feature_engineering:extract_features:66 - Extracted 116 features
2025-10-31 04:22:48.974 | INFO     | __main__:prepare_training_data:39 - Generating signals from primary model (SimplePatternModel)...
2025-10-31 04:22:48.992 | WARNING  | src.ai_engine.feature_engineering:prepare_for_model:230 - Se perdieron todos los datos al eliminar los NaN. Se conservarán los datos rellenados.
2025-10-31 04:22:50.134 | INFO     | src.ai_engine.ai_models:calculate_optimal_threshold:549 - Calculated optimal threshold: 0.0023 (volatility: 0.0008, avg_movement: 0.0034)
2025-10-31 04:22:50.134 | INFO     | src.ai_engine.ai_models:create_meta_labels:577 - Creating meta-labels for secondary model...
2025-10-31 04:22:51.023 | INFO     | src.ai_engine.ai_models:create_meta_labels:629 - Meta-Label distribution - Profitable: 1255 (36.8%), Unprofitable: 2158 (63.2%)
2025-10-31 04:22:51.047 | WARNING  | src.ai_engine.feature_engineering:prepare_for_model:230 - Se perdieron todos los datos al eliminar los NaN. Se conservarán los datos rellenados.
2025-10-31 04:22:51.056 | INFO     | __main__:prepare_training_data:75 - Data preparation complete. Shape of X: (5198, 116), Shape of y: (5198,)
2025-10-31 04:22:51.061 | INFO     | src.ai_engine.feature_engineering:create_sequences:261 - Creating sequences with length 50 from 5198 data points.
2025-10-31 04:22:51.121 | INFO     | src.ai_engine.feature_engineering:create_sequences:270 - Created 5148 sequences.
2025-10-31 04:22:51.122 | INFO     | __main__:main:164 - Initializing and training Ensemble model...
2025-10-31 04:22:51.123 | INFO     | src.ai_engine.ai_models:__init__:304 - Initialized Stacking Ensemble with Logistic Regression as meta-model.
2025-10-31 04:22:51.127 | INFO     | src.ai_engine.ai_models:fit:359 - Creating LSTM model...
2025-10-31 04:22:51.127 | INFO     | src.ai_engine.ai_models:fit:364 - Training base models...
2025-10-31 04:22:51.135 | INFO     | src.ai_engine.ai_models:fit:373 - Training random_forest...
2025-10-31 04:22:52.992 | INFO     | src.ai_engine.ai_models:fit:98 - RandomForest trained successfully on 5198 samples with 2 classes
2025-10-31 04:22:52.993 | INFO     | src.ai_engine.ai_models:fit:373 - Training gradient_boosting...
2025-10-31 04:23:44.693 | INFO     | src.ai_engine.ai_models:fit:157 - GradientBoosting trained successfully on 5198 samples with 2 classes
2025-10-31 04:23:44.694 | INFO     | src.ai_engine.ai_models:fit:373 - Training pattern_based...
2025-10-31 04:23:44.695 | INFO     | src.ai_engine.ai_models:fit:373 - Training lstm...
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\keras\src\layers\rnn\rnn.py:199: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(**kwargs)
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1108: RuntimeWarning: invalid value encountered in divide
  updated_mean = (last_sum + new_sum) / updated_sample_count
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1113: RuntimeWarning: invalid value encountered in divide
  T = new_sum / new_sample_count
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1133: RuntimeWarning: invalid value encountered in divide
  new_unnormalized_variance -= correction**2 / new_sample_count
Epoch 1/50
145/145 ━━━━━━━━━━━━━━━━━━━━ 21s 24ms/step - accuracy: 0.7501 - loss: 0.6764 - val_accuracy: 0.8291 - val_loss: 0.6500
Epoch 2/50
145/145 ━━━━━━━━━━━━━━━━━━━━ 3s 22ms/step - accuracy: 0.7501 - loss: 0.6481 - val_accuracy: 0.8291 - val_loss: 0.6154
Epoch 3/50
145/145 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7501 - loss: 0.6260 - val_accuracy: 0.8291 - val_loss: 0.5868
Epoch 4/50
145/145 ━━━━━━━━━━━━━━━━━━━━ 3s 22ms/step - accuracy: 0.7501 - loss: 0.6089 - val_accuracy: 0.8291 - val_loss: 0.5639
Epoch 5/50
145/145 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7501 - loss: 0.5958 - val_accuracy: 0.8291 - val_loss: 0.5453
Epoch 6/50
145/145 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7501 - loss: 0.5861 - val_accuracy: 0.8291 - val_loss: 0.5301
Epoch 7/50
145/145 ━━━━━━━━━━━━━━━━━━━━ 3s 22ms/step - accuracy: 0.7501 - loss: 0.5789 - val_accuracy: 0.8291 - val_loss: 0.5184
Epoch 8/50
145/145 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7501 - loss: 0.5737 - val_accuracy: 0.8291 - val_loss: 0.5092
Epoch 9/50
145/145 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7501 - loss: 0.5700 - val_accuracy: 0.8291 - val_loss: 0.5017
Epoch 10/50
145/145 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7501 - loss: 0.5674 - val_accuracy: 0.8291 - val_loss: 0.4955
Epoch 11/50
145/145 ━━━━━━━━━━━━━━━━━━━━ 3s 22ms/step - accuracy: 0.7501 - loss: 0.5656 - val_accuracy: 0.8291 - val_loss: 0.4910
Epoch 12/50
145/145 ━━━━━━━━━━━━━━━━━━━━ 3s 22ms/step - accuracy: 0.7501 - loss: 0.5644 - val_accuracy: 0.8291 - val_loss: 0.4874
Epoch 13/50
145/145 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7501 - loss: 0.5636 - val_accuracy: 0.8291 - val_loss: 0.4846
Epoch 14/50
145/145 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7501 - loss: 0.5631 - val_accuracy: 0.8291 - val_loss: 0.4822
Epoch 15/50
145/145 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7501 - loss: 0.5628 - val_accuracy: 0.8291 - val_loss: 0.4807
Epoch 16/50
145/145 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7501 - loss: 0.5626 - val_accuracy: 0.8291 - val_loss: 0.4794
Epoch 17/50
145/145 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7501 - loss: 0.5625 - val_accuracy: 0.8291 - val_loss: 0.4784
Epoch 18/50
145/145 ━━━━━━━━━━━━━━━━━━━━ 3s 22ms/step - accuracy: 0.7501 - loss: 0.5624 - val_accuracy: 0.8291 - val_loss: 0.4778
Epoch 19/50
145/145 ━━━━━━━━━━━━━━━━━━━━ 3s 22ms/step - accuracy: 0.7501 - loss: 0.5624 - val_accuracy: 0.8291 - val_loss: 0.4771
Epoch 20/50
145/145 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7501 - loss: 0.5623 - val_accuracy: 0.8291 - val_loss: 0.4766
Epoch 21/50
145/145 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7501 - loss: 0.5623 - val_accuracy: 0.8291 - val_loss: 0.4765
Epoch 22/50
145/145 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7501 - loss: 0.5623 - val_accuracy: 0.8291 - val_loss: 0.4761
Epoch 23/50
145/145 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7501 - loss: 0.5623 - val_accuracy: 0.8291 - val_loss: 0.4760
Epoch 24/50
145/145 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7501 - loss: 0.5623 - val_accuracy: 0.8291 - val_loss: 0.4757
Epoch 25/50
145/145 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7501 - loss: 0.5623 - val_accuracy: 0.8291 - val_loss: 0.4756
Epoch 26/50
145/145 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7501 - loss: 0.5623 - val_accuracy: 0.8291 - val_loss: 0.4754
Epoch 27/50
145/145 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7501 - loss: 0.5623 - val_accuracy: 0.8291 - val_loss: 0.4756
Epoch 28/50
145/145 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7501 - loss: 0.5623 - val_accuracy: 0.8291 - val_loss: 0.4756
Epoch 29/50
145/145 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7501 - loss: 0.5623 - val_accuracy: 0.8291 - val_loss: 0.4754
Epoch 30/50
145/145 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7501 - loss: 0.5623 - val_accuracy: 0.8291 - val_loss: 0.4754
Epoch 31/50
145/145 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7501 - loss: 0.5623 - val_accuracy: 0.8291 - val_loss: 0.4755
Epoch 32/50
145/145 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7501 - loss: 0.5623 - val_accuracy: 0.8291 - val_loss: 0.4755
Epoch 33/50
145/145 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7501 - loss: 0.5623 - val_accuracy: 0.8291 - val_loss: 0.4755
Epoch 34/50
145/145 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7501 - loss: 0.5623 - val_accuracy: 0.8291 - val_loss: 0.4754
Epoch 35/50
145/145 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7501 - loss: 0.5623 - val_accuracy: 0.8291 - val_loss: 0.4755
Epoch 36/50
145/145 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7501 - loss: 0.5623 - val_accuracy: 0.8291 - val_loss: 0.4752
Epoch 37/50
145/145 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7501 - loss: 0.5623 - val_accuracy: 0.8291 - val_loss: 0.4754
Epoch 38/50
145/145 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7501 - loss: 0.5623 - val_accuracy: 0.8291 - val_loss: 0.4754
Epoch 39/50
145/145 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7501 - loss: 0.5623 - val_accuracy: 0.8291 - val_loss: 0.4756
Epoch 40/50
145/145 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7501 - loss: 0.5623 - val_accuracy: 0.8291 - val_loss: 0.4754
Epoch 41/50
145/145 ━━━━━━━━━━━━━━━━━━━━ 5s 21ms/step - accuracy: 0.7501 - loss: 0.5623 - val_accuracy: 0.8291 - val_loss: 0.4753
Epoch 42/50
145/145 ━━━━━━━━━━━━━━━━━━━━ 3s 22ms/step - accuracy: 0.7501 - loss: 0.5623 - val_accuracy: 0.8291 - val_loss: 0.4754
Epoch 43/50
145/145 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7501 - loss: 0.5623 - val_accuracy: 0.8291 - val_loss: 0.4751
Epoch 44/50
145/145 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7501 - loss: 0.5623 - val_accuracy: 0.8291 - val_loss: 0.4750
Epoch 45/50
145/145 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7501 - loss: 0.5623 - val_accuracy: 0.8291 - val_loss: 0.4755
Epoch 46/50
145/145 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7501 - loss: 0.5623 - val_accuracy: 0.8291 - val_loss: 0.4756
Epoch 47/50
145/145 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7501 - loss: 0.5623 - val_accuracy: 0.8291 - val_loss: 0.4756
Epoch 48/50
145/145 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7501 - loss: 0.5623 - val_accuracy: 0.8291 - val_loss: 0.4750
Epoch 49/50
145/145 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7501 - loss: 0.5623 - val_accuracy: 0.8291 - val_loss: 0.4756
Epoch 50/50
145/145 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7501 - loss: 0.5623 - val_accuracy: 0.8291 - val_loss: 0.4756
2025-10-31 04:26:41.087 | INFO     | src.ai_engine.ai_models:fit:685 - LSTM trained successfully.
2025-10-31 04:26:41.096 | INFO     | src.ai_engine.ai_models:fit:381 - Generating base model predictions for meta-model training...
2025-10-31 04:26:41.435 | INFO     | src.ai_engine.feature_engineering:create_sequences:261 - Creating sequences with length 50 from 5198 data points.
2025-10-31 04:26:41.494 | INFO     | src.ai_engine.feature_engineering:create_sequences:270 - Created 5148 sequences.
WARNING:tensorflow:5 out of the last 647 calls to <function TensorFlowTrainer.make_predict_function.<locals>.one_step_on_data_distributed at 0x000001C844067600> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has reduce_retracing=True option that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
161/161 ━━━━━━━━━━━━━━━━━━━━ 2s 10ms/step
2025-10-31 04:26:43.721 | INFO     | src.ai_engine.ai_models:fit:396 - Training meta-model...
2025-10-31 04:26:43.728 | SUCCESS  | src.ai_engine.ai_models:fit:399 - Stacking Ensemble trained successfully.
2025-10-31 04:26:43.729 | SUCCESS  | __main__:main:167 - Final Ensemble model trained.
2025-10-31 04:26:43.730 | INFO     | __main__:main:171 - Saving models to 'models\GainX_400\1h'...
2025-10-31 04:26:43.777 | INFO     | src.ai_engine.ai_models:save:52 - Model RandomForest saved to models\GainX_400\1h\random_forest.pkl
2025-10-31 04:26:43.786 | INFO     | src.ai_engine.ai_models:save:52 - Model GradientBoosting saved to models\GainX_400\1h\gradient_boosting.pkl
2025-10-31 04:26:43.868 | INFO     | src.ai_engine.ai_models:save:731 - LSTM model saved to models\GainX_400\1h\lstm.keras, models\GainX_400\1h\lstm_scaler.pkl and marker file models\GainX_400\1h\lstm.pkl
2025-10-31 04:26:43.873 | INFO     | src.ai_engine.ai_models:save_all:463 - Meta-model saved to models\GainX_400\1h\meta_model.pkl
2025-10-31 04:26:43.875 | SUCCESS  | __main__:main:174 - --- Finished training for Symbol: GainX 400, Timeframe: 1h ---
2025-10-31 04:26:43.880 | INFO     | __main__:main:140 - --- Starting training for Symbol: GainX 400, Timeframe: 1m ---
2025-10-31 04:26:44.200 | SUCCESS  | __main__:main:148 - Loaded 100001 records.
2025-10-31 04:26:44.201 | INFO     | __main__:prepare_training_data:32 - Preparing data for training with Meta-Labeling...
2025-10-31 04:26:49.680 | DEBUG    | src.ai_engine.technical_indicators:calculate_all:47 - Calculated 63 technical indicators
2025-10-31 04:27:06.779 | DEBUG    | src.ai_engine.feature_engineering:extract_features:66 - Extracted 116 features
2025-10-31 04:27:06.784 | INFO     | __main__:prepare_training_data:39 - Generating signals from primary model (SimplePatternModel)...
2025-10-31 04:27:07.007 | WARNING  | src.ai_engine.feature_engineering:prepare_for_model:230 - Se perdieron todos los datos al eliminar los NaN. Se conservarán los datos rellenados.
2025-10-31 04:27:22.837 | INFO     | src.ai_engine.ai_models:calculate_optimal_threshold:549 - Calculated optimal threshold: 0.0010 (volatility: 0.0001, avg_movement: 0.0004)
2025-10-31 04:27:22.839 | INFO     | src.ai_engine.ai_models:create_meta_labels:577 - Creating meta-labels for secondary model...
2025-10-31 04:27:37.518 | INFO     | src.ai_engine.ai_models:create_meta_labels:629 - Meta-Label distribution - Profitable: 65 (9.1%), Unprofitable: 647 (90.9%)
2025-10-31 04:27:37.775 | WARNING  | src.ai_engine.feature_engineering:prepare_for_model:230 - Se perdieron todos los datos al eliminar los NaN. Se conservarán los datos rellenados.
2025-10-31 04:27:37.876 | INFO     | __main__:prepare_training_data:75 - Data preparation complete. Shape of X: (65092, 116), Shape of y: (65092,)
2025-10-31 04:27:37.928 | INFO     | src.ai_engine.feature_engineering:create_sequences:261 - Creating sequences with length 50 from 65092 data points.
2025-10-31 04:27:38.732 | INFO     | src.ai_engine.feature_engineering:create_sequences:270 - Created 65042 sequences.
2025-10-31 04:27:38.746 | INFO     | __main__:main:164 - Initializing and training Ensemble model...
2025-10-31 04:27:38.749 | INFO     | src.ai_engine.ai_models:__init__:304 - Initialized Stacking Ensemble with Logistic Regression as meta-model.
2025-10-31 04:27:38.752 | INFO     | src.ai_engine.ai_models:fit:359 - Creating LSTM model...
2025-10-31 04:27:38.752 | INFO     | src.ai_engine.ai_models:fit:364 - Training base models...
2025-10-31 04:27:38.869 | INFO     | src.ai_engine.ai_models:fit:373 - Training random_forest...
2025-10-31 04:27:53.626 | INFO     | src.ai_engine.ai_models:fit:98 - RandomForest trained successfully on 65092 samples with 2 classes
2025-10-31 04:27:53.628 | INFO     | src.ai_engine.ai_models:fit:373 - Training gradient_boosting...
2025-10-31 04:39:45.825 | INFO     | src.ai_engine.ai_models:fit:157 - GradientBoosting trained successfully on 65092 samples with 2 classes
2025-10-31 04:39:45.828 | INFO     | src.ai_engine.ai_models:fit:373 - Training pattern_based...
2025-10-31 04:39:45.828 | INFO     | src.ai_engine.ai_models:fit:373 - Training lstm...
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\keras\src\layers\rnn\rnn.py:199: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(**kwargs)
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1108: RuntimeWarning: invalid value encountered in divide
  updated_mean = (last_sum + new_sum) / updated_sample_count
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1113: RuntimeWarning: invalid value encountered in divide
  T = new_sum / new_sample_count
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1133: RuntimeWarning: invalid value encountered in divide
  new_unnormalized_variance -= correction**2 / new_sample_count
Epoch 1/50
1830/1830 ━━━━━━━━━━━━━━━━━━━━ 182s 27ms/step - accuracy: 0.9990 - loss: 0.3937 - val_accuracy: 0.9989 - val_loss: 0.2072
Epoch 2/50
1830/1830 ━━━━━━━━━━━━━━━━━━━━ 40s 22ms/step - accuracy: 0.9990 - loss: 0.1314 - val_accuracy: 0.9989 - val_loss: 0.0803
Epoch 3/50
1830/1830 ━━━━━━━━━━━━━━━━━━━━ 39s 21ms/step - accuracy: 0.9990 - loss: 0.0550 - val_accuracy: 0.9989 - val_loss: 0.0370
Epoch 4/50
1830/1830 ━━━━━━━━━━━━━━━━━━━━ 38s 21ms/step - accuracy: 0.9990 - loss: 0.0268 - val_accuracy: 0.9989 - val_loss: 0.0198
Epoch 5/50
1830/1830 ━━━━━━━━━━━━━━━━━━━━ 38s 21ms/step - accuracy: 0.9990 - loss: 0.0153 - val_accuracy: 0.9989 - val_loss: 0.0126
Epoch 6/50
1830/1830 ━━━━━━━━━━━━━━━━━━━━ 38s 21ms/step - accuracy: 0.9990 - loss: 0.0106 - val_accuracy: 0.9989 - val_loss: 0.0098
Epoch 7/50
1830/1830 ━━━━━━━━━━━━━━━━━━━━ 38s 21ms/step - accuracy: 0.9990 - loss: 0.0088 - val_accuracy: 0.9989 - val_loss: 0.0089
Epoch 8/50
1830/1830 ━━━━━━━━━━━━━━━━━━━━ 39s 21ms/step - accuracy: 0.9990 - loss: 0.0082 - val_accuracy: 0.9989 - val_loss: 0.0086
Epoch 9/50
1830/1830 ━━━━━━━━━━━━━━━━━━━━ 38s 21ms/step - accuracy: 0.9990 - loss: 0.0080 - val_accuracy: 0.9989 - val_loss: 0.0085
Epoch 10/50
1830/1830 ━━━━━━━━━━━━━━━━━━━━ 38s 21ms/step - accuracy: 0.9990 - loss: 0.0079 - val_accuracy: 0.9989 - val_loss: 0.0084
Epoch 11/50
1830/1830 ━━━━━━━━━━━━━━━━━━━━ 38s 21ms/step - accuracy: 0.9990 - loss: 0.0079 - val_accuracy: 0.9989 - val_loss: 0.0084
Epoch 12/50
1830/1830 ━━━━━━━━━━━━━━━━━━━━ 38s 21ms/step - accuracy: 0.9990 - loss: 0.0079 - val_accuracy: 0.9989 - val_loss: 0.0084
Epoch 13/50
1830/1830 ━━━━━━━━━━━━━━━━━━━━ 38s 21ms/step - accuracy: 0.9990 - loss: 0.0079 - val_accuracy: 0.9989 - val_loss: 0.0084
Epoch 14/50
1830/1830 ━━━━━━━━━━━━━━━━━━━━ 38s 21ms/step - accuracy: 0.9990 - loss: 0.0078 - val_accuracy: 0.9989 - val_loss: 0.0084
Epoch 15/50
1830/1830 ━━━━━━━━━━━━━━━━━━━━ 42s 21ms/step - accuracy: 0.9990 - loss: 0.0078 - val_accuracy: 0.9989 - val_loss: 0.0084
Epoch 16/50
1830/1830 ━━━━━━━━━━━━━━━━━━━━ 38s 21ms/step - accuracy: 0.9990 - loss: 0.0078 - val_accuracy: 0.9989 - val_loss: 0.0084
Epoch 17/50
1830/1830 ━━━━━━━━━━━━━━━━━━━━ 38s 21ms/step - accuracy: 0.9990 - loss: 0.0078 - val_accuracy: 0.9989 - val_loss: 0.0084
Epoch 18/50
1830/1830 ━━━━━━━━━━━━━━━━━━━━ 39s 21ms/step - accuracy: 0.9990 - loss: 0.0078 - val_accuracy: 0.9989 - val_loss: 0.0084
Epoch 19/50
1830/1830 ━━━━━━━━━━━━━━━━━━━━ 38s 21ms/step - accuracy: 0.9990 - loss: 0.0078 - val_accuracy: 0.9989 - val_loss: 0.0084
Epoch 20/50
1830/1830 ━━━━━━━━━━━━━━━━━━━━ 38s 21ms/step - accuracy: 0.9990 - loss: 0.0078 - val_accuracy: 0.9989 - val_loss: 0.0084
Epoch 21/50
1830/1830 ━━━━━━━━━━━━━━━━━━━━ 38s 21ms/step - accuracy: 0.9990 - loss: 0.0078 - val_accuracy: 0.9989 - val_loss: 0.0084
Epoch 22/50
1830/1830 ━━━━━━━━━━━━━━━━━━━━ 38s 21ms/step - accuracy: 0.9990 - loss: 0.0078 - val_accuracy: 0.9989 - val_loss: 0.0084
Epoch 23/50
1830/1830 ━━━━━━━━━━━━━━━━━━━━ 38s 21ms/step - accuracy: 0.9990 - loss: 0.0078 - val_accuracy: 0.9989 - val_loss: 0.0084
2025-10-31 05:44:13.582 | INFO     | src.ai_engine.ai_models:fit:685 - LSTM trained successfully.
2025-10-31 05:44:14.127 | INFO     | src.ai_engine.ai_models:fit:381 - Generating base model predictions for meta-model training...
2025-10-31 05:44:21.219 | INFO     | src.ai_engine.feature_engineering:create_sequences:261 - Creating sequences with length 50 from 65092 data points.
2025-10-31 05:44:22.070 | INFO     | src.ai_engine.feature_engineering:create_sequences:270 - Created 65042 sequences.
2033/2033 ━━━━━━━━━━━━━━━━━━━━ 170s 21ms/step
2025-10-31 06:02:35.055 | INFO     | src.ai_engine.ai_models:fit:396 - Training meta-model...
2025-10-31 06:02:40.272 | SUCCESS  | src.ai_engine.ai_models:fit:399 - Stacking Ensemble trained successfully.
2025-10-31 06:02:40.874 | SUCCESS  | __main__:main:167 - Final Ensemble model trained.
2025-10-31 06:02:40.913 | INFO     | __main__:main:171 - Saving models to 'models\GainX_400\1m'...
2025-10-31 06:02:48.380 | INFO     | src.ai_engine.ai_models:save:52 - Model RandomForest saved to models\GainX_400\1m\random_forest.pkl
2025-10-31 06:02:49.798 | INFO     | src.ai_engine.ai_models:save:52 - Model GradientBoosting saved to models\GainX_400\1m\gradient_boosting.pkl
2025-10-31 06:02:57.169 | INFO     | src.ai_engine.ai_models:save:731 - LSTM model saved to models\GainX_400\1m\lstm.keras, models\GainX_400\1m\lstm_scaler.pkl and marker file models\GainX_400\1m\lstm.pkl
2025-10-31 06:02:57.272 | INFO     | src.ai_engine.ai_models:save_all:463 - Meta-model saved to models\GainX_400\1m\meta_model.pkl
2025-10-31 06:02:57.292 | SUCCESS  | __main__:main:174 - --- Finished training for Symbol: GainX 400, Timeframe: 1m ---
2025-10-31 06:02:57.376 | INFO     | __main__:main:140 - --- Starting training for Symbol: GainX 400, Timeframe: 4h ---
2025-10-31 06:02:59.738 | SUCCESS  | __main__:main:148 - Loaded 1809 records.
2025-10-31 06:02:59.740 | INFO     | __main__:prepare_training_data:32 - Preparing data for training with Meta-Labeling...
2025-10-31 06:03:01.436 | DEBUG    | src.ai_engine.technical_indicators:calculate_all:47 - Calculated 63 technical indicators
2025-10-31 06:03:02.594 | DEBUG    | src.ai_engine.feature_engineering:extract_features:66 - Extracted 116 features
2025-10-31 06:03:02.595 | INFO     | __main__:prepare_training_data:39 - Generating signals from primary model (SimplePatternModel)...
2025-10-31 06:03:02.763 | WARNING  | src.ai_engine.feature_engineering:prepare_for_model:230 - Se perdieron todos los datos al eliminar los NaN. Se conservarán los datos rellenados.
2025-10-31 06:03:03.989 | INFO     | src.ai_engine.ai_models:calculate_optimal_threshold:549 - Calculated optimal threshold: 0.0046 (volatility: 0.0015, avg_movement: 0.0066)
2025-10-31 06:03:03.991 | INFO     | src.ai_engine.ai_models:create_meta_labels:577 - Creating meta-labels for secondary model...
2025-10-31 06:03:04.249 | INFO     | src.ai_engine.ai_models:create_meta_labels:629 - Meta-Label distribution - Profitable: 331 (37.4%), Unprofitable: 553 (62.6%)
2025-10-31 06:03:04.354 | WARNING  | src.ai_engine.feature_engineering:prepare_for_model:230 - Se perdieron todos los datos al eliminar los NaN. Se conservarán los datos rellenados.
2025-10-31 06:03:04.453 | INFO     | __main__:prepare_training_data:75 - Data preparation complete. Shape of X: (1281, 116), Shape of y: (1281,)
2025-10-31 06:03:04.780 | INFO     | src.ai_engine.feature_engineering:create_sequences:261 - Creating sequences with length 50 from 1281 data points.
2025-10-31 06:03:04.825 | INFO     | src.ai_engine.feature_engineering:create_sequences:270 - Created 1231 sequences.
2025-10-31 06:03:05.561 | INFO     | __main__:main:164 - Initializing and training Ensemble model...
2025-10-31 06:03:05.595 | INFO     | src.ai_engine.ai_models:__init__:304 - Initialized Stacking Ensemble with Logistic Regression as meta-model.
2025-10-31 06:03:06.491 | INFO     | src.ai_engine.ai_models:fit:359 - Creating LSTM model...
2025-10-31 06:03:06.502 | INFO     | src.ai_engine.ai_models:fit:364 - Training base models...
2025-10-31 06:03:06.548 | INFO     | src.ai_engine.ai_models:fit:373 - Training random_forest...
2025-10-31 06:03:08.978 | INFO     | src.ai_engine.ai_models:fit:98 - RandomForest trained successfully on 1281 samples with 2 classes
2025-10-31 06:03:08.979 | INFO     | src.ai_engine.ai_models:fit:373 - Training gradient_boosting...
2025-10-31 06:03:21.918 | INFO     | src.ai_engine.ai_models:fit:157 - GradientBoosting trained successfully on 1281 samples with 2 classes
2025-10-31 06:03:21.918 | INFO     | src.ai_engine.ai_models:fit:373 - Training pattern_based...
2025-10-31 06:03:21.920 | INFO     | src.ai_engine.ai_models:fit:373 - Training lstm...
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\keras\src\layers\rnn\rnn.py:199: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(**kwargs)
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1108: RuntimeWarning: invalid value encountered in divide
  updated_mean = (last_sum + new_sum) / updated_sample_count
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1113: RuntimeWarning: invalid value encountered in divide
  T = new_sum / new_sample_count
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1133: RuntimeWarning: invalid value encountered in divide
  new_unnormalized_variance -= correction**2 / new_sample_count
Epoch 1/50
35/35 ━━━━━━━━━━━━━━━━━━━━ 21s 112ms/step - accuracy: 0.7299 - loss: 0.6896 - val_accuracy: 0.8387 - val_loss: 0.6822
Epoch 2/50
35/35 ━━━━━━━━━━━━━━━━━━━━ 1s 29ms/step - accuracy: 0.7299 - loss: 0.6822 - val_accuracy: 0.8387 - val_loss: 0.6715
Epoch 3/50
35/35 ━━━━━━━━━━━━━━━━━━━━ 2s 38ms/step - accuracy: 0.7299 - loss: 0.6755 - val_accuracy: 0.8387 - val_loss: 0.6611
Epoch 4/50
35/35 ━━━━━━━━━━━━━━━━━━━━ 1s 23ms/step - accuracy: 0.7299 - loss: 0.6689 - val_accuracy: 0.8387 - val_loss: 0.6520
Epoch 5/50
35/35 ━━━━━━━━━━━━━━━━━━━━ 1s 27ms/step - accuracy: 0.7299 - loss: 0.6629 - val_accuracy: 0.8387 - val_loss: 0.6425
Epoch 6/50
35/35 ━━━━━━━━━━━━━━━━━━━━ 1s 26ms/step - accuracy: 0.7299 - loss: 0.6572 - val_accuracy: 0.8387 - val_loss: 0.6341
Epoch 7/50
35/35 ━━━━━━━━━━━━━━━━━━━━ 1s 26ms/step - accuracy: 0.7299 - loss: 0.6519 - val_accuracy: 0.8387 - val_loss: 0.6254
Epoch 8/50
35/35 ━━━━━━━━━━━━━━━━━━━━ 1s 25ms/step - accuracy: 0.7299 - loss: 0.6467 - val_accuracy: 0.8387 - val_loss: 0.6176
Epoch 9/50
35/35 ━━━━━━━━━━━━━━━━━━━━ 1s 22ms/step - accuracy: 0.7299 - loss: 0.6420 - val_accuracy: 0.8387 - val_loss: 0.6101
Epoch 10/50
35/35 ━━━━━━━━━━━━━━━━━━━━ 1s 22ms/step - accuracy: 0.7299 - loss: 0.6377 - val_accuracy: 0.8387 - val_loss: 0.6024
Epoch 11/50
35/35 ━━━━━━━━━━━━━━━━━━━━ 1s 22ms/step - accuracy: 0.7299 - loss: 0.6333 - val_accuracy: 0.8387 - val_loss: 0.5959
Epoch 12/50
35/35 ━━━━━━━━━━━━━━━━━━━━ 1s 24ms/step - accuracy: 0.7299 - loss: 0.6295 - val_accuracy: 0.8387 - val_loss: 0.5893
Epoch 13/50
35/35 ━━━━━━━━━━━━━━━━━━━━ 1s 22ms/step - accuracy: 0.7299 - loss: 0.6258 - val_accuracy: 0.8387 - val_loss: 0.5831
Epoch 14/50
35/35 ━━━━━━━━━━━━━━━━━━━━ 1s 22ms/step - accuracy: 0.7299 - loss: 0.6225 - val_accuracy: 0.8387 - val_loss: 0.5770
Epoch 15/50
35/35 ━━━━━━━━━━━━━━━━━━━━ 1s 25ms/step - accuracy: 0.7299 - loss: 0.6193 - val_accuracy: 0.8387 - val_loss: 0.5714
Epoch 16/50
35/35 ━━━━━━━━━━━━━━━━━━━━ 1s 24ms/step - accuracy: 0.7299 - loss: 0.6163 - val_accuracy: 0.8387 - val_loss: 0.5663
Epoch 17/50
35/35 ━━━━━━━━━━━━━━━━━━━━ 1s 23ms/step - accuracy: 0.7299 - loss: 0.6136 - val_accuracy: 0.8387 - val_loss: 0.5610
Epoch 18/50
35/35 ━━━━━━━━━━━━━━━━━━━━ 1s 23ms/step - accuracy: 0.7299 - loss: 0.6111 - val_accuracy: 0.8387 - val_loss: 0.5562
Epoch 19/50
35/35 ━━━━━━━━━━━━━━━━━━━━ 1s 22ms/step - accuracy: 0.7299 - loss: 0.6088 - val_accuracy: 0.8387 - val_loss: 0.5514
Epoch 20/50
35/35 ━━━━━━━━━━━━━━━━━━━━ 1s 22ms/step - accuracy: 0.7299 - loss: 0.6065 - val_accuracy: 0.8387 - val_loss: 0.5473
Epoch 21/50
35/35 ━━━━━━━━━━━━━━━━━━━━ 1s 22ms/step - accuracy: 0.7299 - loss: 0.6045 - val_accuracy: 0.8387 - val_loss: 0.5434
Epoch 22/50
35/35 ━━━━━━━━━━━━━━━━━━━━ 1s 22ms/step - accuracy: 0.7299 - loss: 0.6028 - val_accuracy: 0.8387 - val_loss: 0.5391
Epoch 23/50
35/35 ━━━━━━━━━━━━━━━━━━━━ 1s 22ms/step - accuracy: 0.7299 - loss: 0.6010 - val_accuracy: 0.8387 - val_loss: 0.5357
Epoch 24/50
35/35 ━━━━━━━━━━━━━━━━━━━━ 1s 22ms/step - accuracy: 0.7299 - loss: 0.5994 - val_accuracy: 0.8387 - val_loss: 0.5322
Epoch 25/50
35/35 ━━━━━━━━━━━━━━━━━━━━ 1s 22ms/step - accuracy: 0.7299 - loss: 0.5980 - val_accuracy: 0.8387 - val_loss: 0.5288
Epoch 26/50
35/35 ━━━━━━━━━━━━━━━━━━━━ 1s 22ms/step - accuracy: 0.7299 - loss: 0.5966 - val_accuracy: 0.8387 - val_loss: 0.5255
Epoch 27/50
35/35 ━━━━━━━━━━━━━━━━━━━━ 1s 24ms/step - accuracy: 0.7299 - loss: 0.5954 - val_accuracy: 0.8387 - val_loss: 0.5226
Epoch 28/50
35/35 ━━━━━━━━━━━━━━━━━━━━ 1s 22ms/step - accuracy: 0.7299 - loss: 0.5943 - val_accuracy: 0.8387 - val_loss: 0.5198
Epoch 29/50
35/35 ━━━━━━━━━━━━━━━━━━━━ 1s 22ms/step - accuracy: 0.7299 - loss: 0.5932 - val_accuracy: 0.8387 - val_loss: 0.5174
Epoch 30/50
35/35 ━━━━━━━━━━━━━━━━━━━━ 1s 22ms/step - accuracy: 0.7299 - loss: 0.5923 - val_accuracy: 0.8387 - val_loss: 0.5149
Epoch 31/50
35/35 ━━━━━━━━━━━━━━━━━━━━ 1s 23ms/step - accuracy: 0.7299 - loss: 0.5914 - val_accuracy: 0.8387 - val_loss: 0.5125
Epoch 32/50
35/35 ━━━━━━━━━━━━━━━━━━━━ 1s 22ms/step - accuracy: 0.7299 - loss: 0.5906 - val_accuracy: 0.8387 - val_loss: 0.5102
Epoch 33/50
35/35 ━━━━━━━━━━━━━━━━━━━━ 1s 22ms/step - accuracy: 0.7299 - loss: 0.5899 - val_accuracy: 0.8387 - val_loss: 0.5079
Epoch 34/50
35/35 ━━━━━━━━━━━━━━━━━━━━ 1s 23ms/step - accuracy: 0.7299 - loss: 0.5892 - val_accuracy: 0.8387 - val_loss: 0.5061
Epoch 35/50
35/35 ━━━━━━━━━━━━━━━━━━━━ 1s 25ms/step - accuracy: 0.7299 - loss: 0.5886 - val_accuracy: 0.8387 - val_loss: 0.5042
Epoch 36/50
35/35 ━━━━━━━━━━━━━━━━━━━━ 1s 22ms/step - accuracy: 0.7299 - loss: 0.5881 - val_accuracy: 0.8387 - val_loss: 0.5024
Epoch 37/50
35/35 ━━━━━━━━━━━━━━━━━━━━ 1s 22ms/step - accuracy: 0.7299 - loss: 0.5876 - val_accuracy: 0.8387 - val_loss: 0.5007
Epoch 38/50
35/35 ━━━━━━━━━━━━━━━━━━━━ 1s 22ms/step - accuracy: 0.7299 - loss: 0.5871 - val_accuracy: 0.8387 - val_loss: 0.4992
Epoch 39/50
35/35 ━━━━━━━━━━━━━━━━━━━━ 1s 22ms/step - accuracy: 0.7299 - loss: 0.5868 - val_accuracy: 0.8387 - val_loss: 0.4975
Epoch 40/50
35/35 ━━━━━━━━━━━━━━━━━━━━ 1s 22ms/step - accuracy: 0.7299 - loss: 0.5864 - val_accuracy: 0.8387 - val_loss: 0.4964
Epoch 41/50
35/35 ━━━━━━━━━━━━━━━━━━━━ 1s 22ms/step - accuracy: 0.7299 - loss: 0.5861 - val_accuracy: 0.8387 - val_loss: 0.4948
Epoch 42/50
35/35 ━━━━━━━━━━━━━━━━━━━━ 1s 22ms/step - accuracy: 0.7299 - loss: 0.5858 - val_accuracy: 0.8387 - val_loss: 0.4936
Epoch 43/50
35/35 ━━━━━━━━━━━━━━━━━━━━ 1s 22ms/step - accuracy: 0.7299 - loss: 0.5856 - val_accuracy: 0.8387 - val_loss: 0.4926
Epoch 44/50
35/35 ━━━━━━━━━━━━━━━━━━━━ 1s 22ms/step - accuracy: 0.7299 - loss: 0.5853 - val_accuracy: 0.8387 - val_loss: 0.4916
Epoch 45/50
35/35 ━━━━━━━━━━━━━━━━━━━━ 1s 22ms/step - accuracy: 0.7299 - loss: 0.5851 - val_accuracy: 0.8387 - val_loss: 0.4904
Epoch 46/50
35/35 ━━━━━━━━━━━━━━━━━━━━ 1s 23ms/step - accuracy: 0.7299 - loss: 0.5849 - val_accuracy: 0.8387 - val_loss: 0.4896
Epoch 47/50
35/35 ━━━━━━━━━━━━━━━━━━━━ 1s 22ms/step - accuracy: 0.7299 - loss: 0.5847 - val_accuracy: 0.8387 - val_loss: 0.4886
Epoch 48/50
35/35 ━━━━━━━━━━━━━━━━━━━━ 1s 22ms/step - accuracy: 0.7299 - loss: 0.5845 - val_accuracy: 0.8387 - val_loss: 0.4876
Epoch 49/50
35/35 ━━━━━━━━━━━━━━━━━━━━ 1s 22ms/step - accuracy: 0.7299 - loss: 0.5844 - val_accuracy: 0.8387 - val_loss: 0.4867
Epoch 50/50
35/35 ━━━━━━━━━━━━━━━━━━━━ 1s 22ms/step - accuracy: 0.7299 - loss: 0.5843 - val_accuracy: 0.8387 - val_loss: 0.4862
2025-10-31 06:04:30.429 | INFO     | src.ai_engine.ai_models:fit:685 - LSTM trained successfully.
2025-10-31 06:04:30.441 | INFO     | src.ai_engine.ai_models:fit:381 - Generating base model predictions for meta-model training...
2025-10-31 06:04:30.753 | INFO     | src.ai_engine.feature_engineering:create_sequences:261 - Creating sequences with length 50 from 1281 data points.
2025-10-31 06:04:30.768 | INFO     | src.ai_engine.feature_engineering:create_sequences:270 - Created 1231 sequences.
39/39 ━━━━━━━━━━━━━━━━━━━━ 2s 27ms/step
2025-10-31 06:04:33.258 | INFO     | src.ai_engine.ai_models:fit:396 - Training meta-model...
2025-10-31 06:04:33.267 | SUCCESS  | src.ai_engine.ai_models:fit:399 - Stacking Ensemble trained successfully.
2025-10-31 06:04:33.267 | SUCCESS  | __main__:main:167 - Final Ensemble model trained.
2025-10-31 06:04:33.268 | INFO     | __main__:main:171 - Saving models to 'models\GainX_400\4h'...
2025-10-31 06:04:33.673 | INFO     | src.ai_engine.ai_models:save:52 - Model RandomForest saved to models\GainX_400\4h\random_forest.pkl
2025-10-31 06:04:33.705 | INFO     | src.ai_engine.ai_models:save:52 - Model GradientBoosting saved to models\GainX_400\4h\gradient_boosting.pkl
2025-10-31 06:04:33.802 | INFO     | src.ai_engine.ai_models:save:731 - LSTM model saved to models\GainX_400\4h\lstm.keras, models\GainX_400\4h\lstm_scaler.pkl and marker file models\GainX_400\4h\lstm.pkl
2025-10-31 06:04:33.803 | INFO     | src.ai_engine.ai_models:save_all:463 - Meta-model saved to models\GainX_400\4h\meta_model.pkl
2025-10-31 06:04:33.804 | SUCCESS  | __main__:main:174 - --- Finished training for Symbol: GainX 400, Timeframe: 4h ---
2025-10-31 06:04:33.808 | INFO     | __main__:main:140 - --- Starting training for Symbol: GainX 400, Timeframe: 5m ---
2025-10-31 06:04:34.145 | SUCCESS  | __main__:main:148 - Loaded 86685 records.
2025-10-31 06:04:34.145 | INFO     | __main__:prepare_training_data:32 - Preparing data for training with Meta-Labeling...
2025-10-31 06:04:38.933 | DEBUG    | src.ai_engine.technical_indicators:calculate_all:47 - Calculated 63 technical indicators
2025-10-31 06:04:53.867 | DEBUG    | src.ai_engine.feature_engineering:extract_features:66 - Extracted 116 features
2025-10-31 06:04:53.871 | INFO     | __main__:prepare_training_data:39 - Generating signals from primary model (SimplePatternModel)...
2025-10-31 06:04:54.059 | WARNING  | src.ai_engine.feature_engineering:prepare_for_model:230 - Se perdieron todos los datos al eliminar los NaN. Se conservarán los datos rellenados.
2025-10-31 06:05:07.863 | INFO     | src.ai_engine.ai_models:calculate_optimal_threshold:549 - Calculated optimal threshold: 0.0010 (volatility: 0.0002, avg_movement: 0.0010)
2025-10-31 06:05:07.864 | INFO     | src.ai_engine.ai_models:create_meta_labels:577 - Creating meta-labels for secondary model...
2025-10-31 06:05:20.463 | INFO     | src.ai_engine.ai_models:create_meta_labels:629 - Meta-Label distribution - Profitable: 4330 (24.2%), Unprofitable: 13561 (75.8%)
2025-10-31 06:05:20.689 | WARNING  | src.ai_engine.feature_engineering:prepare_for_model:230 - Se perdieron todos los datos al eliminar los NaN. Se conservarán los datos rellenados.
2025-10-31 06:05:20.783 | INFO     | __main__:prepare_training_data:75 - Data preparation complete. Shape of X: (61234, 116), Shape of y: (61234,)
2025-10-31 06:05:20.819 | INFO     | src.ai_engine.feature_engineering:create_sequences:261 - Creating sequences with length 50 from 61234 data points.
2025-10-31 06:05:21.519 | INFO     | src.ai_engine.feature_engineering:create_sequences:270 - Created 61184 sequences.
2025-10-31 06:05:21.528 | INFO     | __main__:main:164 - Initializing and training Ensemble model...
2025-10-31 06:05:21.529 | INFO     | src.ai_engine.ai_models:__init__:304 - Initialized Stacking Ensemble with Logistic Regression as meta-model.
2025-10-31 06:05:21.590 | INFO     | src.ai_engine.ai_models:fit:359 - Creating LSTM model...
2025-10-31 06:05:21.591 | INFO     | src.ai_engine.ai_models:fit:364 - Training base models...
2025-10-31 06:05:21.708 | INFO     | src.ai_engine.ai_models:fit:373 - Training random_forest...
2025-10-31 06:05:45.110 | INFO     | src.ai_engine.ai_models:fit:98 - RandomForest trained successfully on 61234 samples with 2 classes
2025-10-31 06:05:45.113 | INFO     | src.ai_engine.ai_models:fit:373 - Training gradient_boosting...
2025-10-31 06:17:53.460 | INFO     | src.ai_engine.ai_models:fit:157 - GradientBoosting trained successfully on 61234 samples with 2 classes
2025-10-31 06:17:53.464 | INFO     | src.ai_engine.ai_models:fit:373 - Training pattern_based...
2025-10-31 06:17:53.465 | INFO     | src.ai_engine.ai_models:fit:373 - Training lstm...
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\keras\src\layers\rnn\rnn.py:199: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(**kwargs)
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1108: RuntimeWarning: invalid value encountered in divide
  updated_mean = (last_sum + new_sum) / updated_sample_count
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1113: RuntimeWarning: invalid value encountered in divide
  T = new_sum / new_sample_count
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1133: RuntimeWarning: invalid value encountered in divide
  new_unnormalized_variance -= correction**2 / new_sample_count
Epoch 1/50
1721/1721 ━━━━━━━━━━━━━━━━━━━━ 394s 25ms/step - accuracy: 0.9280 - loss: 0.4622 - val_accuracy: 0.9413 - val_loss: 0.3118
Epoch 2/50
1721/1721 ━━━━━━━━━━━━━━━━━━━━ 37s 21ms/step - accuracy: 0.9280 - loss: 0.2890 - val_accuracy: 0.9413 - val_loss: 0.2387
Epoch 3/50
1721/1721 ━━━━━━━━━━━━━━━━━━━━ 36s 21ms/step - accuracy: 0.9280 - loss: 0.2615 - val_accuracy: 0.9413 - val_loss: 0.2265
Epoch 4/50
1721/1721 ━━━━━━━━━━━━━━━━━━━━ 36s 21ms/step - accuracy: 0.9280 - loss: 0.2589 - val_accuracy: 0.9413 - val_loss: 0.2249
Epoch 5/50
1721/1721 ━━━━━━━━━━━━━━━━━━━━ 36s 21ms/step - accuracy: 0.9280 - loss: 0.2588 - val_accuracy: 0.9413 - val_loss: 0.2247
Epoch 6/50
1721/1721 ━━━━━━━━━━━━━━━━━━━━ 36s 21ms/step - accuracy: 0.9280 - loss: 0.2588 - val_accuracy: 0.9413 - val_loss: 0.2247
Epoch 7/50
1721/1721 ━━━━━━━━━━━━━━━━━━━━ 36s 21ms/step - accuracy: 0.9280 - loss: 0.2588 - val_accuracy: 0.9413 - val_loss: 0.2246
Epoch 8/50
1721/1721 ━━━━━━━━━━━━━━━━━━━━ 36s 21ms/step - accuracy: 0.9280 - loss: 0.2588 - val_accuracy: 0.9413 - val_loss: 0.2248
Epoch 9/50
1721/1721 ━━━━━━━━━━━━━━━━━━━━ 36s 21ms/step - accuracy: 0.9280 - loss: 0.2588 - val_accuracy: 0.9413 - val_loss: 0.2248
Epoch 10/50
1721/1721 ━━━━━━━━━━━━━━━━━━━━ 36s 21ms/step - accuracy: 0.9280 - loss: 0.2588 - val_accuracy: 0.9413 - val_loss: 0.2248
Epoch 11/50
1721/1721 ━━━━━━━━━━━━━━━━━━━━ 36s 21ms/step - accuracy: 0.9280 - loss: 0.2588 - val_accuracy: 0.9413 - val_loss: 0.2246
Epoch 12/50
1721/1721 ━━━━━━━━━━━━━━━━━━━━ 37s 21ms/step - accuracy: 0.9280 - loss: 0.2588 - val_accuracy: 0.9413 - val_loss: 0.2249
Epoch 13/50
1721/1721 ━━━━━━━━━━━━━━━━━━━━ 36s 21ms/step - accuracy: 0.9280 - loss: 0.2588 - val_accuracy: 0.9413 - val_loss: 0.2246
Epoch 14/50
1721/1721 ━━━━━━━━━━━━━━━━━━━━ 36s 21ms/step - accuracy: 0.9280 - loss: 0.2588 - val_accuracy: 0.9413 - val_loss: 0.2246
Epoch 15/50
1721/1721 ━━━━━━━━━━━━━━━━━━━━ 36s 21ms/step - accuracy: 0.9280 - loss: 0.2588 - val_accuracy: 0.9413 - val_loss: 0.2246
Epoch 16/50
1721/1721 ━━━━━━━━━━━━━━━━━━━━ 36s 21ms/step - accuracy: 0.9280 - loss: 0.2588 - val_accuracy: 0.9413 - val_loss: 0.2245
Epoch 17/50
1721/1721 ━━━━━━━━━━━━━━━━━━━━ 36s 21ms/step - accuracy: 0.9280 - loss: 0.2588 - val_accuracy: 0.9413 - val_loss: 0.2246
Epoch 18/50
1721/1721 ━━━━━━━━━━━━━━━━━━━━ 36s 21ms/step - accuracy: 0.9280 - loss: 0.2588 - val_accuracy: 0.9413 - val_loss: 0.2248
Epoch 19/50
1721/1721 ━━━━━━━━━━━━━━━━━━━━ 36s 21ms/step - accuracy: 0.9280 - loss: 0.2588 - val_accuracy: 0.9413 - val_loss: 0.2248
Epoch 20/50
1721/1721 ━━━━━━━━━━━━━━━━━━━━ 36s 21ms/step - accuracy: 0.9280 - loss: 0.2588 - val_accuracy: 0.9413 - val_loss: 0.2246
Epoch 21/50
1721/1721 ━━━━━━━━━━━━━━━━━━━━ 36s 21ms/step - accuracy: 0.9280 - loss: 0.2588 - val_accuracy: 0.9413 - val_loss: 0.2247
Epoch 22/50
1721/1721 ━━━━━━━━━━━━━━━━━━━━ 36s 21ms/step - accuracy: 0.9280 - loss: 0.2588 - val_accuracy: 0.9413 - val_loss: 0.2246
Epoch 23/50
1721/1721 ━━━━━━━━━━━━━━━━━━━━ 36s 21ms/step - accuracy: 0.9280 - loss: 0.2588 - val_accuracy: 0.9413 - val_loss: 0.2246
Epoch 24/50
1721/1721 ━━━━━━━━━━━━━━━━━━━━ 36s 21ms/step - accuracy: 0.9280 - loss: 0.2588 - val_accuracy: 0.9413 - val_loss: 0.2248
Epoch 25/50
1721/1721 ━━━━━━━━━━━━━━━━━━━━ 36s 21ms/step - accuracy: 0.9280 - loss: 0.2588 - val_accuracy: 0.9413 - val_loss: 0.2245
Epoch 26/50
1721/1721 ━━━━━━━━━━━━━━━━━━━━ 36s 21ms/step - accuracy: 0.9280 - loss: 0.2588 - val_accuracy: 0.9413 - val_loss: 0.2246
Epoch 27/50
1721/1721 ━━━━━━━━━━━━━━━━━━━━ 36s 21ms/step - accuracy: 0.9280 - loss: 0.2588 - val_accuracy: 0.9413 - val_loss: 0.2248
Epoch 28/50
1721/1721 ━━━━━━━━━━━━━━━━━━━━ 36s 21ms/step - accuracy: 0.9280 - loss: 0.2588 - val_accuracy: 0.9413 - val_loss: 0.2247
Epoch 29/50
1721/1721 ━━━━━━━━━━━━━━━━━━━━ 36s 21ms/step - accuracy: 0.9280 - loss: 0.2588 - val_accuracy: 0.9413 - val_loss: 0.2248
Epoch 30/50
1721/1721 ━━━━━━━━━━━━━━━━━━━━ 36s 21ms/step - accuracy: 0.9280 - loss: 0.2588 - val_accuracy: 0.9413 - val_loss: 0.2247
Epoch 31/50
1721/1721 ━━━━━━━━━━━━━━━━━━━━ 36s 21ms/step - accuracy: 0.9280 - loss: 0.2588 - val_accuracy: 0.9413 - val_loss: 0.2245
Epoch 32/50
1721/1721 ━━━━━━━━━━━━━━━━━━━━ 36s 21ms/step - accuracy: 0.9280 - loss: 0.2588 - val_accuracy: 0.9413 - val_loss: 0.2246
Epoch 33/50
1721/1721 ━━━━━━━━━━━━━━━━━━━━ 36s 21ms/step - accuracy: 0.9280 - loss: 0.2588 - val_accuracy: 0.9413 - val_loss: 0.2247
Epoch 34/50
1721/1721 ━━━━━━━━━━━━━━━━━━━━ 36s 21ms/step - accuracy: 0.9280 - loss: 0.2588 - val_accuracy: 0.9413 - val_loss: 0.2247
Epoch 35/50
1721/1721 ━━━━━━━━━━━━━━━━━━━━ 36s 21ms/step - accuracy: 0.9280 - loss: 0.2588 - val_accuracy: 0.9413 - val_loss: 0.2245
Epoch 36/50
1721/1721 ━━━━━━━━━━━━━━━━━━━━ 36s 21ms/step - accuracy: 0.9280 - loss: 0.2588 - val_accuracy: 0.9413 - val_loss: 0.2248
Epoch 37/50
1721/1721 ━━━━━━━━━━━━━━━━━━━━ 36s 21ms/step - accuracy: 0.9280 - loss: 0.2588 - val_accuracy: 0.9413 - val_loss: 0.2248
Epoch 38/50
1721/1721 ━━━━━━━━━━━━━━━━━━━━ 36s 21ms/step - accuracy: 0.9280 - loss: 0.2588 - val_accuracy: 0.9413 - val_loss: 0.2245
Epoch 39/50
1721/1721 ━━━━━━━━━━━━━━━━━━━━ 36s 21ms/step - accuracy: 0.9280 - loss: 0.2588 - val_accuracy: 0.9413 - val_loss: 0.2248
Epoch 40/50
1721/1721 ━━━━━━━━━━━━━━━━━━━━ 36s 21ms/step - accuracy: 0.9280 - loss: 0.2588 - val_accuracy: 0.9413 - val_loss: 0.2248
Epoch 41/50
1721/1721 ━━━━━━━━━━━━━━━━━━━━ 36s 21ms/step - accuracy: 0.9280 - loss: 0.2588 - val_accuracy: 0.9413 - val_loss: 0.2249
2025-10-31 07:20:41.800 | INFO     | src.ai_engine.ai_models:fit:685 - LSTM trained successfully.
2025-10-31 07:20:42.093 | INFO     | src.ai_engine.ai_models:fit:381 - Generating base model predictions for meta-model training...
2025-10-31 07:21:03.906 | INFO     | src.ai_engine.feature_engineering:create_sequences:261 - Creating sequences with length 50 from 61234 data points.
2025-10-31 07:21:04.614 | INFO     | src.ai_engine.feature_engineering:create_sequences:270 - Created 61184 sequences.
1912/1912 ━━━━━━━━━━━━━━━━━━━━ 197s 19ms/step
2025-10-31 07:38:30.721 | INFO     | src.ai_engine.ai_models:fit:396 - Training meta-model...
2025-10-31 07:38:42.204 | SUCCESS  | src.ai_engine.ai_models:fit:399 - Stacking Ensemble trained successfully.
2025-10-31 07:38:42.686 | SUCCESS  | __main__:main:167 - Final Ensemble model trained.
2025-10-31 07:38:42.701 | INFO     | __main__:main:171 - Saving models to 'models\GainX_400\5m'...
2025-10-31 07:38:53.436 | INFO     | src.ai_engine.ai_models:save:52 - Model RandomForest saved to models\GainX_400\5m\random_forest.pkl
2025-10-31 07:38:56.416 | INFO     | src.ai_engine.ai_models:save:52 - Model GradientBoosting saved to models\GainX_400\5m\gradient_boosting.pkl
2025-10-31 07:39:06.470 | INFO     | src.ai_engine.ai_models:save:731 - LSTM model saved to models\GainX_400\5m\lstm.keras, models\GainX_400\5m\lstm_scaler.pkl and marker file models\GainX_400\5m\lstm.pkl
2025-10-31 07:39:06.566 | INFO     | src.ai_engine.ai_models:save_all:463 - Meta-model saved to models\GainX_400\5m\meta_model.pkl
2025-10-31 07:39:06.567 | SUCCESS  | __main__:main:174 - --- Finished training for Symbol: GainX 400, Timeframe: 5m ---
2025-10-31 07:39:06.658 | INFO     | __main__:main:140 - --- Starting training for Symbol: GainX 600, Timeframe: 15m ---
2025-10-31 07:39:12.009 | SUCCESS  | __main__:main:148 - Loaded 28898 records.
2025-10-31 07:39:12.010 | INFO     | __main__:prepare_training_data:32 - Preparing data for training with Meta-Labeling...
2025-10-31 07:39:19.874 | DEBUG    | src.ai_engine.technical_indicators:calculate_all:47 - Calculated 63 technical indicators
2025-10-31 07:39:27.984 | DEBUG    | src.ai_engine.feature_engineering:extract_features:66 - Extracted 116 features
2025-10-31 07:39:28.050 | INFO     | __main__:prepare_training_data:39 - Generating signals from primary model (SimplePatternModel)...
2025-10-31 07:39:28.248 | WARNING  | src.ai_engine.feature_engineering:prepare_for_model:230 - Se perdieron todos los datos al eliminar los NaN. Se conservarán los datos rellenados.
2025-10-31 07:39:35.039 | INFO     | src.ai_engine.ai_models:calculate_optimal_threshold:549 - Calculated optimal threshold: 0.0011 (volatility: 0.0004, avg_movement: 0.0016)
2025-10-31 07:39:35.042 | INFO     | src.ai_engine.ai_models:create_meta_labels:577 - Creating meta-labels for secondary model...
2025-10-31 07:39:38.677 | INFO     | src.ai_engine.ai_models:create_meta_labels:629 - Meta-Label distribution - Profitable: 4681 (35.7%), Unprofitable: 8416 (64.3%)
2025-10-31 07:39:38.777 | WARNING  | src.ai_engine.feature_engineering:prepare_for_model:230 - Se perdieron todos los datos al eliminar los NaN. Se conservarán los datos rellenados.
2025-10-31 07:39:38.863 | INFO     | __main__:prepare_training_data:75 - Data preparation complete. Shape of X: (20759, 116), Shape of y: (20759,)
2025-10-31 07:39:39.378 | INFO     | src.ai_engine.feature_engineering:create_sequences:261 - Creating sequences with length 50 from 20759 data points.
2025-10-31 07:39:39.904 | INFO     | src.ai_engine.feature_engineering:create_sequences:270 - Created 20709 sequences.
2025-10-31 07:39:40.456 | INFO     | __main__:main:164 - Initializing and training Ensemble model...
2025-10-31 07:39:40.576 | INFO     | src.ai_engine.ai_models:__init__:304 - Initialized Stacking Ensemble with Logistic Regression as meta-model.
2025-10-31 07:39:41.498 | INFO     | src.ai_engine.ai_models:fit:359 - Creating LSTM model...
2025-10-31 07:39:41.499 | INFO     | src.ai_engine.ai_models:fit:364 - Training base models...
2025-10-31 07:39:41.539 | INFO     | src.ai_engine.ai_models:fit:373 - Training random_forest...
2025-10-31 07:39:55.931 | INFO     | src.ai_engine.ai_models:fit:98 - RandomForest trained successfully on 20759 samples with 2 classes
2025-10-31 07:39:55.932 | INFO     | src.ai_engine.ai_models:fit:373 - Training gradient_boosting...
2025-10-31 07:43:49.947 | INFO     | src.ai_engine.ai_models:fit:157 - GradientBoosting trained successfully on 20759 samples with 2 classes
2025-10-31 07:43:49.949 | INFO     | src.ai_engine.ai_models:fit:373 - Training pattern_based...
2025-10-31 07:43:49.974 | INFO     | src.ai_engine.ai_models:fit:373 - Training lstm...
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\keras\src\layers\rnn\rnn.py:199: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(**kwargs)
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1108: RuntimeWarning: invalid value encountered in divide
  updated_mean = (last_sum + new_sum) / updated_sample_count
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1113: RuntimeWarning: invalid value encountered in divide
  T = new_sum / new_sample_count
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1133: RuntimeWarning: invalid value encountered in divide
  new_unnormalized_variance -= correction**2 / new_sample_count
Epoch 1/50
583/583 ━━━━━━━━━━━━━━━━━━━━ 61s 29ms/step - accuracy: 0.7703 - loss: 0.6335 - val_accuracy: 0.8165 - val_loss: 0.5666
Epoch 2/50
583/583 ━━━━━━━━━━━━━━━━━━━━ 14s 23ms/step - accuracy: 0.7703 - loss: 0.5679 - val_accuracy: 0.8165 - val_loss: 0.5145
Epoch 3/50
583/583 ━━━━━━━━━━━━━━━━━━━━ 13s 22ms/step - accuracy: 0.7703 - loss: 0.5460 - val_accuracy: 0.8165 - val_loss: 0.4938
Epoch 4/50
583/583 ━━━━━━━━━━━━━━━━━━━━ 13s 22ms/step - accuracy: 0.7703 - loss: 0.5402 - val_accuracy: 0.8165 - val_loss: 0.4865
Epoch 5/50
583/583 ━━━━━━━━━━━━━━━━━━━━ 13s 22ms/step - accuracy: 0.7703 - loss: 0.5391 - val_accuracy: 0.8165 - val_loss: 0.4841
Epoch 6/50
583/583 ━━━━━━━━━━━━━━━━━━━━ 21s 37ms/step - accuracy: 0.7703 - loss: 0.5389 - val_accuracy: 0.8165 - val_loss: 0.4835
Epoch 7/50
583/583 ━━━━━━━━━━━━━━━━━━━━ 13s 21ms/step - accuracy: 0.7703 - loss: 0.5389 - val_accuracy: 0.8165 - val_loss: 0.4831
Epoch 8/50
583/583 ━━━━━━━━━━━━━━━━━━━━ 12s 21ms/step - accuracy: 0.7703 - loss: 0.5389 - val_accuracy: 0.8165 - val_loss: 0.4830
Epoch 9/50
583/583 ━━━━━━━━━━━━━━━━━━━━ 12s 21ms/step - accuracy: 0.7703 - loss: 0.5389 - val_accuracy: 0.8165 - val_loss: 0.4832
Epoch 10/50
583/583 ━━━━━━━━━━━━━━━━━━━━ 12s 21ms/step - accuracy: 0.7703 - loss: 0.5389 - val_accuracy: 0.8165 - val_loss: 0.4832
Epoch 11/50
583/583 ━━━━━━━━━━━━━━━━━━━━ 12s 21ms/step - accuracy: 0.7703 - loss: 0.5389 - val_accuracy: 0.8165 - val_loss: 0.4833
Epoch 12/50
583/583 ━━━━━━━━━━━━━━━━━━━━ 19s 33ms/step - accuracy: 0.7703 - loss: 0.5389 - val_accuracy: 0.8165 - val_loss: 0.4832
Epoch 13/50
583/583 ━━━━━━━━━━━━━━━━━━━━ 12s 21ms/step - accuracy: 0.7703 - loss: 0.5389 - val_accuracy: 0.8165 - val_loss: 0.4831
Epoch 14/50
583/583 ━━━━━━━━━━━━━━━━━━━━ 13s 21ms/step - accuracy: 0.7703 - loss: 0.5389 - val_accuracy: 0.8165 - val_loss: 0.4830
Epoch 15/50
583/583 ━━━━━━━━━━━━━━━━━━━━ 12s 21ms/step - accuracy: 0.7703 - loss: 0.5389 - val_accuracy: 0.8165 - val_loss: 0.4830
Epoch 16/50
583/583 ━━━━━━━━━━━━━━━━━━━━ 12s 21ms/step - accuracy: 0.7703 - loss: 0.5389 - val_accuracy: 0.8165 - val_loss: 0.4825
Epoch 17/50
583/583 ━━━━━━━━━━━━━━━━━━━━ 13s 21ms/step - accuracy: 0.7703 - loss: 0.5389 - val_accuracy: 0.8165 - val_loss: 0.4824
Epoch 18/50
583/583 ━━━━━━━━━━━━━━━━━━━━ 12s 21ms/step - accuracy: 0.7703 - loss: 0.5389 - val_accuracy: 0.8165 - val_loss: 0.4829
Epoch 19/50
583/583 ━━━━━━━━━━━━━━━━━━━━ 12s 21ms/step - accuracy: 0.7703 - loss: 0.5389 - val_accuracy: 0.8165 - val_loss: 0.4828
Epoch 20/50
583/583 ━━━━━━━━━━━━━━━━━━━━ 12s 21ms/step - accuracy: 0.7703 - loss: 0.5389 - val_accuracy: 0.8165 - val_loss: 0.4830
Epoch 21/50
583/583 ━━━━━━━━━━━━━━━━━━━━ 12s 21ms/step - accuracy: 0.7703 - loss: 0.5389 - val_accuracy: 0.8165 - val_loss: 0.4838
Epoch 22/50
583/583 ━━━━━━━━━━━━━━━━━━━━ 12s 21ms/step - accuracy: 0.7703 - loss: 0.5389 - val_accuracy: 0.8165 - val_loss: 0.4832
Epoch 23/50
583/583 ━━━━━━━━━━━━━━━━━━━━ 12s 21ms/step - accuracy: 0.7703 - loss: 0.5389 - val_accuracy: 0.8165 - val_loss: 0.4831
Epoch 24/50
583/583 ━━━━━━━━━━━━━━━━━━━━ 13s 21ms/step - accuracy: 0.7703 - loss: 0.5389 - val_accuracy: 0.8165 - val_loss: 0.4828
Epoch 25/50
583/583 ━━━━━━━━━━━━━━━━━━━━ 12s 21ms/step - accuracy: 0.7703 - loss: 0.5389 - val_accuracy: 0.8165 - val_loss: 0.4832
Epoch 26/50
583/583 ━━━━━━━━━━━━━━━━━━━━ 12s 21ms/step - accuracy: 0.7703 - loss: 0.5389 - val_accuracy: 0.8165 - val_loss: 0.4829
Epoch 27/50
583/583 ━━━━━━━━━━━━━━━━━━━━ 12s 21ms/step - accuracy: 0.7703 - loss: 0.5389 - val_accuracy: 0.8165 - val_loss: 0.4829
2025-10-31 07:50:42.677 | INFO     | src.ai_engine.ai_models:fit:685 - LSTM trained successfully.
2025-10-31 07:50:42.729 | INFO     | src.ai_engine.ai_models:fit:381 - Generating base model predictions for meta-model training...
2025-10-31 07:50:44.053 | INFO     | src.ai_engine.feature_engineering:create_sequences:261 - Creating sequences with length 50 from 20759 data points.
2025-10-31 07:50:44.314 | INFO     | src.ai_engine.feature_engineering:create_sequences:270 - Created 20709 sequences.
648/648 ━━━━━━━━━━━━━━━━━━━━ 7s 11ms/step
2025-10-31 07:50:54.174 | INFO     | src.ai_engine.ai_models:fit:396 - Training meta-model...
2025-10-31 07:50:54.188 | SUCCESS  | src.ai_engine.ai_models:fit:399 - Stacking Ensemble trained successfully.
2025-10-31 07:50:54.190 | SUCCESS  | __main__:main:167 - Final Ensemble model trained.
2025-10-31 07:50:54.190 | INFO     | __main__:main:171 - Saving models to 'models\GainX_600\15m'...
2025-10-31 07:50:54.310 | INFO     | src.ai_engine.ai_models:save:52 - Model RandomForest saved to models\GainX_600\15m\random_forest.pkl
2025-10-31 07:50:54.377 | INFO     | src.ai_engine.ai_models:save:52 - Model GradientBoosting saved to models\GainX_600\15m\gradient_boosting.pkl
2025-10-31 07:50:54.653 | INFO     | src.ai_engine.ai_models:save:731 - LSTM model saved to models\GainX_600\15m\lstm.keras, models\GainX_600\15m\lstm_scaler.pkl and marker file models\GainX_600\15m\lstm.pkl
2025-10-31 07:50:54.658 | INFO     | src.ai_engine.ai_models:save_all:463 - Meta-model saved to models\GainX_600\15m\meta_model.pkl
2025-10-31 07:50:54.660 | SUCCESS  | __main__:main:174 - --- Finished training for Symbol: GainX 600, Timeframe: 15m ---
2025-10-31 07:50:54.663 | INFO     | __main__:main:140 - --- Starting training for Symbol: GainX 600, Timeframe: 1d ---
2025-10-31 07:50:54.795 | SUCCESS  | __main__:main:148 - Loaded 302 records.
2025-10-31 07:50:54.796 | INFO     | __main__:prepare_training_data:32 - Preparing data for training with Meta-Labeling...
2025-10-31 07:50:54.893 | DEBUG    | src.ai_engine.technical_indicators:calculate_all:47 - Calculated 62 technical indicators
2025-10-31 07:50:54.948 | DEBUG    | src.ai_engine.feature_engineering:extract_features:66 - Extracted 116 features
2025-10-31 07:50:54.948 | INFO     | __main__:prepare_training_data:39 - Generating signals from primary model (SimplePatternModel)...
2025-10-31 07:50:54.952 | WARNING  | src.ai_engine.feature_engineering:prepare_for_model:230 - Se perdieron todos los datos al eliminar los NaN. Se conservarán los datos rellenados.
2025-10-31 07:50:55.103 | INFO     | src.ai_engine.ai_models:calculate_optimal_threshold:549 - Calculated optimal threshold: 0.0110 (volatility: 0.0035, avg_movement: 0.0158)
2025-10-31 07:50:55.103 | INFO     | src.ai_engine.ai_models:create_meta_labels:577 - Creating meta-labels for secondary model...
2025-10-31 07:50:55.142 | INFO     | src.ai_engine.ai_models:create_meta_labels:629 - Meta-Label distribution - Profitable: 79 (58.1%), Unprofitable: 57 (41.9%)
2025-10-31 07:50:55.147 | WARNING  | src.ai_engine.feature_engineering:prepare_for_model:230 - Se perdieron todos los datos al eliminar los NaN. Se conservarán los datos rellenados.
2025-10-31 07:50:55.149 | INFO     | __main__:prepare_training_data:75 - Data preparation complete. Shape of X: (203, 116), Shape of y: (203,)
2025-10-31 07:50:55.151 | INFO     | src.ai_engine.feature_engineering:create_sequences:261 - Creating sequences with length 50 from 203 data points.
2025-10-31 07:50:55.155 | INFO     | src.ai_engine.feature_engineering:create_sequences:270 - Created 153 sequences.
2025-10-31 07:50:55.189 | INFO     | __main__:main:164 - Initializing and training Ensemble model...
2025-10-31 07:50:55.189 | INFO     | src.ai_engine.ai_models:__init__:304 - Initialized Stacking Ensemble with Logistic Regression as meta-model.
2025-10-31 07:50:55.411 | INFO     | src.ai_engine.ai_models:fit:359 - Creating LSTM model...
2025-10-31 07:50:55.412 | INFO     | src.ai_engine.ai_models:fit:364 - Training base models...
2025-10-31 07:50:55.419 | INFO     | src.ai_engine.ai_models:fit:373 - Training random_forest...
2025-10-31 07:50:56.224 | INFO     | src.ai_engine.ai_models:fit:98 - RandomForest trained successfully on 203 samples with 2 classes
2025-10-31 07:50:56.225 | INFO     | src.ai_engine.ai_models:fit:373 - Training gradient_boosting...
2025-10-31 07:50:57.924 | INFO     | src.ai_engine.ai_models:fit:157 - GradientBoosting trained successfully on 203 samples with 2 classes
2025-10-31 07:50:57.924 | INFO     | src.ai_engine.ai_models:fit:373 - Training pattern_based...
2025-10-31 07:50:57.926 | INFO     | src.ai_engine.ai_models:fit:373 - Training lstm...
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\keras\src\layers\rnn\rnn.py:199: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(**kwargs)
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1108: RuntimeWarning: invalid value encountered in divide
  updated_mean = (last_sum + new_sum) / updated_sample_count
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1113: RuntimeWarning: invalid value encountered in divide
  T = new_sum / new_sample_count
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1133: RuntimeWarning: invalid value encountered in divide
  new_unnormalized_variance -= correction**2 / new_sample_count
Epoch 1/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 9s 333ms/step - accuracy: 0.5985 - loss: 0.6930 - val_accuracy: 1.0000 - val_loss: 0.6911
Epoch 2/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 81ms/step - accuracy: 0.5985 - loss: 0.6926 - val_accuracy: 1.0000 - val_loss: 0.6890
Epoch 3/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 39ms/step - accuracy: 0.5985 - loss: 0.6922 - val_accuracy: 1.0000 - val_loss: 0.6869
Epoch 4/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 38ms/step - accuracy: 0.5985 - loss: 0.6918 - val_accuracy: 1.0000 - val_loss: 0.6848
Epoch 5/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 48ms/step - accuracy: 0.5985 - loss: 0.6914 - val_accuracy: 1.0000 - val_loss: 0.6830
Epoch 6/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 57ms/step - accuracy: 0.5985 - loss: 0.6911 - val_accuracy: 1.0000 - val_loss: 0.6811
Epoch 7/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 67ms/step - accuracy: 0.5985 - loss: 0.6907 - val_accuracy: 1.0000 - val_loss: 0.6796
Epoch 8/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 37ms/step - accuracy: 0.5985 - loss: 0.6905 - val_accuracy: 1.0000 - val_loss: 0.6780
Epoch 9/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 34ms/step - accuracy: 0.5985 - loss: 0.6901 - val_accuracy: 1.0000 - val_loss: 0.6764
Epoch 10/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 40ms/step - accuracy: 0.5985 - loss: 0.6899 - val_accuracy: 1.0000 - val_loss: 0.6746
Epoch 11/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 35ms/step - accuracy: 0.5985 - loss: 0.6895 - val_accuracy: 1.0000 - val_loss: 0.6727
Epoch 12/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 35ms/step - accuracy: 0.5985 - loss: 0.6892 - val_accuracy: 1.0000 - val_loss: 0.6711
Epoch 13/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 35ms/step - accuracy: 0.5985 - loss: 0.6889 - val_accuracy: 1.0000 - val_loss: 0.6698
Epoch 14/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 35ms/step - accuracy: 0.5985 - loss: 0.6887 - val_accuracy: 1.0000 - val_loss: 0.6686
Epoch 15/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 35ms/step - accuracy: 0.5985 - loss: 0.6885 - val_accuracy: 1.0000 - val_loss: 0.6671
Epoch 16/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 35ms/step - accuracy: 0.5985 - loss: 0.6882 - val_accuracy: 1.0000 - val_loss: 0.6657
Epoch 17/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 36ms/step - accuracy: 0.5985 - loss: 0.6879 - val_accuracy: 1.0000 - val_loss: 0.6643
Epoch 18/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 38ms/step - accuracy: 0.5985 - loss: 0.6877 - val_accuracy: 1.0000 - val_loss: 0.6625
Epoch 19/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 35ms/step - accuracy: 0.5985 - loss: 0.6874 - val_accuracy: 1.0000 - val_loss: 0.6608
Epoch 20/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 35ms/step - accuracy: 0.5985 - loss: 0.6871 - val_accuracy: 1.0000 - val_loss: 0.6593
Epoch 21/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 35ms/step - accuracy: 0.5985 - loss: 0.6869 - val_accuracy: 1.0000 - val_loss: 0.6579
Epoch 22/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 35ms/step - accuracy: 0.5985 - loss: 0.6866 - val_accuracy: 1.0000 - val_loss: 0.6565
Epoch 23/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 35ms/step - accuracy: 0.5985 - loss: 0.6864 - val_accuracy: 1.0000 - val_loss: 0.6551
Epoch 24/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 35ms/step - accuracy: 0.5985 - loss: 0.6862 - val_accuracy: 1.0000 - val_loss: 0.6540
Epoch 25/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 35ms/step - accuracy: 0.5985 - loss: 0.6860 - val_accuracy: 1.0000 - val_loss: 0.6526
Epoch 26/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 35ms/step - accuracy: 0.5985 - loss: 0.6858 - val_accuracy: 1.0000 - val_loss: 0.6513
Epoch 27/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 35ms/step - accuracy: 0.5985 - loss: 0.6856 - val_accuracy: 1.0000 - val_loss: 0.6500
Epoch 28/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 39ms/step - accuracy: 0.5985 - loss: 0.6854 - val_accuracy: 1.0000 - val_loss: 0.6486
Epoch 29/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 37ms/step - accuracy: 0.5985 - loss: 0.6852 - val_accuracy: 1.0000 - val_loss: 0.6472
Epoch 30/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 35ms/step - accuracy: 0.5985 - loss: 0.6849 - val_accuracy: 1.0000 - val_loss: 0.6459
Epoch 31/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 49ms/step - accuracy: 0.5985 - loss: 0.6847 - val_accuracy: 1.0000 - val_loss: 0.6446
Epoch 32/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 35ms/step - accuracy: 0.5985 - loss: 0.6846 - val_accuracy: 1.0000 - val_loss: 0.6435
Epoch 33/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 35ms/step - accuracy: 0.5985 - loss: 0.6844 - val_accuracy: 1.0000 - val_loss: 0.6428
Epoch 34/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 34ms/step - accuracy: 0.5985 - loss: 0.6842 - val_accuracy: 1.0000 - val_loss: 0.6415
Epoch 35/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 35ms/step - accuracy: 0.5985 - loss: 0.6840 - val_accuracy: 1.0000 - val_loss: 0.6404
Epoch 36/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 39ms/step - accuracy: 0.5985 - loss: 0.6839 - val_accuracy: 1.0000 - val_loss: 0.6390
Epoch 37/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 35ms/step - accuracy: 0.5985 - loss: 0.6837 - val_accuracy: 1.0000 - val_loss: 0.6378
Epoch 38/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 35ms/step - accuracy: 0.5985 - loss: 0.6835 - val_accuracy: 1.0000 - val_loss: 0.6367
Epoch 39/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 35ms/step - accuracy: 0.5985 - loss: 0.6833 - val_accuracy: 1.0000 - val_loss: 0.6357
Epoch 40/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 35ms/step - accuracy: 0.5985 - loss: 0.6832 - val_accuracy: 1.0000 - val_loss: 0.6347
Epoch 41/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 35ms/step - accuracy: 0.5985 - loss: 0.6830 - val_accuracy: 1.0000 - val_loss: 0.6337
Epoch 42/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 35ms/step - accuracy: 0.5985 - loss: 0.6829 - val_accuracy: 1.0000 - val_loss: 0.6325
Epoch 43/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 35ms/step - accuracy: 0.5985 - loss: 0.6827 - val_accuracy: 1.0000 - val_loss: 0.6315
Epoch 44/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 35ms/step - accuracy: 0.5985 - loss: 0.6826 - val_accuracy: 1.0000 - val_loss: 0.6305
Epoch 45/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 35ms/step - accuracy: 0.5985 - loss: 0.6824 - val_accuracy: 1.0000 - val_loss: 0.6292
Epoch 46/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 41ms/step - accuracy: 0.5985 - loss: 0.6822 - val_accuracy: 1.0000 - val_loss: 0.6280
Epoch 47/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 35ms/step - accuracy: 0.5985 - loss: 0.6821 - val_accuracy: 1.0000 - val_loss: 0.6268
Epoch 48/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 35ms/step - accuracy: 0.5985 - loss: 0.6819 - val_accuracy: 1.0000 - val_loss: 0.6255
Epoch 49/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 34ms/step - accuracy: 0.5985 - loss: 0.6817 - val_accuracy: 1.0000 - val_loss: 0.6242
Epoch 50/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 35ms/step - accuracy: 0.5985 - loss: 0.6816 - val_accuracy: 1.0000 - val_loss: 0.6228
2025-10-31 07:51:16.773 | INFO     | src.ai_engine.ai_models:fit:685 - LSTM trained successfully.
2025-10-31 07:51:16.774 | INFO     | src.ai_engine.ai_models:fit:381 - Generating base model predictions for meta-model training...
2025-10-31 07:51:16.790 | INFO     | src.ai_engine.feature_engineering:create_sequences:261 - Creating sequences with length 50 from 203 data points.
2025-10-31 07:51:16.793 | INFO     | src.ai_engine.feature_engineering:create_sequences:270 - Created 153 sequences.
5/5 ━━━━━━━━━━━━━━━━━━━━ 1s 125ms/step
2025-10-31 07:51:17.779 | INFO     | src.ai_engine.ai_models:fit:396 - Training meta-model...
2025-10-31 07:51:17.812 | SUCCESS  | src.ai_engine.ai_models:fit:399 - Stacking Ensemble trained successfully.
2025-10-31 07:51:17.813 | SUCCESS  | __main__:main:167 - Final Ensemble model trained.
2025-10-31 07:51:17.815 | INFO     | __main__:main:171 - Saving models to 'models\GainX_600\1d'...
2025-10-31 07:51:17.921 | INFO     | src.ai_engine.ai_models:save:52 - Model RandomForest saved to models\GainX_600\1d\random_forest.pkl
2025-10-31 07:51:17.959 | INFO     | src.ai_engine.ai_models:save:52 - Model GradientBoosting saved to models\GainX_600\1d\gradient_boosting.pkl
2025-10-31 07:51:18.069 | INFO     | src.ai_engine.ai_models:save:731 - LSTM model saved to models\GainX_600\1d\lstm.keras, models\GainX_600\1d\lstm_scaler.pkl and marker file models\GainX_600\1d\lstm.pkl
2025-10-31 07:51:18.086 | INFO     | src.ai_engine.ai_models:save_all:463 - Meta-model saved to models\GainX_600\1d\meta_model.pkl
2025-10-31 07:51:18.087 | SUCCESS  | __main__:main:174 - --- Finished training for Symbol: GainX 600, Timeframe: 1d ---
2025-10-31 07:51:18.089 | INFO     | __main__:main:140 - --- Starting training for Symbol: GainX 600, Timeframe: 1h ---
2025-10-31 07:51:18.180 | SUCCESS  | __main__:main:148 - Loaded 7227 records.
2025-10-31 07:51:18.180 | INFO     | __main__:prepare_training_data:32 - Preparing data for training with Meta-Labeling...
2025-10-31 07:51:18.616 | DEBUG    | src.ai_engine.technical_indicators:calculate_all:47 - Calculated 63 technical indicators
2025-10-31 07:51:19.857 | DEBUG    | src.ai_engine.feature_engineering:extract_features:66 - Extracted 116 features
2025-10-31 07:51:19.857 | INFO     | __main__:prepare_training_data:39 - Generating signals from primary model (SimplePatternModel)...
2025-10-31 07:51:19.877 | WARNING  | src.ai_engine.feature_engineering:prepare_for_model:230 - Se perdieron todos los datos al eliminar los NaN. Se conservarán los datos rellenados.
2025-10-31 07:51:21.027 | INFO     | src.ai_engine.ai_models:calculate_optimal_threshold:549 - Calculated optimal threshold: 0.0022 (volatility: 0.0007, avg_movement: 0.0032)
2025-10-31 07:51:21.028 | INFO     | src.ai_engine.ai_models:create_meta_labels:577 - Creating meta-labels for secondary model...
2025-10-31 07:51:21.874 | INFO     | src.ai_engine.ai_models:create_meta_labels:629 - Meta-Label distribution - Profitable: 1216 (36.0%), Unprofitable: 2163 (64.0%)
2025-10-31 07:51:21.897 | WARNING  | src.ai_engine.feature_engineering:prepare_for_model:230 - Se perdieron todos los datos al eliminar los NaN. Se conservarán los datos rellenados.
2025-10-31 07:51:21.907 | INFO     | __main__:prepare_training_data:75 - Data preparation complete. Shape of X: (5024, 116), Shape of y: (5024,)
2025-10-31 07:51:21.911 | INFO     | src.ai_engine.feature_engineering:create_sequences:261 - Creating sequences with length 50 from 5024 data points.
2025-10-31 07:51:21.971 | INFO     | src.ai_engine.feature_engineering:create_sequences:270 - Created 4974 sequences.
2025-10-31 07:51:21.973 | INFO     | __main__:main:164 - Initializing and training Ensemble model...
2025-10-31 07:51:21.974 | INFO     | src.ai_engine.ai_models:__init__:304 - Initialized Stacking Ensemble with Logistic Regression as meta-model.
2025-10-31 07:51:21.998 | INFO     | src.ai_engine.ai_models:fit:359 - Creating LSTM model...
2025-10-31 07:51:21.999 | INFO     | src.ai_engine.ai_models:fit:364 - Training base models...
2025-10-31 07:51:22.008 | INFO     | src.ai_engine.ai_models:fit:373 - Training random_forest...
2025-10-31 07:51:23.835 | INFO     | src.ai_engine.ai_models:fit:98 - RandomForest trained successfully on 5024 samples with 2 classes
2025-10-31 07:51:23.836 | INFO     | src.ai_engine.ai_models:fit:373 - Training gradient_boosting...
2025-10-31 07:52:13.595 | INFO     | src.ai_engine.ai_models:fit:157 - GradientBoosting trained successfully on 5024 samples with 2 classes
2025-10-31 07:52:13.596 | INFO     | src.ai_engine.ai_models:fit:373 - Training pattern_based...
2025-10-31 07:52:13.597 | INFO     | src.ai_engine.ai_models:fit:373 - Training lstm...
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\keras\src\layers\rnn\rnn.py:199: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(**kwargs)
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1108: RuntimeWarning: invalid value encountered in divide
  updated_mean = (last_sum + new_sum) / updated_sample_count
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1113: RuntimeWarning: invalid value encountered in divide
  T = new_sum / new_sample_count
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1133: RuntimeWarning: invalid value encountered in divide
  new_unnormalized_variance -= correction**2 / new_sample_count
Epoch 1/50
140/140 ━━━━━━━━━━━━━━━━━━━━ 7s 30ms/step - accuracy: 0.7574 - loss: 0.6764 - val_accuracy: 0.7550 - val_loss: 0.6615
Epoch 2/50
140/140 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7574 - loss: 0.6479 - val_accuracy: 0.7550 - val_loss: 0.6361
Epoch 3/50
140/140 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7574 - loss: 0.6253 - val_accuracy: 0.7550 - val_loss: 0.6164
Epoch 4/50
140/140 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7574 - loss: 0.6075 - val_accuracy: 0.7550 - val_loss: 0.6009
Epoch 5/50
140/140 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7574 - loss: 0.5936 - val_accuracy: 0.7550 - val_loss: 0.5889
Epoch 6/50
140/140 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7574 - loss: 0.5829 - val_accuracy: 0.7550 - val_loss: 0.5799
Epoch 7/50
140/140 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7574 - loss: 0.5748 - val_accuracy: 0.7550 - val_loss: 0.5732
Epoch 8/50
140/140 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7574 - loss: 0.5688 - val_accuracy: 0.7550 - val_loss: 0.5682
Epoch 9/50
140/140 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7574 - loss: 0.5644 - val_accuracy: 0.7550 - val_loss: 0.5645
Epoch 10/50
140/140 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7574 - loss: 0.5612 - val_accuracy: 0.7550 - val_loss: 0.5620
Epoch 11/50
140/140 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7574 - loss: 0.5589 - val_accuracy: 0.7550 - val_loss: 0.5602
Epoch 12/50
140/140 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7574 - loss: 0.5573 - val_accuracy: 0.7550 - val_loss: 0.5589
Epoch 13/50
140/140 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7574 - loss: 0.5562 - val_accuracy: 0.7550 - val_loss: 0.5581
Epoch 14/50
140/140 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7574 - loss: 0.5554 - val_accuracy: 0.7550 - val_loss: 0.5576
Epoch 15/50
140/140 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7574 - loss: 0.5550 - val_accuracy: 0.7550 - val_loss: 0.5572
Epoch 16/50
140/140 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7574 - loss: 0.5546 - val_accuracy: 0.7550 - val_loss: 0.5570
Epoch 17/50
140/140 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7574 - loss: 0.5544 - val_accuracy: 0.7550 - val_loss: 0.5569
Epoch 18/50
140/140 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7574 - loss: 0.5543 - val_accuracy: 0.7550 - val_loss: 0.5568
Epoch 19/50
140/140 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7574 - loss: 0.5542 - val_accuracy: 0.7550 - val_loss: 0.5568
Epoch 20/50
140/140 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7574 - loss: 0.5542 - val_accuracy: 0.7550 - val_loss: 0.5568
Epoch 21/50
140/140 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7574 - loss: 0.5542 - val_accuracy: 0.7550 - val_loss: 0.5568
Epoch 22/50
140/140 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7574 - loss: 0.5541 - val_accuracy: 0.7550 - val_loss: 0.5568
Epoch 23/50
140/140 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7574 - loss: 0.5541 - val_accuracy: 0.7550 - val_loss: 0.5568
Epoch 24/50
140/140 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7574 - loss: 0.5541 - val_accuracy: 0.7550 - val_loss: 0.5568
Epoch 25/50
140/140 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7574 - loss: 0.5541 - val_accuracy: 0.7550 - val_loss: 0.5568
Epoch 26/50
140/140 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7574 - loss: 0.5541 - val_accuracy: 0.7550 - val_loss: 0.5568
Epoch 27/50
140/140 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7574 - loss: 0.5541 - val_accuracy: 0.7550 - val_loss: 0.5568
Epoch 28/50
140/140 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7574 - loss: 0.5541 - val_accuracy: 0.7550 - val_loss: 0.5568
Epoch 29/50
140/140 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7574 - loss: 0.5541 - val_accuracy: 0.7550 - val_loss: 0.5568
Epoch 30/50
140/140 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7574 - loss: 0.5541 - val_accuracy: 0.7550 - val_loss: 0.5568
Epoch 31/50
140/140 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7574 - loss: 0.5541 - val_accuracy: 0.7550 - val_loss: 0.5568
Epoch 32/50
140/140 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7574 - loss: 0.5541 - val_accuracy: 0.7550 - val_loss: 0.5568
Epoch 33/50
140/140 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7574 - loss: 0.5541 - val_accuracy: 0.7550 - val_loss: 0.5568
2025-10-31 07:53:57.034 | INFO     | src.ai_engine.ai_models:fit:685 - LSTM trained successfully.
2025-10-31 07:53:57.042 | INFO     | src.ai_engine.ai_models:fit:381 - Generating base model predictions for meta-model training...
2025-10-31 07:53:57.369 | INFO     | src.ai_engine.feature_engineering:create_sequences:261 - Creating sequences with length 50 from 5024 data points.
2025-10-31 07:53:57.428 | INFO     | src.ai_engine.feature_engineering:create_sequences:270 - Created 4974 sequences.
156/156 ━━━━━━━━━━━━━━━━━━━━ 2s 10ms/step
2025-10-31 07:54:00.407 | INFO     | src.ai_engine.ai_models:fit:396 - Training meta-model...
2025-10-31 07:54:00.415 | SUCCESS  | src.ai_engine.ai_models:fit:399 - Stacking Ensemble trained successfully.
2025-10-31 07:54:00.417 | SUCCESS  | __main__:main:167 - Final Ensemble model trained.
2025-10-31 07:54:00.417 | INFO     | __main__:main:171 - Saving models to 'models\GainX_600\1h'...
2025-10-31 07:54:00.585 | INFO     | src.ai_engine.ai_models:save:52 - Model RandomForest saved to models\GainX_600\1h\random_forest.pkl
2025-10-31 07:54:00.793 | INFO     | src.ai_engine.ai_models:save:52 - Model GradientBoosting saved to models\GainX_600\1h\gradient_boosting.pkl
2025-10-31 07:54:01.198 | INFO     | src.ai_engine.ai_models:save:731 - LSTM model saved to models\GainX_600\1h\lstm.keras, models\GainX_600\1h\lstm_scaler.pkl and marker file models\GainX_600\1h\lstm.pkl
2025-10-31 07:54:01.202 | INFO     | src.ai_engine.ai_models:save_all:463 - Meta-model saved to models\GainX_600\1h\meta_model.pkl
2025-10-31 07:54:01.205 | SUCCESS  | __main__:main:174 - --- Finished training for Symbol: GainX 600, Timeframe: 1h ---
2025-10-31 07:54:01.267 | INFO     | __main__:main:140 - --- Starting training for Symbol: GainX 600, Timeframe: 1m ---
2025-10-31 07:54:01.647 | SUCCESS  | __main__:main:148 - Loaded 100001 records.
2025-10-31 07:54:01.647 | INFO     | __main__:prepare_training_data:32 - Preparing data for training with Meta-Labeling...
2025-10-31 07:54:07.119 | DEBUG    | src.ai_engine.technical_indicators:calculate_all:47 - Calculated 63 technical indicators
2025-10-31 07:54:24.124 | DEBUG    | src.ai_engine.feature_engineering:extract_features:66 - Extracted 116 features
2025-10-31 07:54:24.132 | INFO     | __main__:prepare_training_data:39 - Generating signals from primary model (SimplePatternModel)...
2025-10-31 07:54:24.352 | WARNING  | src.ai_engine.feature_engineering:prepare_for_model:230 - Se perdieron todos los datos al eliminar los NaN. Se conservarán los datos rellenados.
2025-10-31 07:55:28.756 | INFO     | src.ai_engine.ai_models:calculate_optimal_threshold:549 - Calculated optimal threshold: 0.0010 (volatility: 0.0001, avg_movement: 0.0004)
2025-10-31 07:55:28.758 | INFO     | src.ai_engine.ai_models:create_meta_labels:577 - Creating meta-labels for secondary model...
2025-10-31 07:55:42.369 | INFO     | src.ai_engine.ai_models:create_meta_labels:629 - Meta-Label distribution - Profitable: 62 (9.7%), Unprofitable: 577 (90.3%)
2025-10-31 07:55:42.619 | WARNING  | src.ai_engine.feature_engineering:prepare_for_model:230 - Se perdieron todos los datos al eliminar los NaN. Se conservarán los datos rellenados.
2025-10-31 07:55:42.722 | INFO     | __main__:prepare_training_data:75 - Data preparation complete. Shape of X: (61090, 116), Shape of y: (61090,)
2025-10-31 07:55:42.763 | INFO     | src.ai_engine.feature_engineering:create_sequences:261 - Creating sequences with length 50 from 61090 data points.
2025-10-31 07:55:43.495 | INFO     | src.ai_engine.feature_engineering:create_sequences:270 - Created 61040 sequences.
2025-10-31 07:55:43.510 | INFO     | __main__:main:164 - Initializing and training Ensemble model...
2025-10-31 07:55:43.511 | INFO     | src.ai_engine.ai_models:__init__:304 - Initialized Stacking Ensemble with Logistic Regression as meta-model.
2025-10-31 07:55:43.513 | INFO     | src.ai_engine.ai_models:fit:359 - Creating LSTM model...
2025-10-31 07:55:43.513 | INFO     | src.ai_engine.ai_models:fit:364 - Training base models...
2025-10-31 07:55:43.641 | INFO     | src.ai_engine.ai_models:fit:373 - Training random_forest...
2025-10-31 07:55:56.558 | INFO     | src.ai_engine.ai_models:fit:98 - RandomForest trained successfully on 61090 samples with 2 classes
2025-10-31 07:55:56.562 | INFO     | src.ai_engine.ai_models:fit:373 - Training gradient_boosting...
2025-10-31 08:06:46.949 | INFO     | src.ai_engine.ai_models:fit:157 - GradientBoosting trained successfully on 61090 samples with 2 classes
2025-10-31 08:06:46.953 | INFO     | src.ai_engine.ai_models:fit:373 - Training pattern_based...
2025-10-31 08:06:46.955 | INFO     | src.ai_engine.ai_models:fit:373 - Training lstm...
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\keras\src\layers\rnn\rnn.py:199: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(**kwargs)
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1108: RuntimeWarning: invalid value encountered in divide
  updated_mean = (last_sum + new_sum) / updated_sample_count
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1113: RuntimeWarning: invalid value encountered in divide
  T = new_sum / new_sample_count
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1133: RuntimeWarning: invalid value encountered in divide
  new_unnormalized_variance -= correction**2 / new_sample_count
Epoch 1/50
1717/1717 ━━━━━━━━━━━━━━━━━━━━ 191s 25ms/step - accuracy: 0.9990 - loss: 0.4057 - val_accuracy: 0.9989 - val_loss: 0.2216
Epoch 2/50
1717/1717 ━━━━━━━━━━━━━━━━━━━━ 37s 21ms/step - accuracy: 0.9990 - loss: 0.1431 - val_accuracy: 0.9989 - val_loss: 0.0895
Epoch 3/50
1717/1717 ━━━━━━━━━━━━━━━━━━━━ 37s 22ms/step - accuracy: 0.9990 - loss: 0.0620 - val_accuracy: 0.9989 - val_loss: 0.0425
Epoch 4/50
1717/1717 ━━━━━━━━━━━━━━━━━━━━ 42s 24ms/step - accuracy: 0.9990 - loss: 0.0309 - val_accuracy: 0.9989 - val_loss: 0.0230
Epoch 5/50
1717/1717 ━━━━━━━━━━━━━━━━━━━━ 37s 21ms/step - accuracy: 0.9990 - loss: 0.0176 - val_accuracy: 0.9989 - val_loss: 0.0146
Epoch 6/50
1717/1717 ━━━━━━━━━━━━━━━━━━━━ 36s 21ms/step - accuracy: 0.9990 - loss: 0.0118 - val_accuracy: 0.9989 - val_loss: 0.0110
Epoch 7/50
1717/1717 ━━━━━━━━━━━━━━━━━━━━ 37s 21ms/step - accuracy: 0.9990 - loss: 0.0093 - val_accuracy: 0.9989 - val_loss: 0.0096
Epoch 8/50
1717/1717 ━━━━━━━━━━━━━━━━━━━━ 36s 21ms/step - accuracy: 0.9990 - loss: 0.0084 - val_accuracy: 0.9989 - val_loss: 0.0091
Epoch 9/50
1717/1717 ━━━━━━━━━━━━━━━━━━━━ 36s 21ms/step - accuracy: 0.9990 - loss: 0.0081 - val_accuracy: 0.9989 - val_loss: 0.0090
Epoch 10/50
1717/1717 ━━━━━━━━━━━━━━━━━━━━ 36s 21ms/step - accuracy: 0.9990 - loss: 0.0080 - val_accuracy: 0.9989 - val_loss: 0.0089
Epoch 11/50
1717/1717 ━━━━━━━━━━━━━━━━━━━━ 36s 21ms/step - accuracy: 0.9990 - loss: 0.0080 - val_accuracy: 0.9989 - val_loss: 0.0089
Epoch 12/50
1717/1717 ━━━━━━━━━━━━━━━━━━━━ 36s 21ms/step - accuracy: 0.9990 - loss: 0.0079 - val_accuracy: 0.9989 - val_loss: 0.0089
Epoch 13/50
1717/1717 ━━━━━━━━━━━━━━━━━━━━ 36s 21ms/step - accuracy: 0.9990 - loss: 0.0079 - val_accuracy: 0.9989 - val_loss: 0.0089
Epoch 14/50
1717/1717 ━━━━━━━━━━━━━━━━━━━━ 36s 21ms/step - accuracy: 0.9990 - loss: 0.0079 - val_accuracy: 0.9989 - val_loss: 0.0089
Epoch 15/50
1717/1717 ━━━━━━━━━━━━━━━━━━━━ 36s 21ms/step - accuracy: 0.9990 - loss: 0.0079 - val_accuracy: 0.9989 - val_loss: 0.0089
Epoch 16/50
1717/1717 ━━━━━━━━━━━━━━━━━━━━ 36s 21ms/step - accuracy: 0.9990 - loss: 0.0079 - val_accuracy: 0.9989 - val_loss: 0.0089
Epoch 17/50
1717/1717 ━━━━━━━━━━━━━━━━━━━━ 36s 21ms/step - accuracy: 0.9990 - loss: 0.0079 - val_accuracy: 0.9989 - val_loss: 0.0089
Epoch 18/50
1717/1717 ━━━━━━━━━━━━━━━━━━━━ 36s 21ms/step - accuracy: 0.9990 - loss: 0.0079 - val_accuracy: 0.9989 - val_loss: 0.0089
Epoch 19/50
1717/1717 ━━━━━━━━━━━━━━━━━━━━ 36s 21ms/step - accuracy: 0.9990 - loss: 0.0079 - val_accuracy: 0.9989 - val_loss: 0.0089
Epoch 20/50
1717/1717 ━━━━━━━━━━━━━━━━━━━━ 36s 21ms/step - accuracy: 0.9990 - loss: 0.0079 - val_accuracy: 0.9989 - val_loss: 0.0089
Epoch 21/50
1717/1717 ━━━━━━━━━━━━━━━━━━━━ 36s 21ms/step - accuracy: 0.9990 - loss: 0.0079 - val_accuracy: 0.9989 - val_loss: 0.0089
Epoch 22/50
1717/1717 ━━━━━━━━━━━━━━━━━━━━ 36s 21ms/step - accuracy: 0.9990 - loss: 0.0079 - val_accuracy: 0.9989 - val_loss: 0.0089
2025-10-31 08:49:52.808 | INFO     | src.ai_engine.ai_models:fit:685 - LSTM trained successfully.
2025-10-31 08:49:53.629 | INFO     | src.ai_engine.ai_models:fit:381 - Generating base model predictions for meta-model training...
2025-10-31 08:50:17.743 | INFO     | src.ai_engine.feature_engineering:create_sequences:261 - Creating sequences with length 50 from 61090 data points.
2025-10-31 08:50:18.497 | INFO     | src.ai_engine.feature_engineering:create_sequences:270 - Created 61040 sequences.
1908/1908 ━━━━━━━━━━━━━━━━━━━━ 147s 21ms/step
2025-10-31 09:12:13.458 | INFO     | src.ai_engine.ai_models:fit:396 - Training meta-model...
2025-10-31 09:12:18.820 | SUCCESS  | src.ai_engine.ai_models:fit:399 - Stacking Ensemble trained successfully.
2025-10-31 09:12:19.132 | SUCCESS  | __main__:main:167 - Final Ensemble model trained.
2025-10-31 09:12:19.149 | INFO     | __main__:main:171 - Saving models to 'models\GainX_600\1m'...
2025-10-31 09:12:23.694 | INFO     | src.ai_engine.ai_models:save:52 - Model RandomForest saved to models\GainX_600\1m\random_forest.pkl
2025-10-31 09:12:25.058 | INFO     | src.ai_engine.ai_models:save:52 - Model GradientBoosting saved to models\GainX_600\1m\gradient_boosting.pkl
2025-10-31 09:12:32.014 | INFO     | src.ai_engine.ai_models:save:731 - LSTM model saved to models\GainX_600\1m\lstm.keras, models\GainX_600\1m\lstm_scaler.pkl and marker file models\GainX_600\1m\lstm.pkl
2025-10-31 09:12:32.087 | INFO     | src.ai_engine.ai_models:save_all:463 - Meta-model saved to models\GainX_600\1m\meta_model.pkl
2025-10-31 09:12:32.089 | SUCCESS  | __main__:main:174 - --- Finished training for Symbol: GainX 600, Timeframe: 1m ---
2025-10-31 09:12:32.112 | INFO     | __main__:main:140 - --- Starting training for Symbol: GainX 600, Timeframe: 4h ---
2025-10-31 09:12:35.005 | SUCCESS  | __main__:main:148 - Loaded 1809 records.
2025-10-31 09:12:35.007 | INFO     | __main__:prepare_training_data:32 - Preparing data for training with Meta-Labeling...
2025-10-31 09:12:36.592 | DEBUG    | src.ai_engine.technical_indicators:calculate_all:47 - Calculated 63 technical indicators
2025-10-31 09:12:38.087 | DEBUG    | src.ai_engine.feature_engineering:extract_features:66 - Extracted 116 features
2025-10-31 09:12:38.089 | INFO     | __main__:prepare_training_data:39 - Generating signals from primary model (SimplePatternModel)...
2025-10-31 09:12:38.182 | WARNING  | src.ai_engine.feature_engineering:prepare_for_model:230 - Se perdieron todos los datos al eliminar los NaN. Se conservarán los datos rellenados.
2025-10-31 09:12:39.423 | INFO     | src.ai_engine.ai_models:calculate_optimal_threshold:549 - Calculated optimal threshold: 0.0045 (volatility: 0.0015, avg_movement: 0.0063)
2025-10-31 09:12:39.425 | INFO     | src.ai_engine.ai_models:create_meta_labels:577 - Creating meta-labels for secondary model...
2025-10-31 09:12:39.739 | INFO     | src.ai_engine.ai_models:create_meta_labels:629 - Meta-Label distribution - Profitable: 269 (31.3%), Unprofitable: 591 (68.7%)
2025-10-31 09:12:39.921 | WARNING  | src.ai_engine.feature_engineering:prepare_for_model:230 - Se perdieron todos los datos al eliminar los NaN. Se conservarán los datos rellenados.
2025-10-31 09:12:39.932 | INFO     | __main__:prepare_training_data:75 - Data preparation complete. Shape of X: (1282, 116), Shape of y: (1282,)
2025-10-31 09:12:40.181 | INFO     | src.ai_engine.feature_engineering:create_sequences:261 - Creating sequences with length 50 from 1282 data points.
2025-10-31 09:12:40.233 | INFO     | src.ai_engine.feature_engineering:create_sequences:270 - Created 1232 sequences.
2025-10-31 09:12:40.672 | INFO     | __main__:main:164 - Initializing and training Ensemble model...
2025-10-31 09:12:40.673 | INFO     | src.ai_engine.ai_models:__init__:304 - Initialized Stacking Ensemble with Logistic Regression as meta-model.
2025-10-31 09:12:41.256 | INFO     | src.ai_engine.ai_models:fit:359 - Creating LSTM model...
2025-10-31 09:12:41.258 | INFO     | src.ai_engine.ai_models:fit:364 - Training base models...
2025-10-31 09:12:41.274 | INFO     | src.ai_engine.ai_models:fit:373 - Training random_forest...
2025-10-31 09:12:44.312 | INFO     | src.ai_engine.ai_models:fit:98 - RandomForest trained successfully on 1282 samples with 2 classes
2025-10-31 09:12:44.313 | INFO     | src.ai_engine.ai_models:fit:373 - Training gradient_boosting...
2025-10-31 09:12:57.631 | INFO     | src.ai_engine.ai_models:fit:157 - GradientBoosting trained successfully on 1282 samples with 2 classes
2025-10-31 09:12:57.632 | INFO     | src.ai_engine.ai_models:fit:373 - Training pattern_based...
2025-10-31 09:12:57.633 | INFO     | src.ai_engine.ai_models:fit:373 - Training lstm...
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\keras\src\layers\rnn\rnn.py:199: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(**kwargs)
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1108: RuntimeWarning: invalid value encountered in divide
  updated_mean = (last_sum + new_sum) / updated_sample_count
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1113: RuntimeWarning: invalid value encountered in divide
  T = new_sum / new_sample_count
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1133: RuntimeWarning: invalid value encountered in divide
  new_unnormalized_variance -= correction**2 / new_sample_count
Epoch 1/50
35/35 ━━━━━━━━━━━━━━━━━━━━ 29s 100ms/step - accuracy: 0.7942 - loss: 0.6882 - val_accuracy: 0.7581 - val_loss: 0.6843
Epoch 2/50
35/35 ━━━━━━━━━━━━━━━━━━━━ 1s 28ms/step - accuracy: 0.7942 - loss: 0.6785 - val_accuracy: 0.7581 - val_loss: 0.6760
Epoch 3/50
35/35 ━━━━━━━━━━━━━━━━━━━━ 1s 25ms/step - accuracy: 0.7942 - loss: 0.6692 - val_accuracy: 0.7581 - val_loss: 0.6684
Epoch 4/50
35/35 ━━━━━━━━━━━━━━━━━━━━ 1s 24ms/step - accuracy: 0.7942 - loss: 0.6605 - val_accuracy: 0.7581 - val_loss: 0.6610
Epoch 5/50
35/35 ━━━━━━━━━━━━━━━━━━━━ 1s 23ms/step - accuracy: 0.7942 - loss: 0.6522 - val_accuracy: 0.7581 - val_loss: 0.6538
Epoch 6/50
35/35 ━━━━━━━━━━━━━━━━━━━━ 1s 22ms/step - accuracy: 0.7942 - loss: 0.6441 - val_accuracy: 0.7581 - val_loss: 0.6473
Epoch 7/50
35/35 ━━━━━━━━━━━━━━━━━━━━ 1s 22ms/step - accuracy: 0.7942 - loss: 0.6365 - val_accuracy: 0.7581 - val_loss: 0.6410
Epoch 8/50
35/35 ━━━━━━━━━━━━━━━━━━━━ 1s 22ms/step - accuracy: 0.7942 - loss: 0.6293 - val_accuracy: 0.7581 - val_loss: 0.6350
Epoch 9/50
35/35 ━━━━━━━━━━━━━━━━━━━━ 1s 23ms/step - accuracy: 0.7942 - loss: 0.6223 - val_accuracy: 0.7581 - val_loss: 0.6293
Epoch 10/50
35/35 ━━━━━━━━━━━━━━━━━━━━ 1s 22ms/step - accuracy: 0.7942 - loss: 0.6157 - val_accuracy: 0.7581 - val_loss: 0.6239
Epoch 11/50
35/35 ━━━━━━━━━━━━━━━━━━━━ 1s 22ms/step - accuracy: 0.7942 - loss: 0.6094 - val_accuracy: 0.7581 - val_loss: 0.6189
Epoch 12/50
35/35 ━━━━━━━━━━━━━━━━━━━━ 1s 23ms/step - accuracy: 0.7942 - loss: 0.6035 - val_accuracy: 0.7581 - val_loss: 0.6140
Epoch 13/50
35/35 ━━━━━━━━━━━━━━━━━━━━ 1s 25ms/step - accuracy: 0.7942 - loss: 0.5977 - val_accuracy: 0.7581 - val_loss: 0.6095
Epoch 14/50
35/35 ━━━━━━━━━━━━━━━━━━━━ 1s 22ms/step - accuracy: 0.7942 - loss: 0.5923 - val_accuracy: 0.7581 - val_loss: 0.6053
Epoch 15/50
35/35 ━━━━━━━━━━━━━━━━━━━━ 1s 22ms/step - accuracy: 0.7942 - loss: 0.5873 - val_accuracy: 0.7581 - val_loss: 0.6012
Epoch 16/50
35/35 ━━━━━━━━━━━━━━━━━━━━ 1s 22ms/step - accuracy: 0.7942 - loss: 0.5825 - val_accuracy: 0.7581 - val_loss: 0.5975
Epoch 17/50
35/35 ━━━━━━━━━━━━━━━━━━━━ 1s 23ms/step - accuracy: 0.7942 - loss: 0.5779 - val_accuracy: 0.7581 - val_loss: 0.5939
Epoch 18/50
35/35 ━━━━━━━━━━━━━━━━━━━━ 1s 26ms/step - accuracy: 0.7942 - loss: 0.5735 - val_accuracy: 0.7581 - val_loss: 0.5907
Epoch 19/50
35/35 ━━━━━━━━━━━━━━━━━━━━ 1s 22ms/step - accuracy: 0.7942 - loss: 0.5695 - val_accuracy: 0.7581 - val_loss: 0.5876
Epoch 20/50
35/35 ━━━━━━━━━━━━━━━━━━━━ 1s 22ms/step - accuracy: 0.7942 - loss: 0.5656 - val_accuracy: 0.7581 - val_loss: 0.5847
Epoch 21/50
35/35 ━━━━━━━━━━━━━━━━━━━━ 1s 24ms/step - accuracy: 0.7942 - loss: 0.5620 - val_accuracy: 0.7581 - val_loss: 0.5820
Epoch 22/50
35/35 ━━━━━━━━━━━━━━━━━━━━ 1s 22ms/step - accuracy: 0.7942 - loss: 0.5585 - val_accuracy: 0.7581 - val_loss: 0.5794
Epoch 23/50
35/35 ━━━━━━━━━━━━━━━━━━━━ 1s 22ms/step - accuracy: 0.7942 - loss: 0.5552 - val_accuracy: 0.7581 - val_loss: 0.5771
Epoch 24/50
35/35 ━━━━━━━━━━━━━━━━━━━━ 1s 22ms/step - accuracy: 0.7942 - loss: 0.5521 - val_accuracy: 0.7581 - val_loss: 0.5749
Epoch 25/50
35/35 ━━━━━━━━━━━━━━━━━━━━ 1s 25ms/step - accuracy: 0.7942 - loss: 0.5492 - val_accuracy: 0.7581 - val_loss: 0.5730
Epoch 26/50
35/35 ━━━━━━━━━━━━━━━━━━━━ 1s 23ms/step - accuracy: 0.7942 - loss: 0.5465 - val_accuracy: 0.7581 - val_loss: 0.5710
Epoch 27/50
35/35 ━━━━━━━━━━━━━━━━━━━━ 1s 22ms/step - accuracy: 0.7942 - loss: 0.5439 - val_accuracy: 0.7581 - val_loss: 0.5693
Epoch 28/50
35/35 ━━━━━━━━━━━━━━━━━━━━ 1s 22ms/step - accuracy: 0.7942 - loss: 0.5415 - val_accuracy: 0.7581 - val_loss: 0.5676
Epoch 29/50
35/35 ━━━━━━━━━━━━━━━━━━━━ 1s 22ms/step - accuracy: 0.7942 - loss: 0.5392 - val_accuracy: 0.7581 - val_loss: 0.5662
Epoch 30/50
35/35 ━━━━━━━━━━━━━━━━━━━━ 1s 22ms/step - accuracy: 0.7942 - loss: 0.5371 - val_accuracy: 0.7581 - val_loss: 0.5648
Epoch 31/50
35/35 ━━━━━━━━━━━━━━━━━━━━ 1s 22ms/step - accuracy: 0.7942 - loss: 0.5350 - val_accuracy: 0.7581 - val_loss: 0.5635
Epoch 32/50
35/35 ━━━━━━━━━━━━━━━━━━━━ 1s 22ms/step - accuracy: 0.7942 - loss: 0.5332 - val_accuracy: 0.7581 - val_loss: 0.5624
Epoch 33/50
35/35 ━━━━━━━━━━━━━━━━━━━━ 1s 22ms/step - accuracy: 0.7942 - loss: 0.5313 - val_accuracy: 0.7581 - val_loss: 0.5614
Epoch 34/50
35/35 ━━━━━━━━━━━━━━━━━━━━ 1s 22ms/step - accuracy: 0.7942 - loss: 0.5297 - val_accuracy: 0.7581 - val_loss: 0.5604
Epoch 35/50
35/35 ━━━━━━━━━━━━━━━━━━━━ 1s 22ms/step - accuracy: 0.7942 - loss: 0.5281 - val_accuracy: 0.7581 - val_loss: 0.5595
Epoch 36/50
35/35 ━━━━━━━━━━━━━━━━━━━━ 1s 22ms/step - accuracy: 0.7942 - loss: 0.5267 - val_accuracy: 0.7581 - val_loss: 0.5586
Epoch 37/50
35/35 ━━━━━━━━━━━━━━━━━━━━ 1s 22ms/step - accuracy: 0.7942 - loss: 0.5253 - val_accuracy: 0.7581 - val_loss: 0.5579
Epoch 38/50
35/35 ━━━━━━━━━━━━━━━━━━━━ 1s 22ms/step - accuracy: 0.7942 - loss: 0.5240 - val_accuracy: 0.7581 - val_loss: 0.5573
Epoch 39/50
35/35 ━━━━━━━━━━━━━━━━━━━━ 1s 23ms/step - accuracy: 0.7942 - loss: 0.5229 - val_accuracy: 0.7581 - val_loss: 0.5567
Epoch 40/50
35/35 ━━━━━━━━━━━━━━━━━━━━ 1s 22ms/step - accuracy: 0.7942 - loss: 0.5218 - val_accuracy: 0.7581 - val_loss: 0.5562
Epoch 41/50
35/35 ━━━━━━━━━━━━━━━━━━━━ 1s 22ms/step - accuracy: 0.7942 - loss: 0.5207 - val_accuracy: 0.7581 - val_loss: 0.5557
Epoch 42/50
35/35 ━━━━━━━━━━━━━━━━━━━━ 1s 22ms/step - accuracy: 0.7942 - loss: 0.5197 - val_accuracy: 0.7581 - val_loss: 0.5553
Epoch 43/50
35/35 ━━━━━━━━━━━━━━━━━━━━ 1s 22ms/step - accuracy: 0.7942 - loss: 0.5188 - val_accuracy: 0.7581 - val_loss: 0.5549
Epoch 44/50
35/35 ━━━━━━━━━━━━━━━━━━━━ 1s 22ms/step - accuracy: 0.7942 - loss: 0.5180 - val_accuracy: 0.7581 - val_loss: 0.5546
Epoch 45/50
35/35 ━━━━━━━━━━━━━━━━━━━━ 1s 23ms/step - accuracy: 0.7942 - loss: 0.5173 - val_accuracy: 0.7581 - val_loss: 0.5543
Epoch 46/50
35/35 ━━━━━━━━━━━━━━━━━━━━ 1s 22ms/step - accuracy: 0.7942 - loss: 0.5165 - val_accuracy: 0.7581 - val_loss: 0.5541
Epoch 47/50
35/35 ━━━━━━━━━━━━━━━━━━━━ 1s 22ms/step - accuracy: 0.7942 - loss: 0.5159 - val_accuracy: 0.7581 - val_loss: 0.5539
Epoch 48/50
35/35 ━━━━━━━━━━━━━━━━━━━━ 1s 22ms/step - accuracy: 0.7942 - loss: 0.5153 - val_accuracy: 0.7581 - val_loss: 0.5537
Epoch 49/50
35/35 ━━━━━━━━━━━━━━━━━━━━ 1s 22ms/step - accuracy: 0.7942 - loss: 0.5147 - val_accuracy: 0.7581 - val_loss: 0.5536
Epoch 50/50
35/35 ━━━━━━━━━━━━━━━━━━━━ 1s 22ms/step - accuracy: 0.7942 - loss: 0.5141 - val_accuracy: 0.7581 - val_loss: 0.5535
2025-10-31 09:14:11.804 | INFO     | src.ai_engine.ai_models:fit:685 - LSTM trained successfully.
2025-10-31 09:14:11.812 | INFO     | src.ai_engine.ai_models:fit:381 - Generating base model predictions for meta-model training...
2025-10-31 09:14:11.922 | INFO     | src.ai_engine.feature_engineering:create_sequences:261 - Creating sequences with length 50 from 1282 data points.
2025-10-31 09:14:11.938 | INFO     | src.ai_engine.feature_engineering:create_sequences:270 - Created 1232 sequences.
39/39 ━━━━━━━━━━━━━━━━━━━━ 2s 28ms/step
2025-10-31 09:14:13.850 | INFO     | src.ai_engine.ai_models:fit:396 - Training meta-model...
2025-10-31 09:14:13.884 | SUCCESS  | src.ai_engine.ai_models:fit:399 - Stacking Ensemble trained successfully.
2025-10-31 09:14:13.924 | SUCCESS  | __main__:main:167 - Final Ensemble model trained.
2025-10-31 09:14:13.928 | INFO     | __main__:main:171 - Saving models to 'models\GainX_600\4h'...
2025-10-31 09:14:14.144 | INFO     | src.ai_engine.ai_models:save:52 - Model RandomForest saved to models\GainX_600\4h\random_forest.pkl
2025-10-31 09:14:14.196 | INFO     | src.ai_engine.ai_models:save:52 - Model GradientBoosting saved to models\GainX_600\4h\gradient_boosting.pkl
2025-10-31 09:14:14.670 | INFO     | src.ai_engine.ai_models:save:731 - LSTM model saved to models\GainX_600\4h\lstm.keras, models\GainX_600\4h\lstm_scaler.pkl and marker file models\GainX_600\4h\lstm.pkl
2025-10-31 09:14:14.695 | INFO     | src.ai_engine.ai_models:save_all:463 - Meta-model saved to models\GainX_600\4h\meta_model.pkl
2025-10-31 09:14:14.697 | SUCCESS  | __main__:main:174 - --- Finished training for Symbol: GainX 600, Timeframe: 4h ---
2025-10-31 09:14:14.699 | INFO     | __main__:main:140 - --- Starting training for Symbol: GainX 600, Timeframe: 5m ---
2025-10-31 09:14:15.031 | SUCCESS  | __main__:main:148 - Loaded 86685 records.
2025-10-31 09:14:15.031 | INFO     | __main__:prepare_training_data:32 - Preparing data for training with Meta-Labeling...
2025-10-31 09:14:19.853 | DEBUG    | src.ai_engine.technical_indicators:calculate_all:47 - Calculated 63 technical indicators
2025-10-31 09:14:34.702 | DEBUG    | src.ai_engine.feature_engineering:extract_features:66 - Extracted 116 features
2025-10-31 09:14:34.710 | INFO     | __main__:prepare_training_data:39 - Generating signals from primary model (SimplePatternModel)...
2025-10-31 09:14:34.899 | WARNING  | src.ai_engine.feature_engineering:prepare_for_model:230 - Se perdieron todos los datos al eliminar los NaN. Se conservarán los datos rellenados.
2025-10-31 09:14:48.723 | INFO     | src.ai_engine.ai_models:calculate_optimal_threshold:549 - Calculated optimal threshold: 0.0010 (volatility: 0.0002, avg_movement: 0.0009)
2025-10-31 09:14:48.724 | INFO     | src.ai_engine.ai_models:create_meta_labels:577 - Creating meta-labels for secondary model...
2025-10-31 09:15:01.780 | INFO     | src.ai_engine.ai_models:create_meta_labels:629 - Meta-Label distribution - Profitable: 3714 (23.4%), Unprofitable: 12131 (76.6%)
2025-10-31 09:15:02.006 | WARNING  | src.ai_engine.feature_engineering:prepare_for_model:230 - Se perdieron todos los datos al eliminar los NaN. Se conservarán los datos rellenados.
2025-10-31 09:15:02.098 | INFO     | __main__:prepare_training_data:75 - Data preparation complete. Shape of X: (61994, 116), Shape of y: (61994,)
2025-10-31 09:15:02.138 | INFO     | src.ai_engine.feature_engineering:create_sequences:261 - Creating sequences with length 50 from 61994 data points.
2025-10-31 09:15:02.840 | INFO     | src.ai_engine.feature_engineering:create_sequences:270 - Created 61944 sequences.
2025-10-31 09:15:02.850 | INFO     | __main__:main:164 - Initializing and training Ensemble model...
2025-10-31 09:15:02.851 | INFO     | src.ai_engine.ai_models:__init__:304 - Initialized Stacking Ensemble with Logistic Regression as meta-model.
2025-10-31 09:15:02.911 | INFO     | src.ai_engine.ai_models:fit:359 - Creating LSTM model...
2025-10-31 09:15:02.911 | INFO     | src.ai_engine.ai_models:fit:364 - Training base models...
2025-10-31 09:15:03.044 | INFO     | src.ai_engine.ai_models:fit:373 - Training random_forest...
2025-10-31 09:15:27.008 | INFO     | src.ai_engine.ai_models:fit:98 - RandomForest trained successfully on 61994 samples with 2 classes
2025-10-31 09:15:27.011 | INFO     | src.ai_engine.ai_models:fit:373 - Training gradient_boosting...
2025-10-31 09:27:28.277 | INFO     | src.ai_engine.ai_models:fit:157 - GradientBoosting trained successfully on 61994 samples with 2 classes
2025-10-31 09:27:28.280 | INFO     | src.ai_engine.ai_models:fit:373 - Training pattern_based...
2025-10-31 09:27:28.280 | INFO     | src.ai_engine.ai_models:fit:373 - Training lstm...
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\keras\src\layers\rnn\rnn.py:199: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(**kwargs)
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1108: RuntimeWarning: invalid value encountered in divide
  updated_mean = (last_sum + new_sum) / updated_sample_count
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1113: RuntimeWarning: invalid value encountered in divide
  T = new_sum / new_sample_count
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1133: RuntimeWarning: invalid value encountered in divide
  new_unnormalized_variance -= correction**2 / new_sample_count
Epoch 1/50
1743/1743 ━━━━━━━━━━━━━━━━━━━━ 319s 43ms/step - accuracy: 0.9406 - loss: 0.4509 - val_accuracy: 0.9362 - val_loss: 0.3148
Epoch 2/50
1743/1743 ━━━━━━━━━━━━━━━━━━━━ 41s 23ms/step - accuracy: 0.9406 - loss: 0.2632 - val_accuracy: 0.9362 - val_loss: 0.2464
Epoch 3/50
1743/1743 ━━━━━━━━━━━━━━━━━━━━ 39s 22ms/step - accuracy: 0.9406 - loss: 0.2297 - val_accuracy: 0.9362 - val_loss: 0.2374
Epoch 4/50
1743/1743 ━━━━━━━━━━━━━━━━━━━━ 38s 21ms/step - accuracy: 0.9406 - loss: 0.2257 - val_accuracy: 0.9362 - val_loss: 0.2373
Epoch 5/50
1743/1743 ━━━━━━━━━━━━━━━━━━━━ 36s 21ms/step - accuracy: 0.9406 - loss: 0.2254 - val_accuracy: 0.9362 - val_loss: 0.2375
Epoch 6/50
1743/1743 ━━━━━━━━━━━━━━━━━━━━ 37s 21ms/step - accuracy: 0.9406 - loss: 0.2255 - val_accuracy: 0.9362 - val_loss: 0.2373
Epoch 7/50
1743/1743 ━━━━━━━━━━━━━━━━━━━━ 37s 21ms/step - accuracy: 0.9406 - loss: 0.2255 - val_accuracy: 0.9362 - val_loss: 0.2373
Epoch 8/50
1743/1743 ━━━━━━━━━━━━━━━━━━━━ 37s 21ms/step - accuracy: 0.9406 - loss: 0.2255 - val_accuracy: 0.9362 - val_loss: 0.2374
Epoch 9/50
1743/1743 ━━━━━━━━━━━━━━━━━━━━ 36s 21ms/step - accuracy: 0.9406 - loss: 0.2255 - val_accuracy: 0.9362 - val_loss: 0.2373
Epoch 10/50
1743/1743 ━━━━━━━━━━━━━━━━━━━━ 36s 21ms/step - accuracy: 0.9406 - loss: 0.2255 - val_accuracy: 0.9362 - val_loss: 0.2373
Epoch 11/50
1743/1743 ━━━━━━━━━━━━━━━━━━━━ 36s 21ms/step - accuracy: 0.9406 - loss: 0.2255 - val_accuracy: 0.9362 - val_loss: 0.2373
Epoch 12/50
1743/1743 ━━━━━━━━━━━━━━━━━━━━ 36s 21ms/step - accuracy: 0.9406 - loss: 0.2255 - val_accuracy: 0.9362 - val_loss: 0.2373
Epoch 13/50
1743/1743 ━━━━━━━━━━━━━━━━━━━━ 36s 21ms/step - accuracy: 0.9406 - loss: 0.2255 - val_accuracy: 0.9362 - val_loss: 0.2373
Epoch 14/50
1743/1743 ━━━━━━━━━━━━━━━━━━━━ 36s 21ms/step - accuracy: 0.9406 - loss: 0.2255 - val_accuracy: 0.9362 - val_loss: 0.2373
2025-10-31 10:04:55.787 | INFO     | src.ai_engine.ai_models:fit:685 - LSTM trained successfully.
2025-10-31 10:04:56.770 | INFO     | src.ai_engine.ai_models:fit:381 - Generating base model predictions for meta-model training...
2025-10-31 10:05:22.871 | INFO     | src.ai_engine.feature_engineering:create_sequences:261 - Creating sequences with length 50 from 61994 data points.
2025-10-31 10:05:23.993 | INFO     | src.ai_engine.feature_engineering:create_sequences:270 - Created 61944 sequences.
1936/1936 ━━━━━━━━━━━━━━━━━━━━ 261s 26ms/step
2025-10-31 10:20:16.892 | INFO     | src.ai_engine.ai_models:fit:396 - Training meta-model...
2025-10-31 10:20:22.729 | SUCCESS  | src.ai_engine.ai_models:fit:399 - Stacking Ensemble trained successfully.
2025-10-31 10:20:23.233 | SUCCESS  | __main__:main:167 - Final Ensemble model trained.
2025-10-31 10:20:23.260 | INFO     | __main__:main:171 - Saving models to 'models\GainX_600\5m'...
2025-10-31 10:20:32.680 | INFO     | src.ai_engine.ai_models:save:52 - Model RandomForest saved to models\GainX_600\5m\random_forest.pkl
2025-10-31 10:20:34.394 | INFO     | src.ai_engine.ai_models:save:52 - Model GradientBoosting saved to models\GainX_600\5m\gradient_boosting.pkl
2025-10-31 10:20:44.224 | INFO     | src.ai_engine.ai_models:save:731 - LSTM model saved to models\GainX_600\5m\lstm.keras, models\GainX_600\5m\lstm_scaler.pkl and marker file models\GainX_600\5m\lstm.pkl
2025-10-31 10:20:44.247 | INFO     | src.ai_engine.ai_models:save_all:463 - Meta-model saved to models\GainX_600\5m\meta_model.pkl
2025-10-31 10:20:44.311 | SUCCESS  | __main__:main:174 - --- Finished training for Symbol: GainX 600, Timeframe: 5m ---
2025-10-31 10:20:44.393 | INFO     | __main__:main:140 - --- Starting training for Symbol: GainX 800, Timeframe: 15m ---
2025-10-31 10:20:47.897 | SUCCESS  | __main__:main:148 - Loaded 28898 records.
2025-10-31 10:20:47.922 | INFO     | __main__:prepare_training_data:32 - Preparing data for training with Meta-Labeling...
2025-10-31 10:20:51.714 | DEBUG    | src.ai_engine.technical_indicators:calculate_all:47 - Calculated 63 technical indicators
2025-10-31 10:20:58.068 | DEBUG    | src.ai_engine.feature_engineering:extract_features:66 - Extracted 116 features
2025-10-31 10:20:58.069 | INFO     | __main__:prepare_training_data:39 - Generating signals from primary model (SimplePatternModel)...
2025-10-31 10:20:58.307 | WARNING  | src.ai_engine.feature_engineering:prepare_for_model:230 - Se perdieron todos los datos al eliminar los NaN. Se conservarán los datos rellenados.
2025-10-31 10:21:04.139 | INFO     | src.ai_engine.ai_models:calculate_optimal_threshold:549 - Calculated optimal threshold: 0.0010 (volatility: 0.0003, avg_movement: 0.0012)
2025-10-31 10:21:04.141 | INFO     | src.ai_engine.ai_models:create_meta_labels:577 - Creating meta-labels for secondary model...
2025-10-31 10:21:08.028 | INFO     | src.ai_engine.ai_models:create_meta_labels:629 - Meta-Label distribution - Profitable: 3191 (31.3%), Unprofitable: 7020 (68.7%)
2025-10-31 10:21:08.152 | WARNING  | src.ai_engine.feature_engineering:prepare_for_model:230 - Se perdieron todos los datos al eliminar los NaN. Se conservarán los datos rellenados.
2025-10-31 10:21:08.224 | INFO     | __main__:prepare_training_data:75 - Data preparation complete. Shape of X: (20314, 116), Shape of y: (20314,)
2025-10-31 10:21:08.543 | INFO     | src.ai_engine.feature_engineering:create_sequences:261 - Creating sequences with length 50 from 20314 data points.
2025-10-31 10:21:08.815 | INFO     | src.ai_engine.feature_engineering:create_sequences:270 - Created 20264 sequences.
2025-10-31 10:21:09.530 | INFO     | __main__:main:164 - Initializing and training Ensemble model...
2025-10-31 10:21:09.565 | INFO     | src.ai_engine.ai_models:__init__:304 - Initialized Stacking Ensemble with Logistic Regression as meta-model.
2025-10-31 10:21:11.468 | INFO     | src.ai_engine.ai_models:fit:359 - Creating LSTM model...
2025-10-31 10:21:11.490 | INFO     | src.ai_engine.ai_models:fit:364 - Training base models...
2025-10-31 10:21:11.551 | INFO     | src.ai_engine.ai_models:fit:373 - Training random_forest...
2025-10-31 10:21:22.939 | INFO     | src.ai_engine.ai_models:fit:98 - RandomForest trained successfully on 20314 samples with 2 classes
2025-10-31 10:21:23.014 | INFO     | src.ai_engine.ai_models:fit:373 - Training gradient_boosting...
2025-10-31 10:25:07.613 | INFO     | src.ai_engine.ai_models:fit:157 - GradientBoosting trained successfully on 20314 samples with 2 classes
2025-10-31 10:25:07.615 | INFO     | src.ai_engine.ai_models:fit:373 - Training pattern_based...
2025-10-31 10:25:07.617 | INFO     | src.ai_engine.ai_models:fit:373 - Training lstm...
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\keras\src\layers\rnn\rnn.py:199: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(**kwargs)
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1108: RuntimeWarning: invalid value encountered in divide
  updated_mean = (last_sum + new_sum) / updated_sample_count
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1113: RuntimeWarning: invalid value encountered in divide
  T = new_sum / new_sample_count
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1133: RuntimeWarning: invalid value encountered in divide
  new_unnormalized_variance -= correction**2 / new_sample_count
Epoch 1/50
570/570 ━━━━━━━━━━━━━━━━━━━━ 61s 29ms/step - accuracy: 0.8403 - loss: 0.6161 - val_accuracy: 0.8663 - val_loss: 0.5407
Epoch 2/50
570/570 ━━━━━━━━━━━━━━━━━━━━ 12s 22ms/step - accuracy: 0.8403 - loss: 0.5158 - val_accuracy: 0.8663 - val_loss: 0.4630
Epoch 3/50
570/570 ━━━━━━━━━━━━━━━━━━━━ 13s 22ms/step - accuracy: 0.8403 - loss: 0.4689 - val_accuracy: 0.8663 - val_loss: 0.4253
Epoch 4/50
570/570 ━━━━━━━━━━━━━━━━━━━━ 12s 22ms/step - accuracy: 0.8403 - loss: 0.4494 - val_accuracy: 0.8663 - val_loss: 0.4086
Epoch 5/50
570/570 ━━━━━━━━━━━━━━━━━━━━ 12s 22ms/step - accuracy: 0.8403 - loss: 0.4423 - val_accuracy: 0.8663 - val_loss: 0.4012
Epoch 6/50
570/570 ━━━━━━━━━━━━━━━━━━━━ 12s 21ms/step - accuracy: 0.8403 - loss: 0.4400 - val_accuracy: 0.8663 - val_loss: 0.3980
Epoch 7/50
570/570 ━━━━━━━━━━━━━━━━━━━━ 12s 21ms/step - accuracy: 0.8403 - loss: 0.4394 - val_accuracy: 0.8663 - val_loss: 0.3967
Epoch 8/50
570/570 ━━━━━━━━━━━━━━━━━━━━ 12s 22ms/step - accuracy: 0.8403 - loss: 0.4393 - val_accuracy: 0.8663 - val_loss: 0.3965
Epoch 9/50
570/570 ━━━━━━━━━━━━━━━━━━━━ 12s 21ms/step - accuracy: 0.8403 - loss: 0.4393 - val_accuracy: 0.8663 - val_loss: 0.3963
Epoch 10/50
570/570 ━━━━━━━━━━━━━━━━━━━━ 12s 21ms/step - accuracy: 0.8403 - loss: 0.4393 - val_accuracy: 0.8663 - val_loss: 0.3959
Epoch 11/50
570/570 ━━━━━━━━━━━━━━━━━━━━ 12s 21ms/step - accuracy: 0.8403 - loss: 0.4392 - val_accuracy: 0.8663 - val_loss: 0.3959
Epoch 12/50
570/570 ━━━━━━━━━━━━━━━━━━━━ 12s 21ms/step - accuracy: 0.8403 - loss: 0.4393 - val_accuracy: 0.8663 - val_loss: 0.3959
Epoch 13/50
570/570 ━━━━━━━━━━━━━━━━━━━━ 12s 21ms/step - accuracy: 0.8403 - loss: 0.4393 - val_accuracy: 0.8663 - val_loss: 0.3961
Epoch 14/50
570/570 ━━━━━━━━━━━━━━━━━━━━ 12s 21ms/step - accuracy: 0.8403 - loss: 0.4392 - val_accuracy: 0.8663 - val_loss: 0.3958
Epoch 15/50
570/570 ━━━━━━━━━━━━━━━━━━━━ 12s 21ms/step - accuracy: 0.8403 - loss: 0.4392 - val_accuracy: 0.8663 - val_loss: 0.3959
Epoch 16/50
570/570 ━━━━━━━━━━━━━━━━━━━━ 12s 21ms/step - accuracy: 0.8403 - loss: 0.4393 - val_accuracy: 0.8663 - val_loss: 0.3960
Epoch 17/50
570/570 ━━━━━━━━━━━━━━━━━━━━ 12s 21ms/step - accuracy: 0.8403 - loss: 0.4392 - val_accuracy: 0.8663 - val_loss: 0.3961
Epoch 18/50
570/570 ━━━━━━━━━━━━━━━━━━━━ 12s 21ms/step - accuracy: 0.8403 - loss: 0.4392 - val_accuracy: 0.8663 - val_loss: 0.3960
Epoch 19/50
570/570 ━━━━━━━━━━━━━━━━━━━━ 12s 21ms/step - accuracy: 0.8403 - loss: 0.4393 - val_accuracy: 0.8663 - val_loss: 0.3958
Epoch 20/50
570/570 ━━━━━━━━━━━━━━━━━━━━ 12s 21ms/step - accuracy: 0.8403 - loss: 0.4393 - val_accuracy: 0.8663 - val_loss: 0.3960
Epoch 21/50
570/570 ━━━━━━━━━━━━━━━━━━━━ 12s 21ms/step - accuracy: 0.8403 - loss: 0.4392 - val_accuracy: 0.8663 - val_loss: 0.3960
Epoch 22/50
570/570 ━━━━━━━━━━━━━━━━━━━━ 12s 21ms/step - accuracy: 0.8403 - loss: 0.4393 - val_accuracy: 0.8663 - val_loss: 0.3958
Epoch 23/50
570/570 ━━━━━━━━━━━━━━━━━━━━ 12s 21ms/step - accuracy: 0.8403 - loss: 0.4393 - val_accuracy: 0.8663 - val_loss: 0.3960
Epoch 24/50
570/570 ━━━━━━━━━━━━━━━━━━━━ 12s 21ms/step - accuracy: 0.8403 - loss: 0.4392 - val_accuracy: 0.8663 - val_loss: 0.3960
Epoch 25/50
570/570 ━━━━━━━━━━━━━━━━━━━━ 12s 21ms/step - accuracy: 0.8403 - loss: 0.4392 - val_accuracy: 0.8663 - val_loss: 0.3961
Epoch 26/50
570/570 ━━━━━━━━━━━━━━━━━━━━ 12s 21ms/step - accuracy: 0.8403 - loss: 0.4393 - val_accuracy: 0.8663 - val_loss: 0.3959
Epoch 27/50
570/570 ━━━━━━━━━━━━━━━━━━━━ 12s 21ms/step - accuracy: 0.8403 - loss: 0.4393 - val_accuracy: 0.8663 - val_loss: 0.3961
Epoch 28/50
570/570 ━━━━━━━━━━━━━━━━━━━━ 12s 21ms/step - accuracy: 0.8403 - loss: 0.4392 - val_accuracy: 0.8663 - val_loss: 0.3960
Epoch 29/50
570/570 ━━━━━━━━━━━━━━━━━━━━ 12s 21ms/step - accuracy: 0.8403 - loss: 0.4393 - val_accuracy: 0.8663 - val_loss: 0.3962
2025-10-31 10:31:56.004 | INFO     | src.ai_engine.ai_models:fit:685 - LSTM trained successfully.
2025-10-31 10:31:56.079 | INFO     | src.ai_engine.ai_models:fit:381 - Generating base model predictions for meta-model training...
2025-10-31 10:31:57.405 | INFO     | src.ai_engine.feature_engineering:create_sequences:261 - Creating sequences with length 50 from 20314 data points.
2025-10-31 10:31:57.642 | INFO     | src.ai_engine.feature_engineering:create_sequences:270 - Created 20264 sequences.
634/634 ━━━━━━━━━━━━━━━━━━━━ 7s 9ms/step
2025-10-31 10:32:06.591 | INFO     | src.ai_engine.ai_models:fit:396 - Training meta-model...
2025-10-31 10:32:06.606 | SUCCESS  | src.ai_engine.ai_models:fit:399 - Stacking Ensemble trained successfully.
2025-10-31 10:32:06.607 | SUCCESS  | __main__:main:167 - Final Ensemble model trained.
2025-10-31 10:32:06.608 | INFO     | __main__:main:171 - Saving models to 'models\GainX_800\15m'...
2025-10-31 10:32:06.683 | INFO     | src.ai_engine.ai_models:save:52 - Model RandomForest saved to models\GainX_800\15m\random_forest.pkl
2025-10-31 10:32:06.721 | INFO     | src.ai_engine.ai_models:save:52 - Model GradientBoosting saved to models\GainX_800\15m\gradient_boosting.pkl
2025-10-31 10:32:06.803 | INFO     | src.ai_engine.ai_models:save:731 - LSTM model saved to models\GainX_800\15m\lstm.keras, models\GainX_800\15m\lstm_scaler.pkl and marker file models\GainX_800\15m\lstm.pkl
2025-10-31 10:32:06.804 | INFO     | src.ai_engine.ai_models:save_all:463 - Meta-model saved to models\GainX_800\15m\meta_model.pkl
2025-10-31 10:32:06.805 | SUCCESS  | __main__:main:174 - --- Finished training for Symbol: GainX 800, Timeframe: 15m ---
2025-10-31 10:32:06.806 | INFO     | __main__:main:140 - --- Starting training for Symbol: GainX 800, Timeframe: 1d ---
2025-10-31 10:32:06.823 | SUCCESS  | __main__:main:148 - Loaded 302 records.
2025-10-31 10:32:06.823 | INFO     | __main__:prepare_training_data:32 - Preparing data for training with Meta-Labeling...
2025-10-31 10:32:06.900 | DEBUG    | src.ai_engine.technical_indicators:calculate_all:47 - Calculated 62 technical indicators
2025-10-31 10:32:06.970 | DEBUG    | src.ai_engine.feature_engineering:extract_features:66 - Extracted 116 features
2025-10-31 10:32:06.971 | INFO     | __main__:prepare_training_data:39 - Generating signals from primary model (SimplePatternModel)...
2025-10-31 10:32:07.002 | WARNING  | src.ai_engine.feature_engineering:prepare_for_model:230 - Se perdieron todos los datos al eliminar los NaN. Se conservarán los datos rellenados.
2025-10-31 10:32:07.053 | INFO     | src.ai_engine.ai_models:calculate_optimal_threshold:549 - Calculated optimal threshold: 0.0089 (volatility: 0.0029, avg_movement: 0.0122)
2025-10-31 10:32:07.053 | INFO     | src.ai_engine.ai_models:create_meta_labels:577 - Creating meta-labels for secondary model...
2025-10-31 10:32:07.095 | INFO     | src.ai_engine.ai_models:create_meta_labels:629 - Meta-Label distribution - Profitable: 42 (30.4%), Unprofitable: 96 (69.6%)
2025-10-31 10:32:07.119 | WARNING  | src.ai_engine.feature_engineering:prepare_for_model:230 - Se perdieron todos los datos al eliminar los NaN. Se conservarán los datos rellenados.
2025-10-31 10:32:07.149 | INFO     | __main__:prepare_training_data:75 - Data preparation complete. Shape of X: (228, 116), Shape of y: (228,)
2025-10-31 10:32:07.156 | INFO     | src.ai_engine.feature_engineering:create_sequences:261 - Creating sequences with length 50 from 228 data points.
2025-10-31 10:32:07.161 | INFO     | src.ai_engine.feature_engineering:create_sequences:270 - Created 178 sequences.
2025-10-31 10:32:07.198 | INFO     | __main__:main:164 - Initializing and training Ensemble model...
2025-10-31 10:32:07.209 | INFO     | src.ai_engine.ai_models:__init__:304 - Initialized Stacking Ensemble with Logistic Regression as meta-model.
2025-10-31 10:32:07.284 | INFO     | src.ai_engine.ai_models:fit:359 - Creating LSTM model...
2025-10-31 10:32:07.284 | INFO     | src.ai_engine.ai_models:fit:364 - Training base models...
2025-10-31 10:32:07.287 | INFO     | src.ai_engine.ai_models:fit:373 - Training random_forest...
2025-10-31 10:32:08.108 | INFO     | src.ai_engine.ai_models:fit:98 - RandomForest trained successfully on 228 samples with 2 classes
2025-10-31 10:32:08.108 | INFO     | src.ai_engine.ai_models:fit:373 - Training gradient_boosting...
2025-10-31 10:32:10.023 | INFO     | src.ai_engine.ai_models:fit:157 - GradientBoosting trained successfully on 228 samples with 2 classes
2025-10-31 10:32:10.023 | INFO     | src.ai_engine.ai_models:fit:373 - Training pattern_based...
2025-10-31 10:32:10.042 | INFO     | src.ai_engine.ai_models:fit:373 - Training lstm...
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\keras\src\layers\rnn\rnn.py:199: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(**kwargs)
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1108: RuntimeWarning: invalid value encountered in divide
  updated_mean = (last_sum + new_sum) / updated_sample_count
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1113: RuntimeWarning: invalid value encountered in divide
  T = new_sum / new_sample_count
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1133: RuntimeWarning: invalid value encountered in divide
  new_unnormalized_variance -= correction**2 / new_sample_count
Epoch 1/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 70s 298ms/step - accuracy: 0.8250 - loss: 0.6925 - val_accuracy: 1.0000 - val_loss: 0.6907
Epoch 2/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 55ms/step - accuracy: 0.8250 - loss: 0.6909 - val_accuracy: 1.0000 - val_loss: 0.6883
Epoch 3/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 72ms/step - accuracy: 0.8250 - loss: 0.6894 - val_accuracy: 1.0000 - val_loss: 0.6858
Epoch 4/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 39ms/step - accuracy: 0.8250 - loss: 0.6877 - val_accuracy: 1.0000 - val_loss: 0.6834
Epoch 5/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 52ms/step - accuracy: 0.8250 - loss: 0.6862 - val_accuracy: 1.0000 - val_loss: 0.6810
Epoch 6/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 34ms/step - accuracy: 0.8250 - loss: 0.6847 - val_accuracy: 1.0000 - val_loss: 0.6786
Epoch 7/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 33ms/step - accuracy: 0.8250 - loss: 0.6831 - val_accuracy: 1.0000 - val_loss: 0.6762
Epoch 8/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 33ms/step - accuracy: 0.8250 - loss: 0.6815 - val_accuracy: 1.0000 - val_loss: 0.6738
Epoch 9/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 33ms/step - accuracy: 0.8250 - loss: 0.6800 - val_accuracy: 1.0000 - val_loss: 0.6714
Epoch 10/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 42ms/step - accuracy: 0.8250 - loss: 0.6786 - val_accuracy: 1.0000 - val_loss: 0.6690
Epoch 11/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 33ms/step - accuracy: 0.8250 - loss: 0.6769 - val_accuracy: 1.0000 - val_loss: 0.6667
Epoch 12/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 33ms/step - accuracy: 0.8250 - loss: 0.6754 - val_accuracy: 1.0000 - val_loss: 0.6644
Epoch 13/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 33ms/step - accuracy: 0.8250 - loss: 0.6740 - val_accuracy: 1.0000 - val_loss: 0.6620
Epoch 14/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 40ms/step - accuracy: 0.8250 - loss: 0.6725 - val_accuracy: 1.0000 - val_loss: 0.6597
Epoch 15/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 33ms/step - accuracy: 0.8250 - loss: 0.6710 - val_accuracy: 1.0000 - val_loss: 0.6573
Epoch 16/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 39ms/step - accuracy: 0.8250 - loss: 0.6695 - val_accuracy: 1.0000 - val_loss: 0.6550
Epoch 17/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 33ms/step - accuracy: 0.8250 - loss: 0.6681 - val_accuracy: 1.0000 - val_loss: 0.6527
Epoch 18/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 33ms/step - accuracy: 0.8250 - loss: 0.6666 - val_accuracy: 1.0000 - val_loss: 0.6504
Epoch 19/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 33ms/step - accuracy: 0.8250 - loss: 0.6651 - val_accuracy: 1.0000 - val_loss: 0.6482
Epoch 20/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 33ms/step - accuracy: 0.8250 - loss: 0.6638 - val_accuracy: 1.0000 - val_loss: 0.6459
Epoch 21/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 33ms/step - accuracy: 0.8250 - loss: 0.6623 - val_accuracy: 1.0000 - val_loss: 0.6436
Epoch 22/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 33ms/step - accuracy: 0.8250 - loss: 0.6608 - val_accuracy: 1.0000 - val_loss: 0.6414
Epoch 23/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 33ms/step - accuracy: 0.8250 - loss: 0.6594 - val_accuracy: 1.0000 - val_loss: 0.6392
Epoch 24/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 33ms/step - accuracy: 0.8250 - loss: 0.6581 - val_accuracy: 1.0000 - val_loss: 0.6370
Epoch 25/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 33ms/step - accuracy: 0.8250 - loss: 0.6567 - val_accuracy: 1.0000 - val_loss: 0.6348
Epoch 26/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 33ms/step - accuracy: 0.8250 - loss: 0.6552 - val_accuracy: 1.0000 - val_loss: 0.6326
Epoch 27/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 33ms/step - accuracy: 0.8250 - loss: 0.6539 - val_accuracy: 1.0000 - val_loss: 0.6304
Epoch 28/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 33ms/step - accuracy: 0.8250 - loss: 0.6525 - val_accuracy: 1.0000 - val_loss: 0.6282
Epoch 29/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 33ms/step - accuracy: 0.8250 - loss: 0.6513 - val_accuracy: 1.0000 - val_loss: 0.6260
Epoch 30/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 34ms/step - accuracy: 0.8250 - loss: 0.6498 - val_accuracy: 1.0000 - val_loss: 0.6238
Epoch 31/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 34ms/step - accuracy: 0.8250 - loss: 0.6484 - val_accuracy: 1.0000 - val_loss: 0.6217
Epoch 32/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 33ms/step - accuracy: 0.8250 - loss: 0.6471 - val_accuracy: 1.0000 - val_loss: 0.6196
Epoch 33/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 33ms/step - accuracy: 0.8250 - loss: 0.6458 - val_accuracy: 1.0000 - val_loss: 0.6174
Epoch 34/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 33ms/step - accuracy: 0.8250 - loss: 0.6445 - val_accuracy: 1.0000 - val_loss: 0.6153
Epoch 35/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 33ms/step - accuracy: 0.8250 - loss: 0.6432 - val_accuracy: 1.0000 - val_loss: 0.6132
Epoch 36/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 33ms/step - accuracy: 0.8250 - loss: 0.6419 - val_accuracy: 1.0000 - val_loss: 0.6111
Epoch 37/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 33ms/step - accuracy: 0.8250 - loss: 0.6406 - val_accuracy: 1.0000 - val_loss: 0.6090
Epoch 38/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 33ms/step - accuracy: 0.8250 - loss: 0.6393 - val_accuracy: 1.0000 - val_loss: 0.6069
Epoch 39/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 33ms/step - accuracy: 0.8250 - loss: 0.6380 - val_accuracy: 1.0000 - val_loss: 0.6048
Epoch 40/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 33ms/step - accuracy: 0.8250 - loss: 0.6367 - val_accuracy: 1.0000 - val_loss: 0.6028
Epoch 41/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 33ms/step - accuracy: 0.8250 - loss: 0.6354 - val_accuracy: 1.0000 - val_loss: 0.6007
Epoch 42/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 33ms/step - accuracy: 0.8250 - loss: 0.6342 - val_accuracy: 1.0000 - val_loss: 0.5986
Epoch 43/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 37ms/step - accuracy: 0.8250 - loss: 0.6329 - val_accuracy: 1.0000 - val_loss: 0.5966
Epoch 44/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 33ms/step - accuracy: 0.8250 - loss: 0.6317 - val_accuracy: 1.0000 - val_loss: 0.5945
Epoch 45/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 33ms/step - accuracy: 0.8250 - loss: 0.6304 - val_accuracy: 1.0000 - val_loss: 0.5925
Epoch 46/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 33ms/step - accuracy: 0.8250 - loss: 0.6292 - val_accuracy: 1.0000 - val_loss: 0.5905
Epoch 47/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 33ms/step - accuracy: 0.8250 - loss: 0.6280 - val_accuracy: 1.0000 - val_loss: 0.5885
Epoch 48/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 33ms/step - accuracy: 0.8250 - loss: 0.6268 - val_accuracy: 1.0000 - val_loss: 0.5865
Epoch 49/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 33ms/step - accuracy: 0.8250 - loss: 0.6256 - val_accuracy: 1.0000 - val_loss: 0.5845
Epoch 50/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 33ms/step - accuracy: 0.8250 - loss: 0.6243 - val_accuracy: 1.0000 - val_loss: 0.5825
2025-10-31 10:33:30.283 | INFO     | src.ai_engine.ai_models:fit:685 - LSTM trained successfully.
2025-10-31 10:33:30.284 | INFO     | src.ai_engine.ai_models:fit:381 - Generating base model predictions for meta-model training...
2025-10-31 10:33:30.302 | INFO     | src.ai_engine.feature_engineering:create_sequences:261 - Creating sequences with length 50 from 228 data points.
2025-10-31 10:33:30.304 | INFO     | src.ai_engine.feature_engineering:create_sequences:270 - Created 178 sequences.
6/6 ━━━━━━━━━━━━━━━━━━━━ 1s 76ms/step
2025-10-31 10:33:31.192 | INFO     | src.ai_engine.ai_models:fit:396 - Training meta-model...
2025-10-31 10:33:31.199 | SUCCESS  | src.ai_engine.ai_models:fit:399 - Stacking Ensemble trained successfully.
2025-10-31 10:33:31.200 | SUCCESS  | __main__:main:167 - Final Ensemble model trained.
2025-10-31 10:33:31.201 | INFO     | __main__:main:171 - Saving models to 'models\GainX_800\1d'...
2025-10-31 10:33:31.233 | INFO     | src.ai_engine.ai_models:save:52 - Model RandomForest saved to models\GainX_800\1d\random_forest.pkl
2025-10-31 10:33:31.246 | INFO     | src.ai_engine.ai_models:save:52 - Model GradientBoosting saved to models\GainX_800\1d\gradient_boosting.pkl
2025-10-31 10:33:31.334 | INFO     | src.ai_engine.ai_models:save:731 - LSTM model saved to models\GainX_800\1d\lstm.keras, models\GainX_800\1d\lstm_scaler.pkl and marker file models\GainX_800\1d\lstm.pkl
2025-10-31 10:33:31.378 | INFO     | src.ai_engine.ai_models:save_all:463 - Meta-model saved to models\GainX_800\1d\meta_model.pkl
2025-10-31 10:33:31.379 | SUCCESS  | __main__:main:174 - --- Finished training for Symbol: GainX 800, Timeframe: 1d ---
2025-10-31 10:33:31.384 | INFO     | __main__:main:140 - --- Starting training for Symbol: GainX 800, Timeframe: 1h ---
2025-10-31 10:33:31.481 | SUCCESS  | __main__:main:148 - Loaded 7227 records.
2025-10-31 10:33:31.481 | INFO     | __main__:prepare_training_data:32 - Preparing data for training with Meta-Labeling...
2025-10-31 10:33:31.949 | DEBUG    | src.ai_engine.technical_indicators:calculate_all:47 - Calculated 63 technical indicators
2025-10-31 10:33:33.180 | DEBUG    | src.ai_engine.feature_engineering:extract_features:66 - Extracted 116 features
2025-10-31 10:33:33.181 | INFO     | __main__:prepare_training_data:39 - Generating signals from primary model (SimplePatternModel)...
2025-10-31 10:33:33.200 | WARNING  | src.ai_engine.feature_engineering:prepare_for_model:230 - Se perdieron todos los datos al eliminar los NaN. Se conservarán los datos rellenados.
2025-10-31 10:33:34.360 | INFO     | src.ai_engine.ai_models:calculate_optimal_threshold:549 - Calculated optimal threshold: 0.0017 (volatility: 0.0006, avg_movement: 0.0025)
2025-10-31 10:33:34.374 | INFO     | src.ai_engine.ai_models:create_meta_labels:577 - Creating meta-labels for secondary model...
2025-10-31 10:33:35.258 | INFO     | src.ai_engine.ai_models:create_meta_labels:629 - Meta-Label distribution - Profitable: 1014 (31.0%), Unprofitable: 2262 (69.0%)
2025-10-31 10:33:35.294 | WARNING  | src.ai_engine.feature_engineering:prepare_for_model:230 - Se perdieron todos los datos al eliminar los NaN. Se conservarán los datos rellenados.
2025-10-31 10:33:35.305 | INFO     | __main__:prepare_training_data:75 - Data preparation complete. Shape of X: (5073, 116), Shape of y: (5073,)
2025-10-31 10:33:35.308 | INFO     | src.ai_engine.feature_engineering:create_sequences:261 - Creating sequences with length 50 from 5073 data points.
2025-10-31 10:33:35.367 | INFO     | src.ai_engine.feature_engineering:create_sequences:270 - Created 5023 sequences.
2025-10-31 10:33:35.369 | INFO     | __main__:main:164 - Initializing and training Ensemble model...
2025-10-31 10:33:35.370 | INFO     | src.ai_engine.ai_models:__init__:304 - Initialized Stacking Ensemble with Logistic Regression as meta-model.
2025-10-31 10:33:35.392 | INFO     | src.ai_engine.ai_models:fit:359 - Creating LSTM model...
2025-10-31 10:33:35.393 | INFO     | src.ai_engine.ai_models:fit:364 - Training base models...
2025-10-31 10:33:35.404 | INFO     | src.ai_engine.ai_models:fit:373 - Training random_forest...
2025-10-31 10:33:37.281 | INFO     | src.ai_engine.ai_models:fit:98 - RandomForest trained successfully on 5073 samples with 2 classes
2025-10-31 10:33:37.282 | INFO     | src.ai_engine.ai_models:fit:373 - Training gradient_boosting...
2025-10-31 10:34:27.882 | INFO     | src.ai_engine.ai_models:fit:157 - GradientBoosting trained successfully on 5073 samples with 2 classes
2025-10-31 10:34:27.883 | INFO     | src.ai_engine.ai_models:fit:373 - Training pattern_based...
2025-10-31 10:34:27.884 | INFO     | src.ai_engine.ai_models:fit:373 - Training lstm...
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\keras\src\layers\rnn\rnn.py:199: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(**kwargs)
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1108: RuntimeWarning: invalid value encountered in divide
  updated_mean = (last_sum + new_sum) / updated_sample_count
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1113: RuntimeWarning: invalid value encountered in divide
  T = new_sum / new_sample_count
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1133: RuntimeWarning: invalid value encountered in divide
  new_unnormalized_variance -= correction**2 / new_sample_count
Epoch 1/50
142/142 ━━━━━━━━━━━━━━━━━━━━ 9s 27ms/step - accuracy: 0.7973 - loss: 0.6740 - val_accuracy: 0.8270 - val_loss: 0.6515
Epoch 2/50
142/142 ━━━━━━━━━━━━━━━━━━━━ 3s 22ms/step - accuracy: 0.7973 - loss: 0.6394 - val_accuracy: 0.8270 - val_loss: 0.6162
Epoch 3/50
142/142 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7973 - loss: 0.6109 - val_accuracy: 0.8270 - val_loss: 0.5871
Epoch 4/50
142/142 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7973 - loss: 0.5876 - val_accuracy: 0.8270 - val_loss: 0.5629
Epoch 5/50
142/142 ━━━━━━━━━━━━━━━━━━━━ 3s 22ms/step - accuracy: 0.7973 - loss: 0.5688 - val_accuracy: 0.8270 - val_loss: 0.5432
Epoch 6/50
142/142 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7973 - loss: 0.5537 - val_accuracy: 0.8270 - val_loss: 0.5268
Epoch 7/50
142/142 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7973 - loss: 0.5418 - val_accuracy: 0.8270 - val_loss: 0.5138
Epoch 8/50
142/142 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7973 - loss: 0.5324 - val_accuracy: 0.8270 - val_loss: 0.5033
Epoch 9/50
142/142 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7973 - loss: 0.5252 - val_accuracy: 0.8270 - val_loss: 0.4948
Epoch 10/50
142/142 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7973 - loss: 0.5196 - val_accuracy: 0.8270 - val_loss: 0.4881
Epoch 11/50
142/142 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7973 - loss: 0.5153 - val_accuracy: 0.8270 - val_loss: 0.4827
Epoch 12/50
142/142 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7973 - loss: 0.5121 - val_accuracy: 0.8270 - val_loss: 0.4785
Epoch 13/50
142/142 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7973 - loss: 0.5098 - val_accuracy: 0.8270 - val_loss: 0.4750
Epoch 14/50
142/142 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7973 - loss: 0.5080 - val_accuracy: 0.8270 - val_loss: 0.4724
Epoch 15/50
142/142 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7973 - loss: 0.5068 - val_accuracy: 0.8270 - val_loss: 0.4704
Epoch 16/50
142/142 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7973 - loss: 0.5059 - val_accuracy: 0.8270 - val_loss: 0.4688
Epoch 17/50
142/142 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7973 - loss: 0.5053 - val_accuracy: 0.8270 - val_loss: 0.4675
Epoch 18/50
142/142 ━━━━━━━━━━━━━━━━━━━━ 5s 21ms/step - accuracy: 0.7973 - loss: 0.5049 - val_accuracy: 0.8270 - val_loss: 0.4667
Epoch 19/50
142/142 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7973 - loss: 0.5046 - val_accuracy: 0.8270 - val_loss: 0.4659
Epoch 20/50
142/142 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7973 - loss: 0.5044 - val_accuracy: 0.8270 - val_loss: 0.4654
Epoch 21/50
142/142 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7973 - loss: 0.5043 - val_accuracy: 0.8270 - val_loss: 0.4649
Epoch 22/50
142/142 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7973 - loss: 0.5042 - val_accuracy: 0.8270 - val_loss: 0.4645
Epoch 23/50
142/142 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7973 - loss: 0.5042 - val_accuracy: 0.8270 - val_loss: 0.4642
Epoch 24/50
142/142 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7973 - loss: 0.5041 - val_accuracy: 0.8270 - val_loss: 0.4641
Epoch 25/50
142/142 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7973 - loss: 0.5041 - val_accuracy: 0.8270 - val_loss: 0.4639
Epoch 26/50
142/142 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7973 - loss: 0.5041 - val_accuracy: 0.8270 - val_loss: 0.4638
Epoch 27/50
142/142 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7973 - loss: 0.5041 - val_accuracy: 0.8270 - val_loss: 0.4636
Epoch 28/50
142/142 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7973 - loss: 0.5041 - val_accuracy: 0.8270 - val_loss: 0.4635
Epoch 29/50
142/142 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7973 - loss: 0.5041 - val_accuracy: 0.8270 - val_loss: 0.4634
Epoch 30/50
142/142 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7973 - loss: 0.5041 - val_accuracy: 0.8270 - val_loss: 0.4635
Epoch 31/50
142/142 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7973 - loss: 0.5041 - val_accuracy: 0.8270 - val_loss: 0.4634
Epoch 32/50
142/142 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7973 - loss: 0.5041 - val_accuracy: 0.8270 - val_loss: 0.4634
Epoch 33/50
142/142 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7973 - loss: 0.5041 - val_accuracy: 0.8270 - val_loss: 0.4634
Epoch 34/50
142/142 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7973 - loss: 0.5041 - val_accuracy: 0.8270 - val_loss: 0.4635
Epoch 35/50
142/142 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7973 - loss: 0.5041 - val_accuracy: 0.8270 - val_loss: 0.4634
Epoch 36/50
142/142 ━━━━━━━━━━━━━━━━━━━━ 5s 21ms/step - accuracy: 0.7973 - loss: 0.5041 - val_accuracy: 0.8270 - val_loss: 0.4634
Epoch 37/50
142/142 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7973 - loss: 0.5041 - val_accuracy: 0.8270 - val_loss: 0.4634
Epoch 38/50
142/142 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7973 - loss: 0.5041 - val_accuracy: 0.8270 - val_loss: 0.4635
Epoch 39/50
142/142 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7973 - loss: 0.5041 - val_accuracy: 0.8270 - val_loss: 0.4635
Epoch 40/50
142/142 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7973 - loss: 0.5041 - val_accuracy: 0.8270 - val_loss: 0.4635
Epoch 41/50
142/142 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7973 - loss: 0.5041 - val_accuracy: 0.8270 - val_loss: 0.4634
Epoch 42/50
142/142 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7973 - loss: 0.5041 - val_accuracy: 0.8270 - val_loss: 0.4634
Epoch 43/50
142/142 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7973 - loss: 0.5041 - val_accuracy: 0.8270 - val_loss: 0.4635
Epoch 44/50
142/142 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7973 - loss: 0.5041 - val_accuracy: 0.8270 - val_loss: 0.4634
Epoch 45/50
142/142 ━━━━━━━━━━━━━━━━━━━━ 3s 21ms/step - accuracy: 0.7973 - loss: 0.5041 - val_accuracy: 0.8270 - val_loss: 0.4635
2025-10-31 10:36:55.230 | INFO     | src.ai_engine.ai_models:fit:685 - LSTM trained successfully.
2025-10-31 10:36:55.238 | INFO     | src.ai_engine.ai_models:fit:381 - Generating base model predictions for meta-model training...
2025-10-31 10:36:55.567 | INFO     | src.ai_engine.feature_engineering:create_sequences:261 - Creating sequences with length 50 from 5073 data points.
2025-10-31 10:36:55.624 | INFO     | src.ai_engine.feature_engineering:create_sequences:270 - Created 5023 sequences.
157/157 ━━━━━━━━━━━━━━━━━━━━ 2s 10ms/step
2025-10-31 10:36:57.930 | INFO     | src.ai_engine.ai_models:fit:396 - Training meta-model...
2025-10-31 10:36:57.939 | SUCCESS  | src.ai_engine.ai_models:fit:399 - Stacking Ensemble trained successfully.
2025-10-31 10:36:57.940 | SUCCESS  | __main__:main:167 - Final Ensemble model trained.
2025-10-31 10:36:57.940 | INFO     | __main__:main:171 - Saving models to 'models\GainX_800\1h'...
2025-10-31 10:36:58.033 | INFO     | src.ai_engine.ai_models:save:52 - Model RandomForest saved to models\GainX_800\1h\random_forest.pkl
2025-10-31 10:36:58.101 | INFO     | src.ai_engine.ai_models:save:52 - Model GradientBoosting saved to models\GainX_800\1h\gradient_boosting.pkl
2025-10-31 10:36:58.230 | INFO     | src.ai_engine.ai_models:save:731 - LSTM model saved to models\GainX_800\1h\lstm.keras, models\GainX_800\1h\lstm_scaler.pkl and marker file models\GainX_800\1h\lstm.pkl
2025-10-31 10:36:58.231 | INFO     | src.ai_engine.ai_models:save_all:463 - Meta-model saved to models\GainX_800\1h\meta_model.pkl
2025-10-31 10:36:58.232 | SUCCESS  | __main__:main:174 - --- Finished training for Symbol: GainX 800, Timeframe: 1h ---
2025-10-31 10:36:58.233 | INFO     | __main__:main:140 - --- Starting training for Symbol: GainX 800, Timeframe: 1m ---
2025-10-31 10:36:58.575 | SUCCESS  | __main__:main:148 - Loaded 100001 records.
2025-10-31 10:36:58.576 | INFO     | __main__:prepare_training_data:32 - Preparing data for training with Meta-Labeling...
2025-10-31 10:37:04.025 | DEBUG    | src.ai_engine.technical_indicators:calculate_all:47 - Calculated 63 technical indicators
2025-10-31 10:37:21.096 | DEBUG    | src.ai_engine.feature_engineering:extract_features:66 - Extracted 116 features
2025-10-31 10:37:21.155 | INFO     | __main__:prepare_training_data:39 - Generating signals from primary model (SimplePatternModel)...
2025-10-31 10:37:21.406 | WARNING  | src.ai_engine.feature_engineering:prepare_for_model:230 - Se perdieron todos los datos al eliminar los NaN. Se conservarán los datos rellenados.
2025-10-31 10:37:37.321 | INFO     | src.ai_engine.ai_models:calculate_optimal_threshold:549 - Calculated optimal threshold: 0.0010 (volatility: 0.0001, avg_movement: 0.0003)
2025-10-31 10:37:37.322 | INFO     | src.ai_engine.ai_models:create_meta_labels:577 - Creating meta-labels for secondary model...
2025-10-31 10:37:50.351 | INFO     | src.ai_engine.ai_models:create_meta_labels:629 - Meta-Label distribution - Profitable: 17 (9.1%), Unprofitable: 170 (90.9%)
2025-10-31 10:37:50.581 | WARNING  | src.ai_engine.feature_engineering:prepare_for_model:230 - Se perdieron todos los datos al eliminar los NaN. Se conservarán los datos rellenados.
2025-10-31 10:37:50.671 | INFO     | __main__:prepare_training_data:75 - Data preparation complete. Shape of X: (57868, 116), Shape of y: (57868,)
2025-10-31 10:37:50.709 | INFO     | src.ai_engine.feature_engineering:create_sequences:261 - Creating sequences with length 50 from 57868 data points.
2025-10-31 10:37:51.365 | INFO     | src.ai_engine.feature_engineering:create_sequences:270 - Created 57818 sequences.
2025-10-31 10:37:51.381 | INFO     | __main__:main:164 - Initializing and training Ensemble model...
2025-10-31 10:37:51.382 | INFO     | src.ai_engine.ai_models:__init__:304 - Initialized Stacking Ensemble with Logistic Regression as meta-model.
2025-10-31 10:37:51.405 | INFO     | src.ai_engine.ai_models:fit:359 - Creating LSTM model...
2025-10-31 10:37:51.406 | INFO     | src.ai_engine.ai_models:fit:364 - Training base models...
2025-10-31 10:37:51.502 | INFO     | src.ai_engine.ai_models:fit:373 - Training random_forest...
2025-10-31 10:37:58.540 | INFO     | src.ai_engine.ai_models:fit:98 - RandomForest trained successfully on 57868 samples with 2 classes
2025-10-31 10:37:58.543 | INFO     | src.ai_engine.ai_models:fit:373 - Training gradient_boosting...
2025-10-31 10:44:16.026 | INFO     | src.ai_engine.ai_models:fit:157 - GradientBoosting trained successfully on 57868 samples with 2 classes
2025-10-31 10:44:16.028 | INFO     | src.ai_engine.ai_models:fit:373 - Training pattern_based...
2025-10-31 10:44:16.029 | INFO     | src.ai_engine.ai_models:fit:373 - Training lstm...
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\keras\src\layers\rnn\rnn.py:199: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(**kwargs)
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1108: RuntimeWarning: invalid value encountered in divide
  updated_mean = (last_sum + new_sum) / updated_sample_count
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1113: RuntimeWarning: invalid value encountered in divide
  T = new_sum / new_sample_count
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1133: RuntimeWarning: invalid value encountered in divide
  new_unnormalized_variance -= correction**2 / new_sample_count
Epoch 1/50
1627/1627 ━━━━━━━━━━━━━━━━━━━━ 244s 33ms/step - accuracy: 0.9997 - loss: 0.4149 - val_accuracy: 1.0000 - val_loss: 0.2319
Epoch 2/50
1627/1627 ━━━━━━━━━━━━━━━━━━━━ 38s 23ms/step - accuracy: 0.9997 - loss: 0.1518 - val_accuracy: 1.0000 - val_loss: 0.0947
Epoch 3/50
1627/1627 ━━━━━━━━━━━━━━━━━━━━ 41s 22ms/step - accuracy: 0.9997 - loss: 0.0663 - val_accuracy: 1.0000 - val_loss: 0.0435
Epoch 4/50
1627/1627 ━━━━━━━━━━━━━━━━━━━━ 34s 21ms/step - accuracy: 0.9997 - loss: 0.0321 - val_accuracy: 1.0000 - val_loss: 0.0212
Epoch 5/50
1627/1627 ━━━━━━━━━━━━━━━━━━━━ 34s 21ms/step - accuracy: 0.9997 - loss: 0.0166 - val_accuracy: 1.0000 - val_loss: 0.0106
Epoch 6/50
1627/1627 ━━━━━━━━━━━━━━━━━━━━ 34s 21ms/step - accuracy: 0.9997 - loss: 0.0093 - val_accuracy: 1.0000 - val_loss: 0.0055
Epoch 7/50
1627/1627 ━━━━━━━━━━━━━━━━━━━━ 34s 21ms/step - accuracy: 0.9997 - loss: 0.0058 - val_accuracy: 1.0000 - val_loss: 0.0029
Epoch 8/50
1627/1627 ━━━━━━━━━━━━━━━━━━━━ 34s 21ms/step - accuracy: 0.9997 - loss: 0.0042 - val_accuracy: 1.0000 - val_loss: 0.0017
Epoch 9/50
1627/1627 ━━━━━━━━━━━━━━━━━━━━ 35s 21ms/step - accuracy: 0.9997 - loss: 0.0035 - val_accuracy: 1.0000 - val_loss: 0.0011
Epoch 10/50
1627/1627 ━━━━━━━━━━━━━━━━━━━━ 34s 21ms/step - accuracy: 0.9997 - loss: 0.0032 - val_accuracy: 1.0000 - val_loss: 8.1793e-04
Epoch 11/50
1627/1627 ━━━━━━━━━━━━━━━━━━━━ 34s 21ms/step - accuracy: 0.9997 - loss: 0.0031 - val_accuracy: 1.0000 - val_loss: 6.6670e-04
Epoch 12/50
1627/1627 ━━━━━━━━━━━━━━━━━━━━ 34s 21ms/step - accuracy: 0.9997 - loss: 0.0030 - val_accuracy: 1.0000 - val_loss: 5.7343e-04
Epoch 13/50
1627/1627 ━━━━━━━━━━━━━━━━━━━━ 34s 21ms/step - accuracy: 0.9997 - loss: 0.0030 - val_accuracy: 1.0000 - val_loss: 5.1121e-04
Epoch 14/50
1627/1627 ━━━━━━━━━━━━━━━━━━━━ 34s 21ms/step - accuracy: 0.9997 - loss: 0.0030 - val_accuracy: 1.0000 - val_loss: 4.6626e-04
Epoch 15/50
1627/1627 ━━━━━━━━━━━━━━━━━━━━ 34s 21ms/step - accuracy: 0.9997 - loss: 0.0030 - val_accuracy: 1.0000 - val_loss: 4.3350e-04
Epoch 16/50
1627/1627 ━━━━━━━━━━━━━━━━━━━━ 34s 21ms/step - accuracy: 0.9997 - loss: 0.0030 - val_accuracy: 1.0000 - val_loss: 4.0960e-04
Epoch 17/50
1627/1627 ━━━━━━━━━━━━━━━━━━━━ 34s 21ms/step - accuracy: 0.9997 - loss: 0.0030 - val_accuracy: 1.0000 - val_loss: 3.9175e-04
Epoch 18/50
1627/1627 ━━━━━━━━━━━━━━━━━━━━ 34s 21ms/step - accuracy: 0.9997 - loss: 0.0030 - val_accuracy: 1.0000 - val_loss: 3.7866e-04
Epoch 19/50
1627/1627 ━━━━━━━━━━━━━━━━━━━━ 34s 21ms/step - accuracy: 0.9997 - loss: 0.0030 - val_accuracy: 1.0000 - val_loss: 3.6779e-04
Epoch 20/50
1627/1627 ━━━━━━━━━━━━━━━━━━━━ 34s 21ms/step - accuracy: 0.9997 - loss: 0.0030 - val_accuracy: 1.0000 - val_loss: 3.5849e-04
Epoch 21/50
1627/1627 ━━━━━━━━━━━━━━━━━━━━ 34s 21ms/step - accuracy: 0.9997 - loss: 0.0030 - val_accuracy: 1.0000 - val_loss: 3.5125e-04
Epoch 22/50
1627/1627 ━━━━━━━━━━━━━━━━━━━━ 34s 21ms/step - accuracy: 0.9997 - loss: 0.0030 - val_accuracy: 1.0000 - val_loss: 3.4488e-04
Epoch 23/50
1627/1627 ━━━━━━━━━━━━━━━━━━━━ 34s 21ms/step - accuracy: 0.9997 - loss: 0.0030 - val_accuracy: 1.0000 - val_loss: 3.3928e-04
Epoch 24/50
1627/1627 ━━━━━━━━━━━━━━━━━━━━ 34s 21ms/step - accuracy: 0.9997 - loss: 0.0030 - val_accuracy: 1.0000 - val_loss: 3.3701e-04
Epoch 25/50
1627/1627 ━━━━━━━━━━━━━━━━━━━━ 41s 21ms/step - accuracy: 0.9997 - loss: 0.0030 - val_accuracy: 1.0000 - val_loss: 3.3418e-04
Epoch 26/50
1627/1627 ━━━━━━━━━━━━━━━━━━━━ 34s 21ms/step - accuracy: 0.9997 - loss: 0.0030 - val_accuracy: 1.0000 - val_loss: 3.3193e-04
Epoch 27/50
1627/1627 ━━━━━━━━━━━━━━━━━━━━ 34s 21ms/step - accuracy: 0.9997 - loss: 0.0030 - val_accuracy: 1.0000 - val_loss: 3.2763e-04
Epoch 28/50
1627/1627 ━━━━━━━━━━━━━━━━━━━━ 34s 21ms/step - accuracy: 0.9997 - loss: 0.0030 - val_accuracy: 1.0000 - val_loss: 3.2837e-04
Epoch 29/50
1627/1627 ━━━━━━━━━━━━━━━━━━━━ 35s 21ms/step - accuracy: 0.9997 - loss: 0.0030 - val_accuracy: 1.0000 - val_loss: 3.2509e-04
Epoch 30/50
1627/1627 ━━━━━━━━━━━━━━━━━━━━ 34s 21ms/step - accuracy: 0.9997 - loss: 0.0030 - val_accuracy: 1.0000 - val_loss: 3.2475e-04
Epoch 31/50
1627/1627 ━━━━━━━━━━━━━━━━━━━━ 34s 21ms/step - accuracy: 0.9997 - loss: 0.0030 - val_accuracy: 1.0000 - val_loss: 3.2215e-04
Epoch 32/50
1627/1627 ━━━━━━━━━━━━━━━━━━━━ 34s 21ms/step - accuracy: 0.9997 - loss: 0.0030 - val_accuracy: 1.0000 - val_loss: 3.2064e-04
Epoch 33/50
1627/1627 ━━━━━━━━━━━━━━━━━━━━ 34s 21ms/step - accuracy: 0.9997 - loss: 0.0030 - val_accuracy: 1.0000 - val_loss: 3.1989e-04
Epoch 34/50
1627/1627 ━━━━━━━━━━━━━━━━━━━━ 34s 21ms/step - accuracy: 0.9997 - loss: 0.0030 - val_accuracy: 1.0000 - val_loss: 3.1926e-04
Epoch 35/50
1627/1627 ━━━━━━━━━━━━━━━━━━━━ 34s 21ms/step - accuracy: 0.9997 - loss: 0.0030 - val_accuracy: 1.0000 - val_loss: 3.1683e-04
Epoch 36/50
1627/1627 ━━━━━━━━━━━━━━━━━━━━ 34s 21ms/step - accuracy: 0.9997 - loss: 0.0030 - val_accuracy: 1.0000 - val_loss: 3.1839e-04
Epoch 37/50
1627/1627 ━━━━━━━━━━━━━━━━━━━━ 34s 21ms/step - accuracy: 0.9997 - loss: 0.0030 - val_accuracy: 1.0000 - val_loss: 3.1746e-04
Epoch 38/50
1627/1627 ━━━━━━━━━━━━━━━━━━━━ 34s 21ms/step - accuracy: 0.9997 - loss: 0.0030 - val_accuracy: 1.0000 - val_loss: 3.1571e-04
Epoch 39/50
1627/1627 ━━━━━━━━━━━━━━━━━━━━ 34s 21ms/step - accuracy: 0.9997 - loss: 0.0030 - val_accuracy: 1.0000 - val_loss: 3.1587e-04
Epoch 40/50
1627/1627 ━━━━━━━━━━━━━━━━━━━━ 34s 21ms/step - accuracy: 0.9997 - loss: 0.0030 - val_accuracy: 1.0000 - val_loss: 3.1498e-04
Epoch 41/50
1627/1627 ━━━━━━━━━━━━━━━━━━━━ 34s 21ms/step - accuracy: 0.9997 - loss: 0.0030 - val_accuracy: 1.0000 - val_loss: 3.1386e-04
Epoch 42/50
1627/1627 ━━━━━━━━━━━━━━━━━━━━ 34s 21ms/step - accuracy: 0.9997 - loss: 0.0030 - val_accuracy: 1.0000 - val_loss: 3.1435e-04
Epoch 43/50
1627/1627 ━━━━━━━━━━━━━━━━━━━━ 34s 21ms/step - accuracy: 0.9997 - loss: 0.0030 - val_accuracy: 1.0000 - val_loss: 3.1476e-04
Epoch 44/50
1627/1627 ━━━━━━━━━━━━━━━━━━━━ 34s 21ms/step - accuracy: 0.9997 - loss: 0.0030 - val_accuracy: 1.0000 - val_loss: 3.1592e-04
Epoch 45/50
1627/1627 ━━━━━━━━━━━━━━━━━━━━ 34s 21ms/step - accuracy: 0.9997 - loss: 0.0030 - val_accuracy: 1.0000 - val_loss: 3.1583e-04
Epoch 46/50
1627/1627 ━━━━━━━━━━━━━━━━━━━━ 34s 21ms/step - accuracy: 0.9997 - loss: 0.0030 - val_accuracy: 1.0000 - val_loss: 3.1546e-04
Epoch 47/50
1627/1627 ━━━━━━━━━━━━━━━━━━━━ 34s 21ms/step - accuracy: 0.9997 - loss: 0.0030 - val_accuracy: 1.0000 - val_loss: 3.1543e-04
Epoch 48/50
1627/1627 ━━━━━━━━━━━━━━━━━━━━ 34s 21ms/step - accuracy: 0.9997 - loss: 0.0030 - val_accuracy: 1.0000 - val_loss: 3.1395e-04
Epoch 49/50
1627/1627 ━━━━━━━━━━━━━━━━━━━━ 35s 21ms/step - accuracy: 0.9997 - loss: 0.0030 - val_accuracy: 1.0000 - val_loss: 3.1599e-04
Epoch 50/50
1627/1627 ━━━━━━━━━━━━━━━━━━━━ 34s 21ms/step - accuracy: 0.9997 - loss: 0.0030 - val_accuracy: 1.0000 - val_loss: 3.1643e-04
2025-10-31 11:39:47.446 | INFO     | src.ai_engine.ai_models:fit:685 - LSTM trained successfully.
2025-10-31 11:39:48.760 | INFO     | src.ai_engine.ai_models:fit:381 - Generating base model predictions for meta-model training...
2025-10-31 11:40:33.276 | INFO     | src.ai_engine.feature_engineering:create_sequences:261 - Creating sequences with length 50 from 57868 data points.
2025-10-31 11:40:34.028 | INFO     | src.ai_engine.feature_engineering:create_sequences:270 - Created 57818 sequences.
1807/1807 ━━━━━━━━━━━━━━━━━━━━ 143s 25ms/step
2025-10-31 11:50:36.044 | INFO     | src.ai_engine.ai_models:fit:396 - Training meta-model...
2025-10-31 11:50:42.251 | SUCCESS  | src.ai_engine.ai_models:fit:399 - Stacking Ensemble trained successfully.
2025-10-31 11:50:42.681 | SUCCESS  | __main__:main:167 - Final Ensemble model trained.
2025-10-31 11:50:42.711 | INFO     | __main__:main:171 - Saving models to 'models\GainX_800\1m'...
2025-10-31 11:50:49.285 | INFO     | src.ai_engine.ai_models:save:52 - Model RandomForest saved to models\GainX_800\1m\random_forest.pkl
2025-10-31 11:50:50.433 | INFO     | src.ai_engine.ai_models:save:52 - Model GradientBoosting saved to models\GainX_800\1m\gradient_boosting.pkl
2025-10-31 11:50:57.489 | INFO     | src.ai_engine.ai_models:save:731 - LSTM model saved to models\GainX_800\1m\lstm.keras, models\GainX_800\1m\lstm_scaler.pkl and marker file models\GainX_800\1m\lstm.pkl
2025-10-31 11:50:57.525 | INFO     | src.ai_engine.ai_models:save_all:463 - Meta-model saved to models\GainX_800\1m\meta_model.pkl
2025-10-31 11:50:57.527 | SUCCESS  | __main__:main:174 - --- Finished training for Symbol: GainX 800, Timeframe: 1m ---
2025-10-31 11:50:57.557 | INFO     | __main__:main:140 - --- Starting training for Symbol: GainX 800, Timeframe: 4h ---
2025-10-31 11:50:59.900 | SUCCESS  | __main__:main:148 - Loaded 1809 records.
2025-10-31 11:50:59.901 | INFO     | __main__:prepare_training_data:32 - Preparing data for training with Meta-Labeling...
2025-10-31 11:51:01.625 | DEBUG    | src.ai_engine.technical_indicators:calculate_all:47 - Calculated 63 technical indicators
2025-10-31 11:51:02.937 | DEBUG    | src.ai_engine.feature_engineering:extract_features:66 - Extracted 116 features
2025-10-31 11:51:02.937 | INFO     | __main__:prepare_training_data:39 - Generating signals from primary model (SimplePatternModel)...
2025-10-31 11:51:03.071 | WARNING  | src.ai_engine.feature_engineering:prepare_for_model:230 - Se perdieron todos los datos al eliminar los NaN. Se conservarán los datos rellenados.
2025-10-31 11:51:04.277 | INFO     | src.ai_engine.ai_models:calculate_optimal_threshold:549 - Calculated optimal threshold: 0.0034 (volatility: 0.0012, avg_movement: 0.0051)
2025-10-31 11:51:04.279 | INFO     | src.ai_engine.ai_models:create_meta_labels:577 - Creating meta-labels for secondary model...
2025-10-31 11:51:04.571 | INFO     | src.ai_engine.ai_models:create_meta_labels:629 - Meta-Label distribution - Profitable: 338 (39.7%), Unprofitable: 514 (60.3%)
2025-10-31 11:51:04.767 | WARNING  | src.ai_engine.feature_engineering:prepare_for_model:230 - Se perdieron todos los datos al eliminar los NaN. Se conservarán los datos rellenados.
2025-10-31 11:51:04.778 | INFO     | __main__:prepare_training_data:75 - Data preparation complete. Shape of X: (1242, 116), Shape of y: (1242,)
2025-10-31 11:51:04.989 | INFO     | src.ai_engine.feature_engineering:create_sequences:261 - Creating sequences with length 50 from 1242 data points.
2025-10-31 11:51:05.048 | INFO     | src.ai_engine.feature_engineering:create_sequences:270 - Created 1192 sequences.
2025-10-31 11:51:05.654 | INFO     | __main__:main:164 - Initializing and training Ensemble model...
2025-10-31 11:51:05.689 | INFO     | src.ai_engine.ai_models:__init__:304 - Initialized Stacking Ensemble with Logistic Regression as meta-model.
2025-10-31 11:51:06.945 | INFO     | src.ai_engine.ai_models:fit:359 - Creating LSTM model...
2025-10-31 11:51:06.953 | INFO     | src.ai_engine.ai_models:fit:364 - Training base models...
2025-10-31 11:51:06.961 | INFO     | src.ai_engine.ai_models:fit:373 - Training random_forest...
2025-10-31 11:51:10.596 | INFO     | src.ai_engine.ai_models:fit:98 - RandomForest trained successfully on 1242 samples with 2 classes
2025-10-31 11:51:10.598 | INFO     | src.ai_engine.ai_models:fit:373 - Training gradient_boosting...
2025-10-31 11:51:24.634 | INFO     | src.ai_engine.ai_models:fit:157 - GradientBoosting trained successfully on 1242 samples with 2 classes
2025-10-31 11:51:24.634 | INFO     | src.ai_engine.ai_models:fit:373 - Training pattern_based...
2025-10-31 11:51:24.636 | INFO     | src.ai_engine.ai_models:fit:373 - Training lstm...
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\keras\src\layers\rnn\rnn.py:199: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(**kwargs)
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1108: RuntimeWarning: invalid value encountered in divide
  updated_mean = (last_sum + new_sum) / updated_sample_count
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1113: RuntimeWarning: invalid value encountered in divide
  T = new_sum / new_sample_count
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1133: RuntimeWarning: invalid value encountered in divide
  new_unnormalized_variance -= correction**2 / new_sample_count
Epoch 1/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 20s 130ms/step - accuracy: 0.7099 - loss: 0.6901 - val_accuracy: 0.8417 - val_loss: 0.6828
Epoch 2/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 34ms/step - accuracy: 0.7099 - loss: 0.6840 - val_accuracy: 0.8417 - val_loss: 0.6725
Epoch 3/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 31ms/step - accuracy: 0.7099 - loss: 0.6780 - val_accuracy: 0.8417 - val_loss: 0.6629
Epoch 4/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 26ms/step - accuracy: 0.7099 - loss: 0.6724 - val_accuracy: 0.8417 - val_loss: 0.6538
Epoch 5/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 28ms/step - accuracy: 0.7099 - loss: 0.6672 - val_accuracy: 0.8417 - val_loss: 0.6445
Epoch 6/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 23ms/step - accuracy: 0.7099 - loss: 0.6622 - val_accuracy: 0.8417 - val_loss: 0.6361
Epoch 7/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 25ms/step - accuracy: 0.7099 - loss: 0.6576 - val_accuracy: 0.8417 - val_loss: 0.6279
Epoch 8/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 23ms/step - accuracy: 0.7099 - loss: 0.6532 - val_accuracy: 0.8417 - val_loss: 0.6203
Epoch 9/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 23ms/step - accuracy: 0.7099 - loss: 0.6491 - val_accuracy: 0.8417 - val_loss: 0.6129
Epoch 10/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 30ms/step - accuracy: 0.7099 - loss: 0.6454 - val_accuracy: 0.8417 - val_loss: 0.6057
Epoch 11/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 23ms/step - accuracy: 0.7099 - loss: 0.6417 - val_accuracy: 0.8417 - val_loss: 0.5992
Epoch 12/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 23ms/step - accuracy: 0.7099 - loss: 0.6385 - val_accuracy: 0.8417 - val_loss: 0.5926
Epoch 13/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 23ms/step - accuracy: 0.7099 - loss: 0.6354 - val_accuracy: 0.8417 - val_loss: 0.5866
Epoch 14/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 24ms/step - accuracy: 0.7099 - loss: 0.6325 - val_accuracy: 0.8417 - val_loss: 0.5809
Epoch 15/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 23ms/step - accuracy: 0.7099 - loss: 0.6299 - val_accuracy: 0.8417 - val_loss: 0.5752
Epoch 16/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 23ms/step - accuracy: 0.7099 - loss: 0.6275 - val_accuracy: 0.8417 - val_loss: 0.5700
Epoch 17/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 23ms/step - accuracy: 0.7099 - loss: 0.6252 - val_accuracy: 0.8417 - val_loss: 0.5655
Epoch 18/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 23ms/step - accuracy: 0.7099 - loss: 0.6232 - val_accuracy: 0.8417 - val_loss: 0.5610
Epoch 19/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 23ms/step - accuracy: 0.7099 - loss: 0.6214 - val_accuracy: 0.8417 - val_loss: 0.5560
Epoch 20/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 23ms/step - accuracy: 0.7099 - loss: 0.6195 - val_accuracy: 0.8417 - val_loss: 0.5519
Epoch 21/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 24ms/step - accuracy: 0.7099 - loss: 0.6179 - val_accuracy: 0.8417 - val_loss: 0.5479
Epoch 22/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 2s 44ms/step - accuracy: 0.7099 - loss: 0.6164 - val_accuracy: 0.8417 - val_loss: 0.5441
Epoch 23/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 23ms/step - accuracy: 0.7099 - loss: 0.6151 - val_accuracy: 0.8417 - val_loss: 0.5413
Epoch 24/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 24ms/step - accuracy: 0.7099 - loss: 0.6139 - val_accuracy: 0.8417 - val_loss: 0.5376
Epoch 25/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 23ms/step - accuracy: 0.7099 - loss: 0.6128 - val_accuracy: 0.8417 - val_loss: 0.5348
Epoch 26/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 23ms/step - accuracy: 0.7099 - loss: 0.6118 - val_accuracy: 0.8417 - val_loss: 0.5315
Epoch 27/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 23ms/step - accuracy: 0.7099 - loss: 0.6108 - val_accuracy: 0.8417 - val_loss: 0.5286
Epoch 28/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 23ms/step - accuracy: 0.7099 - loss: 0.6099 - val_accuracy: 0.8417 - val_loss: 0.5258
Epoch 29/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 23ms/step - accuracy: 0.7099 - loss: 0.6091 - val_accuracy: 0.8417 - val_loss: 0.5234
Epoch 30/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 23ms/step - accuracy: 0.7099 - loss: 0.6085 - val_accuracy: 0.8417 - val_loss: 0.5212
Epoch 31/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 23ms/step - accuracy: 0.7099 - loss: 0.6078 - val_accuracy: 0.8417 - val_loss: 0.5188
Epoch 32/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 23ms/step - accuracy: 0.7099 - loss: 0.6073 - val_accuracy: 0.8417 - val_loss: 0.5166
Epoch 33/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 23ms/step - accuracy: 0.7099 - loss: 0.6067 - val_accuracy: 0.8417 - val_loss: 0.5148
Epoch 34/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 23ms/step - accuracy: 0.7099 - loss: 0.6063 - val_accuracy: 0.8417 - val_loss: 0.5129
Epoch 35/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 23ms/step - accuracy: 0.7099 - loss: 0.6058 - val_accuracy: 0.8417 - val_loss: 0.5110
Epoch 36/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 23ms/step - accuracy: 0.7099 - loss: 0.6055 - val_accuracy: 0.8417 - val_loss: 0.5098
Epoch 37/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 23ms/step - accuracy: 0.7099 - loss: 0.6051 - val_accuracy: 0.8417 - val_loss: 0.5079
Epoch 38/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 23ms/step - accuracy: 0.7099 - loss: 0.6048 - val_accuracy: 0.8417 - val_loss: 0.5063
Epoch 39/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 23ms/step - accuracy: 0.7099 - loss: 0.6045 - val_accuracy: 0.8417 - val_loss: 0.5049
Epoch 40/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 23ms/step - accuracy: 0.7099 - loss: 0.6042 - val_accuracy: 0.8417 - val_loss: 0.5036
Epoch 41/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 23ms/step - accuracy: 0.7099 - loss: 0.6040 - val_accuracy: 0.8417 - val_loss: 0.5023
Epoch 42/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 23ms/step - accuracy: 0.7099 - loss: 0.6038 - val_accuracy: 0.8417 - val_loss: 0.5012
Epoch 43/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 23ms/step - accuracy: 0.7099 - loss: 0.6036 - val_accuracy: 0.8417 - val_loss: 0.5002
Epoch 44/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 23ms/step - accuracy: 0.7099 - loss: 0.6035 - val_accuracy: 0.8417 - val_loss: 0.4988
Epoch 45/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 23ms/step - accuracy: 0.7099 - loss: 0.6033 - val_accuracy: 0.8417 - val_loss: 0.4980
Epoch 46/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 23ms/step - accuracy: 0.7099 - loss: 0.6032 - val_accuracy: 0.8417 - val_loss: 0.4973
Epoch 47/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 23ms/step - accuracy: 0.7099 - loss: 0.6031 - val_accuracy: 0.8417 - val_loss: 0.4965
Epoch 48/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 23ms/step - accuracy: 0.7099 - loss: 0.6030 - val_accuracy: 0.8417 - val_loss: 0.4952
Epoch 49/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 23ms/step - accuracy: 0.7099 - loss: 0.6029 - val_accuracy: 0.8417 - val_loss: 0.4945
Epoch 50/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 23ms/step - accuracy: 0.7099 - loss: 0.6028 - val_accuracy: 0.8417 - val_loss: 0.4941
2025-10-31 11:52:32.012 | INFO     | src.ai_engine.ai_models:fit:685 - LSTM trained successfully.
2025-10-31 11:52:32.028 | INFO     | src.ai_engine.ai_models:fit:381 - Generating base model predictions for meta-model training...
2025-10-31 11:52:32.158 | INFO     | src.ai_engine.feature_engineering:create_sequences:261 - Creating sequences with length 50 from 1242 data points.
2025-10-31 11:52:32.173 | INFO     | src.ai_engine.feature_engineering:create_sequences:270 - Created 1192 sequences.
38/38 ━━━━━━━━━━━━━━━━━━━━ 2s 29ms/step
2025-10-31 11:52:34.232 | INFO     | src.ai_engine.ai_models:fit:396 - Training meta-model...
2025-10-31 11:52:34.239 | SUCCESS  | src.ai_engine.ai_models:fit:399 - Stacking Ensemble trained successfully.
2025-10-31 11:52:34.240 | SUCCESS  | __main__:main:167 - Final Ensemble model trained.
2025-10-31 11:52:34.240 | INFO     | __main__:main:171 - Saving models to 'models\GainX_800\4h'...
2025-10-31 11:52:34.798 | INFO     | src.ai_engine.ai_models:save:52 - Model RandomForest saved to models\GainX_800\4h\random_forest.pkl
2025-10-31 11:52:34.973 | INFO     | src.ai_engine.ai_models:save:52 - Model GradientBoosting saved to models\GainX_800\4h\gradient_boosting.pkl
2025-10-31 11:52:35.333 | INFO     | src.ai_engine.ai_models:save:731 - LSTM model saved to models\GainX_800\4h\lstm.keras, models\GainX_800\4h\lstm_scaler.pkl and marker file models\GainX_800\4h\lstm.pkl
2025-10-31 11:52:35.360 | INFO     | src.ai_engine.ai_models:save_all:463 - Meta-model saved to models\GainX_800\4h\meta_model.pkl
2025-10-31 11:52:35.362 | SUCCESS  | __main__:main:174 - --- Finished training for Symbol: GainX 800, Timeframe: 4h ---
2025-10-31 11:52:35.364 | INFO     | __main__:main:140 - --- Starting training for Symbol: GainX 800, Timeframe: 5m ---
2025-10-31 11:52:35.645 | SUCCESS  | __main__:main:148 - Loaded 86686 records.
2025-10-31 11:52:35.646 | INFO     | __main__:prepare_training_data:32 - Preparing data for training with Meta-Labeling...
2025-10-31 11:52:40.417 | DEBUG    | src.ai_engine.technical_indicators:calculate_all:47 - Calculated 63 technical indicators
2025-10-31 11:52:55.304 | DEBUG    | src.ai_engine.feature_engineering:extract_features:66 - Extracted 116 features
2025-10-31 11:52:55.330 | INFO     | __main__:prepare_training_data:39 - Generating signals from primary model (SimplePatternModel)...
2025-10-31 11:52:55.509 | WARNING  | src.ai_engine.feature_engineering:prepare_for_model:230 - Se perdieron todos los datos al eliminar los NaN. Se conservarán los datos rellenados.
2025-10-31 11:53:09.417 | INFO     | src.ai_engine.ai_models:calculate_optimal_threshold:549 - Calculated optimal threshold: 0.0010 (volatility: 0.0002, avg_movement: 0.0007)
2025-10-31 11:53:09.419 | INFO     | src.ai_engine.ai_models:create_meta_labels:577 - Creating meta-labels for secondary model...
2025-10-31 11:53:22.922 | INFO     | src.ai_engine.ai_models:create_meta_labels:629 - Meta-Label distribution - Profitable: 972 (14.7%), Unprofitable: 5652 (85.3%)
2025-10-31 11:53:23.151 | WARNING  | src.ai_engine.feature_engineering:prepare_for_model:230 - Se perdieron todos los datos al eliminar los NaN. Se conservarán los datos rellenados.
2025-10-31 11:53:23.248 | INFO     | __main__:prepare_training_data:75 - Data preparation complete. Shape of X: (61276, 116), Shape of y: (61276,)
2025-10-31 11:53:23.653 | INFO     | src.ai_engine.feature_engineering:create_sequences:261 - Creating sequences with length 50 from 61276 data points.
2025-10-31 11:53:24.404 | INFO     | src.ai_engine.feature_engineering:create_sequences:270 - Created 61226 sequences.
2025-10-31 11:53:24.415 | INFO     | __main__:main:164 - Initializing and training Ensemble model...
2025-10-31 11:53:24.416 | INFO     | src.ai_engine.ai_models:__init__:304 - Initialized Stacking Ensemble with Logistic Regression as meta-model.
2025-10-31 11:53:24.467 | INFO     | src.ai_engine.ai_models:fit:359 - Creating LSTM model...
2025-10-31 11:53:24.469 | INFO     | src.ai_engine.ai_models:fit:364 - Training base models...
2025-10-31 11:53:24.619 | INFO     | src.ai_engine.ai_models:fit:373 - Training random_forest...
2025-10-31 11:53:44.009 | INFO     | src.ai_engine.ai_models:fit:98 - RandomForest trained successfully on 61276 samples with 2 classes
2025-10-31 11:53:44.012 | INFO     | src.ai_engine.ai_models:fit:373 - Training gradient_boosting...
2025-10-31 12:05:25.118 | INFO     | src.ai_engine.ai_models:fit:157 - GradientBoosting trained successfully on 61276 samples with 2 classes
2025-10-31 12:05:25.121 | INFO     | src.ai_engine.ai_models:fit:373 - Training pattern_based...
2025-10-31 12:05:25.122 | INFO     | src.ai_engine.ai_models:fit:373 - Training lstm...
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\keras\src\layers\rnn\rnn.py:199: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(**kwargs)
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1108: RuntimeWarning: invalid value encountered in divide
  updated_mean = (last_sum + new_sum) / updated_sample_count
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1113: RuntimeWarning: invalid value encountered in divide
  T = new_sum / new_sample_count
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1133: RuntimeWarning: invalid value encountered in divide
  new_unnormalized_variance -= correction**2 / new_sample_count
Epoch 1/50
1722/1722 ━━━━━━━━━━━━━━━━━━━━ 281s 31ms/step - accuracy: 0.9844 - loss: 0.4173 - val_accuracy: 0.9815 - val_loss: 0.2478
Epoch 2/50
1722/1722 ━━━━━━━━━━━━━━━━━━━━ 40s 23ms/step - accuracy: 0.9844 - loss: 0.1741 - val_accuracy: 0.9815 - val_loss: 0.1346
Epoch 3/50
1722/1722 ━━━━━━━━━━━━━━━━━━━━ 40s 23ms/step - accuracy: 0.9844 - loss: 0.1071 - val_accuracy: 0.9815 - val_loss: 0.1018
Epoch 4/50
1722/1722 ━━━━━━━━━━━━━━━━━━━━ 39s 22ms/step - accuracy: 0.9844 - loss: 0.0868 - val_accuracy: 0.9815 - val_loss: 0.0932
Epoch 5/50
1722/1722 ━━━━━━━━━━━━━━━━━━━━ 38s 22ms/step - accuracy: 0.9844 - loss: 0.0814 - val_accuracy: 0.9815 - val_loss: 0.0920
Epoch 6/50
1722/1722 ━━━━━━━━━━━━━━━━━━━━ 38s 22ms/step - accuracy: 0.9844 - loss: 0.0805 - val_accuracy: 0.9815 - val_loss: 0.0921
Epoch 7/50
1722/1722 ━━━━━━━━━━━━━━━━━━━━ 39s 22ms/step - accuracy: 0.9844 - loss: 0.0804 - val_accuracy: 0.9815 - val_loss: 0.0922
Epoch 8/50
1722/1722 ━━━━━━━━━━━━━━━━━━━━ 39s 22ms/step - accuracy: 0.9844 - loss: 0.0803 - val_accuracy: 0.9815 - val_loss: 0.0922
Epoch 9/50
1722/1722 ━━━━━━━━━━━━━━━━━━━━ 39s 22ms/step - accuracy: 0.9844 - loss: 0.0803 - val_accuracy: 0.9815 - val_loss: 0.0922
Epoch 10/50
1722/1722 ━━━━━━━━━━━━━━━━━━━━ 38s 22ms/step - accuracy: 0.9844 - loss: 0.0803 - val_accuracy: 0.9815 - val_loss: 0.0922
Epoch 11/50
1722/1722 ━━━━━━━━━━━━━━━━━━━━ 38s 22ms/step - accuracy: 0.9844 - loss: 0.0803 - val_accuracy: 0.9815 - val_loss: 0.0922
Epoch 12/50
1722/1722 ━━━━━━━━━━━━━━━━━━━━ 38s 22ms/step - accuracy: 0.9844 - loss: 0.0803 - val_accuracy: 0.9815 - val_loss: 0.0922
Epoch 13/50
1722/1722 ━━━━━━━━━━━━━━━━━━━━ 38s 22ms/step - accuracy: 0.9844 - loss: 0.0803 - val_accuracy: 0.9815 - val_loss: 0.0922
Epoch 14/50
1722/1722 ━━━━━━━━━━━━━━━━━━━━ 38s 22ms/step - accuracy: 0.9844 - loss: 0.0803 - val_accuracy: 0.9815 - val_loss: 0.0922
Epoch 15/50
1722/1722 ━━━━━━━━━━━━━━━━━━━━ 38s 22ms/step - accuracy: 0.9844 - loss: 0.0803 - val_accuracy: 0.9815 - val_loss: 0.0922
2025-10-31 12:40:41.930 | INFO     | src.ai_engine.ai_models:fit:685 - LSTM trained successfully.
2025-10-31 12:40:42.741 | INFO     | src.ai_engine.ai_models:fit:381 - Generating base model predictions for meta-model training...
2025-10-31 12:42:37.585 | INFO     | src.ai_engine.feature_engineering:create_sequences:261 - Creating sequences with length 50 from 61276 data points.
2025-10-31 12:42:38.340 | INFO     | src.ai_engine.feature_engineering:create_sequences:270 - Created 61226 sequences.
1914/1914 ━━━━━━━━━━━━━━━━━━━━ 198s 29ms/step
2025-10-31 12:56:16.499 | INFO     | src.ai_engine.ai_models:fit:396 - Training meta-model...
2025-10-31 12:56:20.575 | SUCCESS  | src.ai_engine.ai_models:fit:399 - Stacking Ensemble trained successfully.
2025-10-31 12:56:20.732 | SUCCESS  | __main__:main:167 - Final Ensemble model trained.
2025-10-31 12:56:20.735 | INFO     | __main__:main:171 - Saving models to 'models\GainX_800\5m'...
2025-10-31 12:56:28.256 | INFO     | src.ai_engine.ai_models:save:52 - Model RandomForest saved to models\GainX_800\5m\random_forest.pkl
2025-10-31 12:56:29.456 | INFO     | src.ai_engine.ai_models:save:52 - Model GradientBoosting saved to models\GainX_800\5m\gradient_boosting.pkl
2025-10-31 12:56:34.443 | INFO     | src.ai_engine.ai_models:save:731 - LSTM model saved to models\GainX_800\5m\lstm.keras, models\GainX_800\5m\lstm_scaler.pkl and marker file models\GainX_800\5m\lstm.pkl
2025-10-31 12:56:34.523 | INFO     | src.ai_engine.ai_models:save_all:463 - Meta-model saved to models\GainX_800\5m\meta_model.pkl
2025-10-31 12:56:34.525 | SUCCESS  | __main__:main:174 - --- Finished training for Symbol: GainX 800, Timeframe: 5m ---
2025-10-31 12:56:34.579 | INFO     | __main__:main:140 - --- Starting training for Symbol: GainX 999, Timeframe: 15m ---
2025-10-31 12:56:37.735 | SUCCESS  | __main__:main:148 - Loaded 28898 records.
2025-10-31 12:56:37.738 | INFO     | __main__:prepare_training_data:32 - Preparing data for training with Meta-Labeling...
2025-10-31 12:56:40.875 | DEBUG    | src.ai_engine.technical_indicators:calculate_all:47 - Calculated 63 technical indicators
2025-10-31 12:56:46.726 | DEBUG    | src.ai_engine.feature_engineering:extract_features:66 - Extracted 116 features
2025-10-31 12:56:46.727 | INFO     | __main__:prepare_training_data:39 - Generating signals from primary model (SimplePatternModel)...
2025-10-31 12:56:46.837 | WARNING  | src.ai_engine.feature_engineering:prepare_for_model:230 - Se perdieron todos los datos al eliminar los NaN. Se conservarán los datos rellenados.
2025-10-31 12:56:53.471 | INFO     | src.ai_engine.ai_models:calculate_optimal_threshold:549 - Calculated optimal threshold: 0.0013 (volatility: 0.0004, avg_movement: 0.0018)
2025-10-31 12:56:53.474 | INFO     | src.ai_engine.ai_models:create_meta_labels:577 - Creating meta-labels for secondary model...
2025-10-31 12:56:57.127 | INFO     | src.ai_engine.ai_models:create_meta_labels:629 - Meta-Label distribution - Profitable: 4410 (35.2%), Unprofitable: 8126 (64.8%)
2025-10-31 12:56:57.225 | WARNING  | src.ai_engine.feature_engineering:prepare_for_model:230 - Se perdieron todos los datos al eliminar los NaN. Se conservarán los datos rellenados.
2025-10-31 12:56:57.277 | INFO     | __main__:prepare_training_data:75 - Data preparation complete. Shape of X: (20557, 116), Shape of y: (20557,)
2025-10-31 12:56:57.296 | INFO     | src.ai_engine.feature_engineering:create_sequences:261 - Creating sequences with length 50 from 20557 data points.
2025-10-31 12:56:57.717 | INFO     | src.ai_engine.feature_engineering:create_sequences:270 - Created 20507 sequences.
2025-10-31 12:56:58.110 | INFO     | __main__:main:164 - Initializing and training Ensemble model...
2025-10-31 12:56:58.111 | INFO     | src.ai_engine.ai_models:__init__:304 - Initialized Stacking Ensemble with Logistic Regression as meta-model.
2025-10-31 12:56:58.667 | INFO     | src.ai_engine.ai_models:fit:359 - Creating LSTM model...
2025-10-31 12:56:58.675 | INFO     | src.ai_engine.ai_models:fit:364 - Training base models...
2025-10-31 12:56:58.741 | INFO     | src.ai_engine.ai_models:fit:373 - Training random_forest...
2025-10-31 12:57:08.001 | INFO     | src.ai_engine.ai_models:fit:98 - RandomForest trained successfully on 20557 samples with 2 classes
2025-10-31 12:57:08.002 | INFO     | src.ai_engine.ai_models:fit:373 - Training gradient_boosting...
2025-10-31 13:00:52.018 | INFO     | src.ai_engine.ai_models:fit:157 - GradientBoosting trained successfully on 20557 samples with 2 classes
2025-10-31 13:00:52.020 | INFO     | src.ai_engine.ai_models:fit:373 - Training pattern_based...
2025-10-31 13:00:52.021 | INFO     | src.ai_engine.ai_models:fit:373 - Training lstm...
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\keras\src\layers\rnn\rnn.py:199: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(**kwargs)
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1108: RuntimeWarning: invalid value encountered in divide
  updated_mean = (last_sum + new_sum) / updated_sample_count
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1113: RuntimeWarning: invalid value encountered in divide
  T = new_sum / new_sample_count
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1133: RuntimeWarning: invalid value encountered in divide
  new_unnormalized_variance -= correction**2 / new_sample_count
Epoch 1/50
577/577 ━━━━━━━━━━━━━━━━━━━━ 55s 29ms/step - accuracy: 0.7839 - loss: 0.6309 - val_accuracy: 0.7996 - val_loss: 0.5761
Epoch 2/50
577/577 ━━━━━━━━━━━━━━━━━━━━ 14s 24ms/step - accuracy: 0.7839 - loss: 0.5585 - val_accuracy: 0.7996 - val_loss: 0.5272
Epoch 3/50
577/577 ━━━━━━━━━━━━━━━━━━━━ 13s 23ms/step - accuracy: 0.7839 - loss: 0.5320 - val_accuracy: 0.7996 - val_loss: 0.5096
Epoch 4/50
577/577 ━━━━━━━━━━━━━━━━━━━━ 13s 23ms/step - accuracy: 0.7839 - loss: 0.5241 - val_accuracy: 0.7996 - val_loss: 0.5040
Epoch 5/50
577/577 ━━━━━━━━━━━━━━━━━━━━ 13s 23ms/step - accuracy: 0.7839 - loss: 0.5223 - val_accuracy: 0.7996 - val_loss: 0.5023
Epoch 6/50
577/577 ━━━━━━━━━━━━━━━━━━━━ 13s 23ms/step - accuracy: 0.7839 - loss: 0.5220 - val_accuracy: 0.7996 - val_loss: 0.5019
Epoch 7/50
577/577 ━━━━━━━━━━━━━━━━━━━━ 13s 23ms/step - accuracy: 0.7839 - loss: 0.5219 - val_accuracy: 0.7996 - val_loss: 0.5018
Epoch 8/50
577/577 ━━━━━━━━━━━━━━━━━━━━ 13s 23ms/step - accuracy: 0.7839 - loss: 0.5219 - val_accuracy: 0.7996 - val_loss: 0.5017
Epoch 9/50
577/577 ━━━━━━━━━━━━━━━━━━━━ 13s 23ms/step - accuracy: 0.7839 - loss: 0.5219 - val_accuracy: 0.7996 - val_loss: 0.5017
Epoch 10/50
577/577 ━━━━━━━━━━━━━━━━━━━━ 13s 23ms/step - accuracy: 0.7839 - loss: 0.5219 - val_accuracy: 0.7996 - val_loss: 0.5017
Epoch 11/50
577/577 ━━━━━━━━━━━━━━━━━━━━ 13s 23ms/step - accuracy: 0.7839 - loss: 0.5219 - val_accuracy: 0.7996 - val_loss: 0.5018
Epoch 12/50
577/577 ━━━━━━━━━━━━━━━━━━━━ 13s 22ms/step - accuracy: 0.7839 - loss: 0.5219 - val_accuracy: 0.7996 - val_loss: 0.5016
Epoch 13/50
577/577 ━━━━━━━━━━━━━━━━━━━━ 13s 22ms/step - accuracy: 0.7839 - loss: 0.5219 - val_accuracy: 0.7996 - val_loss: 0.5017
Epoch 14/50
577/577 ━━━━━━━━━━━━━━━━━━━━ 13s 23ms/step - accuracy: 0.7839 - loss: 0.5219 - val_accuracy: 0.7996 - val_loss: 0.5016
Epoch 15/50
577/577 ━━━━━━━━━━━━━━━━━━━━ 13s 23ms/step - accuracy: 0.7839 - loss: 0.5219 - val_accuracy: 0.7996 - val_loss: 0.5016
Epoch 16/50
577/577 ━━━━━━━━━━━━━━━━━━━━ 13s 23ms/step - accuracy: 0.7839 - loss: 0.5219 - val_accuracy: 0.7996 - val_loss: 0.5016
Epoch 17/50
577/577 ━━━━━━━━━━━━━━━━━━━━ 13s 23ms/step - accuracy: 0.7839 - loss: 0.5219 - val_accuracy: 0.7996 - val_loss: 0.5016
Epoch 18/50
577/577 ━━━━━━━━━━━━━━━━━━━━ 13s 23ms/step - accuracy: 0.7839 - loss: 0.5219 - val_accuracy: 0.7996 - val_loss: 0.5016
Epoch 19/50
577/577 ━━━━━━━━━━━━━━━━━━━━ 13s 23ms/step - accuracy: 0.7839 - loss: 0.5219 - val_accuracy: 0.7996 - val_loss: 0.5016
Epoch 20/50
577/577 ━━━━━━━━━━━━━━━━━━━━ 13s 23ms/step - accuracy: 0.7839 - loss: 0.5219 - val_accuracy: 0.7996 - val_loss: 0.5017
Epoch 21/50
577/577 ━━━━━━━━━━━━━━━━━━━━ 13s 23ms/step - accuracy: 0.7839 - loss: 0.5219 - val_accuracy: 0.7996 - val_loss: 0.5017
Epoch 22/50
577/577 ━━━━━━━━━━━━━━━━━━━━ 13s 23ms/step - accuracy: 0.7839 - loss: 0.5219 - val_accuracy: 0.7996 - val_loss: 0.5018
Epoch 23/50
577/577 ━━━━━━━━━━━━━━━━━━━━ 13s 23ms/step - accuracy: 0.7839 - loss: 0.5219 - val_accuracy: 0.7996 - val_loss: 0.5016
Epoch 24/50
577/577 ━━━━━━━━━━━━━━━━━━━━ 13s 23ms/step - accuracy: 0.7839 - loss: 0.5219 - val_accuracy: 0.7996 - val_loss: 0.5016
Epoch 25/50
577/577 ━━━━━━━━━━━━━━━━━━━━ 13s 23ms/step - accuracy: 0.7839 - loss: 0.5219 - val_accuracy: 0.7996 - val_loss: 0.5017
Epoch 26/50
577/577 ━━━━━━━━━━━━━━━━━━━━ 13s 22ms/step - accuracy: 0.7839 - loss: 0.5219 - val_accuracy: 0.7996 - val_loss: 0.5018
Epoch 27/50
577/577 ━━━━━━━━━━━━━━━━━━━━ 13s 23ms/step - accuracy: 0.7839 - loss: 0.5219 - val_accuracy: 0.7996 - val_loss: 0.5017
2025-10-31 13:07:37.879 | INFO     | src.ai_engine.ai_models:fit:685 - LSTM trained successfully.
2025-10-31 13:07:37.960 | INFO     | src.ai_engine.ai_models:fit:381 - Generating base model predictions for meta-model training...
2025-10-31 13:07:39.287 | INFO     | src.ai_engine.feature_engineering:create_sequences:261 - Creating sequences with length 50 from 20557 data points.
2025-10-31 13:07:39.524 | INFO     | src.ai_engine.feature_engineering:create_sequences:270 - Created 20507 sequences.
641/641 ━━━━━━━━━━━━━━━━━━━━ 7s 10ms/step
2025-10-31 13:07:48.571 | INFO     | src.ai_engine.ai_models:fit:396 - Training meta-model...
2025-10-31 13:07:48.585 | SUCCESS  | src.ai_engine.ai_models:fit:399 - Stacking Ensemble trained successfully.
2025-10-31 13:07:48.587 | SUCCESS  | __main__:main:167 - Final Ensemble model trained.
2025-10-31 13:07:48.587 | INFO     | __main__:main:171 - Saving models to 'models\GainX_999\15m'...
2025-10-31 13:07:48.655 | INFO     | src.ai_engine.ai_models:save:52 - Model RandomForest saved to models\GainX_999\15m\random_forest.pkl
2025-10-31 13:07:48.739 | INFO     | src.ai_engine.ai_models:save:52 - Model GradientBoosting saved to models\GainX_999\15m\gradient_boosting.pkl
2025-10-31 13:07:48.967 | INFO     | src.ai_engine.ai_models:save:731 - LSTM model saved to models\GainX_999\15m\lstm.keras, models\GainX_999\15m\lstm_scaler.pkl and marker file models\GainX_999\15m\lstm.pkl
2025-10-31 13:07:48.998 | INFO     | src.ai_engine.ai_models:save_all:463 - Meta-model saved to models\GainX_999\15m\meta_model.pkl
2025-10-31 13:07:48.999 | SUCCESS  | __main__:main:174 - --- Finished training for Symbol: GainX 999, Timeframe: 15m ---
2025-10-31 13:07:49.002 | INFO     | __main__:main:140 - --- Starting training for Symbol: GainX 999, Timeframe: 1d ---
2025-10-31 13:07:49.038 | SUCCESS  | __main__:main:148 - Loaded 302 records.
2025-10-31 13:07:49.039 | INFO     | __main__:prepare_training_data:32 - Preparing data for training with Meta-Labeling...
2025-10-31 13:07:49.140 | DEBUG    | src.ai_engine.technical_indicators:calculate_all:47 - Calculated 62 technical indicators
2025-10-31 13:07:49.213 | DEBUG    | src.ai_engine.feature_engineering:extract_features:66 - Extracted 116 features
2025-10-31 13:07:49.214 | INFO     | __main__:prepare_training_data:39 - Generating signals from primary model (SimplePatternModel)...
2025-10-31 13:07:49.218 | WARNING  | src.ai_engine.feature_engineering:prepare_for_model:230 - Se perdieron todos los datos al eliminar los NaN. Se conservarán los datos rellenados.
2025-10-31 13:07:49.270 | INFO     | src.ai_engine.ai_models:calculate_optimal_threshold:549 - Calculated optimal threshold: 0.0097 (volatility: 0.0039, avg_movement: 0.0138)
2025-10-31 13:07:49.271 | INFO     | src.ai_engine.ai_models:create_meta_labels:577 - Creating meta-labels for secondary model...
2025-10-31 13:07:49.303 | INFO     | src.ai_engine.ai_models:create_meta_labels:629 - Meta-Label distribution - Profitable: 56 (36.6%), Unprofitable: 97 (63.4%)
2025-10-31 13:07:49.309 | WARNING  | src.ai_engine.feature_engineering:prepare_for_model:230 - Se perdieron todos los datos al eliminar los NaN. Se conservarán los datos rellenados.
2025-10-31 13:07:49.311 | INFO     | __main__:prepare_training_data:75 - Data preparation complete. Shape of X: (201, 116), Shape of y: (201,)
2025-10-31 13:07:49.313 | INFO     | src.ai_engine.feature_engineering:create_sequences:261 - Creating sequences with length 50 from 201 data points.
2025-10-31 13:07:49.316 | INFO     | src.ai_engine.feature_engineering:create_sequences:270 - Created 151 sequences.
2025-10-31 13:07:49.380 | INFO     | __main__:main:164 - Initializing and training Ensemble model...
2025-10-31 13:07:49.380 | INFO     | src.ai_engine.ai_models:__init__:304 - Initialized Stacking Ensemble with Logistic Regression as meta-model.
2025-10-31 13:07:49.433 | INFO     | src.ai_engine.ai_models:fit:359 - Creating LSTM model...
2025-10-31 13:07:49.434 | INFO     | src.ai_engine.ai_models:fit:364 - Training base models...
2025-10-31 13:07:49.436 | INFO     | src.ai_engine.ai_models:fit:373 - Training random_forest...
2025-10-31 13:07:50.036 | INFO     | src.ai_engine.ai_models:fit:98 - RandomForest trained successfully on 201 samples with 2 classes
2025-10-31 13:07:50.036 | INFO     | src.ai_engine.ai_models:fit:373 - Training gradient_boosting...
2025-10-31 13:07:51.646 | INFO     | src.ai_engine.ai_models:fit:157 - GradientBoosting trained successfully on 201 samples with 2 classes
2025-10-31 13:07:51.646 | INFO     | src.ai_engine.ai_models:fit:373 - Training pattern_based...
2025-10-31 13:07:51.648 | INFO     | src.ai_engine.ai_models:fit:373 - Training lstm...
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\keras\src\layers\rnn\rnn.py:199: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(**kwargs)
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1108: RuntimeWarning: invalid value encountered in divide
  updated_mean = (last_sum + new_sum) / updated_sample_count
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1113: RuntimeWarning: invalid value encountered in divide
  T = new_sum / new_sample_count
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1133: RuntimeWarning: invalid value encountered in divide
  new_unnormalized_variance -= correction**2 / new_sample_count
Epoch 1/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 10s 497ms/step - accuracy: 0.6667 - loss: 0.6928 - val_accuracy: 1.0000 - val_loss: 0.6908
Epoch 2/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 85ms/step - accuracy: 0.6667 - loss: 0.6922 - val_accuracy: 1.0000 - val_loss: 0.6886
Epoch 3/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 74ms/step - accuracy: 0.6667 - loss: 0.6915 - val_accuracy: 1.0000 - val_loss: 0.6864
Epoch 4/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 76ms/step - accuracy: 0.6667 - loss: 0.6907 - val_accuracy: 1.0000 - val_loss: 0.6843
Epoch 5/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 36ms/step - accuracy: 0.6667 - loss: 0.6900 - val_accuracy: 1.0000 - val_loss: 0.6821
Epoch 6/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 35ms/step - accuracy: 0.6667 - loss: 0.6892 - val_accuracy: 1.0000 - val_loss: 0.6799
Epoch 7/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 35ms/step - accuracy: 0.6667 - loss: 0.6886 - val_accuracy: 1.0000 - val_loss: 0.6776
Epoch 8/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 35ms/step - accuracy: 0.6667 - loss: 0.6879 - val_accuracy: 1.0000 - val_loss: 0.6755
Epoch 9/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 46ms/step - accuracy: 0.6667 - loss: 0.6871 - val_accuracy: 1.0000 - val_loss: 0.6735
Epoch 10/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 62ms/step - accuracy: 0.6667 - loss: 0.6865 - val_accuracy: 1.0000 - val_loss: 0.6714
Epoch 11/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 35ms/step - accuracy: 0.6667 - loss: 0.6858 - val_accuracy: 1.0000 - val_loss: 0.6693
Epoch 12/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 35ms/step - accuracy: 0.6667 - loss: 0.6851 - val_accuracy: 1.0000 - val_loss: 0.6672
Epoch 13/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 35ms/step - accuracy: 0.6667 - loss: 0.6846 - val_accuracy: 1.0000 - val_loss: 0.6653
Epoch 14/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 40ms/step - accuracy: 0.6667 - loss: 0.6839 - val_accuracy: 1.0000 - val_loss: 0.6635
Epoch 15/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 39ms/step - accuracy: 0.6667 - loss: 0.6834 - val_accuracy: 1.0000 - val_loss: 0.6615
Epoch 16/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 35ms/step - accuracy: 0.6667 - loss: 0.6828 - val_accuracy: 1.0000 - val_loss: 0.6595
Epoch 17/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 35ms/step - accuracy: 0.6667 - loss: 0.6822 - val_accuracy: 1.0000 - val_loss: 0.6577
Epoch 18/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 35ms/step - accuracy: 0.6667 - loss: 0.6815 - val_accuracy: 1.0000 - val_loss: 0.6560
Epoch 19/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 35ms/step - accuracy: 0.6667 - loss: 0.6810 - val_accuracy: 1.0000 - val_loss: 0.6540
Epoch 20/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 35ms/step - accuracy: 0.6667 - loss: 0.6804 - val_accuracy: 1.0000 - val_loss: 0.6521
Epoch 21/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 35ms/step - accuracy: 0.6667 - loss: 0.6798 - val_accuracy: 1.0000 - val_loss: 0.6504
Epoch 22/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 35ms/step - accuracy: 0.6667 - loss: 0.6794 - val_accuracy: 1.0000 - val_loss: 0.6487
Epoch 23/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 40ms/step - accuracy: 0.6667 - loss: 0.6788 - val_accuracy: 1.0000 - val_loss: 0.6470
Epoch 24/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 35ms/step - accuracy: 0.6667 - loss: 0.6783 - val_accuracy: 1.0000 - val_loss: 0.6452
Epoch 25/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 35ms/step - accuracy: 0.6667 - loss: 0.6777 - val_accuracy: 1.0000 - val_loss: 0.6433
Epoch 26/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 35ms/step - accuracy: 0.6667 - loss: 0.6773 - val_accuracy: 1.0000 - val_loss: 0.6412
Epoch 27/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 35ms/step - accuracy: 0.6667 - loss: 0.6765 - val_accuracy: 1.0000 - val_loss: 0.6393
Epoch 28/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 35ms/step - accuracy: 0.6667 - loss: 0.6760 - val_accuracy: 1.0000 - val_loss: 0.6373
Epoch 29/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 34ms/step - accuracy: 0.6667 - loss: 0.6754 - val_accuracy: 1.0000 - val_loss: 0.6354
Epoch 30/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 35ms/step - accuracy: 0.6667 - loss: 0.6749 - val_accuracy: 1.0000 - val_loss: 0.6335
Epoch 31/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 35ms/step - accuracy: 0.6667 - loss: 0.6743 - val_accuracy: 1.0000 - val_loss: 0.6318
Epoch 32/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 41ms/step - accuracy: 0.6667 - loss: 0.6739 - val_accuracy: 1.0000 - val_loss: 0.6299
Epoch 33/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 35ms/step - accuracy: 0.6667 - loss: 0.6734 - val_accuracy: 1.0000 - val_loss: 0.6280
Epoch 34/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 35ms/step - accuracy: 0.6667 - loss: 0.6728 - val_accuracy: 1.0000 - val_loss: 0.6263
Epoch 35/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 35ms/step - accuracy: 0.6667 - loss: 0.6724 - val_accuracy: 1.0000 - val_loss: 0.6248
Epoch 36/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 35ms/step - accuracy: 0.6667 - loss: 0.6719 - val_accuracy: 1.0000 - val_loss: 0.6234
Epoch 37/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 44ms/step - accuracy: 0.6667 - loss: 0.6715 - val_accuracy: 1.0000 - val_loss: 0.6221
Epoch 38/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 35ms/step - accuracy: 0.6667 - loss: 0.6711 - val_accuracy: 1.0000 - val_loss: 0.6206
Epoch 39/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 35ms/step - accuracy: 0.6667 - loss: 0.6707 - val_accuracy: 1.0000 - val_loss: 0.6189
Epoch 40/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 35ms/step - accuracy: 0.6667 - loss: 0.6701 - val_accuracy: 1.0000 - val_loss: 0.6171
Epoch 41/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 35ms/step - accuracy: 0.6667 - loss: 0.6697 - val_accuracy: 1.0000 - val_loss: 0.6152
Epoch 42/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 35ms/step - accuracy: 0.6667 - loss: 0.6692 - val_accuracy: 1.0000 - val_loss: 0.6133
Epoch 43/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 35ms/step - accuracy: 0.6667 - loss: 0.6686 - val_accuracy: 1.0000 - val_loss: 0.6114
Epoch 44/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 35ms/step - accuracy: 0.6667 - loss: 0.6682 - val_accuracy: 1.0000 - val_loss: 0.6097
Epoch 45/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 35ms/step - accuracy: 0.6667 - loss: 0.6677 - val_accuracy: 1.0000 - val_loss: 0.6080
Epoch 46/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 35ms/step - accuracy: 0.6667 - loss: 0.6673 - val_accuracy: 1.0000 - val_loss: 0.6062
Epoch 47/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 35ms/step - accuracy: 0.6667 - loss: 0.6668 - val_accuracy: 1.0000 - val_loss: 0.6047
Epoch 48/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 35ms/step - accuracy: 0.6667 - loss: 0.6664 - val_accuracy: 1.0000 - val_loss: 0.6030
Epoch 49/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 35ms/step - accuracy: 0.6667 - loss: 0.6659 - val_accuracy: 1.0000 - val_loss: 0.6015
Epoch 50/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 35ms/step - accuracy: 0.6667 - loss: 0.6655 - val_accuracy: 1.0000 - val_loss: 0.5999
2025-10-31 13:08:11.832 | INFO     | src.ai_engine.ai_models:fit:685 - LSTM trained successfully.
2025-10-31 13:08:11.833 | INFO     | src.ai_engine.ai_models:fit:381 - Generating base model predictions for meta-model training...
2025-10-31 13:08:11.849 | INFO     | src.ai_engine.feature_engineering:create_sequences:261 - Creating sequences with length 50 from 201 data points.
2025-10-31 13:08:11.852 | INFO     | src.ai_engine.feature_engineering:create_sequences:270 - Created 151 sequences.
5/5 ━━━━━━━━━━━━━━━━━━━━ 1s 185ms/step
2025-10-31 13:08:13.125 | INFO     | src.ai_engine.ai_models:fit:396 - Training meta-model...
2025-10-31 13:08:13.142 | SUCCESS  | src.ai_engine.ai_models:fit:399 - Stacking Ensemble trained successfully.
2025-10-31 13:08:13.144 | SUCCESS  | __main__:main:167 - Final Ensemble model trained.
2025-10-31 13:08:13.144 | INFO     | __main__:main:171 - Saving models to 'models\GainX_999\1d'...
2025-10-31 13:08:13.235 | INFO     | src.ai_engine.ai_models:save:52 - Model RandomForest saved to models\GainX_999\1d\random_forest.pkl
2025-10-31 13:08:13.270 | INFO     | src.ai_engine.ai_models:save:52 - Model GradientBoosting saved to models\GainX_999\1d\gradient_boosting.pkl
2025-10-31 13:08:13.432 | INFO     | src.ai_engine.ai_models:save:731 - LSTM model saved to models\GainX_999\1d\lstm.keras, models\GainX_999\1d\lstm_scaler.pkl and marker file models\GainX_999\1d\lstm.pkl
2025-10-31 13:08:13.437 | INFO     | src.ai_engine.ai_models:save_all:463 - Meta-model saved to models\GainX_999\1d\meta_model.pkl
2025-10-31 13:08:13.439 | SUCCESS  | __main__:main:174 - --- Finished training for Symbol: GainX 999, Timeframe: 1d ---
2025-10-31 13:08:13.442 | INFO     | __main__:main:140 - --- Starting training for Symbol: GainX 999, Timeframe: 1h ---
2025-10-31 13:08:13.576 | SUCCESS  | __main__:main:148 - Loaded 7227 records.
2025-10-31 13:08:13.577 | INFO     | __main__:prepare_training_data:32 - Preparing data for training with Meta-Labeling...
2025-10-31 13:08:14.031 | DEBUG    | src.ai_engine.technical_indicators:calculate_all:47 - Calculated 63 technical indicators
2025-10-31 13:08:15.280 | DEBUG    | src.ai_engine.feature_engineering:extract_features:66 - Extracted 116 features
2025-10-31 13:08:15.280 | INFO     | __main__:prepare_training_data:39 - Generating signals from primary model (SimplePatternModel)...
2025-10-31 13:08:15.299 | WARNING  | src.ai_engine.feature_engineering:prepare_for_model:230 - Se perdieron todos los datos al eliminar los NaN. Se conservarán los datos rellenados.
2025-10-31 13:08:16.447 | INFO     | src.ai_engine.ai_models:calculate_optimal_threshold:549 - Calculated optimal threshold: 0.0025 (volatility: 0.0008, avg_movement: 0.0035)
2025-10-31 13:08:16.448 | INFO     | src.ai_engine.ai_models:create_meta_labels:577 - Creating meta-labels for secondary model...
2025-10-31 13:08:17.333 | INFO     | src.ai_engine.ai_models:create_meta_labels:629 - Meta-Label distribution - Profitable: 1182 (35.0%), Unprofitable: 2191 (65.0%)
2025-10-31 13:08:17.357 | WARNING  | src.ai_engine.feature_engineering:prepare_for_model:230 - Se perdieron todos los datos al eliminar los NaN. Se conservarán los datos rellenados.
2025-10-31 13:08:17.367 | INFO     | __main__:prepare_training_data:75 - Data preparation complete. Shape of X: (5183, 116), Shape of y: (5183,)
2025-10-31 13:08:17.371 | INFO     | src.ai_engine.feature_engineering:create_sequences:261 - Creating sequences with length 50 from 5183 data points.
2025-10-31 13:08:17.432 | INFO     | src.ai_engine.feature_engineering:create_sequences:270 - Created 5133 sequences.
2025-10-31 13:08:17.434 | INFO     | __main__:main:164 - Initializing and training Ensemble model...
2025-10-31 13:08:17.435 | INFO     | src.ai_engine.ai_models:__init__:304 - Initialized Stacking Ensemble with Logistic Regression as meta-model.
2025-10-31 13:08:17.438 | INFO     | src.ai_engine.ai_models:fit:359 - Creating LSTM model...
2025-10-31 13:08:17.439 | INFO     | src.ai_engine.ai_models:fit:364 - Training base models...
2025-10-31 13:08:17.447 | INFO     | src.ai_engine.ai_models:fit:373 - Training random_forest...
2025-10-31 13:08:19.365 | INFO     | src.ai_engine.ai_models:fit:98 - RandomForest trained successfully on 5183 samples with 2 classes
2025-10-31 13:08:19.366 | INFO     | src.ai_engine.ai_models:fit:373 - Training gradient_boosting...
2025-10-31 13:09:11.178 | INFO     | src.ai_engine.ai_models:fit:157 - GradientBoosting trained successfully on 5183 samples with 2 classes
2025-10-31 13:09:11.179 | INFO     | src.ai_engine.ai_models:fit:373 - Training pattern_based...
2025-10-31 13:09:11.180 | INFO     | src.ai_engine.ai_models:fit:373 - Training lstm...
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\keras\src\layers\rnn\rnn.py:199: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(**kwargs)
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1108: RuntimeWarning: invalid value encountered in divide
  updated_mean = (last_sum + new_sum) / updated_sample_count
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1113: RuntimeWarning: invalid value encountered in divide
  T = new_sum / new_sample_count
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1133: RuntimeWarning: invalid value encountered in divide
  new_unnormalized_variance -= correction**2 / new_sample_count
Epoch 1/50
145/145 ━━━━━━━━━━━━━━━━━━━━ 8s 27ms/step - accuracy: 0.7647 - loss: 0.6762 - val_accuracy: 0.8424 - val_loss: 0.6494
Epoch 2/50
145/145 ━━━━━━━━━━━━━━━━━━━━ 3s 23ms/step - accuracy: 0.7647 - loss: 0.6460 - val_accuracy: 0.8424 - val_loss: 0.6122
Epoch 3/50
145/145 ━━━━━━━━━━━━━━━━━━━━ 3s 23ms/step - accuracy: 0.7647 - loss: 0.6216 - val_accuracy: 0.8424 - val_loss: 0.5816
Epoch 4/50
145/145 ━━━━━━━━━━━━━━━━━━━━ 3s 23ms/step - accuracy: 0.7647 - loss: 0.6023 - val_accuracy: 0.8424 - val_loss: 0.5565
Epoch 5/50
145/145 ━━━━━━━━━━━━━━━━━━━━ 3s 23ms/step - accuracy: 0.7647 - loss: 0.5873 - val_accuracy: 0.8424 - val_loss: 0.5359
Epoch 6/50
145/145 ━━━━━━━━━━━━━━━━━━━━ 3s 23ms/step - accuracy: 0.7647 - loss: 0.5759 - val_accuracy: 0.8424 - val_loss: 0.5191
Epoch 7/50
145/145 ━━━━━━━━━━━━━━━━━━━━ 3s 23ms/step - accuracy: 0.7647 - loss: 0.5673 - val_accuracy: 0.8424 - val_loss: 0.5060
Epoch 8/50
145/145 ━━━━━━━━━━━━━━━━━━━━ 3s 23ms/step - accuracy: 0.7647 - loss: 0.5609 - val_accuracy: 0.8424 - val_loss: 0.4950
Epoch 9/50
145/145 ━━━━━━━━━━━━━━━━━━━━ 3s 22ms/step - accuracy: 0.7647 - loss: 0.5562 - val_accuracy: 0.8424 - val_loss: 0.4863
Epoch 10/50
145/145 ━━━━━━━━━━━━━━━━━━━━ 3s 23ms/step - accuracy: 0.7647 - loss: 0.5528 - val_accuracy: 0.8424 - val_loss: 0.4790
Epoch 11/50
145/145 ━━━━━━━━━━━━━━━━━━━━ 3s 23ms/step - accuracy: 0.7647 - loss: 0.5505 - val_accuracy: 0.8424 - val_loss: 0.4738
Epoch 12/50
145/145 ━━━━━━━━━━━━━━━━━━━━ 3s 22ms/step - accuracy: 0.7647 - loss: 0.5489 - val_accuracy: 0.8424 - val_loss: 0.4695
Epoch 13/50
145/145 ━━━━━━━━━━━━━━━━━━━━ 3s 22ms/step - accuracy: 0.7647 - loss: 0.5477 - val_accuracy: 0.8424 - val_loss: 0.4659
Epoch 14/50
145/145 ━━━━━━━━━━━━━━━━━━━━ 3s 22ms/step - accuracy: 0.7647 - loss: 0.5470 - val_accuracy: 0.8424 - val_loss: 0.4634
Epoch 15/50
145/145 ━━━━━━━━━━━━━━━━━━━━ 3s 22ms/step - accuracy: 0.7647 - loss: 0.5465 - val_accuracy: 0.8424 - val_loss: 0.4613
Epoch 16/50
145/145 ━━━━━━━━━━━━━━━━━━━━ 3s 22ms/step - accuracy: 0.7647 - loss: 0.5462 - val_accuracy: 0.8424 - val_loss: 0.4594
Epoch 17/50
145/145 ━━━━━━━━━━━━━━━━━━━━ 3s 22ms/step - accuracy: 0.7647 - loss: 0.5460 - val_accuracy: 0.8424 - val_loss: 0.4584
Epoch 18/50
145/145 ━━━━━━━━━━━━━━━━━━━━ 3s 22ms/step - accuracy: 0.7647 - loss: 0.5458 - val_accuracy: 0.8424 - val_loss: 0.4573
Epoch 19/50
145/145 ━━━━━━━━━━━━━━━━━━━━ 3s 22ms/step - accuracy: 0.7647 - loss: 0.5458 - val_accuracy: 0.8424 - val_loss: 0.4565
Epoch 20/50
145/145 ━━━━━━━━━━━━━━━━━━━━ 3s 23ms/step - accuracy: 0.7647 - loss: 0.5457 - val_accuracy: 0.8424 - val_loss: 0.4557
Epoch 21/50
145/145 ━━━━━━━━━━━━━━━━━━━━ 3s 22ms/step - accuracy: 0.7647 - loss: 0.5457 - val_accuracy: 0.8424 - val_loss: 0.4552
Epoch 22/50
145/145 ━━━━━━━━━━━━━━━━━━━━ 3s 22ms/step - accuracy: 0.7647 - loss: 0.5457 - val_accuracy: 0.8424 - val_loss: 0.4549
Epoch 23/50
145/145 ━━━━━━━━━━━━━━━━━━━━ 3s 22ms/step - accuracy: 0.7647 - loss: 0.5457 - val_accuracy: 0.8424 - val_loss: 0.4548
Epoch 24/50
145/145 ━━━━━━━━━━━━━━━━━━━━ 3s 22ms/step - accuracy: 0.7647 - loss: 0.5457 - val_accuracy: 0.8424 - val_loss: 0.4546
Epoch 25/50
145/145 ━━━━━━━━━━━━━━━━━━━━ 3s 22ms/step - accuracy: 0.7647 - loss: 0.5457 - val_accuracy: 0.8424 - val_loss: 0.4545
Epoch 26/50
145/145 ━━━━━━━━━━━━━━━━━━━━ 3s 22ms/step - accuracy: 0.7647 - loss: 0.5457 - val_accuracy: 0.8424 - val_loss: 0.4545
Epoch 27/50
145/145 ━━━━━━━━━━━━━━━━━━━━ 3s 23ms/step - accuracy: 0.7647 - loss: 0.5457 - val_accuracy: 0.8424 - val_loss: 0.4543
Epoch 28/50
145/145 ━━━━━━━━━━━━━━━━━━━━ 3s 22ms/step - accuracy: 0.7647 - loss: 0.5457 - val_accuracy: 0.8424 - val_loss: 0.4540
Epoch 29/50
145/145 ━━━━━━━━━━━━━━━━━━━━ 3s 22ms/step - accuracy: 0.7647 - loss: 0.5457 - val_accuracy: 0.8424 - val_loss: 0.4545
Epoch 30/50
145/145 ━━━━━━━━━━━━━━━━━━━━ 3s 22ms/step - accuracy: 0.7647 - loss: 0.5457 - val_accuracy: 0.8424 - val_loss: 0.4542
Epoch 31/50
145/145 ━━━━━━━━━━━━━━━━━━━━ 3s 23ms/step - accuracy: 0.7647 - loss: 0.5457 - val_accuracy: 0.8424 - val_loss: 0.4540
Epoch 32/50
145/145 ━━━━━━━━━━━━━━━━━━━━ 3s 22ms/step - accuracy: 0.7647 - loss: 0.5457 - val_accuracy: 0.8424 - val_loss: 0.4537
Epoch 33/50
145/145 ━━━━━━━━━━━━━━━━━━━━ 3s 22ms/step - accuracy: 0.7647 - loss: 0.5457 - val_accuracy: 0.8424 - val_loss: 0.4538
Epoch 34/50
145/145 ━━━━━━━━━━━━━━━━━━━━ 3s 22ms/step - accuracy: 0.7647 - loss: 0.5457 - val_accuracy: 0.8424 - val_loss: 0.4536
Epoch 35/50
145/145 ━━━━━━━━━━━━━━━━━━━━ 3s 22ms/step - accuracy: 0.7647 - loss: 0.5457 - val_accuracy: 0.8424 - val_loss: 0.4535
Epoch 36/50
145/145 ━━━━━━━━━━━━━━━━━━━━ 3s 22ms/step - accuracy: 0.7647 - loss: 0.5457 - val_accuracy: 0.8424 - val_loss: 0.4540
Epoch 37/50
145/145 ━━━━━━━━━━━━━━━━━━━━ 3s 22ms/step - accuracy: 0.7647 - loss: 0.5457 - val_accuracy: 0.8424 - val_loss: 0.4541
Epoch 38/50
145/145 ━━━━━━━━━━━━━━━━━━━━ 3s 22ms/step - accuracy: 0.7647 - loss: 0.5457 - val_accuracy: 0.8424 - val_loss: 0.4541
Epoch 39/50
145/145 ━━━━━━━━━━━━━━━━━━━━ 3s 22ms/step - accuracy: 0.7647 - loss: 0.5457 - val_accuracy: 0.8424 - val_loss: 0.4541
Epoch 40/50
145/145 ━━━━━━━━━━━━━━━━━━━━ 3s 22ms/step - accuracy: 0.7647 - loss: 0.5457 - val_accuracy: 0.8424 - val_loss: 0.4540
Epoch 41/50
145/145 ━━━━━━━━━━━━━━━━━━━━ 3s 22ms/step - accuracy: 0.7647 - loss: 0.5457 - val_accuracy: 0.8424 - val_loss: 0.4539
Epoch 42/50
145/145 ━━━━━━━━━━━━━━━━━━━━ 3s 22ms/step - accuracy: 0.7647 - loss: 0.5457 - val_accuracy: 0.8424 - val_loss: 0.4537
Epoch 43/50
145/145 ━━━━━━━━━━━━━━━━━━━━ 3s 22ms/step - accuracy: 0.7647 - loss: 0.5457 - val_accuracy: 0.8424 - val_loss: 0.4538
Epoch 44/50
145/145 ━━━━━━━━━━━━━━━━━━━━ 3s 22ms/step - accuracy: 0.7647 - loss: 0.5457 - val_accuracy: 0.8424 - val_loss: 0.4539
Epoch 45/50
145/145 ━━━━━━━━━━━━━━━━━━━━ 3s 22ms/step - accuracy: 0.7647 - loss: 0.5457 - val_accuracy: 0.8424 - val_loss: 0.4536
2025-10-31 13:11:44.485 | INFO     | src.ai_engine.ai_models:fit:685 - LSTM trained successfully.
2025-10-31 13:11:44.494 | INFO     | src.ai_engine.ai_models:fit:381 - Generating base model predictions for meta-model training...
2025-10-31 13:11:44.828 | INFO     | src.ai_engine.feature_engineering:create_sequences:261 - Creating sequences with length 50 from 5183 data points.
2025-10-31 13:11:44.887 | INFO     | src.ai_engine.feature_engineering:create_sequences:270 - Created 5133 sequences.
161/161 ━━━━━━━━━━━━━━━━━━━━ 2s 11ms/step
2025-10-31 13:11:47.801 | INFO     | src.ai_engine.ai_models:fit:396 - Training meta-model...
2025-10-31 13:11:47.808 | SUCCESS  | src.ai_engine.ai_models:fit:399 - Stacking Ensemble trained successfully.
2025-10-31 13:11:47.809 | SUCCESS  | __main__:main:167 - Final Ensemble model trained.
2025-10-31 13:11:47.809 | INFO     | __main__:main:171 - Saving models to 'models\GainX_999\1h'...
2025-10-31 13:11:47.897 | INFO     | src.ai_engine.ai_models:save:52 - Model RandomForest saved to models\GainX_999\1h\random_forest.pkl
2025-10-31 13:11:47.953 | INFO     | src.ai_engine.ai_models:save:52 - Model GradientBoosting saved to models\GainX_999\1h\gradient_boosting.pkl
2025-10-31 13:11:48.124 | INFO     | src.ai_engine.ai_models:save:731 - LSTM model saved to models\GainX_999\1h\lstm.keras, models\GainX_999\1h\lstm_scaler.pkl and marker file models\GainX_999\1h\lstm.pkl
2025-10-31 13:11:48.149 | INFO     | src.ai_engine.ai_models:save_all:463 - Meta-model saved to models\GainX_999\1h\meta_model.pkl
2025-10-31 13:11:48.150 | SUCCESS  | __main__:main:174 - --- Finished training for Symbol: GainX 999, Timeframe: 1h ---
2025-10-31 13:11:48.153 | INFO     | __main__:main:140 - --- Starting training for Symbol: GainX 999, Timeframe: 1m ---
2025-10-31 13:11:48.495 | SUCCESS  | __main__:main:148 - Loaded 100001 records.
2025-10-31 13:11:48.496 | INFO     | __main__:prepare_training_data:32 - Preparing data for training with Meta-Labeling...
2025-10-31 13:11:53.957 | DEBUG    | src.ai_engine.technical_indicators:calculate_all:47 - Calculated 63 technical indicators
2025-10-31 13:12:10.929 | DEBUG    | src.ai_engine.feature_engineering:extract_features:66 - Extracted 116 features
2025-10-31 13:12:11.091 | INFO     | __main__:prepare_training_data:39 - Generating signals from primary model (SimplePatternModel)...
2025-10-31 13:12:11.325 | WARNING  | src.ai_engine.feature_engineering:prepare_for_model:230 - Se perdieron todos los datos al eliminar los NaN. Se conservarán los datos rellenados.
2025-10-31 13:12:27.104 | INFO     | src.ai_engine.ai_models:calculate_optimal_threshold:549 - Calculated optimal threshold: 0.0010 (volatility: 0.0001, avg_movement: 0.0004)
2025-10-31 13:12:27.106 | INFO     | src.ai_engine.ai_models:create_meta_labels:577 - Creating meta-labels for secondary model...
2025-10-31 13:12:39.146 | INFO     | src.ai_engine.ai_models:create_meta_labels:629 - Meta-Label distribution - Profitable: 136 (11.8%), Unprofitable: 1017 (88.2%)
2025-10-31 13:12:39.385 | WARNING  | src.ai_engine.feature_engineering:prepare_for_model:230 - Se perdieron todos los datos al eliminar los NaN. Se conservarán los datos rellenados.
2025-10-31 13:12:39.476 | INFO     | __main__:prepare_training_data:75 - Data preparation complete. Shape of X: (53809, 116), Shape of y: (53809,)
2025-10-31 13:12:39.517 | INFO     | src.ai_engine.feature_engineering:create_sequences:261 - Creating sequences with length 50 from 53809 data points.
2025-10-31 13:12:40.167 | INFO     | src.ai_engine.feature_engineering:create_sequences:270 - Created 53759 sequences.
2025-10-31 13:12:40.180 | INFO     | __main__:main:164 - Initializing and training Ensemble model...
2025-10-31 13:12:40.181 | INFO     | src.ai_engine.ai_models:__init__:304 - Initialized Stacking Ensemble with Logistic Regression as meta-model.
2025-10-31 13:12:40.183 | INFO     | src.ai_engine.ai_models:fit:359 - Creating LSTM model...
2025-10-31 13:12:40.183 | INFO     | src.ai_engine.ai_models:fit:364 - Training base models...
2025-10-31 13:12:40.288 | INFO     | src.ai_engine.ai_models:fit:373 - Training random_forest...
2025-10-31 13:12:54.463 | INFO     | src.ai_engine.ai_models:fit:98 - RandomForest trained successfully on 53809 samples with 2 classes
2025-10-31 13:12:54.466 | INFO     | src.ai_engine.ai_models:fit:373 - Training gradient_boosting...
2025-10-31 13:21:57.227 | INFO     | src.ai_engine.ai_models:fit:157 - GradientBoosting trained successfully on 53809 samples with 2 classes
2025-10-31 13:21:57.230 | INFO     | src.ai_engine.ai_models:fit:373 - Training pattern_based...
2025-10-31 13:21:57.230 | INFO     | src.ai_engine.ai_models:fit:373 - Training lstm...
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\keras\src\layers\rnn\rnn.py:199: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(**kwargs)
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1108: RuntimeWarning: invalid value encountered in divide
  updated_mean = (last_sum + new_sum) / updated_sample_count
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1113: RuntimeWarning: invalid value encountered in divide
  T = new_sum / new_sample_count
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1133: RuntimeWarning: invalid value encountered in divide
  new_unnormalized_variance -= correction**2 / new_sample_count
Epoch 1/50
1512/1512 ━━━━━━━━━━━━━━━━━━━━ 190s 27ms/step - accuracy: 0.9975 - loss: 0.4296 - val_accuracy: 0.9974 - val_loss: 0.2524
Epoch 2/50
1512/1512 ━━━━━━━━━━━━━━━━━━━━ 35s 23ms/step - accuracy: 0.9975 - loss: 0.1706 - val_accuracy: 0.9974 - val_loss: 0.1129
Epoch 3/50
1512/1512 ━━━━━━━━━━━━━━━━━━━━ 34s 23ms/step - accuracy: 0.9975 - loss: 0.0821 - val_accuracy: 0.9974 - val_loss: 0.0594
Epoch 4/50
1512/1512 ━━━━━━━━━━━━━━━━━━━━ 34s 22ms/step - accuracy: 0.9975 - loss: 0.0460 - val_accuracy: 0.9974 - val_loss: 0.0362
Epoch 5/50
1512/1512 ━━━━━━━━━━━━━━━━━━━━ 33s 22ms/step - accuracy: 0.9975 - loss: 0.0298 - val_accuracy: 0.9974 - val_loss: 0.0255
Epoch 6/50
1512/1512 ━━━━━━━━━━━━━━━━━━━━ 34s 22ms/step - accuracy: 0.9975 - loss: 0.0225 - val_accuracy: 0.9974 - val_loss: 0.0209
Epoch 7/50
1512/1512 ━━━━━━━━━━━━━━━━━━━━ 34s 22ms/step - accuracy: 0.9975 - loss: 0.0194 - val_accuracy: 0.9974 - val_loss: 0.0190
Epoch 8/50
1512/1512 ━━━━━━━━━━━━━━━━━━━━ 34s 22ms/step - accuracy: 0.9975 - loss: 0.0182 - val_accuracy: 0.9974 - val_loss: 0.0184
Epoch 9/50
1512/1512 ━━━━━━━━━━━━━━━━━━━━ 33s 22ms/step - accuracy: 0.9975 - loss: 0.0178 - val_accuracy: 0.9974 - val_loss: 0.0182
Epoch 10/50
1512/1512 ━━━━━━━━━━━━━━━━━━━━ 34s 22ms/step - accuracy: 0.9975 - loss: 0.0177 - val_accuracy: 0.9974 - val_loss: 0.0181
Epoch 11/50
1512/1512 ━━━━━━━━━━━━━━━━━━━━ 34s 22ms/step - accuracy: 0.9975 - loss: 0.0176 - val_accuracy: 0.9974 - val_loss: 0.0181
Epoch 12/50
1512/1512 ━━━━━━━━━━━━━━━━━━━━ 33s 22ms/step - accuracy: 0.9975 - loss: 0.0176 - val_accuracy: 0.9974 - val_loss: 0.0181
Epoch 13/50
1512/1512 ━━━━━━━━━━━━━━━━━━━━ 33s 22ms/step - accuracy: 0.9975 - loss: 0.0176 - val_accuracy: 0.9974 - val_loss: 0.0181
Epoch 14/50
1512/1512 ━━━━━━━━━━━━━━━━━━━━ 34s 22ms/step - accuracy: 0.9975 - loss: 0.0176 - val_accuracy: 0.9974 - val_loss: 0.0181
Epoch 15/50
1512/1512 ━━━━━━━━━━━━━━━━━━━━ 33s 22ms/step - accuracy: 0.9975 - loss: 0.0176 - val_accuracy: 0.9974 - val_loss: 0.0181
Epoch 16/50
1512/1512 ━━━━━━━━━━━━━━━━━━━━ 33s 22ms/step - accuracy: 0.9975 - loss: 0.0176 - val_accuracy: 0.9974 - val_loss: 0.0181
Epoch 17/50
1512/1512 ━━━━━━━━━━━━━━━━━━━━ 33s 22ms/step - accuracy: 0.9975 - loss: 0.0176 - val_accuracy: 0.9974 - val_loss: 0.0181
Epoch 18/50
1512/1512 ━━━━━━━━━━━━━━━━━━━━ 34s 23ms/step - accuracy: 0.9975 - loss: 0.0176 - val_accuracy: 0.9974 - val_loss: 0.0181
Epoch 19/50
1512/1512 ━━━━━━━━━━━━━━━━━━━━ 34s 22ms/step - accuracy: 0.9975 - loss: 0.0176 - val_accuracy: 0.9974 - val_loss: 0.0181
Epoch 20/50
1512/1512 ━━━━━━━━━━━━━━━━━━━━ 34s 22ms/step - accuracy: 0.9975 - loss: 0.0176 - val_accuracy: 0.9974 - val_loss: 0.0181
Epoch 21/50
1512/1512 ━━━━━━━━━━━━━━━━━━━━ 33s 22ms/step - accuracy: 0.9975 - loss: 0.0176 - val_accuracy: 0.9974 - val_loss: 0.0181
Epoch 22/50
1512/1512 ━━━━━━━━━━━━━━━━━━━━ 33s 22ms/step - accuracy: 0.9975 - loss: 0.0176 - val_accuracy: 0.9974 - val_loss: 0.0181
Epoch 23/50
1512/1512 ━━━━━━━━━━━━━━━━━━━━ 33s 22ms/step - accuracy: 0.9975 - loss: 0.0176 - val_accuracy: 0.9974 - val_loss: 0.0181
Epoch 24/50
1512/1512 ━━━━━━━━━━━━━━━━━━━━ 33s 22ms/step - accuracy: 0.9975 - loss: 0.0176 - val_accuracy: 0.9974 - val_loss: 0.0181
2025-10-31 14:02:00.809 | INFO     | src.ai_engine.ai_models:fit:685 - LSTM trained successfully.
2025-10-31 14:02:01.472 | INFO     | src.ai_engine.ai_models:fit:381 - Generating base model predictions for meta-model training...
2025-10-31 14:02:12.811 | INFO     | src.ai_engine.feature_engineering:create_sequences:261 - Creating sequences with length 50 from 53809 data points.
2025-10-31 14:02:13.795 | INFO     | src.ai_engine.feature_engineering:create_sequences:270 - Created 53759 sequences.
1680/1680 ━━━━━━━━━━━━━━━━━━━━ 138s 27ms/step
2025-10-31 14:16:19.381 | INFO     | src.ai_engine.ai_models:fit:396 - Training meta-model...
2025-10-31 14:16:23.632 | SUCCESS  | src.ai_engine.ai_models:fit:399 - Stacking Ensemble trained successfully.
2025-10-31 14:16:24.549 | SUCCESS  | __main__:main:167 - Final Ensemble model trained.
2025-10-31 14:16:24.626 | INFO     | __main__:main:171 - Saving models to 'models\GainX_999\1m'...
2025-10-31 14:16:35.461 | INFO     | src.ai_engine.ai_models:save:52 - Model RandomForest saved to models\GainX_999\1m\random_forest.pkl
2025-10-31 14:16:37.709 | INFO     | src.ai_engine.ai_models:save:52 - Model GradientBoosting saved to models\GainX_999\1m\gradient_boosting.pkl
2025-10-31 14:16:44.501 | INFO     | src.ai_engine.ai_models:save:731 - LSTM model saved to models\GainX_999\1m\lstm.keras, models\GainX_999\1m\lstm_scaler.pkl and marker file models\GainX_999\1m\lstm.pkl
2025-10-31 14:16:44.532 | INFO     | src.ai_engine.ai_models:save_all:463 - Meta-model saved to models\GainX_999\1m\meta_model.pkl
2025-10-31 14:16:44.564 | SUCCESS  | __main__:main:174 - --- Finished training for Symbol: GainX 999, Timeframe: 1m ---
2025-10-31 14:16:44.594 | INFO     | __main__:main:140 - --- Starting training for Symbol: GainX 999, Timeframe: 4h ---
2025-10-31 14:16:47.097 | SUCCESS  | __main__:main:148 - Loaded 1809 records.
2025-10-31 14:16:47.099 | INFO     | __main__:prepare_training_data:32 - Preparing data for training with Meta-Labeling...
2025-10-31 14:16:49.778 | DEBUG    | src.ai_engine.technical_indicators:calculate_all:47 - Calculated 63 technical indicators
2025-10-31 14:16:51.102 | DEBUG    | src.ai_engine.feature_engineering:extract_features:66 - Extracted 116 features
2025-10-31 14:16:51.104 | INFO     | __main__:prepare_training_data:39 - Generating signals from primary model (SimplePatternModel)...
2025-10-31 14:16:51.256 | WARNING  | src.ai_engine.feature_engineering:prepare_for_model:230 - Se perdieron todos los datos al eliminar los NaN. Se conservarán los datos rellenados.
2025-10-31 14:16:53.060 | INFO     | src.ai_engine.ai_models:calculate_optimal_threshold:549 - Calculated optimal threshold: 0.0047 (volatility: 0.0017, avg_movement: 0.0067)
2025-10-31 14:16:53.062 | INFO     | src.ai_engine.ai_models:create_meta_labels:577 - Creating meta-labels for secondary model...
2025-10-31 14:16:53.322 | INFO     | src.ai_engine.ai_models:create_meta_labels:629 - Meta-Label distribution - Profitable: 272 (31.7%), Unprofitable: 586 (68.3%)
2025-10-31 14:16:53.504 | WARNING  | src.ai_engine.feature_engineering:prepare_for_model:230 - Se perdieron todos los datos al eliminar los NaN. Se conservarán los datos rellenados.
2025-10-31 14:16:53.537 | INFO     | __main__:prepare_training_data:75 - Data preparation complete. Shape of X: (1296, 116), Shape of y: (1296,)
2025-10-31 14:16:53.942 | INFO     | src.ai_engine.feature_engineering:create_sequences:261 - Creating sequences with length 50 from 1296 data points.
2025-10-31 14:16:54.013 | INFO     | src.ai_engine.feature_engineering:create_sequences:270 - Created 1246 sequences.
2025-10-31 14:16:54.507 | INFO     | __main__:main:164 - Initializing and training Ensemble model...
2025-10-31 14:16:54.508 | INFO     | src.ai_engine.ai_models:__init__:304 - Initialized Stacking Ensemble with Logistic Regression as meta-model.
2025-10-31 14:16:55.776 | INFO     | src.ai_engine.ai_models:fit:359 - Creating LSTM model...
2025-10-31 14:16:55.776 | INFO     | src.ai_engine.ai_models:fit:364 - Training base models...
2025-10-31 14:16:55.780 | INFO     | src.ai_engine.ai_models:fit:373 - Training random_forest...
2025-10-31 14:16:59.331 | INFO     | src.ai_engine.ai_models:fit:98 - RandomForest trained successfully on 1296 samples with 2 classes
2025-10-31 14:16:59.333 | INFO     | src.ai_engine.ai_models:fit:373 - Training gradient_boosting...
2025-10-31 14:17:14.509 | INFO     | src.ai_engine.ai_models:fit:157 - GradientBoosting trained successfully on 1296 samples with 2 classes
2025-10-31 14:17:14.510 | INFO     | src.ai_engine.ai_models:fit:373 - Training pattern_based...
2025-10-31 14:17:14.547 | INFO     | src.ai_engine.ai_models:fit:373 - Training lstm...
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\keras\src\layers\rnn\rnn.py:199: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(**kwargs)
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1108: RuntimeWarning: invalid value encountered in divide
  updated_mean = (last_sum + new_sum) / updated_sample_count
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1113: RuntimeWarning: invalid value encountered in divide
  T = new_sum / new_sample_count
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1133: RuntimeWarning: invalid value encountered in divide
  new_unnormalized_variance -= correction**2 / new_sample_count
Epoch 1/50
36/36 ━━━━━━━━━━━━━━━━━━━━ 92s 271ms/step - accuracy: 0.8020 - loss: 0.6882 - val_accuracy: 0.7520 - val_loss: 0.6846
Epoch 2/50
36/36 ━━━━━━━━━━━━━━━━━━━━ 2s 51ms/step - accuracy: 0.8020 - loss: 0.6787 - val_accuracy: 0.7520 - val_loss: 0.6770
Epoch 3/50
36/36 ━━━━━━━━━━━━━━━━━━━━ 2s 43ms/step - accuracy: 0.8020 - loss: 0.6691 - val_accuracy: 0.7520 - val_loss: 0.6692
Epoch 4/50
36/36 ━━━━━━━━━━━━━━━━━━━━ 4s 89ms/step - accuracy: 0.8020 - loss: 0.6598 - val_accuracy: 0.7520 - val_loss: 0.6617
Epoch 5/50
36/36 ━━━━━━━━━━━━━━━━━━━━ 1s 33ms/step - accuracy: 0.8020 - loss: 0.6508 - val_accuracy: 0.7520 - val_loss: 0.6546
Epoch 6/50
36/36 ━━━━━━━━━━━━━━━━━━━━ 2s 27ms/step - accuracy: 0.8020 - loss: 0.6424 - val_accuracy: 0.7520 - val_loss: 0.6478
Epoch 7/50
36/36 ━━━━━━━━━━━━━━━━━━━━ 1s 32ms/step - accuracy: 0.8020 - loss: 0.6342 - val_accuracy: 0.7520 - val_loss: 0.6416
Epoch 8/50
36/36 ━━━━━━━━━━━━━━━━━━━━ 1s 26ms/step - accuracy: 0.8020 - loss: 0.6264 - val_accuracy: 0.7520 - val_loss: 0.6357
Epoch 9/50
36/36 ━━━━━━━━━━━━━━━━━━━━ 1s 27ms/step - accuracy: 0.8020 - loss: 0.6191 - val_accuracy: 0.7520 - val_loss: 0.6301
Epoch 10/50
36/36 ━━━━━━━━━━━━━━━━━━━━ 1s 28ms/step - accuracy: 0.8020 - loss: 0.6127 - val_accuracy: 0.7520 - val_loss: 0.6253
Epoch 11/50
36/36 ━━━━━━━━━━━━━━━━━━━━ 1s 34ms/step - accuracy: 0.8020 - loss: 0.6061 - val_accuracy: 0.7520 - val_loss: 0.6204
Epoch 12/50
36/36 ━━━━━━━━━━━━━━━━━━━━ 1s 34ms/step - accuracy: 0.8020 - loss: 0.5998 - val_accuracy: 0.7520 - val_loss: 0.6156
Epoch 13/50
36/36 ━━━━━━━━━━━━━━━━━━━━ 1s 28ms/step - accuracy: 0.8020 - loss: 0.5938 - val_accuracy: 0.7520 - val_loss: 0.6110
Epoch 14/50
36/36 ━━━━━━━━━━━━━━━━━━━━ 1s 24ms/step - accuracy: 0.8020 - loss: 0.5880 - val_accuracy: 0.7520 - val_loss: 0.6069
Epoch 15/50
36/36 ━━━━━━━━━━━━━━━━━━━━ 1s 25ms/step - accuracy: 0.8020 - loss: 0.5826 - val_accuracy: 0.7520 - val_loss: 0.6031
Epoch 16/50
36/36 ━━━━━━━━━━━━━━━━━━━━ 1s 32ms/step - accuracy: 0.8020 - loss: 0.5775 - val_accuracy: 0.7520 - val_loss: 0.5994
Epoch 17/50
36/36 ━━━━━━━━━━━━━━━━━━━━ 1s 24ms/step - accuracy: 0.8020 - loss: 0.5726 - val_accuracy: 0.7520 - val_loss: 0.5960
Epoch 18/50
36/36 ━━━━━━━━━━━━━━━━━━━━ 1s 24ms/step - accuracy: 0.8020 - loss: 0.5684 - val_accuracy: 0.7520 - val_loss: 0.5933
Epoch 19/50
36/36 ━━━━━━━━━━━━━━━━━━━━ 1s 25ms/step - accuracy: 0.8020 - loss: 0.5643 - val_accuracy: 0.7520 - val_loss: 0.5902
Epoch 20/50
36/36 ━━━━━━━━━━━━━━━━━━━━ 1s 24ms/step - accuracy: 0.8020 - loss: 0.5605 - val_accuracy: 0.7520 - val_loss: 0.5878
Epoch 21/50
36/36 ━━━━━━━━━━━━━━━━━━━━ 1s 24ms/step - accuracy: 0.8020 - loss: 0.5567 - val_accuracy: 0.7520 - val_loss: 0.5853
Epoch 22/50
36/36 ━━━━━━━━━━━━━━━━━━━━ 1s 24ms/step - accuracy: 0.8020 - loss: 0.5530 - val_accuracy: 0.7520 - val_loss: 0.5827
Epoch 23/50
36/36 ━━━━━━━━━━━━━━━━━━━━ 1s 24ms/step - accuracy: 0.8020 - loss: 0.5494 - val_accuracy: 0.7520 - val_loss: 0.5805
Epoch 24/50
36/36 ━━━━━━━━━━━━━━━━━━━━ 1s 30ms/step - accuracy: 0.8020 - loss: 0.5460 - val_accuracy: 0.7520 - val_loss: 0.5784
Epoch 25/50
36/36 ━━━━━━━━━━━━━━━━━━━━ 1s 24ms/step - accuracy: 0.8020 - loss: 0.5429 - val_accuracy: 0.7520 - val_loss: 0.5764
Epoch 26/50
36/36 ━━━━━━━━━━━━━━━━━━━━ 1s 31ms/step - accuracy: 0.8020 - loss: 0.5399 - val_accuracy: 0.7520 - val_loss: 0.5747
Epoch 27/50
36/36 ━━━━━━━━━━━━━━━━━━━━ 1s 24ms/step - accuracy: 0.8020 - loss: 0.5371 - val_accuracy: 0.7520 - val_loss: 0.5731
Epoch 28/50
36/36 ━━━━━━━━━━━━━━━━━━━━ 1s 24ms/step - accuracy: 0.8020 - loss: 0.5348 - val_accuracy: 0.7520 - val_loss: 0.5718
Epoch 29/50
36/36 ━━━━━━━━━━━━━━━━━━━━ 1s 24ms/step - accuracy: 0.8020 - loss: 0.5324 - val_accuracy: 0.7520 - val_loss: 0.5705
Epoch 30/50
36/36 ━━━━━━━━━━━━━━━━━━━━ 1s 24ms/step - accuracy: 0.8020 - loss: 0.5304 - val_accuracy: 0.7520 - val_loss: 0.5694
Epoch 31/50
36/36 ━━━━━━━━━━━━━━━━━━━━ 1s 24ms/step - accuracy: 0.8020 - loss: 0.5287 - val_accuracy: 0.7520 - val_loss: 0.5685
Epoch 32/50
36/36 ━━━━━━━━━━━━━━━━━━━━ 1s 26ms/step - accuracy: 0.8020 - loss: 0.5270 - val_accuracy: 0.7520 - val_loss: 0.5676
Epoch 33/50
36/36 ━━━━━━━━━━━━━━━━━━━━ 1s 24ms/step - accuracy: 0.8020 - loss: 0.5251 - val_accuracy: 0.7520 - val_loss: 0.5666
Epoch 34/50
36/36 ━━━━━━━━━━━━━━━━━━━━ 1s 24ms/step - accuracy: 0.8020 - loss: 0.5232 - val_accuracy: 0.7520 - val_loss: 0.5657
Epoch 35/50
36/36 ━━━━━━━━━━━━━━━━━━━━ 1s 24ms/step - accuracy: 0.8020 - loss: 0.5213 - val_accuracy: 0.7520 - val_loss: 0.5649
Epoch 36/50
36/36 ━━━━━━━━━━━━━━━━━━━━ 1s 24ms/step - accuracy: 0.8020 - loss: 0.5200 - val_accuracy: 0.7520 - val_loss: 0.5643
Epoch 37/50
36/36 ━━━━━━━━━━━━━━━━━━━━ 1s 24ms/step - accuracy: 0.8020 - loss: 0.5188 - val_accuracy: 0.7520 - val_loss: 0.5638
Epoch 38/50
36/36 ━━━━━━━━━━━━━━━━━━━━ 1s 25ms/step - accuracy: 0.8020 - loss: 0.5177 - val_accuracy: 0.7520 - val_loss: 0.5633
Epoch 39/50
36/36 ━━━━━━━━━━━━━━━━━━━━ 1s 24ms/step - accuracy: 0.8020 - loss: 0.5167 - val_accuracy: 0.7520 - val_loss: 0.5629
Epoch 40/50
36/36 ━━━━━━━━━━━━━━━━━━━━ 1s 24ms/step - accuracy: 0.8020 - loss: 0.5154 - val_accuracy: 0.7520 - val_loss: 0.5624
Epoch 41/50
36/36 ━━━━━━━━━━━━━━━━━━━━ 1s 27ms/step - accuracy: 0.8020 - loss: 0.5141 - val_accuracy: 0.7520 - val_loss: 0.5619
Epoch 42/50
36/36 ━━━━━━━━━━━━━━━━━━━━ 1s 34ms/step - accuracy: 0.8020 - loss: 0.5128 - val_accuracy: 0.7520 - val_loss: 0.5616
Epoch 43/50
36/36 ━━━━━━━━━━━━━━━━━━━━ 1s 24ms/step - accuracy: 0.8020 - loss: 0.5117 - val_accuracy: 0.7520 - val_loss: 0.5612
Epoch 44/50
36/36 ━━━━━━━━━━━━━━━━━━━━ 1s 24ms/step - accuracy: 0.8020 - loss: 0.5106 - val_accuracy: 0.7520 - val_loss: 0.5609
Epoch 45/50
36/36 ━━━━━━━━━━━━━━━━━━━━ 1s 24ms/step - accuracy: 0.8020 - loss: 0.5096 - val_accuracy: 0.7520 - val_loss: 0.5607
Epoch 46/50
36/36 ━━━━━━━━━━━━━━━━━━━━ 1s 24ms/step - accuracy: 0.8020 - loss: 0.5087 - val_accuracy: 0.7520 - val_loss: 0.5605
Epoch 47/50
36/36 ━━━━━━━━━━━━━━━━━━━━ 1s 24ms/step - accuracy: 0.8020 - loss: 0.5078 - val_accuracy: 0.7520 - val_loss: 0.5603
Epoch 48/50
36/36 ━━━━━━━━━━━━━━━━━━━━ 1s 24ms/step - accuracy: 0.8020 - loss: 0.5070 - val_accuracy: 0.7520 - val_loss: 0.5602
Epoch 49/50
36/36 ━━━━━━━━━━━━━━━━━━━━ 1s 25ms/step - accuracy: 0.8020 - loss: 0.5062 - val_accuracy: 0.7520 - val_loss: 0.5602
Epoch 50/50
36/36 ━━━━━━━━━━━━━━━━━━━━ 1s 24ms/step - accuracy: 0.8020 - loss: 0.5055 - val_accuracy: 0.7520 - val_loss: 0.5601
2025-10-31 14:19:47.414 | INFO     | src.ai_engine.ai_models:fit:685 - LSTM trained successfully.
2025-10-31 14:19:47.422 | INFO     | src.ai_engine.ai_models:fit:381 - Generating base model predictions for meta-model training...
2025-10-31 14:19:47.617 | INFO     | src.ai_engine.feature_engineering:create_sequences:261 - Creating sequences with length 50 from 1296 data points.
2025-10-31 14:19:47.633 | INFO     | src.ai_engine.feature_engineering:create_sequences:270 - Created 1246 sequences.
39/39 ━━━━━━━━━━━━━━━━━━━━ 9s 132ms/step
2025-10-31 14:19:57.602 | INFO     | src.ai_engine.ai_models:fit:396 - Training meta-model...
2025-10-31 14:19:57.678 | SUCCESS  | src.ai_engine.ai_models:fit:399 - Stacking Ensemble trained successfully.
2025-10-31 14:19:57.680 | SUCCESS  | __main__:main:167 - Final Ensemble model trained.
2025-10-31 14:19:57.684 | INFO     | __main__:main:171 - Saving models to 'models\GainX_999\4h'...
2025-10-31 14:19:58.643 | INFO     | src.ai_engine.ai_models:save:52 - Model RandomForest saved to models\GainX_999\4h\random_forest.pkl
2025-10-31 14:19:59.200 | INFO     | src.ai_engine.ai_models:save:52 - Model GradientBoosting saved to models\GainX_999\4h\gradient_boosting.pkl
2025-10-31 14:19:59.887 | INFO     | src.ai_engine.ai_models:save:731 - LSTM model saved to models\GainX_999\4h\lstm.keras, models\GainX_999\4h\lstm_scaler.pkl and marker file models\GainX_999\4h\lstm.pkl
2025-10-31 14:19:59.891 | INFO     | src.ai_engine.ai_models:save_all:463 - Meta-model saved to models\GainX_999\4h\meta_model.pkl
2025-10-31 14:19:59.894 | SUCCESS  | __main__:main:174 - --- Finished training for Symbol: GainX 999, Timeframe: 4h ---
2025-10-31 14:19:59.924 | INFO     | __main__:main:140 - --- Starting training for Symbol: GainX 999, Timeframe: 5m ---
2025-10-31 14:20:00.503 | SUCCESS  | __main__:main:148 - Loaded 86686 records.
2025-10-31 14:20:00.504 | INFO     | __main__:prepare_training_data:32 - Preparing data for training with Meta-Labeling...
2025-10-31 14:20:05.356 | DEBUG    | src.ai_engine.technical_indicators:calculate_all:47 - Calculated 63 technical indicators
2025-10-31 14:20:20.180 | DEBUG    | src.ai_engine.feature_engineering:extract_features:66 - Extracted 116 features
2025-10-31 14:20:20.220 | INFO     | __main__:prepare_training_data:39 - Generating signals from primary model (SimplePatternModel)...
2025-10-31 14:20:20.432 | WARNING  | src.ai_engine.feature_engineering:prepare_for_model:230 - Se perdieron todos los datos al eliminar los NaN. Se conservarán los datos rellenados.
2025-10-31 14:20:34.414 | INFO     | src.ai_engine.ai_models:calculate_optimal_threshold:549 - Calculated optimal threshold: 0.0010 (volatility: 0.0002, avg_movement: 0.0010)
2025-10-31 14:20:34.416 | INFO     | src.ai_engine.ai_models:create_meta_labels:577 - Creating meta-labels for secondary model...
2025-10-31 14:20:46.852 | INFO     | src.ai_engine.ai_models:create_meta_labels:629 - Meta-Label distribution - Profitable: 5156 (25.5%), Unprofitable: 15029 (74.5%)
2025-10-31 14:20:47.090 | WARNING  | src.ai_engine.feature_engineering:prepare_for_model:230 - Se perdieron todos los datos al eliminar los NaN. Se conservarán los datos rellenados.
2025-10-31 14:20:47.185 | INFO     | __main__:prepare_training_data:75 - Data preparation complete. Shape of X: (60684, 116), Shape of y: (60684,)
2025-10-31 14:20:47.753 | INFO     | src.ai_engine.feature_engineering:create_sequences:261 - Creating sequences with length 50 from 60684 data points.
2025-10-31 14:20:48.771 | INFO     | src.ai_engine.feature_engineering:create_sequences:270 - Created 60634 sequences.
2025-10-31 14:20:48.781 | INFO     | __main__:main:164 - Initializing and training Ensemble model...
2025-10-31 14:20:48.817 | INFO     | src.ai_engine.ai_models:__init__:304 - Initialized Stacking Ensemble with Logistic Regression as meta-model.
2025-10-31 14:20:48.834 | INFO     | src.ai_engine.ai_models:fit:359 - Creating LSTM model...
2025-10-31 14:20:48.834 | INFO     | src.ai_engine.ai_models:fit:364 - Training base models...
2025-10-31 14:20:48.957 | INFO     | src.ai_engine.ai_models:fit:373 - Training random_forest...
2025-10-31 14:21:11.754 | INFO     | src.ai_engine.ai_models:fit:98 - RandomForest trained successfully on 60684 samples with 2 classes
2025-10-31 14:21:11.757 | INFO     | src.ai_engine.ai_models:fit:373 - Training gradient_boosting...
2025-10-31 14:32:51.012 | INFO     | src.ai_engine.ai_models:fit:157 - GradientBoosting trained successfully on 60684 samples with 2 classes
2025-10-31 14:32:51.016 | INFO     | src.ai_engine.ai_models:fit:373 - Training pattern_based...
2025-10-31 14:32:51.018 | INFO     | src.ai_engine.ai_models:fit:373 - Training lstm...
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\keras\src\layers\rnn\rnn.py:199: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(**kwargs)
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1108: RuntimeWarning: invalid value encountered in divide
  updated_mean = (last_sum + new_sum) / updated_sample_count
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1113: RuntimeWarning: invalid value encountered in divide
  T = new_sum / new_sample_count
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1133: RuntimeWarning: invalid value encountered in divide
  new_unnormalized_variance -= correction**2 / new_sample_count
Epoch 1/50
1706/1706 ━━━━━━━━━━━━━━━━━━━━ 316s 62ms/step - accuracy: 0.9171 - loss: 0.4724 - val_accuracy: 0.8961 - val_loss: 0.3749
Epoch 2/50
1706/1706 ━━━━━━━━━━━━━━━━━━━━ 43s 25ms/step - accuracy: 0.9171 - loss: 0.3109 - val_accuracy: 0.8961 - val_loss: 0.3343
Epoch 3/50
1706/1706 ━━━━━━━━━━━━━━━━━━━━ 41s 24ms/step - accuracy: 0.9171 - loss: 0.2878 - val_accuracy: 0.8961 - val_loss: 0.3348
Epoch 4/50
1706/1706 ━━━━━━━━━━━━━━━━━━━━ 40s 24ms/step - accuracy: 0.9171 - loss: 0.2859 - val_accuracy: 0.8961 - val_loss: 0.3359
Epoch 5/50
1706/1706 ━━━━━━━━━━━━━━━━━━━━ 41s 24ms/step - accuracy: 0.9171 - loss: 0.2859 - val_accuracy: 0.8961 - val_loss: 0.3365
Epoch 6/50
1706/1706 ━━━━━━━━━━━━━━━━━━━━ 41s 24ms/step - accuracy: 0.9171 - loss: 0.2859 - val_accuracy: 0.8961 - val_loss: 0.3364
Epoch 7/50
1706/1706 ━━━━━━━━━━━━━━━━━━━━ 40s 23ms/step - accuracy: 0.9171 - loss: 0.2859 - val_accuracy: 0.8961 - val_loss: 0.3362
Epoch 8/50
1706/1706 ━━━━━━━━━━━━━━━━━━━━ 40s 23ms/step - accuracy: 0.9171 - loss: 0.2859 - val_accuracy: 0.8961 - val_loss: 0.3362
Epoch 9/50
1706/1706 ━━━━━━━━━━━━━━━━━━━━ 40s 23ms/step - accuracy: 0.9171 - loss: 0.2859 - val_accuracy: 0.8961 - val_loss: 0.3363
Epoch 10/50
1706/1706 ━━━━━━━━━━━━━━━━━━━━ 41s 24ms/step - accuracy: 0.9171 - loss: 0.2859 - val_accuracy: 0.8961 - val_loss: 0.3366
Epoch 11/50
1706/1706 ━━━━━━━━━━━━━━━━━━━━ 40s 23ms/step - accuracy: 0.9171 - loss: 0.2859 - val_accuracy: 0.8961 - val_loss: 0.3368
Epoch 12/50
1706/1706 ━━━━━━━━━━━━━━━━━━━━ 40s 23ms/step - accuracy: 0.9171 - loss: 0.2859 - val_accuracy: 0.8961 - val_loss: 0.3361
2025-10-31 15:16:57.423 | INFO     | src.ai_engine.ai_models:fit:685 - LSTM trained successfully.
2025-10-31 15:16:58.164 | INFO     | src.ai_engine.ai_models:fit:381 - Generating base model predictions for meta-model training...
2025-10-31 15:21:05.012 | INFO     | src.ai_engine.feature_engineering:create_sequences:261 - Creating sequences with length 50 from 60684 data points.
2025-10-31 15:21:05.766 | INFO     | src.ai_engine.feature_engineering:create_sequences:270 - Created 60634 sequences.
1895/1895 ━━━━━━━━━━━━━━━━━━━━ 148s 35ms/step
2025-10-31 15:46:11.674 | INFO     | src.ai_engine.ai_models:fit:396 - Training meta-model...
2025-10-31 15:46:19.877 | SUCCESS  | src.ai_engine.ai_models:fit:399 - Stacking Ensemble trained successfully.
2025-10-31 15:46:20.468 | SUCCESS  | __main__:main:167 - Final Ensemble model trained.
2025-10-31 15:46:20.529 | INFO     | __main__:main:171 - Saving models to 'models\GainX_999\5m'...
2025-10-31 15:46:46.530 | INFO     | src.ai_engine.ai_models:save:52 - Model RandomForest saved to models\GainX_999\5m\random_forest.pkl
2025-10-31 15:46:49.609 | INFO     | src.ai_engine.ai_models:save:52 - Model GradientBoosting saved to models\GainX_999\5m\gradient_boosting.pkl
2025-10-31 15:47:01.226 | INFO     | src.ai_engine.ai_models:save:731 - LSTM model saved to models\GainX_999\5m\lstm.keras, models\GainX_999\5m\lstm_scaler.pkl and marker file models\GainX_999\5m\lstm.pkl
2025-10-31 15:47:01.317 | INFO     | src.ai_engine.ai_models:save_all:463 - Meta-model saved to models\GainX_999\5m\meta_model.pkl
2025-10-31 15:47:01.355 | SUCCESS  | __main__:main:174 - --- Finished training for Symbol: GainX 999, Timeframe: 5m ---
2025-10-31 15:47:01.478 | INFO     | __main__:main:140 - --- Starting training for Symbol: PainX 1200, Timeframe: 15m ---
2025-10-31 15:47:12.830 | SUCCESS  | __main__:main:148 - Loaded 28898 records.
2025-10-31 15:47:12.842 | INFO     | __main__:prepare_training_data:32 - Preparing data for training with Meta-Labeling...
2025-10-31 15:47:18.876 | DEBUG    | src.ai_engine.technical_indicators:calculate_all:47 - Calculated 63 technical indicators
2025-10-31 15:47:27.815 | DEBUG    | src.ai_engine.feature_engineering:extract_features:66 - Extracted 116 features
2025-10-31 15:47:27.866 | INFO     | __main__:prepare_training_data:39 - Generating signals from primary model (SimplePatternModel)...
2025-10-31 15:47:28.158 | WARNING  | src.ai_engine.feature_engineering:prepare_for_model:230 - Se perdieron todos los datos al eliminar los NaN. Se conservarán los datos rellenados.
2025-10-31 15:47:36.170 | INFO     | src.ai_engine.ai_models:calculate_optimal_threshold:549 - Calculated optimal threshold: 0.0010 (volatility: 0.0002, avg_movement: 0.0010)
2025-10-31 15:47:36.174 | INFO     | src.ai_engine.ai_models:create_meta_labels:577 - Creating meta-labels for secondary model...
2025-10-31 15:47:40.435 | INFO     | src.ai_engine.ai_models:create_meta_labels:629 - Meta-Label distribution - Profitable: 1559 (24.1%), Unprofitable: 4902 (75.9%)
2025-10-31 15:47:40.678 | WARNING  | src.ai_engine.feature_engineering:prepare_for_model:230 - Se perdieron todos los datos al eliminar los NaN. Se conservarán los datos rellenados.
2025-10-31 15:47:40.829 | INFO     | __main__:prepare_training_data:75 - Data preparation complete. Shape of X: (20556, 116), Shape of y: (20556,)
2025-10-31 15:47:41.210 | INFO     | src.ai_engine.feature_engineering:create_sequences:261 - Creating sequences with length 50 from 20556 data points.
2025-10-31 15:47:44.670 | INFO     | src.ai_engine.feature_engineering:create_sequences:270 - Created 20506 sequences.
2025-10-31 15:47:45.489 | INFO     | __main__:main:164 - Initializing and training Ensemble model...
2025-10-31 15:47:45.608 | INFO     | src.ai_engine.ai_models:__init__:304 - Initialized Stacking Ensemble with Logistic Regression as meta-model.
2025-10-31 15:47:49.284 | INFO     | src.ai_engine.ai_models:fit:359 - Creating LSTM model...
2025-10-31 15:47:49.322 | INFO     | src.ai_engine.ai_models:fit:364 - Training base models...
2025-10-31 15:47:49.385 | INFO     | src.ai_engine.ai_models:fit:373 - Training random_forest...
2025-10-31 15:48:10.254 | INFO     | src.ai_engine.ai_models:fit:98 - RandomForest trained successfully on 20556 samples with 2 classes
2025-10-31 15:48:10.259 | INFO     | src.ai_engine.ai_models:fit:373 - Training gradient_boosting...
2025-10-31 15:51:58.627 | INFO     | src.ai_engine.ai_models:fit:157 - GradientBoosting trained successfully on 20556 samples with 2 classes
2025-10-31 15:51:58.629 | INFO     | src.ai_engine.ai_models:fit:373 - Training pattern_based...
2025-10-31 15:51:58.631 | INFO     | src.ai_engine.ai_models:fit:373 - Training lstm...
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\keras\src\layers\rnn\rnn.py:199: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(**kwargs)
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1108: RuntimeWarning: invalid value encountered in divide
  updated_mean = (last_sum + new_sum) / updated_sample_count
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1113: RuntimeWarning: invalid value encountered in divide
  T = new_sum / new_sample_count
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1133: RuntimeWarning: invalid value encountered in divide
  new_unnormalized_variance -= correction**2 / new_sample_count
Epoch 1/50
577/577 ━━━━━━━━━━━━━━━━━━━━ 121s 41ms/step - accuracy: 0.9252 - loss: 0.5903 - val_accuracy: 0.9171 - val_loss: 0.5080
Epoch 2/50
577/577 ━━━━━━━━━━━━━━━━━━━━ 16s 27ms/step - accuracy: 0.9252 - loss: 0.4439 - val_accuracy: 0.9171 - val_loss: 0.4024
Epoch 3/50
577/577 ━━━━━━━━━━━━━━━━━━━━ 15s 26ms/step - accuracy: 0.9252 - loss: 0.3614 - val_accuracy: 0.9171 - val_loss: 0.3447
Epoch 4/50
577/577 ━━━━━━━━━━━━━━━━━━━━ 15s 25ms/step - accuracy: 0.9252 - loss: 0.3157 - val_accuracy: 0.9171 - val_loss: 0.3138
Epoch 5/50
577/577 ━━━━━━━━━━━━━━━━━━━━ 15s 26ms/step - accuracy: 0.9252 - loss: 0.2907 - val_accuracy: 0.9171 - val_loss: 0.2976
Epoch 6/50
577/577 ━━━━━━━━━━━━━━━━━━━━ 15s 26ms/step - accuracy: 0.9252 - loss: 0.2774 - val_accuracy: 0.9171 - val_loss: 0.2901
Epoch 7/50
577/577 ━━━━━━━━━━━━━━━━━━━━ 15s 25ms/step - accuracy: 0.9252 - loss: 0.2708 - val_accuracy: 0.9171 - val_loss: 0.2869
Epoch 8/50
577/577 ━━━━━━━━━━━━━━━━━━━━ 14s 25ms/step - accuracy: 0.9252 - loss: 0.2678 - val_accuracy: 0.9171 - val_loss: 0.2859
Epoch 9/50
577/577 ━━━━━━━━━━━━━━━━━━━━ 15s 26ms/step - accuracy: 0.9252 - loss: 0.2666 - val_accuracy: 0.9171 - val_loss: 0.2858
Epoch 10/50
577/577 ━━━━━━━━━━━━━━━━━━━━ 15s 25ms/step - accuracy: 0.9252 - loss: 0.2661 - val_accuracy: 0.9171 - val_loss: 0.2859
Epoch 11/50
577/577 ━━━━━━━━━━━━━━━━━━━━ 14s 25ms/step - accuracy: 0.9252 - loss: 0.2660 - val_accuracy: 0.9171 - val_loss: 0.2861
Epoch 12/50
577/577 ━━━━━━━━━━━━━━━━━━━━ 15s 25ms/step - accuracy: 0.9252 - loss: 0.2660 - val_accuracy: 0.9171 - val_loss: 0.2861
Epoch 13/50
577/577 ━━━━━━━━━━━━━━━━━━━━ 14s 25ms/step - accuracy: 0.9252 - loss: 0.2660 - val_accuracy: 0.9171 - val_loss: 0.2862
Epoch 14/50
577/577 ━━━━━━━━━━━━━━━━━━━━ 14s 25ms/step - accuracy: 0.9252 - loss: 0.2660 - val_accuracy: 0.9171 - val_loss: 0.2862
Epoch 15/50
577/577 ━━━━━━━━━━━━━━━━━━━━ 14s 25ms/step - accuracy: 0.9252 - loss: 0.2660 - val_accuracy: 0.9171 - val_loss: 0.2862
Epoch 16/50
577/577 ━━━━━━━━━━━━━━━━━━━━ 15s 25ms/step - accuracy: 0.9252 - loss: 0.2660 - val_accuracy: 0.9171 - val_loss: 0.2863
Epoch 17/50
577/577 ━━━━━━━━━━━━━━━━━━━━ 14s 25ms/step - accuracy: 0.9252 - loss: 0.2660 - val_accuracy: 0.9171 - val_loss: 0.2862
Epoch 18/50
577/577 ━━━━━━━━━━━━━━━━━━━━ 14s 25ms/step - accuracy: 0.9252 - loss: 0.2660 - val_accuracy: 0.9171 - val_loss: 0.2862
Epoch 19/50
577/577 ━━━━━━━━━━━━━━━━━━━━ 14s 25ms/step - accuracy: 0.9252 - loss: 0.2660 - val_accuracy: 0.9171 - val_loss: 0.2862
2025-10-31 15:58:35.825 | INFO     | src.ai_engine.ai_models:fit:685 - LSTM trained successfully.
2025-10-31 15:58:35.897 | INFO     | src.ai_engine.ai_models:fit:381 - Generating base model predictions for meta-model training...
2025-10-31 15:58:37.265 | INFO     | src.ai_engine.feature_engineering:create_sequences:261 - Creating sequences with length 50 from 20556 data points.
2025-10-31 15:58:37.684 | INFO     | src.ai_engine.feature_engineering:create_sequences:270 - Created 20506 sequences.
641/641 ━━━━━━━━━━━━━━━━━━━━ 11s 13ms/step
2025-10-31 15:58:50.815 | INFO     | src.ai_engine.ai_models:fit:396 - Training meta-model...
2025-10-31 15:58:50.832 | SUCCESS  | src.ai_engine.ai_models:fit:399 - Stacking Ensemble trained successfully.
2025-10-31 15:58:50.833 | SUCCESS  | __main__:main:167 - Final Ensemble model trained.
2025-10-31 15:58:50.834 | INFO     | __main__:main:171 - Saving models to 'models\PainX_1200\15m'...
2025-10-31 15:58:51.404 | INFO     | src.ai_engine.ai_models:save:52 - Model RandomForest saved to models\PainX_1200\15m\random_forest.pkl
2025-10-31 15:58:51.603 | INFO     | src.ai_engine.ai_models:save:52 - Model GradientBoosting saved to models\PainX_1200\15m\gradient_boosting.pkl
2025-10-31 15:58:52.100 | INFO     | src.ai_engine.ai_models:save:731 - LSTM model saved to models\PainX_1200\15m\lstm.keras, models\PainX_1200\15m\lstm_scaler.pkl and marker file models\PainX_1200\15m\lstm.pkl
2025-10-31 15:58:52.105 | INFO     | src.ai_engine.ai_models:save_all:463 - Meta-model saved to models\PainX_1200\15m\meta_model.pkl
2025-10-31 15:58:52.107 | SUCCESS  | __main__:main:174 - --- Finished training for Symbol: PainX 1200, Timeframe: 15m ---
2025-10-31 15:58:52.109 | INFO     | __main__:main:140 - --- Starting training for Symbol: PainX 1200, Timeframe: 1d ---
2025-10-31 15:58:52.206 | SUCCESS  | __main__:main:148 - Loaded 302 records.
2025-10-31 15:58:52.208 | INFO     | __main__:prepare_training_data:32 - Preparing data for training with Meta-Labeling...
2025-10-31 15:58:52.400 | DEBUG    | src.ai_engine.technical_indicators:calculate_all:47 - Calculated 62 technical indicators
2025-10-31 15:58:52.534 | DEBUG    | src.ai_engine.feature_engineering:extract_features:66 - Extracted 116 features
2025-10-31 15:58:52.535 | INFO     | __main__:prepare_training_data:39 - Generating signals from primary model (SimplePatternModel)...
2025-10-31 15:58:52.540 | WARNING  | src.ai_engine.feature_engineering:prepare_for_model:230 - Se perdieron todos los datos al eliminar los NaN. Se conservarán los datos rellenados.
2025-10-31 15:58:52.600 | INFO     | src.ai_engine.ai_models:calculate_optimal_threshold:549 - Calculated optimal threshold: 0.0063 (volatility: 0.0023, avg_movement: 0.0087)
2025-10-31 15:58:52.600 | INFO     | src.ai_engine.ai_models:create_meta_labels:577 - Creating meta-labels for secondary model...
2025-10-31 15:58:52.643 | INFO     | src.ai_engine.ai_models:create_meta_labels:629 - Meta-Label distribution - Profitable: 57 (41.0%), Unprofitable: 82 (59.0%)
2025-10-31 15:58:52.664 | WARNING  | src.ai_engine.feature_engineering:prepare_for_model:230 - Se perdieron todos los datos al eliminar los NaN. Se conservarán los datos rellenados.
2025-10-31 15:58:52.666 | INFO     | __main__:prepare_training_data:75 - Data preparation complete. Shape of X: (228, 116), Shape of y: (228,)
2025-10-31 15:58:52.668 | INFO     | src.ai_engine.feature_engineering:create_sequences:261 - Creating sequences with length 50 from 228 data points.
2025-10-31 15:58:52.690 | INFO     | src.ai_engine.feature_engineering:create_sequences:270 - Created 178 sequences.
2025-10-31 15:58:52.747 | INFO     | __main__:main:164 - Initializing and training Ensemble model...
2025-10-31 15:58:52.747 | INFO     | src.ai_engine.ai_models:__init__:304 - Initialized Stacking Ensemble with Logistic Regression as meta-model.
2025-10-31 15:58:52.867 | INFO     | src.ai_engine.ai_models:fit:359 - Creating LSTM model...
2025-10-31 15:58:52.868 | INFO     | src.ai_engine.ai_models:fit:364 - Training base models...
2025-10-31 15:58:52.874 | INFO     | src.ai_engine.ai_models:fit:373 - Training random_forest...
2025-10-31 15:58:54.319 | INFO     | src.ai_engine.ai_models:fit:98 - RandomForest trained successfully on 228 samples with 2 classes
2025-10-31 15:58:54.320 | INFO     | src.ai_engine.ai_models:fit:373 - Training gradient_boosting...
2025-10-31 15:58:56.709 | INFO     | src.ai_engine.ai_models:fit:157 - GradientBoosting trained successfully on 228 samples with 2 classes
2025-10-31 15:58:56.710 | INFO     | src.ai_engine.ai_models:fit:373 - Training pattern_based...
2025-10-31 15:58:56.711 | INFO     | src.ai_engine.ai_models:fit:373 - Training lstm...
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\keras\src\layers\rnn\rnn.py:199: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(**kwargs)
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1108: RuntimeWarning: invalid value encountered in divide
  updated_mean = (last_sum + new_sum) / updated_sample_count
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1113: RuntimeWarning: invalid value encountered in divide
  T = new_sum / new_sample_count
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1133: RuntimeWarning: invalid value encountered in divide
  new_unnormalized_variance -= correction**2 / new_sample_count
Epoch 1/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 37s 1s/step - accuracy: 0.7312 - loss: 0.6928 - val_accuracy: 0.8333 - val_loss: 0.6915
Epoch 2/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 1s 124ms/step - accuracy: 0.7312 - loss: 0.6916 - val_accuracy: 0.8333 - val_loss: 0.6900
Epoch 3/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 1s 96ms/step - accuracy: 0.7312 - loss: 0.6905 - val_accuracy: 0.8333 - val_loss: 0.6884
Epoch 4/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 1s 119ms/step - accuracy: 0.7312 - loss: 0.6895 - val_accuracy: 0.8333 - val_loss: 0.6868
Epoch 5/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 77ms/step - accuracy: 0.7312 - loss: 0.6884 - val_accuracy: 0.8333 - val_loss: 0.6853
Epoch 6/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 103ms/step - accuracy: 0.7312 - loss: 0.6873 - val_accuracy: 0.8333 - val_loss: 0.6837
Epoch 7/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 50ms/step - accuracy: 0.7312 - loss: 0.6862 - val_accuracy: 0.8333 - val_loss: 0.6821
Epoch 8/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 35ms/step - accuracy: 0.7312 - loss: 0.6852 - val_accuracy: 0.8333 - val_loss: 0.6806
Epoch 9/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 69ms/step - accuracy: 0.7312 - loss: 0.6841 - val_accuracy: 0.8333 - val_loss: 0.6791
Epoch 10/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 58ms/step - accuracy: 0.7312 - loss: 0.6831 - val_accuracy: 0.8333 - val_loss: 0.6775
Epoch 11/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 40ms/step - accuracy: 0.7312 - loss: 0.6820 - val_accuracy: 0.8333 - val_loss: 0.6760
Epoch 12/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 46ms/step - accuracy: 0.7312 - loss: 0.6810 - val_accuracy: 0.8333 - val_loss: 0.6745
Epoch 13/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 52ms/step - accuracy: 0.7312 - loss: 0.6800 - val_accuracy: 0.8333 - val_loss: 0.6730
Epoch 14/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 46ms/step - accuracy: 0.7312 - loss: 0.6789 - val_accuracy: 0.8333 - val_loss: 0.6716
Epoch 15/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 51ms/step - accuracy: 0.7312 - loss: 0.6780 - val_accuracy: 0.8333 - val_loss: 0.6700
Epoch 16/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 67ms/step - accuracy: 0.7312 - loss: 0.6769 - val_accuracy: 0.8333 - val_loss: 0.6686
Epoch 17/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 47ms/step - accuracy: 0.7312 - loss: 0.6760 - val_accuracy: 0.8333 - val_loss: 0.6671
Epoch 18/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 34ms/step - accuracy: 0.7312 - loss: 0.6750 - val_accuracy: 0.8333 - val_loss: 0.6656
Epoch 19/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 43ms/step - accuracy: 0.7312 - loss: 0.6740 - val_accuracy: 0.8333 - val_loss: 0.6642
Epoch 20/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 36ms/step - accuracy: 0.7312 - loss: 0.6729 - val_accuracy: 0.8333 - val_loss: 0.6628
Epoch 21/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 34ms/step - accuracy: 0.7312 - loss: 0.6721 - val_accuracy: 0.8333 - val_loss: 0.6614
Epoch 22/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 78ms/step - accuracy: 0.7312 - loss: 0.6711 - val_accuracy: 0.8333 - val_loss: 0.6600
Epoch 23/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 60ms/step - accuracy: 0.7312 - loss: 0.6701 - val_accuracy: 0.8333 - val_loss: 0.6586
Epoch 24/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 41ms/step - accuracy: 0.7312 - loss: 0.6693 - val_accuracy: 0.8333 - val_loss: 0.6572
Epoch 25/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 41ms/step - accuracy: 0.7312 - loss: 0.6683 - val_accuracy: 0.8333 - val_loss: 0.6558
Epoch 26/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 77ms/step - accuracy: 0.7312 - loss: 0.6674 - val_accuracy: 0.8333 - val_loss: 0.6544
Epoch 27/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 41ms/step - accuracy: 0.7312 - loss: 0.6665 - val_accuracy: 0.8333 - val_loss: 0.6531
Epoch 28/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 40ms/step - accuracy: 0.7312 - loss: 0.6656 - val_accuracy: 0.8333 - val_loss: 0.6517
Epoch 29/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 39ms/step - accuracy: 0.7312 - loss: 0.6647 - val_accuracy: 0.8333 - val_loss: 0.6503
Epoch 30/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 40ms/step - accuracy: 0.7312 - loss: 0.6638 - val_accuracy: 0.8333 - val_loss: 0.6490
Epoch 31/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 40ms/step - accuracy: 0.7312 - loss: 0.6630 - val_accuracy: 0.8333 - val_loss: 0.6476
Epoch 32/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 51ms/step - accuracy: 0.7312 - loss: 0.6621 - val_accuracy: 0.8333 - val_loss: 0.6463
Epoch 33/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 34ms/step - accuracy: 0.7312 - loss: 0.6612 - val_accuracy: 0.8333 - val_loss: 0.6450
Epoch 34/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 53ms/step - accuracy: 0.7312 - loss: 0.6603 - val_accuracy: 0.8333 - val_loss: 0.6438
Epoch 35/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 34ms/step - accuracy: 0.7312 - loss: 0.6595 - val_accuracy: 0.8333 - val_loss: 0.6425
Epoch 36/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 110ms/step - accuracy: 0.7312 - loss: 0.6587 - val_accuracy: 0.8333 - val_loss: 0.6412
Epoch 37/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 52ms/step - accuracy: 0.7312 - loss: 0.6578 - val_accuracy: 0.8333 - val_loss: 0.6400
Epoch 38/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 47ms/step - accuracy: 0.7312 - loss: 0.6571 - val_accuracy: 0.8333 - val_loss: 0.6387
Epoch 39/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 35ms/step - accuracy: 0.7312 - loss: 0.6561 - val_accuracy: 0.8333 - val_loss: 0.6374
Epoch 40/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 35ms/step - accuracy: 0.7312 - loss: 0.6554 - val_accuracy: 0.8333 - val_loss: 0.6362
Epoch 41/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 35ms/step - accuracy: 0.7312 - loss: 0.6545 - val_accuracy: 0.8333 - val_loss: 0.6350
Epoch 42/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 35ms/step - accuracy: 0.7312 - loss: 0.6539 - val_accuracy: 0.8333 - val_loss: 0.6337
Epoch 43/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 35ms/step - accuracy: 0.7312 - loss: 0.6530 - val_accuracy: 0.8333 - val_loss: 0.6325
Epoch 44/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 36ms/step - accuracy: 0.7312 - loss: 0.6522 - val_accuracy: 0.8333 - val_loss: 0.6313
Epoch 45/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 68ms/step - accuracy: 0.7312 - loss: 0.6515 - val_accuracy: 0.8333 - val_loss: 0.6301
Epoch 46/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 40ms/step - accuracy: 0.7312 - loss: 0.6507 - val_accuracy: 0.8333 - val_loss: 0.6289
Epoch 47/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 35ms/step - accuracy: 0.7312 - loss: 0.6500 - val_accuracy: 0.8333 - val_loss: 0.6277
Epoch 48/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 35ms/step - accuracy: 0.7312 - loss: 0.6492 - val_accuracy: 0.8333 - val_loss: 0.6266
Epoch 49/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 35ms/step - accuracy: 0.7312 - loss: 0.6485 - val_accuracy: 0.8333 - val_loss: 0.6254
Epoch 50/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 35ms/step - accuracy: 0.7312 - loss: 0.6477 - val_accuracy: 0.8333 - val_loss: 0.6242
2025-10-31 15:59:48.797 | INFO     | src.ai_engine.ai_models:fit:685 - LSTM trained successfully.
2025-10-31 15:59:48.798 | INFO     | src.ai_engine.ai_models:fit:381 - Generating base model predictions for meta-model training...
2025-10-31 15:59:48.815 | INFO     | src.ai_engine.feature_engineering:create_sequences:261 - Creating sequences with length 50 from 228 data points.
2025-10-31 15:59:48.819 | INFO     | src.ai_engine.feature_engineering:create_sequences:270 - Created 178 sequences.
6/6 ━━━━━━━━━━━━━━━━━━━━ 3s 301ms/step
2025-10-31 15:59:53.010 | INFO     | src.ai_engine.ai_models:fit:396 - Training meta-model...
2025-10-31 15:59:53.028 | SUCCESS  | src.ai_engine.ai_models:fit:399 - Stacking Ensemble trained successfully.
2025-10-31 15:59:53.030 | SUCCESS  | __main__:main:167 - Final Ensemble model trained.
2025-10-31 15:59:53.031 | INFO     | __main__:main:171 - Saving models to 'models\PainX_1200\1d'...
2025-10-31 15:59:53.140 | INFO     | src.ai_engine.ai_models:save:52 - Model RandomForest saved to models\PainX_1200\1d\random_forest.pkl
2025-10-31 15:59:53.287 | INFO     | src.ai_engine.ai_models:save:52 - Model GradientBoosting saved to models\PainX_1200\1d\gradient_boosting.pkl
2025-10-31 15:59:53.493 | INFO     | src.ai_engine.ai_models:save:731 - LSTM model saved to models\PainX_1200\1d\lstm.keras, models\PainX_1200\1d\lstm_scaler.pkl and marker file models\PainX_1200\1d\lstm.pkl
2025-10-31 15:59:53.498 | INFO     | src.ai_engine.ai_models:save_all:463 - Meta-model saved to models\PainX_1200\1d\meta_model.pkl
2025-10-31 15:59:53.500 | SUCCESS  | __main__:main:174 - --- Finished training for Symbol: PainX 1200, Timeframe: 1d ---
2025-10-31 15:59:53.502 | INFO     | __main__:main:140 - --- Starting training for Symbol: PainX 1200, Timeframe: 1h ---
2025-10-31 15:59:53.592 | SUCCESS  | __main__:main:148 - Loaded 7227 records.
2025-10-31 15:59:53.593 | INFO     | __main__:prepare_training_data:32 - Preparing data for training with Meta-Labeling...
2025-10-31 15:59:54.184 | DEBUG    | src.ai_engine.technical_indicators:calculate_all:47 - Calculated 63 technical indicators
2025-10-31 15:59:55.429 | DEBUG    | src.ai_engine.feature_engineering:extract_features:66 - Extracted 116 features
2025-10-31 15:59:55.430 | INFO     | __main__:prepare_training_data:39 - Generating signals from primary model (SimplePatternModel)...
2025-10-31 15:59:55.448 | WARNING  | src.ai_engine.feature_engineering:prepare_for_model:230 - Se perdieron todos los datos al eliminar los NaN. Se conservarán los datos rellenados.
2025-10-31 15:59:56.596 | INFO     | src.ai_engine.ai_models:calculate_optimal_threshold:549 - Calculated optimal threshold: 0.0014 (volatility: 0.0005, avg_movement: 0.0020)
2025-10-31 15:59:56.597 | INFO     | src.ai_engine.ai_models:create_meta_labels:577 - Creating meta-labels for secondary model...
2025-10-31 15:59:57.491 | INFO     | src.ai_engine.ai_models:create_meta_labels:629 - Meta-Label distribution - Profitable: 1166 (35.6%), Unprofitable: 2111 (64.4%)
2025-10-31 15:59:57.516 | WARNING  | src.ai_engine.feature_engineering:prepare_for_model:230 - Se perdieron todos los datos al eliminar los NaN. Se conservarán los datos rellenados.
2025-10-31 15:59:57.526 | INFO     | __main__:prepare_training_data:75 - Data preparation complete. Shape of X: (5195, 116), Shape of y: (5195,)
2025-10-31 15:59:57.531 | INFO     | src.ai_engine.feature_engineering:create_sequences:261 - Creating sequences with length 50 from 5195 data points.
2025-10-31 15:59:57.596 | INFO     | src.ai_engine.feature_engineering:create_sequences:270 - Created 5145 sequences.
2025-10-31 15:59:57.597 | INFO     | __main__:main:164 - Initializing and training Ensemble model...
2025-10-31 15:59:57.598 | INFO     | src.ai_engine.ai_models:__init__:304 - Initialized Stacking Ensemble with Logistic Regression as meta-model.
2025-10-31 15:59:57.644 | INFO     | src.ai_engine.ai_models:fit:359 - Creating LSTM model...
2025-10-31 15:59:57.645 | INFO     | src.ai_engine.ai_models:fit:364 - Training base models...
2025-10-31 15:59:57.682 | INFO     | src.ai_engine.ai_models:fit:373 - Training random_forest...
2025-10-31 15:59:59.791 | INFO     | src.ai_engine.ai_models:fit:98 - RandomForest trained successfully on 5195 samples with 2 classes
2025-10-31 15:59:59.793 | INFO     | src.ai_engine.ai_models:fit:373 - Training gradient_boosting...
2025-10-31 16:00:54.613 | INFO     | src.ai_engine.ai_models:fit:157 - GradientBoosting trained successfully on 5195 samples with 2 classes
2025-10-31 16:00:54.614 | INFO     | src.ai_engine.ai_models:fit:373 - Training pattern_based...
2025-10-31 16:00:54.615 | INFO     | src.ai_engine.ai_models:fit:373 - Training lstm...
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\keras\src\layers\rnn\rnn.py:199: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(**kwargs)
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1108: RuntimeWarning: invalid value encountered in divide
  updated_mean = (last_sum + new_sum) / updated_sample_count
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1113: RuntimeWarning: invalid value encountered in divide
  T = new_sum / new_sample_count
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1133: RuntimeWarning: invalid value encountered in divide
  new_unnormalized_variance -= correction**2 / new_sample_count
Epoch 1/50
145/145 ━━━━━━━━━━━━━━━━━━━━ 28s 44ms/step - accuracy: 0.7795 - loss: 0.6748 - val_accuracy: 0.7709 - val_loss: 0.6583
Epoch 2/50
145/145 ━━━━━━━━━━━━━━━━━━━━ 4s 25ms/step - accuracy: 0.7795 - loss: 0.6421 - val_accuracy: 0.7709 - val_loss: 0.6303
Epoch 3/50
145/145 ━━━━━━━━━━━━━━━━━━━━ 4s 26ms/step - accuracy: 0.7795 - loss: 0.6157 - val_accuracy: 0.7709 - val_loss: 0.6076
Epoch 4/50
145/145 ━━━━━━━━━━━━━━━━━━━━ 4s 25ms/step - accuracy: 0.7795 - loss: 0.5947 - val_accuracy: 0.7709 - val_loss: 0.5899
Epoch 5/50
145/145 ━━━━━━━━━━━━━━━━━━━━ 4s 25ms/step - accuracy: 0.7795 - loss: 0.5781 - val_accuracy: 0.7709 - val_loss: 0.5762
Epoch 6/50
145/145 ━━━━━━━━━━━━━━━━━━━━ 4s 25ms/step - accuracy: 0.7795 - loss: 0.5652 - val_accuracy: 0.7709 - val_loss: 0.5656
Epoch 7/50
145/145 ━━━━━━━━━━━━━━━━━━━━ 4s 25ms/step - accuracy: 0.7795 - loss: 0.5552 - val_accuracy: 0.7709 - val_loss: 0.5576
Epoch 8/50
145/145 ━━━━━━━━━━━━━━━━━━━━ 4s 25ms/step - accuracy: 0.7795 - loss: 0.5476 - val_accuracy: 0.7709 - val_loss: 0.5517
Epoch 9/50
145/145 ━━━━━━━━━━━━━━━━━━━━ 4s 25ms/step - accuracy: 0.7795 - loss: 0.5419 - val_accuracy: 0.7709 - val_loss: 0.5473
Epoch 10/50
145/145 ━━━━━━━━━━━━━━━━━━━━ 4s 25ms/step - accuracy: 0.7795 - loss: 0.5376 - val_accuracy: 0.7709 - val_loss: 0.5441
Epoch 11/50
145/145 ━━━━━━━━━━━━━━━━━━━━ 4s 25ms/step - accuracy: 0.7795 - loss: 0.5346 - val_accuracy: 0.7709 - val_loss: 0.5420
Epoch 12/50
145/145 ━━━━━━━━━━━━━━━━━━━━ 4s 25ms/step - accuracy: 0.7795 - loss: 0.5324 - val_accuracy: 0.7709 - val_loss: 0.5406
Epoch 13/50
145/145 ━━━━━━━━━━━━━━━━━━━━ 4s 24ms/step - accuracy: 0.7795 - loss: 0.5308 - val_accuracy: 0.7709 - val_loss: 0.5396
Epoch 14/50
145/145 ━━━━━━━━━━━━━━━━━━━━ 4s 25ms/step - accuracy: 0.7795 - loss: 0.5297 - val_accuracy: 0.7709 - val_loss: 0.5389
Epoch 15/50
145/145 ━━━━━━━━━━━━━━━━━━━━ 4s 25ms/step - accuracy: 0.7795 - loss: 0.5290 - val_accuracy: 0.7709 - val_loss: 0.5385
Epoch 16/50
145/145 ━━━━━━━━━━━━━━━━━━━━ 4s 25ms/step - accuracy: 0.7795 - loss: 0.5285 - val_accuracy: 0.7709 - val_loss: 0.5384
Epoch 17/50
145/145 ━━━━━━━━━━━━━━━━━━━━ 4s 25ms/step - accuracy: 0.7795 - loss: 0.5282 - val_accuracy: 0.7709 - val_loss: 0.5383
Epoch 18/50
145/145 ━━━━━━━━━━━━━━━━━━━━ 4s 25ms/step - accuracy: 0.7795 - loss: 0.5279 - val_accuracy: 0.7709 - val_loss: 0.5382
Epoch 19/50
145/145 ━━━━━━━━━━━━━━━━━━━━ 4s 25ms/step - accuracy: 0.7795 - loss: 0.5278 - val_accuracy: 0.7709 - val_loss: 0.5382
Epoch 20/50
145/145 ━━━━━━━━━━━━━━━━━━━━ 4s 25ms/step - accuracy: 0.7795 - loss: 0.5277 - val_accuracy: 0.7709 - val_loss: 0.5382
Epoch 21/50
145/145 ━━━━━━━━━━━━━━━━━━━━ 4s 25ms/step - accuracy: 0.7795 - loss: 0.5277 - val_accuracy: 0.7709 - val_loss: 0.5383
Epoch 22/50
145/145 ━━━━━━━━━━━━━━━━━━━━ 4s 25ms/step - accuracy: 0.7795 - loss: 0.5276 - val_accuracy: 0.7709 - val_loss: 0.5383
Epoch 23/50
145/145 ━━━━━━━━━━━━━━━━━━━━ 4s 25ms/step - accuracy: 0.7795 - loss: 0.5276 - val_accuracy: 0.7709 - val_loss: 0.5383
Epoch 24/50
145/145 ━━━━━━━━━━━━━━━━━━━━ 4s 24ms/step - accuracy: 0.7795 - loss: 0.5276 - val_accuracy: 0.7709 - val_loss: 0.5383
Epoch 25/50
145/145 ━━━━━━━━━━━━━━━━━━━━ 4s 25ms/step - accuracy: 0.7795 - loss: 0.5276 - val_accuracy: 0.7709 - val_loss: 0.5384
Epoch 26/50
145/145 ━━━━━━━━━━━━━━━━━━━━ 4s 25ms/step - accuracy: 0.7795 - loss: 0.5276 - val_accuracy: 0.7709 - val_loss: 0.5384
Epoch 27/50
145/145 ━━━━━━━━━━━━━━━━━━━━ 4s 24ms/step - accuracy: 0.7795 - loss: 0.5276 - val_accuracy: 0.7709 - val_loss: 0.5384
Epoch 28/50
145/145 ━━━━━━━━━━━━━━━━━━━━ 4s 24ms/step - accuracy: 0.7795 - loss: 0.5276 - val_accuracy: 0.7709 - val_loss: 0.5384
Epoch 29/50
145/145 ━━━━━━━━━━━━━━━━━━━━ 4s 25ms/step - accuracy: 0.7795 - loss: 0.5276 - val_accuracy: 0.7709 - val_loss: 0.5384
2025-10-31 16:03:05.873 | INFO     | src.ai_engine.ai_models:fit:685 - LSTM trained successfully.
2025-10-31 16:03:05.881 | INFO     | src.ai_engine.ai_models:fit:381 - Generating base model predictions for meta-model training...
2025-10-31 16:03:06.223 | INFO     | src.ai_engine.feature_engineering:create_sequences:261 - Creating sequences with length 50 from 5195 data points.
2025-10-31 16:03:06.284 | INFO     | src.ai_engine.feature_engineering:create_sequences:270 - Created 5145 sequences.
161/161 ━━━━━━━━━━━━━━━━━━━━ 4s 16ms/step
2025-10-31 16:03:11.088 | INFO     | src.ai_engine.ai_models:fit:396 - Training meta-model...
2025-10-31 16:03:11.096 | SUCCESS  | src.ai_engine.ai_models:fit:399 - Stacking Ensemble trained successfully.
2025-10-31 16:03:11.097 | SUCCESS  | __main__:main:167 - Final Ensemble model trained.
2025-10-31 16:03:11.097 | INFO     | __main__:main:171 - Saving models to 'models\PainX_1200\1h'...
2025-10-31 16:03:11.163 | INFO     | src.ai_engine.ai_models:save:52 - Model RandomForest saved to models\PainX_1200\1h\random_forest.pkl
2025-10-31 16:03:11.217 | INFO     | src.ai_engine.ai_models:save:52 - Model GradientBoosting saved to models\PainX_1200\1h\gradient_boosting.pkl
2025-10-31 16:03:11.462 | INFO     | src.ai_engine.ai_models:save:731 - LSTM model saved to models\PainX_1200\1h\lstm.keras, models\PainX_1200\1h\lstm_scaler.pkl and marker file models\PainX_1200\1h\lstm.pkl
2025-10-31 16:03:11.466 | INFO     | src.ai_engine.ai_models:save_all:463 - Meta-model saved to models\PainX_1200\1h\meta_model.pkl
2025-10-31 16:03:11.468 | SUCCESS  | __main__:main:174 - --- Finished training for Symbol: PainX 1200, Timeframe: 1h ---
2025-10-31 16:03:11.518 | INFO     | __main__:main:140 - --- Starting training for Symbol: PainX 1200, Timeframe: 1m ---
2025-10-31 16:03:11.841 | SUCCESS  | __main__:main:148 - Loaded 100001 records.
2025-10-31 16:03:11.841 | INFO     | __main__:prepare_training_data:32 - Preparing data for training with Meta-Labeling...
2025-10-31 16:03:17.365 | DEBUG    | src.ai_engine.technical_indicators:calculate_all:47 - Calculated 63 technical indicators
2025-10-31 16:03:33.998 | DEBUG    | src.ai_engine.feature_engineering:extract_features:66 - Extracted 116 features
2025-10-31 16:03:34.003 | INFO     | __main__:prepare_training_data:39 - Generating signals from primary model (SimplePatternModel)...
2025-10-31 16:03:34.210 | WARNING  | src.ai_engine.feature_engineering:prepare_for_model:230 - Se perdieron todos los datos al eliminar los NaN. Se conservarán los datos rellenados.
2025-10-31 16:03:49.957 | INFO     | src.ai_engine.ai_models:calculate_optimal_threshold:549 - Calculated optimal threshold: 0.0010 (volatility: 0.0001, avg_movement: 0.0002)
2025-10-31 16:03:49.959 | INFO     | src.ai_engine.ai_models:create_meta_labels:577 - Creating meta-labels for secondary model...
2025-10-31 16:04:01.513 | INFO     | src.ai_engine.ai_models:create_meta_labels:629 - Meta-Label distribution - Profitable: 8 (17.0%), Unprofitable: 39 (83.0%)
2025-10-31 16:04:01.729 | WARNING  | src.ai_engine.feature_engineering:prepare_for_model:230 - Se perdieron todos los datos al eliminar los NaN. Se conservarán los datos rellenados.
2025-10-31 16:04:01.811 | INFO     | __main__:prepare_training_data:75 - Data preparation complete. Shape of X: (51341, 116), Shape of y: (51341,)
2025-10-31 16:04:01.846 | INFO     | src.ai_engine.feature_engineering:create_sequences:261 - Creating sequences with length 50 from 51341 data points.
2025-10-31 16:04:02.442 | INFO     | src.ai_engine.feature_engineering:create_sequences:270 - Created 51291 sequences.
2025-10-31 16:04:02.456 | INFO     | __main__:main:164 - Initializing and training Ensemble model...
2025-10-31 16:04:02.457 | INFO     | src.ai_engine.ai_models:__init__:304 - Initialized Stacking Ensemble with Logistic Regression as meta-model.
2025-10-31 16:04:02.490 | INFO     | src.ai_engine.ai_models:fit:359 - Creating LSTM model...
2025-10-31 16:04:02.491 | INFO     | src.ai_engine.ai_models:fit:364 - Training base models...
2025-10-31 16:04:02.582 | INFO     | src.ai_engine.ai_models:fit:373 - Training random_forest...
2025-10-31 16:04:05.986 | INFO     | src.ai_engine.ai_models:fit:98 - RandomForest trained successfully on 51341 samples with 2 classes
2025-10-31 16:04:05.988 | INFO     | src.ai_engine.ai_models:fit:373 - Training gradient_boosting...
2025-10-31 16:05:02.509 | INFO     | src.ai_engine.ai_models:fit:157 - GradientBoosting trained successfully on 51341 samples with 2 classes
2025-10-31 16:05:02.512 | INFO     | src.ai_engine.ai_models:fit:373 - Training pattern_based...
2025-10-31 16:05:02.514 | INFO     | src.ai_engine.ai_models:fit:373 - Training lstm...
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\keras\src\layers\rnn\rnn.py:199: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(**kwargs)
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1108: RuntimeWarning: invalid value encountered in divide
  updated_mean = (last_sum + new_sum) / updated_sample_count
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1113: RuntimeWarning: invalid value encountered in divide
  T = new_sum / new_sample_count
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1133: RuntimeWarning: invalid value encountered in divide
  new_unnormalized_variance -= correction**2 / new_sample_count
Epoch 1/50
1443/1443 ━━━━━━━━━━━━━━━━━━━━ 208s 44ms/step - accuracy: 0.9998 - loss: 0.4363 - val_accuracy: 1.0000 - val_loss: 0.2597
Epoch 2/50
1443/1443 ━━━━━━━━━━━━━━━━━━━━ 39s 26ms/step - accuracy: 0.9998 - loss: 0.1755 - val_accuracy: 1.0000 - val_loss: 0.1144
Epoch 3/50
1443/1443 ━━━━━━━━━━━━━━━━━━━━ 37s 25ms/step - accuracy: 0.9998 - loss: 0.0818 - val_accuracy: 1.0000 - val_loss: 0.0561
Epoch 4/50
1443/1443 ━━━━━━━━━━━━━━━━━━━━ 36s 25ms/step - accuracy: 0.9998 - loss: 0.0416 - val_accuracy: 1.0000 - val_loss: 0.0292
Epoch 5/50
1443/1443 ━━━━━━━━━━━━━━━━━━━━ 36s 25ms/step - accuracy: 0.9998 - loss: 0.0223 - val_accuracy: 1.0000 - val_loss: 0.0156
Epoch 6/50
1443/1443 ━━━━━━━━━━━━━━━━━━━━ 36s 25ms/step - accuracy: 0.9998 - loss: 0.0124 - val_accuracy: 1.0000 - val_loss: 0.0085
Epoch 7/50
1443/1443 ━━━━━━━━━━━━━━━━━━━━ 36s 25ms/step - accuracy: 0.9998 - loss: 0.0073 - val_accuracy: 1.0000 - val_loss: 0.0047
Epoch 8/50
1443/1443 ━━━━━━━━━━━━━━━━━━━━ 37s 25ms/step - accuracy: 0.9998 - loss: 0.0045 - val_accuracy: 1.0000 - val_loss: 0.0026
Epoch 9/50
1443/1443 ━━━━━━━━━━━━━━━━━━━━ 36s 25ms/step - accuracy: 0.9998 - loss: 0.0031 - val_accuracy: 1.0000 - val_loss: 0.0015
Epoch 10/50
1443/1443 ━━━━━━━━━━━━━━━━━━━━ 36s 25ms/step - accuracy: 0.9998 - loss: 0.0024 - val_accuracy: 1.0000 - val_loss: 9.7310e-04
Epoch 11/50
1443/1443 ━━━━━━━━━━━━━━━━━━━━ 36s 25ms/step - accuracy: 0.9998 - loss: 0.0020 - val_accuracy: 1.0000 - val_loss: 6.8529e-04
Epoch 12/50
1443/1443 ━━━━━━━━━━━━━━━━━━━━ 36s 25ms/step - accuracy: 0.9998 - loss: 0.0019 - val_accuracy: 1.0000 - val_loss: 5.2902e-04
Epoch 13/50
1443/1443 ━━━━━━━━━━━━━━━━━━━━ 37s 26ms/step - accuracy: 0.9998 - loss: 0.0018 - val_accuracy: 1.0000 - val_loss: 4.3763e-04
Epoch 14/50
1443/1443 ━━━━━━━━━━━━━━━━━━━━ 36s 25ms/step - accuracy: 0.9998 - loss: 0.0018 - val_accuracy: 1.0000 - val_loss: 3.7697e-04
Epoch 15/50
1443/1443 ━━━━━━━━━━━━━━━━━━━━ 36s 25ms/step - accuracy: 0.9998 - loss: 0.0017 - val_accuracy: 1.0000 - val_loss: 3.3625e-04
Epoch 16/50
1443/1443 ━━━━━━━━━━━━━━━━━━━━ 36s 25ms/step - accuracy: 0.9998 - loss: 0.0017 - val_accuracy: 1.0000 - val_loss: 3.0531e-04
Epoch 17/50
1443/1443 ━━━━━━━━━━━━━━━━━━━━ 36s 25ms/step - accuracy: 0.9998 - loss: 0.0017 - val_accuracy: 1.0000 - val_loss: 2.8081e-04
Epoch 18/50
1443/1443 ━━━━━━━━━━━━━━━━━━━━ 36s 25ms/step - accuracy: 0.9998 - loss: 0.0017 - val_accuracy: 1.0000 - val_loss: 2.6047e-04
Epoch 19/50
1443/1443 ━━━━━━━━━━━━━━━━━━━━ 36s 25ms/step - accuracy: 0.9998 - loss: 0.0017 - val_accuracy: 1.0000 - val_loss: 2.4757e-04
Epoch 20/50
1443/1443 ━━━━━━━━━━━━━━━━━━━━ 36s 25ms/step - accuracy: 0.9998 - loss: 0.0017 - val_accuracy: 1.0000 - val_loss: 2.3625e-04
Epoch 21/50
1443/1443 ━━━━━━━━━━━━━━━━━━━━ 35s 25ms/step - accuracy: 0.9998 - loss: 0.0017 - val_accuracy: 1.0000 - val_loss: 2.2678e-04
Epoch 22/50
1443/1443 ━━━━━━━━━━━━━━━━━━━━ 36s 25ms/step - accuracy: 0.9998 - loss: 0.0017 - val_accuracy: 1.0000 - val_loss: 2.1800e-04
Epoch 23/50
1443/1443 ━━━━━━━━━━━━━━━━━━━━ 36s 25ms/step - accuracy: 0.9998 - loss: 0.0017 - val_accuracy: 1.0000 - val_loss: 2.1078e-04
Epoch 24/50
1443/1443 ━━━━━━━━━━━━━━━━━━━━ 36s 25ms/step - accuracy: 0.9998 - loss: 0.0017 - val_accuracy: 1.0000 - val_loss: 2.0499e-04
Epoch 25/50
1443/1443 ━━━━━━━━━━━━━━━━━━━━ 36s 25ms/step - accuracy: 0.9998 - loss: 0.0017 - val_accuracy: 1.0000 - val_loss: 1.9998e-04
Epoch 26/50
1443/1443 ━━━━━━━━━━━━━━━━━━━━ 36s 25ms/step - accuracy: 0.9998 - loss: 0.0017 - val_accuracy: 1.0000 - val_loss: 1.9538e-04
Epoch 27/50
1443/1443 ━━━━━━━━━━━━━━━━━━━━ 36s 25ms/step - accuracy: 0.9998 - loss: 0.0017 - val_accuracy: 1.0000 - val_loss: 1.9100e-04
Epoch 28/50
1443/1443 ━━━━━━━━━━━━━━━━━━━━ 36s 25ms/step - accuracy: 0.9998 - loss: 0.0017 - val_accuracy: 1.0000 - val_loss: 1.8853e-04
Epoch 29/50
1443/1443 ━━━━━━━━━━━━━━━━━━━━ 36s 25ms/step - accuracy: 0.9998 - loss: 0.0017 - val_accuracy: 1.0000 - val_loss: 1.8606e-04
Epoch 30/50
1443/1443 ━━━━━━━━━━━━━━━━━━━━ 36s 25ms/step - accuracy: 0.9998 - loss: 0.0017 - val_accuracy: 1.0000 - val_loss: 1.8377e-04
Epoch 31/50
1443/1443 ━━━━━━━━━━━━━━━━━━━━ 35s 24ms/step - accuracy: 0.9998 - loss: 0.0017 - val_accuracy: 1.0000 - val_loss: 1.8175e-04
Epoch 32/50
1443/1443 ━━━━━━━━━━━━━━━━━━━━ 36s 25ms/step - accuracy: 0.9998 - loss: 0.0017 - val_accuracy: 1.0000 - val_loss: 1.7921e-04
Epoch 33/50
1443/1443 ━━━━━━━━━━━━━━━━━━━━ 36s 25ms/step - accuracy: 0.9998 - loss: 0.0017 - val_accuracy: 1.0000 - val_loss: 1.7721e-04
Epoch 34/50
1443/1443 ━━━━━━━━━━━━━━━━━━━━ 36s 25ms/step - accuracy: 0.9998 - loss: 0.0017 - val_accuracy: 1.0000 - val_loss: 1.7572e-04
Epoch 35/50
1443/1443 ━━━━━━━━━━━━━━━━━━━━ 36s 25ms/step - accuracy: 0.9998 - loss: 0.0017 - val_accuracy: 1.0000 - val_loss: 1.7288e-04
Epoch 36/50
1443/1443 ━━━━━━━━━━━━━━━━━━━━ 36s 25ms/step - accuracy: 0.9998 - loss: 0.0017 - val_accuracy: 1.0000 - val_loss: 1.7333e-04
Epoch 37/50
1443/1443 ━━━━━━━━━━━━━━━━━━━━ 36s 25ms/step - accuracy: 0.9998 - loss: 0.0017 - val_accuracy: 1.0000 - val_loss: 1.7262e-04
Epoch 38/50
1443/1443 ━━━━━━━━━━━━━━━━━━━━ 37s 25ms/step - accuracy: 0.9998 - loss: 0.0017 - val_accuracy: 1.0000 - val_loss: 1.7183e-04
Epoch 39/50
1443/1443 ━━━━━━━━━━━━━━━━━━━━ 41s 25ms/step - accuracy: 0.9998 - loss: 0.0017 - val_accuracy: 1.0000 - val_loss: 1.7122e-04
Epoch 40/50
1443/1443 ━━━━━━━━━━━━━━━━━━━━ 36s 25ms/step - accuracy: 0.9998 - loss: 0.0017 - val_accuracy: 1.0000 - val_loss: 1.7058e-04
Epoch 41/50
1443/1443 ━━━━━━━━━━━━━━━━━━━━ 36s 25ms/step - accuracy: 0.9998 - loss: 0.0017 - val_accuracy: 1.0000 - val_loss: 1.6998e-04
Epoch 42/50
1443/1443 ━━━━━━━━━━━━━━━━━━━━ 36s 25ms/step - accuracy: 0.9998 - loss: 0.0017 - val_accuracy: 1.0000 - val_loss: 1.6892e-04
Epoch 43/50
1443/1443 ━━━━━━━━━━━━━━━━━━━━ 40s 25ms/step - accuracy: 0.9998 - loss: 0.0017 - val_accuracy: 1.0000 - val_loss: 1.6908e-04
Epoch 44/50
1443/1443 ━━━━━━━━━━━━━━━━━━━━ 36s 25ms/step - accuracy: 0.9998 - loss: 0.0017 - val_accuracy: 1.0000 - val_loss: 1.6859e-04
Epoch 45/50
1443/1443 ━━━━━━━━━━━━━━━━━━━━ 36s 25ms/step - accuracy: 0.9998 - loss: 0.0017 - val_accuracy: 1.0000 - val_loss: 1.6660e-04
Epoch 46/50
1443/1443 ━━━━━━━━━━━━━━━━━━━━ 36s 25ms/step - accuracy: 0.9998 - loss: 0.0017 - val_accuracy: 1.0000 - val_loss: 1.6753e-04
Epoch 47/50
1443/1443 ━━━━━━━━━━━━━━━━━━━━ 36s 25ms/step - accuracy: 0.9998 - loss: 0.0017 - val_accuracy: 1.0000 - val_loss: 1.6735e-04
Epoch 48/50
1443/1443 ━━━━━━━━━━━━━━━━━━━━ 36s 25ms/step - accuracy: 0.9998 - loss: 0.0017 - val_accuracy: 1.0000 - val_loss: 1.6715e-04
Epoch 49/50
1443/1443 ━━━━━━━━━━━━━━━━━━━━ 36s 25ms/step - accuracy: 0.9998 - loss: 0.0017 - val_accuracy: 1.0000 - val_loss: 1.6687e-04
Epoch 50/50
1443/1443 ━━━━━━━━━━━━━━━━━━━━ 36s 25ms/step - accuracy: 0.9998 - loss: 0.0017 - val_accuracy: 1.0000 - val_loss: 1.6657e-04
2025-10-31 16:59:29.310 | INFO     | src.ai_engine.ai_models:fit:685 - LSTM trained successfully.
2025-10-31 16:59:32.006 | INFO     | src.ai_engine.ai_models:fit:381 - Generating base model predictions for meta-model training...
2025-10-31 16:59:43.556 | INFO     | src.ai_engine.feature_engineering:create_sequences:261 - Creating sequences with length 50 from 51341 data points.
2025-10-31 16:59:44.343 | INFO     | src.ai_engine.feature_engineering:create_sequences:270 - Created 51291 sequences.
1603/1603 ━━━━━━━━━━━━━━━━━━━━ 236s 29ms/step
2025-10-31 17:12:39.144 | INFO     | src.ai_engine.ai_models:fit:396 - Training meta-model...
2025-10-31 17:12:50.279 | SUCCESS  | src.ai_engine.ai_models:fit:399 - Stacking Ensemble trained successfully.
2025-10-31 17:12:51.011 | SUCCESS  | __main__:main:167 - Final Ensemble model trained.
2025-10-31 17:12:51.044 | INFO     | __main__:main:171 - Saving models to 'models\PainX_1200\1m'...
2025-10-31 17:12:58.195 | INFO     | src.ai_engine.ai_models:save:52 - Model RandomForest saved to models\PainX_1200\1m\random_forest.pkl
2025-10-31 17:12:59.981 | INFO     | src.ai_engine.ai_models:save:52 - Model GradientBoosting saved to models\PainX_1200\1m\gradient_boosting.pkl
2025-10-31 17:13:09.521 | INFO     | src.ai_engine.ai_models:save:731 - LSTM model saved to models\PainX_1200\1m\lstm.keras, models\PainX_1200\1m\lstm_scaler.pkl and marker file models\PainX_1200\1m\lstm.pkl
2025-10-31 17:13:09.628 | INFO     | src.ai_engine.ai_models:save_all:463 - Meta-model saved to models\PainX_1200\1m\meta_model.pkl
2025-10-31 17:13:09.649 | SUCCESS  | __main__:main:174 - --- Finished training for Symbol: PainX 1200, Timeframe: 1m ---
2025-10-31 17:13:09.678 | INFO     | __main__:main:140 - --- Starting training for Symbol: PainX 1200, Timeframe: 4h ---
2025-10-31 17:13:13.375 | SUCCESS  | __main__:main:148 - Loaded 1809 records.
2025-10-31 17:13:13.408 | INFO     | __main__:prepare_training_data:32 - Preparing data for training with Meta-Labeling...
2025-10-31 17:13:17.247 | DEBUG    | src.ai_engine.technical_indicators:calculate_all:47 - Calculated 63 technical indicators
2025-10-31 17:13:21.072 | DEBUG    | src.ai_engine.feature_engineering:extract_features:66 - Extracted 116 features
2025-10-31 17:13:21.094 | INFO     | __main__:prepare_training_data:39 - Generating signals from primary model (SimplePatternModel)...
2025-10-31 17:13:21.492 | WARNING  | src.ai_engine.feature_engineering:prepare_for_model:230 - Se perdieron todos los datos al eliminar los NaN. Se conservarán los datos rellenados.
2025-10-31 17:13:24.884 | INFO     | src.ai_engine.ai_models:calculate_optimal_threshold:549 - Calculated optimal threshold: 0.0027 (volatility: 0.0009, avg_movement: 0.0037)
2025-10-31 17:13:24.886 | INFO     | src.ai_engine.ai_models:create_meta_labels:577 - Creating meta-labels for secondary model...
2025-10-31 17:13:25.170 | INFO     | src.ai_engine.ai_models:create_meta_labels:629 - Meta-Label distribution - Profitable: 291 (34.4%), Unprofitable: 555 (65.6%)
2025-10-31 17:13:25.796 | WARNING  | src.ai_engine.feature_engineering:prepare_for_model:230 - Se perdieron todos los datos al eliminar los NaN. Se conservarán los datos rellenados.
2025-10-31 17:13:25.889 | INFO     | __main__:prepare_training_data:75 - Data preparation complete. Shape of X: (1275, 116), Shape of y: (1275,)
2025-10-31 17:13:26.279 | INFO     | src.ai_engine.feature_engineering:create_sequences:261 - Creating sequences with length 50 from 1275 data points.
2025-10-31 17:13:26.371 | INFO     | src.ai_engine.feature_engineering:create_sequences:270 - Created 1225 sequences.
2025-10-31 17:13:26.792 | INFO     | __main__:main:164 - Initializing and training Ensemble model...
2025-10-31 17:13:26.823 | INFO     | src.ai_engine.ai_models:__init__:304 - Initialized Stacking Ensemble with Logistic Regression as meta-model.
2025-10-31 17:13:27.583 | INFO     | src.ai_engine.ai_models:fit:359 - Creating LSTM model...
2025-10-31 17:13:27.584 | INFO     | src.ai_engine.ai_models:fit:364 - Training base models...
2025-10-31 17:13:27.588 | INFO     | src.ai_engine.ai_models:fit:373 - Training random_forest...
2025-10-31 17:13:33.829 | INFO     | src.ai_engine.ai_models:fit:98 - RandomForest trained successfully on 1275 samples with 2 classes
2025-10-31 17:13:33.832 | INFO     | src.ai_engine.ai_models:fit:373 - Training gradient_boosting...
2025-10-31 17:13:49.916 | INFO     | src.ai_engine.ai_models:fit:157 - GradientBoosting trained successfully on 1275 samples with 2 classes
2025-10-31 17:13:49.917 | INFO     | src.ai_engine.ai_models:fit:373 - Training pattern_based...
2025-10-31 17:13:49.918 | INFO     | src.ai_engine.ai_models:fit:373 - Training lstm...
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\keras\src\layers\rnn\rnn.py:199: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(**kwargs)
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1108: RuntimeWarning: invalid value encountered in divide
  updated_mean = (last_sum + new_sum) / updated_sample_count
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1113: RuntimeWarning: invalid value encountered in divide
  T = new_sum / new_sample_count
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1133: RuntimeWarning: invalid value encountered in divide
  new_unnormalized_variance -= correction**2 / new_sample_count
Epoch 1/50
35/35 ━━━━━━━━━━━━━━━━━━━━ 91s 245ms/step - accuracy: 0.7877 - loss: 0.6888 - val_accuracy: 0.6423 - val_loss: 0.6885
Epoch 2/50
35/35 ━━━━━━━━━━━━━━━━━━━━ 2s 50ms/step - accuracy: 0.7877 - loss: 0.6794 - val_accuracy: 0.6423 - val_loss: 0.6844
Epoch 3/50
35/35 ━━━━━━━━━━━━━━━━━━━━ 2s 48ms/step - accuracy: 0.7877 - loss: 0.6705 - val_accuracy: 0.6423 - val_loss: 0.6803
Epoch 4/50
35/35 ━━━━━━━━━━━━━━━━━━━━ 1s 37ms/step - accuracy: 0.7877 - loss: 0.6618 - val_accuracy: 0.6423 - val_loss: 0.6766
Epoch 5/50
35/35 ━━━━━━━━━━━━━━━━━━━━ 2s 39ms/step - accuracy: 0.7877 - loss: 0.6536 - val_accuracy: 0.6423 - val_loss: 0.6733
Epoch 6/50
35/35 ━━━━━━━━━━━━━━━━━━━━ 1s 36ms/step - accuracy: 0.7877 - loss: 0.6459 - val_accuracy: 0.6423 - val_loss: 0.6702
Epoch 7/50
35/35 ━━━━━━━━━━━━━━━━━━━━ 1s 29ms/step - accuracy: 0.7877 - loss: 0.6384 - val_accuracy: 0.6423 - val_loss: 0.6675
Epoch 8/50
35/35 ━━━━━━━━━━━━━━━━━━━━ 1s 29ms/step - accuracy: 0.7877 - loss: 0.6314 - val_accuracy: 0.6423 - val_loss: 0.6650
Epoch 9/50
35/35 ━━━━━━━━━━━━━━━━━━━━ 1s 37ms/step - accuracy: 0.7877 - loss: 0.6247 - val_accuracy: 0.6423 - val_loss: 0.6627
Epoch 10/50
35/35 ━━━━━━━━━━━━━━━━━━━━ 1s 27ms/step - accuracy: 0.7877 - loss: 0.6183 - val_accuracy: 0.6423 - val_loss: 0.6607
Epoch 11/50
35/35 ━━━━━━━━━━━━━━━━━━━━ 1s 32ms/step - accuracy: 0.7877 - loss: 0.6123 - val_accuracy: 0.6423 - val_loss: 0.6590
Epoch 12/50
35/35 ━━━━━━━━━━━━━━━━━━━━ 1s 30ms/step - accuracy: 0.7877 - loss: 0.6065 - val_accuracy: 0.6423 - val_loss: 0.6575
Epoch 13/50
35/35 ━━━━━━━━━━━━━━━━━━━━ 1s 27ms/step - accuracy: 0.7877 - loss: 0.6010 - val_accuracy: 0.6423 - val_loss: 0.6562
Epoch 14/50
35/35 ━━━━━━━━━━━━━━━━━━━━ 1s 27ms/step - accuracy: 0.7877 - loss: 0.5958 - val_accuracy: 0.6423 - val_loss: 0.6551
Epoch 15/50
35/35 ━━━━━━━━━━━━━━━━━━━━ 1s 26ms/step - accuracy: 0.7877 - loss: 0.5909 - val_accuracy: 0.6423 - val_loss: 0.6542
Epoch 16/50
35/35 ━━━━━━━━━━━━━━━━━━━━ 1s 30ms/step - accuracy: 0.7877 - loss: 0.5864 - val_accuracy: 0.6423 - val_loss: 0.6534
Epoch 17/50
35/35 ━━━━━━━━━━━━━━━━━━━━ 1s 26ms/step - accuracy: 0.7877 - loss: 0.5819 - val_accuracy: 0.6423 - val_loss: 0.6529
Epoch 18/50
35/35 ━━━━━━━━━━━━━━━━━━━━ 1s 26ms/step - accuracy: 0.7877 - loss: 0.5778 - val_accuracy: 0.6423 - val_loss: 0.6525
Epoch 19/50
35/35 ━━━━━━━━━━━━━━━━━━━━ 1s 26ms/step - accuracy: 0.7877 - loss: 0.5739 - val_accuracy: 0.6423 - val_loss: 0.6522
Epoch 20/50
35/35 ━━━━━━━━━━━━━━━━━━━━ 1s 27ms/step - accuracy: 0.7877 - loss: 0.5703 - val_accuracy: 0.6423 - val_loss: 0.6521
Epoch 21/50
35/35 ━━━━━━━━━━━━━━━━━━━━ 1s 26ms/step - accuracy: 0.7877 - loss: 0.5668 - val_accuracy: 0.6423 - val_loss: 0.6521
Epoch 22/50
35/35 ━━━━━━━━━━━━━━━━━━━━ 1s 29ms/step - accuracy: 0.7877 - loss: 0.5635 - val_accuracy: 0.6423 - val_loss: 0.6522
Epoch 23/50
35/35 ━━━━━━━━━━━━━━━━━━━━ 1s 27ms/step - accuracy: 0.7877 - loss: 0.5604 - val_accuracy: 0.6423 - val_loss: 0.6525
Epoch 24/50
35/35 ━━━━━━━━━━━━━━━━━━━━ 1s 26ms/step - accuracy: 0.7877 - loss: 0.5574 - val_accuracy: 0.6423 - val_loss: 0.6528
Epoch 25/50
35/35 ━━━━━━━━━━━━━━━━━━━━ 1s 29ms/step - accuracy: 0.7877 - loss: 0.5547 - val_accuracy: 0.6423 - val_loss: 0.6533
Epoch 26/50
35/35 ━━━━━━━━━━━━━━━━━━━━ 1s 29ms/step - accuracy: 0.7877 - loss: 0.5521 - val_accuracy: 0.6423 - val_loss: 0.6539
Epoch 27/50
35/35 ━━━━━━━━━━━━━━━━━━━━ 1s 27ms/step - accuracy: 0.7877 - loss: 0.5496 - val_accuracy: 0.6423 - val_loss: 0.6544
Epoch 28/50
35/35 ━━━━━━━━━━━━━━━━━━━━ 1s 27ms/step - accuracy: 0.7877 - loss: 0.5474 - val_accuracy: 0.6423 - val_loss: 0.6551
Epoch 29/50
35/35 ━━━━━━━━━━━━━━━━━━━━ 1s 28ms/step - accuracy: 0.7877 - loss: 0.5452 - val_accuracy: 0.6423 - val_loss: 0.6559
Epoch 30/50
35/35 ━━━━━━━━━━━━━━━━━━━━ 1s 27ms/step - accuracy: 0.7877 - loss: 0.5433 - val_accuracy: 0.6423 - val_loss: 0.6567
2025-10-31 17:16:02.111 | INFO     | src.ai_engine.ai_models:fit:685 - LSTM trained successfully.
2025-10-31 17:16:02.125 | INFO     | src.ai_engine.ai_models:fit:381 - Generating base model predictions for meta-model training...
2025-10-31 17:16:02.251 | INFO     | src.ai_engine.feature_engineering:create_sequences:261 - Creating sequences with length 50 from 1275 data points.
2025-10-31 17:16:02.266 | INFO     | src.ai_engine.feature_engineering:create_sequences:270 - Created 1225 sequences.
39/39 ━━━━━━━━━━━━━━━━━━━━ 5s 88ms/step
2025-10-31 17:16:08.131 | INFO     | src.ai_engine.ai_models:fit:396 - Training meta-model...
2025-10-31 17:16:08.182 | SUCCESS  | src.ai_engine.ai_models:fit:399 - Stacking Ensemble trained successfully.
2025-10-31 17:16:08.207 | SUCCESS  | __main__:main:167 - Final Ensemble model trained.
2025-10-31 17:16:08.209 | INFO     | __main__:main:171 - Saving models to 'models\PainX_1200\4h'...
2025-10-31 17:16:09.238 | INFO     | src.ai_engine.ai_models:save:52 - Model RandomForest saved to models\PainX_1200\4h\random_forest.pkl
2025-10-31 17:16:09.592 | INFO     | src.ai_engine.ai_models:save:52 - Model GradientBoosting saved to models\PainX_1200\4h\gradient_boosting.pkl
2025-10-31 17:16:09.942 | INFO     | src.ai_engine.ai_models:save:731 - LSTM model saved to models\PainX_1200\4h\lstm.keras, models\PainX_1200\4h\lstm_scaler.pkl and marker file models\PainX_1200\4h\lstm.pkl
2025-10-31 17:16:09.947 | INFO     | src.ai_engine.ai_models:save_all:463 - Meta-model saved to models\PainX_1200\4h\meta_model.pkl
2025-10-31 17:16:09.949 | SUCCESS  | __main__:main:174 - --- Finished training for Symbol: PainX 1200, Timeframe: 4h ---
2025-10-31 17:16:09.991 | INFO     | __main__:main:140 - --- Starting training for Symbol: PainX 1200, Timeframe: 5m ---
2025-10-31 17:16:10.421 | SUCCESS  | __main__:main:148 - Loaded 86685 records.
2025-10-31 17:16:10.421 | INFO     | __main__:prepare_training_data:32 - Preparing data for training with Meta-Labeling...
2025-10-31 17:16:15.288 | DEBUG    | src.ai_engine.technical_indicators:calculate_all:47 - Calculated 63 technical indicators
2025-10-31 17:16:29.961 | DEBUG    | src.ai_engine.feature_engineering:extract_features:66 - Extracted 116 features
2025-10-31 17:16:30.012 | INFO     | __main__:prepare_training_data:39 - Generating signals from primary model (SimplePatternModel)...
2025-10-31 17:16:30.282 | WARNING  | src.ai_engine.feature_engineering:prepare_for_model:230 - Se perdieron todos los datos al eliminar los NaN. Se conservarán los datos rellenados.
2025-10-31 17:16:44.117 | INFO     | src.ai_engine.ai_models:calculate_optimal_threshold:549 - Calculated optimal threshold: 0.0010 (volatility: 0.0001, avg_movement: 0.0006)
2025-10-31 17:16:44.119 | INFO     | src.ai_engine.ai_models:create_meta_labels:577 - Creating meta-labels for secondary model...
2025-10-31 17:16:57.711 | INFO     | src.ai_engine.ai_models:create_meta_labels:629 - Meta-Label distribution - Profitable: 320 (14.2%), Unprofitable: 1939 (85.8%)
2025-10-31 17:16:57.946 | WARNING  | src.ai_engine.feature_engineering:prepare_for_model:230 - Se perdieron todos los datos al eliminar los NaN. Se conservarán los datos rellenados.
2025-10-31 17:16:58.039 | INFO     | __main__:prepare_training_data:75 - Data preparation complete. Shape of X: (59861, 116), Shape of y: (59861,)
2025-10-31 17:16:58.200 | INFO     | src.ai_engine.feature_engineering:create_sequences:261 - Creating sequences with length 50 from 59861 data points.
2025-10-31 17:16:59.049 | INFO     | src.ai_engine.feature_engineering:create_sequences:270 - Created 59811 sequences.
2025-10-31 17:16:59.058 | INFO     | __main__:main:164 - Initializing and training Ensemble model...
2025-10-31 17:16:59.058 | INFO     | src.ai_engine.ai_models:__init__:304 - Initialized Stacking Ensemble with Logistic Regression as meta-model.
2025-10-31 17:16:59.163 | INFO     | src.ai_engine.ai_models:fit:359 - Creating LSTM model...
2025-10-31 17:16:59.164 | INFO     | src.ai_engine.ai_models:fit:364 - Training base models...
2025-10-31 17:16:59.302 | INFO     | src.ai_engine.ai_models:fit:373 - Training random_forest...
2025-10-31 17:17:17.769 | INFO     | src.ai_engine.ai_models:fit:98 - RandomForest trained successfully on 59861 samples with 2 classes
2025-10-31 17:17:17.773 | INFO     | src.ai_engine.ai_models:fit:373 - Training gradient_boosting...
2025-10-31 17:28:24.066 | INFO     | src.ai_engine.ai_models:fit:157 - GradientBoosting trained successfully on 59861 samples with 2 classes
2025-10-31 17:28:24.070 | INFO     | src.ai_engine.ai_models:fit:373 - Training pattern_based...
2025-10-31 17:28:24.072 | INFO     | src.ai_engine.ai_models:fit:373 - Training lstm...
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\keras\src\layers\rnn\rnn.py:199: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(**kwargs)
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1108: RuntimeWarning: invalid value encountered in divide
  updated_mean = (last_sum + new_sum) / updated_sample_count
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1113: RuntimeWarning: invalid value encountered in divide
  T = new_sum / new_sample_count
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1133: RuntimeWarning: invalid value encountered in divide
  new_unnormalized_variance -= correction**2 / new_sample_count
Epoch 1/50
1683/1683 ━━━━━━━━━━━━━━━━━━━━ 320s 34ms/step - accuracy: 0.9949 - loss: 0.4125 - val_accuracy: 0.9920 - val_loss: 0.2361
Epoch 2/50
1683/1683 ━━━━━━━━━━━━━━━━━━━━ 44s 25ms/step - accuracy: 0.9949 - loss: 0.1554 - val_accuracy: 0.9920 - val_loss: 0.1098
Epoch 3/50
1683/1683 ━━━━━━━━━━━━━━━━━━━━ 42s 25ms/step - accuracy: 0.9949 - loss: 0.0770 - val_accuracy: 0.9920 - val_loss: 0.0675
Epoch 4/50
1683/1683 ━━━━━━━━━━━━━━━━━━━━ 43s 25ms/step - accuracy: 0.9949 - loss: 0.0481 - val_accuracy: 0.9920 - val_loss: 0.0521
Epoch 5/50
1683/1683 ━━━━━━━━━━━━━━━━━━━━ 43s 25ms/step - accuracy: 0.9949 - loss: 0.0371 - val_accuracy: 0.9920 - val_loss: 0.0475
Epoch 6/50
1683/1683 ━━━━━━━━━━━━━━━━━━━━ 43s 25ms/step - accuracy: 0.9949 - loss: 0.0332 - val_accuracy: 0.9920 - val_loss: 0.0467
Epoch 7/50
1683/1683 ━━━━━━━━━━━━━━━━━━━━ 41s 25ms/step - accuracy: 0.9949 - loss: 0.0321 - val_accuracy: 0.9920 - val_loss: 0.0469
Epoch 8/50
1683/1683 ━━━━━━━━━━━━━━━━━━━━ 41s 24ms/step - accuracy: 0.9949 - loss: 0.0318 - val_accuracy: 0.9920 - val_loss: 0.0472
Epoch 9/50
1683/1683 ━━━━━━━━━━━━━━━━━━━━ 42s 25ms/step - accuracy: 0.9949 - loss: 0.0318 - val_accuracy: 0.9920 - val_loss: 0.0473
Epoch 10/50
1683/1683 ━━━━━━━━━━━━━━━━━━━━ 41s 24ms/step - accuracy: 0.9949 - loss: 0.0318 - val_accuracy: 0.9920 - val_loss: 0.0474
Epoch 11/50
1683/1683 ━━━━━━━━━━━━━━━━━━━━ 41s 24ms/step - accuracy: 0.9949 - loss: 0.0318 - val_accuracy: 0.9920 - val_loss: 0.0474
Epoch 12/50
1683/1683 ━━━━━━━━━━━━━━━━━━━━ 41s 24ms/step - accuracy: 0.9949 - loss: 0.0318 - val_accuracy: 0.9920 - val_loss: 0.0474
Epoch 13/50
1683/1683 ━━━━━━━━━━━━━━━━━━━━ 41s 24ms/step - accuracy: 0.9949 - loss: 0.0318 - val_accuracy: 0.9920 - val_loss: 0.0474
Epoch 14/50
1683/1683 ━━━━━━━━━━━━━━━━━━━━ 41s 24ms/step - accuracy: 0.9949 - loss: 0.0318 - val_accuracy: 0.9920 - val_loss: 0.0475
Epoch 15/50
1683/1683 ━━━━━━━━━━━━━━━━━━━━ 41s 25ms/step - accuracy: 0.9949 - loss: 0.0318 - val_accuracy: 0.9920 - val_loss: 0.0475
Epoch 16/50
1683/1683 ━━━━━━━━━━━━━━━━━━━━ 42s 25ms/step - accuracy: 0.9949 - loss: 0.0318 - val_accuracy: 0.9920 - val_loss: 0.0475
2025-10-31 18:05:22.223 | INFO     | src.ai_engine.ai_models:fit:685 - LSTM trained successfully.
2025-10-31 18:05:23.463 | INFO     | src.ai_engine.ai_models:fit:381 - Generating base model predictions for meta-model training...
2025-10-31 18:05:48.054 | INFO     | src.ai_engine.feature_engineering:create_sequences:261 - Creating sequences with length 50 from 59861 data points.
2025-10-31 18:05:49.153 | INFO     | src.ai_engine.feature_engineering:create_sequences:270 - Created 59811 sequences.
1870/1870 ━━━━━━━━━━━━━━━━━━━━ 297s 33ms/step
2025-10-31 18:25:08.762 | INFO     | src.ai_engine.ai_models:fit:396 - Training meta-model...
2025-10-31 18:25:15.740 | SUCCESS  | src.ai_engine.ai_models:fit:399 - Stacking Ensemble trained successfully.
2025-10-31 18:25:16.348 | SUCCESS  | __main__:main:167 - Final Ensemble model trained.
2025-10-31 18:25:16.406 | INFO     | __main__:main:171 - Saving models to 'models\PainX_1200\5m'...
2025-10-31 18:25:25.695 | INFO     | src.ai_engine.ai_models:save:52 - Model RandomForest saved to models\PainX_1200\5m\random_forest.pkl
2025-10-31 18:25:27.776 | INFO     | src.ai_engine.ai_models:save:52 - Model GradientBoosting saved to models\PainX_1200\5m\gradient_boosting.pkl
2025-10-31 18:25:37.717 | INFO     | src.ai_engine.ai_models:save:731 - LSTM model saved to models\PainX_1200\5m\lstm.keras, models\PainX_1200\5m\lstm_scaler.pkl and marker file models\PainX_1200\5m\lstm.pkl
2025-10-31 18:25:37.807 | INFO     | src.ai_engine.ai_models:save_all:463 - Meta-model saved to models\PainX_1200\5m\meta_model.pkl
2025-10-31 18:25:37.808 | SUCCESS  | __main__:main:174 - --- Finished training for Symbol: PainX 1200, Timeframe: 5m ---
2025-10-31 18:25:37.891 | INFO     | __main__:main:140 - --- Starting training for Symbol: PainX 400, Timeframe: 15m ---
2025-10-31 18:25:42.183 | SUCCESS  | __main__:main:148 - Loaded 28862 records.
2025-10-31 18:25:42.185 | INFO     | __main__:prepare_training_data:32 - Preparing data for training with Meta-Labeling...
2025-10-31 18:25:48.085 | DEBUG    | src.ai_engine.technical_indicators:calculate_all:47 - Calculated 63 technical indicators
2025-10-31 18:25:55.086 | DEBUG    | src.ai_engine.feature_engineering:extract_features:66 - Extracted 116 features
2025-10-31 18:25:55.088 | INFO     | __main__:prepare_training_data:39 - Generating signals from primary model (SimplePatternModel)...
2025-10-31 18:25:55.253 | WARNING  | src.ai_engine.feature_engineering:prepare_for_model:230 - Se perdieron todos los datos al eliminar los NaN. Se conservarán los datos rellenados.
2025-10-31 18:26:01.345 | INFO     | src.ai_engine.ai_models:calculate_optimal_threshold:549 - Calculated optimal threshold: 0.0012 (volatility: 0.0004, avg_movement: 0.0018)
2025-10-31 18:26:01.349 | INFO     | src.ai_engine.ai_models:create_meta_labels:577 - Creating meta-labels for secondary model...
2025-10-31 18:26:04.933 | INFO     | src.ai_engine.ai_models:create_meta_labels:629 - Meta-Label distribution - Profitable: 4416 (33.8%), Unprofitable: 8645 (66.2%)
2025-10-31 18:26:05.070 | WARNING  | src.ai_engine.feature_engineering:prepare_for_model:230 - Se perdieron todos los datos al eliminar los NaN. Se conservarán los datos rellenados.
2025-10-31 18:26:05.118 | INFO     | __main__:prepare_training_data:75 - Data preparation complete. Shape of X: (20528, 116), Shape of y: (20528,)
2025-10-31 18:26:05.463 | INFO     | src.ai_engine.feature_engineering:create_sequences:261 - Creating sequences with length 50 from 20528 data points.
2025-10-31 18:26:05.758 | INFO     | src.ai_engine.feature_engineering:create_sequences:270 - Created 20478 sequences.
2025-10-31 18:26:06.316 | INFO     | __main__:main:164 - Initializing and training Ensemble model...
2025-10-31 18:26:06.326 | INFO     | src.ai_engine.ai_models:__init__:304 - Initialized Stacking Ensemble with Logistic Regression as meta-model.
2025-10-31 18:26:08.093 | INFO     | src.ai_engine.ai_models:fit:359 - Creating LSTM model...
2025-10-31 18:26:08.094 | INFO     | src.ai_engine.ai_models:fit:364 - Training base models...
2025-10-31 18:26:08.132 | INFO     | src.ai_engine.ai_models:fit:373 - Training random_forest...
2025-10-31 18:26:23.923 | INFO     | src.ai_engine.ai_models:fit:98 - RandomForest trained successfully on 20528 samples with 2 classes
2025-10-31 18:26:23.927 | INFO     | src.ai_engine.ai_models:fit:373 - Training gradient_boosting...
2025-10-31 18:30:16.103 | INFO     | src.ai_engine.ai_models:fit:157 - GradientBoosting trained successfully on 20528 samples with 2 classes
2025-10-31 18:30:16.121 | INFO     | src.ai_engine.ai_models:fit:373 - Training pattern_based...
2025-10-31 18:30:16.122 | INFO     | src.ai_engine.ai_models:fit:373 - Training lstm...
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\keras\src\layers\rnn\rnn.py:199: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(**kwargs)
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1108: RuntimeWarning: invalid value encountered in divide
  updated_mean = (last_sum + new_sum) / updated_sample_count
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1113: RuntimeWarning: invalid value encountered in divide
  T = new_sum / new_sample_count
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1133: RuntimeWarning: invalid value encountered in divide
  new_unnormalized_variance -= correction**2 / new_sample_count
Epoch 1/50
576/576 ━━━━━━━━━━━━━━━━━━━━ 270s 34ms/step - accuracy: 0.7834 - loss: 0.6308 - val_accuracy: 0.7944 - val_loss: 0.5787
Epoch 2/50
576/576 ━━━━━━━━━━━━━━━━━━━━ 16s 27ms/step - accuracy: 0.7834 - loss: 0.5593 - val_accuracy: 0.7944 - val_loss: 0.5322
Epoch 3/50
576/576 ━━━━━━━━━━━━━━━━━━━━ 16s 28ms/step - accuracy: 0.7834 - loss: 0.5329 - val_accuracy: 0.7944 - val_loss: 0.5155
Epoch 4/50
576/576 ━━━━━━━━━━━━━━━━━━━━ 16s 27ms/step - accuracy: 0.7834 - loss: 0.5250 - val_accuracy: 0.7944 - val_loss: 0.5105
Epoch 5/50
576/576 ━━━━━━━━━━━━━━━━━━━━ 16s 27ms/step - accuracy: 0.7834 - loss: 0.5230 - val_accuracy: 0.7944 - val_loss: 0.5089
Epoch 6/50
576/576 ━━━━━━━━━━━━━━━━━━━━ 16s 27ms/step - accuracy: 0.7834 - loss: 0.5227 - val_accuracy: 0.7944 - val_loss: 0.5086
Epoch 7/50
576/576 ━━━━━━━━━━━━━━━━━━━━ 16s 27ms/step - accuracy: 0.7834 - loss: 0.5226 - val_accuracy: 0.7944 - val_loss: 0.5084
Epoch 8/50
576/576 ━━━━━━━━━━━━━━━━━━━━ 16s 27ms/step - accuracy: 0.7834 - loss: 0.5226 - val_accuracy: 0.7944 - val_loss: 0.5085
Epoch 9/50
576/576 ━━━━━━━━━━━━━━━━━━━━ 16s 27ms/step - accuracy: 0.7834 - loss: 0.5226 - val_accuracy: 0.7944 - val_loss: 0.5084
Epoch 10/50
576/576 ━━━━━━━━━━━━━━━━━━━━ 16s 27ms/step - accuracy: 0.7834 - loss: 0.5226 - val_accuracy: 0.7944 - val_loss: 0.5084
Epoch 11/50
576/576 ━━━━━━━━━━━━━━━━━━━━ 16s 27ms/step - accuracy: 0.7834 - loss: 0.5226 - val_accuracy: 0.7944 - val_loss: 0.5084
Epoch 12/50
576/576 ━━━━━━━━━━━━━━━━━━━━ 16s 27ms/step - accuracy: 0.7834 - loss: 0.5226 - val_accuracy: 0.7944 - val_loss: 0.5084
Epoch 13/50
576/576 ━━━━━━━━━━━━━━━━━━━━ 16s 27ms/step - accuracy: 0.7834 - loss: 0.5226 - val_accuracy: 0.7944 - val_loss: 0.5084
Epoch 14/50
576/576 ━━━━━━━━━━━━━━━━━━━━ 16s 27ms/step - accuracy: 0.7834 - loss: 0.5226 - val_accuracy: 0.7944 - val_loss: 0.5083
Epoch 15/50
576/576 ━━━━━━━━━━━━━━━━━━━━ 16s 27ms/step - accuracy: 0.7834 - loss: 0.5226 - val_accuracy: 0.7944 - val_loss: 0.5084
Epoch 16/50
576/576 ━━━━━━━━━━━━━━━━━━━━ 16s 28ms/step - accuracy: 0.7834 - loss: 0.5226 - val_accuracy: 0.7944 - val_loss: 0.5085
Epoch 17/50
576/576 ━━━━━━━━━━━━━━━━━━━━ 16s 27ms/step - accuracy: 0.7834 - loss: 0.5226 - val_accuracy: 0.7944 - val_loss: 0.5084
Epoch 18/50
576/576 ━━━━━━━━━━━━━━━━━━━━ 16s 27ms/step - accuracy: 0.7834 - loss: 0.5226 - val_accuracy: 0.7944 - val_loss: 0.5084
Epoch 19/50
576/576 ━━━━━━━━━━━━━━━━━━━━ 16s 27ms/step - accuracy: 0.7834 - loss: 0.5226 - val_accuracy: 0.7944 - val_loss: 0.5084
Epoch 20/50
576/576 ━━━━━━━━━━━━━━━━━━━━ 16s 27ms/step - accuracy: 0.7834 - loss: 0.5226 - val_accuracy: 0.7944 - val_loss: 0.5084
Epoch 21/50
576/576 ━━━━━━━━━━━━━━━━━━━━ 16s 27ms/step - accuracy: 0.7834 - loss: 0.5226 - val_accuracy: 0.7944 - val_loss: 0.5085
Epoch 22/50
576/576 ━━━━━━━━━━━━━━━━━━━━ 16s 27ms/step - accuracy: 0.7834 - loss: 0.5226 - val_accuracy: 0.7944 - val_loss: 0.5084
Epoch 23/50
576/576 ━━━━━━━━━━━━━━━━━━━━ 16s 27ms/step - accuracy: 0.7834 - loss: 0.5226 - val_accuracy: 0.7944 - val_loss: 0.5084
Epoch 24/50
576/576 ━━━━━━━━━━━━━━━━━━━━ 16s 27ms/step - accuracy: 0.7834 - loss: 0.5226 - val_accuracy: 0.7944 - val_loss: 0.5083
Epoch 25/50
576/576 ━━━━━━━━━━━━━━━━━━━━ 16s 27ms/step - accuracy: 0.7834 - loss: 0.5226 - val_accuracy: 0.7944 - val_loss: 0.5084
Epoch 26/50
576/576 ━━━━━━━━━━━━━━━━━━━━ 16s 27ms/step - accuracy: 0.7834 - loss: 0.5226 - val_accuracy: 0.7944 - val_loss: 0.5084
Epoch 27/50
576/576 ━━━━━━━━━━━━━━━━━━━━ 16s 27ms/step - accuracy: 0.7834 - loss: 0.5226 - val_accuracy: 0.7944 - val_loss: 0.5083
Epoch 28/50
576/576 ━━━━━━━━━━━━━━━━━━━━ 16s 27ms/step - accuracy: 0.7834 - loss: 0.5226 - val_accuracy: 0.7944 - val_loss: 0.5084
Epoch 29/50
576/576 ━━━━━━━━━━━━━━━━━━━━ 16s 27ms/step - accuracy: 0.7834 - loss: 0.5226 - val_accuracy: 0.7944 - val_loss: 0.5083
Epoch 30/50
576/576 ━━━━━━━━━━━━━━━━━━━━ 16s 27ms/step - accuracy: 0.7834 - loss: 0.5226 - val_accuracy: 0.7944 - val_loss: 0.5084
Epoch 31/50
576/576 ━━━━━━━━━━━━━━━━━━━━ 16s 27ms/step - accuracy: 0.7834 - loss: 0.5226 - val_accuracy: 0.7944 - val_loss: 0.5084
Epoch 32/50
576/576 ━━━━━━━━━━━━━━━━━━━━ 16s 27ms/step - accuracy: 0.7834 - loss: 0.5226 - val_accuracy: 0.7944 - val_loss: 0.5084
Epoch 33/50
576/576 ━━━━━━━━━━━━━━━━━━━━ 16s 27ms/step - accuracy: 0.7834 - loss: 0.5226 - val_accuracy: 0.7944 - val_loss: 0.5083
Epoch 34/50
576/576 ━━━━━━━━━━━━━━━━━━━━ 16s 27ms/step - accuracy: 0.7834 - loss: 0.5226 - val_accuracy: 0.7944 - val_loss: 0.5084
Epoch 35/50
576/576 ━━━━━━━━━━━━━━━━━━━━ 16s 27ms/step - accuracy: 0.7834 - loss: 0.5226 - val_accuracy: 0.7944 - val_loss: 0.5084
Epoch 36/50
576/576 ━━━━━━━━━━━━━━━━━━━━ 16s 27ms/step - accuracy: 0.7834 - loss: 0.5226 - val_accuracy: 0.7944 - val_loss: 0.5085
Epoch 37/50
576/576 ━━━━━━━━━━━━━━━━━━━━ 16s 27ms/step - accuracy: 0.7834 - loss: 0.5226 - val_accuracy: 0.7944 - val_loss: 0.5084
Epoch 38/50
576/576 ━━━━━━━━━━━━━━━━━━━━ 16s 27ms/step - accuracy: 0.7834 - loss: 0.5226 - val_accuracy: 0.7944 - val_loss: 0.5084
Epoch 39/50
576/576 ━━━━━━━━━━━━━━━━━━━━ 16s 27ms/step - accuracy: 0.7834 - loss: 0.5226 - val_accuracy: 0.7944 - val_loss: 0.5083
Epoch 40/50
576/576 ━━━━━━━━━━━━━━━━━━━━ 16s 27ms/step - accuracy: 0.7834 - loss: 0.5226 - val_accuracy: 0.7944 - val_loss: 0.5083
Epoch 41/50
576/576 ━━━━━━━━━━━━━━━━━━━━ 16s 27ms/step - accuracy: 0.7834 - loss: 0.5226 - val_accuracy: 0.7944 - val_loss: 0.5084
Epoch 42/50
576/576 ━━━━━━━━━━━━━━━━━━━━ 16s 27ms/step - accuracy: 0.7834 - loss: 0.5226 - val_accuracy: 0.7944 - val_loss: 0.5084
Epoch 43/50
576/576 ━━━━━━━━━━━━━━━━━━━━ 16s 27ms/step - accuracy: 0.7834 - loss: 0.5226 - val_accuracy: 0.7944 - val_loss: 0.5084
Epoch 44/50
576/576 ━━━━━━━━━━━━━━━━━━━━ 16s 27ms/step - accuracy: 0.7834 - loss: 0.5226 - val_accuracy: 0.7944 - val_loss: 0.5084
Epoch 45/50
576/576 ━━━━━━━━━━━━━━━━━━━━ 16s 27ms/step - accuracy: 0.7834 - loss: 0.5226 - val_accuracy: 0.7944 - val_loss: 0.5084
Epoch 46/50
576/576 ━━━━━━━━━━━━━━━━━━━━ 16s 27ms/step - accuracy: 0.7834 - loss: 0.5226 - val_accuracy: 0.7944 - val_loss: 0.5084
Epoch 47/50
576/576 ━━━━━━━━━━━━━━━━━━━━ 16s 27ms/step - accuracy: 0.7834 - loss: 0.5226 - val_accuracy: 0.7944 - val_loss: 0.5084
Epoch 48/50
576/576 ━━━━━━━━━━━━━━━━━━━━ 16s 27ms/step - accuracy: 0.7834 - loss: 0.5226 - val_accuracy: 0.7944 - val_loss: 0.5084
Epoch 49/50
576/576 ━━━━━━━━━━━━━━━━━━━━ 16s 27ms/step - accuracy: 0.7834 - loss: 0.5226 - val_accuracy: 0.7944 - val_loss: 0.5083
2025-10-31 18:47:27.321 | INFO     | src.ai_engine.ai_models:fit:685 - LSTM trained successfully.
2025-10-31 18:47:27.399 | INFO     | src.ai_engine.ai_models:fit:381 - Generating base model predictions for meta-model training...
2025-10-31 18:47:28.720 | INFO     | src.ai_engine.feature_engineering:create_sequences:261 - Creating sequences with length 50 from 20528 data points.
2025-10-31 18:47:28.962 | INFO     | src.ai_engine.feature_engineering:create_sequences:270 - Created 20478 sequences.
640/640 ━━━━━━━━━━━━━━━━━━━━ 10s 12ms/step
2025-10-31 18:47:51.450 | INFO     | src.ai_engine.ai_models:fit:396 - Training meta-model...
2025-10-31 18:47:51.465 | SUCCESS  | src.ai_engine.ai_models:fit:399 - Stacking Ensemble trained successfully.
2025-10-31 18:47:51.467 | SUCCESS  | __main__:main:167 - Final Ensemble model trained.
2025-10-31 18:47:51.467 | INFO     | __main__:main:171 - Saving models to 'models\PainX_400\15m'...
2025-10-31 18:47:51.935 | INFO     | src.ai_engine.ai_models:save:52 - Model RandomForest saved to models\PainX_400\15m\random_forest.pkl
2025-10-31 18:47:52.003 | INFO     | src.ai_engine.ai_models:save:52 - Model GradientBoosting saved to models\PainX_400\15m\gradient_boosting.pkl
2025-10-31 18:47:52.112 | INFO     | src.ai_engine.ai_models:save:731 - LSTM model saved to models\PainX_400\15m\lstm.keras, models\PainX_400\15m\lstm_scaler.pkl and marker file models\PainX_400\15m\lstm.pkl
2025-10-31 18:47:52.122 | INFO     | src.ai_engine.ai_models:save_all:463 - Meta-model saved to models\PainX_400\15m\meta_model.pkl
2025-10-31 18:47:52.122 | SUCCESS  | __main__:main:174 - --- Finished training for Symbol: PainX 400, Timeframe: 15m ---
2025-10-31 18:47:52.123 | INFO     | __main__:main:140 - --- Starting training for Symbol: PainX 400, Timeframe: 1d ---
2025-10-31 18:47:52.160 | SUCCESS  | __main__:main:148 - Loaded 302 records.
2025-10-31 18:47:52.160 | INFO     | __main__:prepare_training_data:32 - Preparing data for training with Meta-Labeling...
2025-10-31 18:47:52.221 | DEBUG    | src.ai_engine.technical_indicators:calculate_all:47 - Calculated 62 technical indicators
2025-10-31 18:47:52.276 | DEBUG    | src.ai_engine.feature_engineering:extract_features:66 - Extracted 116 features
2025-10-31 18:47:52.277 | INFO     | __main__:prepare_training_data:39 - Generating signals from primary model (SimplePatternModel)...
2025-10-31 18:47:52.281 | WARNING  | src.ai_engine.feature_engineering:prepare_for_model:230 - Se perdieron todos los datos al eliminar los NaN. Se conservarán los datos rellenados.
2025-10-31 18:47:52.334 | INFO     | src.ai_engine.ai_models:calculate_optimal_threshold:549 - Calculated optimal threshold: 0.0118 (volatility: 0.0038, avg_movement: 0.0163)
2025-10-31 18:47:52.334 | INFO     | src.ai_engine.ai_models:create_meta_labels:577 - Creating meta-labels for secondary model...
2025-10-31 18:47:52.373 | INFO     | src.ai_engine.ai_models:create_meta_labels:629 - Meta-Label distribution - Profitable: 65 (44.2%), Unprofitable: 82 (55.8%)
2025-10-31 18:47:52.381 | WARNING  | src.ai_engine.feature_engineering:prepare_for_model:230 - Se perdieron todos los datos al eliminar los NaN. Se conservarán los datos rellenados.
2025-10-31 18:47:52.383 | INFO     | __main__:prepare_training_data:75 - Data preparation complete. Shape of X: (216, 116), Shape of y: (216,)
2025-10-31 18:47:52.388 | INFO     | src.ai_engine.feature_engineering:create_sequences:261 - Creating sequences with length 50 from 216 data points.
2025-10-31 18:47:52.391 | INFO     | src.ai_engine.feature_engineering:create_sequences:270 - Created 166 sequences.
2025-10-31 18:47:52.457 | INFO     | __main__:main:164 - Initializing and training Ensemble model...
2025-10-31 18:47:52.458 | INFO     | src.ai_engine.ai_models:__init__:304 - Initialized Stacking Ensemble with Logistic Regression as meta-model.
2025-10-31 18:47:52.493 | INFO     | src.ai_engine.ai_models:fit:359 - Creating LSTM model...
2025-10-31 18:47:52.494 | INFO     | src.ai_engine.ai_models:fit:364 - Training base models...
2025-10-31 18:47:52.497 | INFO     | src.ai_engine.ai_models:fit:373 - Training random_forest...
2025-10-31 18:47:53.033 | INFO     | src.ai_engine.ai_models:fit:98 - RandomForest trained successfully on 216 samples with 2 classes
2025-10-31 18:47:53.034 | INFO     | src.ai_engine.ai_models:fit:373 - Training gradient_boosting...
2025-10-31 18:47:54.821 | INFO     | src.ai_engine.ai_models:fit:157 - GradientBoosting trained successfully on 216 samples with 2 classes
2025-10-31 18:47:54.821 | INFO     | src.ai_engine.ai_models:fit:373 - Training pattern_based...
2025-10-31 18:47:54.825 | INFO     | src.ai_engine.ai_models:fit:373 - Training lstm...
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\keras\src\layers\rnn\rnn.py:199: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(**kwargs)
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1108: RuntimeWarning: invalid value encountered in divide
  updated_mean = (last_sum + new_sum) / updated_sample_count
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1113: RuntimeWarning: invalid value encountered in divide
  T = new_sum / new_sample_count
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1133: RuntimeWarning: invalid value encountered in divide
  new_unnormalized_variance -= correction**2 / new_sample_count
Epoch 1/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 24s 744ms/step - accuracy: 0.6443 - loss: 0.6928 - val_accuracy: 0.9412 - val_loss: 0.6910
Epoch 2/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 1s 182ms/step - accuracy: 0.6443 - loss: 0.6922 - val_accuracy: 0.9412 - val_loss: 0.6888
Epoch 3/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 1s 112ms/step - accuracy: 0.6443 - loss: 0.6914 - val_accuracy: 0.9412 - val_loss: 0.6867
Epoch 4/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 65ms/step - accuracy: 0.6443 - loss: 0.6908 - val_accuracy: 0.9412 - val_loss: 0.6847
Epoch 5/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 104ms/step - accuracy: 0.6443 - loss: 0.6901 - val_accuracy: 0.9412 - val_loss: 0.6826
Epoch 6/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 39ms/step - accuracy: 0.6443 - loss: 0.6896 - val_accuracy: 0.9412 - val_loss: 0.6806
Epoch 7/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 46ms/step - accuracy: 0.6443 - loss: 0.6889 - val_accuracy: 0.9412 - val_loss: 0.6787
Epoch 8/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 48ms/step - accuracy: 0.6443 - loss: 0.6883 - val_accuracy: 0.9412 - val_loss: 0.6769
Epoch 9/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 65ms/step - accuracy: 0.6443 - loss: 0.6878 - val_accuracy: 0.9412 - val_loss: 0.6751
Epoch 10/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 40ms/step - accuracy: 0.6443 - loss: 0.6872 - val_accuracy: 0.9412 - val_loss: 0.6733
Epoch 11/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 43ms/step - accuracy: 0.6443 - loss: 0.6866 - val_accuracy: 0.9412 - val_loss: 0.6715
Epoch 12/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 39ms/step - accuracy: 0.6443 - loss: 0.6861 - val_accuracy: 0.9412 - val_loss: 0.6697
Epoch 13/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 39ms/step - accuracy: 0.6443 - loss: 0.6855 - val_accuracy: 0.9412 - val_loss: 0.6680
Epoch 14/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 39ms/step - accuracy: 0.6443 - loss: 0.6850 - val_accuracy: 0.9412 - val_loss: 0.6663
Epoch 15/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 39ms/step - accuracy: 0.6443 - loss: 0.6845 - val_accuracy: 0.9412 - val_loss: 0.6645
Epoch 16/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 53ms/step - accuracy: 0.6443 - loss: 0.6839 - val_accuracy: 0.9412 - val_loss: 0.6628
Epoch 17/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 39ms/step - accuracy: 0.6443 - loss: 0.6834 - val_accuracy: 0.9412 - val_loss: 0.6609
Epoch 18/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 39ms/step - accuracy: 0.6443 - loss: 0.6828 - val_accuracy: 0.9412 - val_loss: 0.6593
Epoch 19/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 39ms/step - accuracy: 0.6443 - loss: 0.6824 - val_accuracy: 0.9412 - val_loss: 0.6574
Epoch 20/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 39ms/step - accuracy: 0.6443 - loss: 0.6819 - val_accuracy: 0.9412 - val_loss: 0.6557
Epoch 21/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 39ms/step - accuracy: 0.6443 - loss: 0.6814 - val_accuracy: 0.9412 - val_loss: 0.6540
Epoch 22/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 39ms/step - accuracy: 0.6443 - loss: 0.6809 - val_accuracy: 0.9412 - val_loss: 0.6524
Epoch 23/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 39ms/step - accuracy: 0.6443 - loss: 0.6804 - val_accuracy: 0.9412 - val_loss: 0.6508
Epoch 24/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 39ms/step - accuracy: 0.6443 - loss: 0.6799 - val_accuracy: 0.9412 - val_loss: 0.6492
Epoch 25/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 39ms/step - accuracy: 0.6443 - loss: 0.6795 - val_accuracy: 0.9412 - val_loss: 0.6476
Epoch 26/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 39ms/step - accuracy: 0.6443 - loss: 0.6791 - val_accuracy: 0.9412 - val_loss: 0.6459
Epoch 27/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 39ms/step - accuracy: 0.6443 - loss: 0.6786 - val_accuracy: 0.9412 - val_loss: 0.6444
Epoch 28/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 44ms/step - accuracy: 0.6443 - loss: 0.6782 - val_accuracy: 0.9412 - val_loss: 0.6429
Epoch 29/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 62ms/step - accuracy: 0.6443 - loss: 0.6777 - val_accuracy: 0.9412 - val_loss: 0.6414
Epoch 30/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 39ms/step - accuracy: 0.6443 - loss: 0.6773 - val_accuracy: 0.9412 - val_loss: 0.6398
Epoch 31/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 39ms/step - accuracy: 0.6443 - loss: 0.6769 - val_accuracy: 0.9412 - val_loss: 0.6383
Epoch 32/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 39ms/step - accuracy: 0.6443 - loss: 0.6765 - val_accuracy: 0.9412 - val_loss: 0.6367
Epoch 33/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 38ms/step - accuracy: 0.6443 - loss: 0.6760 - val_accuracy: 0.9412 - val_loss: 0.6352
Epoch 34/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 39ms/step - accuracy: 0.6443 - loss: 0.6756 - val_accuracy: 0.9412 - val_loss: 0.6336
Epoch 35/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 39ms/step - accuracy: 0.6443 - loss: 0.6751 - val_accuracy: 0.9412 - val_loss: 0.6322
Epoch 36/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 39ms/step - accuracy: 0.6443 - loss: 0.6748 - val_accuracy: 0.9412 - val_loss: 0.6307
Epoch 37/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 39ms/step - accuracy: 0.6443 - loss: 0.6744 - val_accuracy: 0.9412 - val_loss: 0.6292
Epoch 38/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 40ms/step - accuracy: 0.6443 - loss: 0.6740 - val_accuracy: 0.9412 - val_loss: 0.6277
Epoch 39/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 39ms/step - accuracy: 0.6443 - loss: 0.6736 - val_accuracy: 0.9412 - val_loss: 0.6261
Epoch 40/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 39ms/step - accuracy: 0.6443 - loss: 0.6733 - val_accuracy: 0.9412 - val_loss: 0.6245
Epoch 41/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 39ms/step - accuracy: 0.6443 - loss: 0.6728 - val_accuracy: 0.9412 - val_loss: 0.6232
Epoch 42/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 44ms/step - accuracy: 0.6443 - loss: 0.6725 - val_accuracy: 0.9412 - val_loss: 0.6218
Epoch 43/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 49ms/step - accuracy: 0.6443 - loss: 0.6721 - val_accuracy: 0.9412 - val_loss: 0.6205
Epoch 44/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 47ms/step - accuracy: 0.6443 - loss: 0.6717 - val_accuracy: 0.9412 - val_loss: 0.6192
Epoch 45/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 39ms/step - accuracy: 0.6443 - loss: 0.6714 - val_accuracy: 0.9412 - val_loss: 0.6178
Epoch 46/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 39ms/step - accuracy: 0.6443 - loss: 0.6711 - val_accuracy: 0.9412 - val_loss: 0.6165
Epoch 47/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 39ms/step - accuracy: 0.6443 - loss: 0.6708 - val_accuracy: 0.9412 - val_loss: 0.6151
Epoch 48/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 52ms/step - accuracy: 0.6443 - loss: 0.6704 - val_accuracy: 0.9412 - val_loss: 0.6138
Epoch 49/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 40ms/step - accuracy: 0.6443 - loss: 0.6701 - val_accuracy: 0.9412 - val_loss: 0.6125
Epoch 50/50
5/5 ━━━━━━━━━━━━━━━━━━━━ 0s 39ms/step - accuracy: 0.6443 - loss: 0.6698 - val_accuracy: 0.9412 - val_loss: 0.6111
2025-10-31 18:48:31.523 | INFO     | src.ai_engine.ai_models:fit:685 - LSTM trained successfully.
2025-10-31 18:48:31.523 | INFO     | src.ai_engine.ai_models:fit:381 - Generating base model predictions for meta-model training...
2025-10-31 18:48:31.540 | INFO     | src.ai_engine.feature_engineering:create_sequences:261 - Creating sequences with length 50 from 216 data points.
2025-10-31 18:48:31.543 | INFO     | src.ai_engine.feature_engineering:create_sequences:270 - Created 166 sequences.
6/6 ━━━━━━━━━━━━━━━━━━━━ 2s 244ms/step
2025-10-31 18:48:33.868 | INFO     | src.ai_engine.ai_models:fit:396 - Training meta-model...
2025-10-31 18:48:33.882 | SUCCESS  | src.ai_engine.ai_models:fit:399 - Stacking Ensemble trained successfully.
2025-10-31 18:48:33.883 | SUCCESS  | __main__:main:167 - Final Ensemble model trained.
2025-10-31 18:48:33.884 | INFO     | __main__:main:171 - Saving models to 'models\PainX_400\1d'...
2025-10-31 18:48:34.011 | INFO     | src.ai_engine.ai_models:save:52 - Model RandomForest saved to models\PainX_400\1d\random_forest.pkl
2025-10-31 18:48:34.072 | INFO     | src.ai_engine.ai_models:save:52 - Model GradientBoosting saved to models\PainX_400\1d\gradient_boosting.pkl
2025-10-31 18:48:34.181 | INFO     | src.ai_engine.ai_models:save:731 - LSTM model saved to models\PainX_400\1d\lstm.keras, models\PainX_400\1d\lstm_scaler.pkl and marker file models\PainX_400\1d\lstm.pkl
2025-10-31 18:48:34.200 | INFO     | src.ai_engine.ai_models:save_all:463 - Meta-model saved to models\PainX_400\1d\meta_model.pkl
2025-10-31 18:48:34.201 | SUCCESS  | __main__:main:174 - --- Finished training for Symbol: PainX 400, Timeframe: 1d ---
2025-10-31 18:48:34.201 | INFO     | __main__:main:140 - --- Starting training for Symbol: PainX 400, Timeframe: 1h ---
2025-10-31 18:48:34.280 | SUCCESS  | __main__:main:148 - Loaded 7227 records.
2025-10-31 18:48:34.280 | INFO     | __main__:prepare_training_data:32 - Preparing data for training with Meta-Labeling...
2025-10-31 18:48:34.729 | DEBUG    | src.ai_engine.technical_indicators:calculate_all:47 - Calculated 63 technical indicators
2025-10-31 18:48:35.983 | DEBUG    | src.ai_engine.feature_engineering:extract_features:66 - Extracted 116 features
2025-10-31 18:48:35.984 | INFO     | __main__:prepare_training_data:39 - Generating signals from primary model (SimplePatternModel)...
2025-10-31 18:48:36.004 | WARNING  | src.ai_engine.feature_engineering:prepare_for_model:230 - Se perdieron todos los datos al eliminar los NaN. Se conservarán los datos rellenados.
2025-10-31 18:48:37.162 | INFO     | src.ai_engine.ai_models:calculate_optimal_threshold:549 - Calculated optimal threshold: 0.0025 (volatility: 0.0008, avg_movement: 0.0035)
2025-10-31 18:48:37.163 | INFO     | src.ai_engine.ai_models:create_meta_labels:577 - Creating meta-labels for secondary model...
2025-10-31 18:48:38.033 | INFO     | src.ai_engine.ai_models:create_meta_labels:629 - Meta-Label distribution - Profitable: 1005 (28.7%), Unprofitable: 2492 (71.3%)
2025-10-31 18:48:38.058 | WARNING  | src.ai_engine.feature_engineering:prepare_for_model:230 - Se perdieron todos los datos al eliminar los NaN. Se conservarán los datos rellenados.
2025-10-31 18:48:38.070 | INFO     | __main__:prepare_training_data:75 - Data preparation complete. Shape of X: (5209, 116), Shape of y: (5209,)
2025-10-31 18:48:38.074 | INFO     | src.ai_engine.feature_engineering:create_sequences:261 - Creating sequences with length 50 from 5209 data points.
2025-10-31 18:48:38.136 | INFO     | src.ai_engine.feature_engineering:create_sequences:270 - Created 5159 sequences.
2025-10-31 18:48:38.138 | INFO     | __main__:main:164 - Initializing and training Ensemble model...
2025-10-31 18:48:38.139 | INFO     | src.ai_engine.ai_models:__init__:304 - Initialized Stacking Ensemble with Logistic Regression as meta-model.
2025-10-31 18:48:38.142 | INFO     | src.ai_engine.ai_models:fit:359 - Creating LSTM model...
2025-10-31 18:48:38.142 | INFO     | src.ai_engine.ai_models:fit:364 - Training base models...
2025-10-31 18:48:38.152 | INFO     | src.ai_engine.ai_models:fit:373 - Training random_forest...
2025-10-31 18:48:40.172 | INFO     | src.ai_engine.ai_models:fit:98 - RandomForest trained successfully on 5209 samples with 2 classes
2025-10-31 18:48:40.173 | INFO     | src.ai_engine.ai_models:fit:373 - Training gradient_boosting...
2025-10-31 18:49:33.330 | INFO     | src.ai_engine.ai_models:fit:157 - GradientBoosting trained successfully on 5209 samples with 2 classes
2025-10-31 18:49:33.331 | INFO     | src.ai_engine.ai_models:fit:373 - Training pattern_based...
2025-10-31 18:49:33.332 | INFO     | src.ai_engine.ai_models:fit:373 - Training lstm...
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\keras\src\layers\rnn\rnn.py:199: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(**kwargs)
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1108: RuntimeWarning: invalid value encountered in divide
  updated_mean = (last_sum + new_sum) / updated_sample_count
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1113: RuntimeWarning: invalid value encountered in divide
  T = new_sum / new_sample_count
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1133: RuntimeWarning: invalid value encountered in divide
  new_unnormalized_variance -= correction**2 / new_sample_count
Epoch 1/50
146/146 ━━━━━━━━━━━━━━━━━━━━ 14s 35ms/step - accuracy: 0.8064 - loss: 0.6726 - val_accuracy: 0.8140 - val_loss: 0.6519
Epoch 2/50
146/146 ━━━━━━━━━━━━━━━━━━━━ 4s 27ms/step - accuracy: 0.8064 - loss: 0.6359 - val_accuracy: 0.8140 - val_loss: 0.6176
Epoch 3/50
146/146 ━━━━━━━━━━━━━━━━━━━━ 4s 27ms/step - accuracy: 0.8064 - loss: 0.6057 - val_accuracy: 0.8140 - val_loss: 0.5894
Epoch 4/50
146/146 ━━━━━━━━━━━━━━━━━━━━ 4s 26ms/step - accuracy: 0.8064 - loss: 0.5810 - val_accuracy: 0.8140 - val_loss: 0.5664
Epoch 5/50
146/146 ━━━━━━━━━━━━━━━━━━━━ 4s 26ms/step - accuracy: 0.8064 - loss: 0.5614 - val_accuracy: 0.8140 - val_loss: 0.5481
Epoch 6/50
146/146 ━━━━━━━━━━━━━━━━━━━━ 4s 25ms/step - accuracy: 0.8064 - loss: 0.5454 - val_accuracy: 0.8140 - val_loss: 0.5331
Epoch 7/50
146/146 ━━━━━━━━━━━━━━━━━━━━ 4s 25ms/step - accuracy: 0.8064 - loss: 0.5327 - val_accuracy: 0.8140 - val_loss: 0.5212
Epoch 8/50
146/146 ━━━━━━━━━━━━━━━━━━━━ 4s 26ms/step - accuracy: 0.8064 - loss: 0.5228 - val_accuracy: 0.8140 - val_loss: 0.5119
Epoch 9/50
146/146 ━━━━━━━━━━━━━━━━━━━━ 4s 25ms/step - accuracy: 0.8064 - loss: 0.5149 - val_accuracy: 0.8140 - val_loss: 0.5044
Epoch 10/50
146/146 ━━━━━━━━━━━━━━━━━━━━ 4s 26ms/step - accuracy: 0.8064 - loss: 0.5088 - val_accuracy: 0.8140 - val_loss: 0.4985
Epoch 11/50
146/146 ━━━━━━━━━━━━━━━━━━━━ 4s 25ms/step - accuracy: 0.8064 - loss: 0.5042 - val_accuracy: 0.8140 - val_loss: 0.4941
Epoch 12/50
146/146 ━━━━━━━━━━━━━━━━━━━━ 4s 25ms/step - accuracy: 0.8064 - loss: 0.5006 - val_accuracy: 0.8140 - val_loss: 0.4906
Epoch 13/50
146/146 ━━━━━━━━━━━━━━━━━━━━ 4s 25ms/step - accuracy: 0.8064 - loss: 0.4980 - val_accuracy: 0.8140 - val_loss: 0.4881
Epoch 14/50
146/146 ━━━━━━━━━━━━━━━━━━━━ 4s 25ms/step - accuracy: 0.8064 - loss: 0.4961 - val_accuracy: 0.8140 - val_loss: 0.4861
Epoch 15/50
146/146 ━━━━━━━━━━━━━━━━━━━━ 4s 25ms/step - accuracy: 0.8064 - loss: 0.4946 - val_accuracy: 0.8140 - val_loss: 0.4845
Epoch 16/50
146/146 ━━━━━━━━━━━━━━━━━━━━ 4s 25ms/step - accuracy: 0.8064 - loss: 0.4936 - val_accuracy: 0.8140 - val_loss: 0.4835
Epoch 17/50
146/146 ━━━━━━━━━━━━━━━━━━━━ 4s 26ms/step - accuracy: 0.8064 - loss: 0.4929 - val_accuracy: 0.8140 - val_loss: 0.4827
Epoch 18/50
146/146 ━━━━━━━━━━━━━━━━━━━━ 4s 25ms/step - accuracy: 0.8064 - loss: 0.4924 - val_accuracy: 0.8140 - val_loss: 0.4821
Epoch 19/50
146/146 ━━━━━━━━━━━━━━━━━━━━ 4s 24ms/step - accuracy: 0.8064 - loss: 0.4920 - val_accuracy: 0.8140 - val_loss: 0.4816
Epoch 20/50
146/146 ━━━━━━━━━━━━━━━━━━━━ 4s 25ms/step - accuracy: 0.8064 - loss: 0.4918 - val_accuracy: 0.8140 - val_loss: 0.4813
Epoch 21/50
146/146 ━━━━━━━━━━━━━━━━━━━━ 4s 25ms/step - accuracy: 0.8064 - loss: 0.4917 - val_accuracy: 0.8140 - val_loss: 0.4811
Epoch 22/50
146/146 ━━━━━━━━━━━━━━━━━━━━ 4s 24ms/step - accuracy: 0.8064 - loss: 0.4916 - val_accuracy: 0.8140 - val_loss: 0.4810
Epoch 23/50
146/146 ━━━━━━━━━━━━━━━━━━━━ 5s 25ms/step - accuracy: 0.8064 - loss: 0.4915 - val_accuracy: 0.8140 - val_loss: 0.4809
Epoch 24/50
146/146 ━━━━━━━━━━━━━━━━━━━━ 4s 25ms/step - accuracy: 0.8064 - loss: 0.4915 - val_accuracy: 0.8140 - val_loss: 0.4808
Epoch 25/50
146/146 ━━━━━━━━━━━━━━━━━━━━ 4s 25ms/step - accuracy: 0.8064 - loss: 0.4915 - val_accuracy: 0.8140 - val_loss: 0.4807
Epoch 26/50
146/146 ━━━━━━━━━━━━━━━━━━━━ 4s 25ms/step - accuracy: 0.8064 - loss: 0.4915 - val_accuracy: 0.8140 - val_loss: 0.4807
Epoch 27/50
146/146 ━━━━━━━━━━━━━━━━━━━━ 4s 25ms/step - accuracy: 0.8064 - loss: 0.4915 - val_accuracy: 0.8140 - val_loss: 0.4806
Epoch 28/50
146/146 ━━━━━━━━━━━━━━━━━━━━ 4s 25ms/step - accuracy: 0.8064 - loss: 0.4915 - val_accuracy: 0.8140 - val_loss: 0.4806
Epoch 29/50
146/146 ━━━━━━━━━━━━━━━━━━━━ 4s 25ms/step - accuracy: 0.8064 - loss: 0.4915 - val_accuracy: 0.8140 - val_loss: 0.4806
Epoch 30/50
146/146 ━━━━━━━━━━━━━━━━━━━━ 4s 25ms/step - accuracy: 0.8064 - loss: 0.4915 - val_accuracy: 0.8140 - val_loss: 0.4806
Epoch 31/50
146/146 ━━━━━━━━━━━━━━━━━━━━ 4s 25ms/step - accuracy: 0.8064 - loss: 0.4915 - val_accuracy: 0.8140 - val_loss: 0.4806
Epoch 32/50
146/146 ━━━━━━━━━━━━━━━━━━━━ 4s 25ms/step - accuracy: 0.8064 - loss: 0.4915 - val_accuracy: 0.8140 - val_loss: 0.4806
Epoch 33/50
146/146 ━━━━━━━━━━━━━━━━━━━━ 4s 24ms/step - accuracy: 0.8064 - loss: 0.4915 - val_accuracy: 0.8140 - val_loss: 0.4806
Epoch 34/50
146/146 ━━━━━━━━━━━━━━━━━━━━ 4s 24ms/step - accuracy: 0.8064 - loss: 0.4915 - val_accuracy: 0.8140 - val_loss: 0.4806
Epoch 35/50
146/146 ━━━━━━━━━━━━━━━━━━━━ 4s 24ms/step - accuracy: 0.8064 - loss: 0.4915 - val_accuracy: 0.8140 - val_loss: 0.4806
Epoch 36/50
146/146 ━━━━━━━━━━━━━━━━━━━━ 4s 24ms/step - accuracy: 0.8064 - loss: 0.4915 - val_accuracy: 0.8140 - val_loss: 0.4807
Epoch 37/50
146/146 ━━━━━━━━━━━━━━━━━━━━ 4s 25ms/step - accuracy: 0.8064 - loss: 0.4915 - val_accuracy: 0.8140 - val_loss: 0.4807
Epoch 38/50
146/146 ━━━━━━━━━━━━━━━━━━━━ 4s 26ms/step - accuracy: 0.8064 - loss: 0.4915 - val_accuracy: 0.8140 - val_loss: 0.4806
Epoch 39/50
146/146 ━━━━━━━━━━━━━━━━━━━━ 4s 25ms/step - accuracy: 0.8064 - loss: 0.4915 - val_accuracy: 0.8140 - val_loss: 0.4806
Epoch 40/50
146/146 ━━━━━━━━━━━━━━━━━━━━ 4s 25ms/step - accuracy: 0.8064 - loss: 0.4915 - val_accuracy: 0.8140 - val_loss: 0.4806
Epoch 41/50
146/146 ━━━━━━━━━━━━━━━━━━━━ 4s 25ms/step - accuracy: 0.8064 - loss: 0.4915 - val_accuracy: 0.8140 - val_loss: 0.4807
Epoch 42/50
146/146 ━━━━━━━━━━━━━━━━━━━━ 4s 25ms/step - accuracy: 0.8064 - loss: 0.4915 - val_accuracy: 0.8140 - val_loss: 0.4806
Epoch 43/50
146/146 ━━━━━━━━━━━━━━━━━━━━ 4s 25ms/step - accuracy: 0.8064 - loss: 0.4915 - val_accuracy: 0.8140 - val_loss: 0.4806
Epoch 44/50
146/146 ━━━━━━━━━━━━━━━━━━━━ 4s 24ms/step - accuracy: 0.8064 - loss: 0.4915 - val_accuracy: 0.8140 - val_loss: 0.4806
Epoch 45/50
146/146 ━━━━━━━━━━━━━━━━━━━━ 4s 25ms/step - accuracy: 0.8064 - loss: 0.4915 - val_accuracy: 0.8140 - val_loss: 0.4806
Epoch 46/50
146/146 ━━━━━━━━━━━━━━━━━━━━ 4s 25ms/step - accuracy: 0.8064 - loss: 0.4915 - val_accuracy: 0.8140 - val_loss: 0.4806
Epoch 47/50
146/146 ━━━━━━━━━━━━━━━━━━━━ 4s 25ms/step - accuracy: 0.8064 - loss: 0.4915 - val_accuracy: 0.8140 - val_loss: 0.4806
Epoch 48/50
146/146 ━━━━━━━━━━━━━━━━━━━━ 4s 25ms/step - accuracy: 0.8064 - loss: 0.4915 - val_accuracy: 0.8140 - val_loss: 0.4806
Epoch 49/50
146/146 ━━━━━━━━━━━━━━━━━━━━ 4s 25ms/step - accuracy: 0.8064 - loss: 0.4915 - val_accuracy: 0.8140 - val_loss: 0.4807
Epoch 50/50
146/146 ━━━━━━━━━━━━━━━━━━━━ 4s 25ms/step - accuracy: 0.8064 - loss: 0.4915 - val_accuracy: 0.8140 - val_loss: 0.4807
2025-10-31 18:52:51.394 | INFO     | src.ai_engine.ai_models:fit:685 - LSTM trained successfully.
2025-10-31 18:52:51.402 | INFO     | src.ai_engine.ai_models:fit:381 - Generating base model predictions for meta-model training...
2025-10-31 18:52:51.740 | INFO     | src.ai_engine.feature_engineering:create_sequences:261 - Creating sequences with length 50 from 5209 data points.
2025-10-31 18:52:51.800 | INFO     | src.ai_engine.feature_engineering:create_sequences:270 - Created 5159 sequences.
162/162 ━━━━━━━━━━━━━━━━━━━━ 3s 14ms/step
2025-10-31 18:52:55.039 | INFO     | src.ai_engine.ai_models:fit:396 - Training meta-model...
2025-10-31 18:52:55.047 | SUCCESS  | src.ai_engine.ai_models:fit:399 - Stacking Ensemble trained successfully.
2025-10-31 18:52:55.048 | SUCCESS  | __main__:main:167 - Final Ensemble model trained.
2025-10-31 18:52:55.049 | INFO     | __main__:main:171 - Saving models to 'models\PainX_400\1h'...
2025-10-31 18:52:55.290 | INFO     | src.ai_engine.ai_models:save:52 - Model RandomForest saved to models\PainX_400\1h\random_forest.pkl
2025-10-31 18:52:55.423 | INFO     | src.ai_engine.ai_models:save:52 - Model GradientBoosting saved to models\PainX_400\1h\gradient_boosting.pkl
2025-10-31 18:52:55.571 | INFO     | src.ai_engine.ai_models:save:731 - LSTM model saved to models\PainX_400\1h\lstm.keras, models\PainX_400\1h\lstm_scaler.pkl and marker file models\PainX_400\1h\lstm.pkl
2025-10-31 18:52:55.598 | INFO     | src.ai_engine.ai_models:save_all:463 - Meta-model saved to models\PainX_400\1h\meta_model.pkl
2025-10-31 18:52:55.600 | SUCCESS  | __main__:main:174 - --- Finished training for Symbol: PainX 400, Timeframe: 1h ---
2025-10-31 18:52:55.602 | INFO     | __main__:main:140 - --- Starting training for Symbol: PainX 400, Timeframe: 1m ---
2025-10-31 18:52:55.941 | SUCCESS  | __main__:main:148 - Loaded 100001 records.
2025-10-31 18:52:55.941 | INFO     | __main__:prepare_training_data:32 - Preparing data for training with Meta-Labeling...
2025-10-31 18:53:01.418 | DEBUG    | src.ai_engine.technical_indicators:calculate_all:47 - Calculated 63 technical indicators
2025-10-31 18:53:18.613 | DEBUG    | src.ai_engine.feature_engineering:extract_features:66 - Extracted 116 features
2025-10-31 18:53:18.616 | INFO     | __main__:prepare_training_data:39 - Generating signals from primary model (SimplePatternModel)...
2025-10-31 18:53:18.822 | WARNING  | src.ai_engine.feature_engineering:prepare_for_model:230 - Se perdieron todos los datos al eliminar los NaN. Se conservarán los datos rellenados.
2025-10-31 18:53:34.797 | INFO     | src.ai_engine.ai_models:calculate_optimal_threshold:549 - Calculated optimal threshold: 0.0010 (volatility: 0.0001, avg_movement: 0.0005)
2025-10-31 18:53:34.798 | INFO     | src.ai_engine.ai_models:create_meta_labels:577 - Creating meta-labels for secondary model...
2025-10-31 18:53:49.411 | INFO     | src.ai_engine.ai_models:create_meta_labels:629 - Meta-Label distribution - Profitable: 164 (13.6%), Unprofitable: 1044 (86.4%)
2025-10-31 18:53:49.674 | WARNING  | src.ai_engine.feature_engineering:prepare_for_model:230 - Se perdieron todos los datos al eliminar los NaN. Se conservarán los datos rellenados.
2025-10-31 18:53:49.777 | INFO     | __main__:prepare_training_data:75 - Data preparation complete. Shape of X: (65304, 116), Shape of y: (65304,)
2025-10-31 18:53:49.814 | INFO     | src.ai_engine.feature_engineering:create_sequences:261 - Creating sequences with length 50 from 65304 data points.
2025-10-31 18:53:50.595 | INFO     | src.ai_engine.feature_engineering:create_sequences:270 - Created 65254 sequences.
2025-10-31 18:53:50.613 | INFO     | __main__:main:164 - Initializing and training Ensemble model...
2025-10-31 18:53:50.614 | INFO     | src.ai_engine.ai_models:__init__:304 - Initialized Stacking Ensemble with Logistic Regression as meta-model.
2025-10-31 18:53:50.922 | INFO     | src.ai_engine.ai_models:fit:359 - Creating LSTM model...
2025-10-31 18:53:50.924 | INFO     | src.ai_engine.ai_models:fit:364 - Training base models...
2025-10-31 18:53:51.090 | INFO     | src.ai_engine.ai_models:fit:373 - Training random_forest...
2025-10-31 18:54:09.334 | INFO     | src.ai_engine.ai_models:fit:98 - RandomForest trained successfully on 65304 samples with 2 classes
2025-10-31 18:54:09.336 | INFO     | src.ai_engine.ai_models:fit:373 - Training gradient_boosting...
2025-10-31 19:05:54.994 | INFO     | src.ai_engine.ai_models:fit:157 - GradientBoosting trained successfully on 65304 samples with 2 classes
2025-10-31 19:05:54.998 | INFO     | src.ai_engine.ai_models:fit:373 - Training pattern_based...
2025-10-31 19:05:54.999 | INFO     | src.ai_engine.ai_models:fit:373 - Training lstm...
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\keras\src\layers\rnn\rnn.py:199: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(**kwargs)
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1108: RuntimeWarning: invalid value encountered in divide
  updated_mean = (last_sum + new_sum) / updated_sample_count
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1113: RuntimeWarning: invalid value encountered in divide
  T = new_sum / new_sample_count
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1133: RuntimeWarning: invalid value encountered in divide
  new_unnormalized_variance -= correction**2 / new_sample_count
Epoch 1/50
1836/1836 ━━━━━━━━━━━━━━━━━━━━ 570s 37ms/step - accuracy: 0.9975 - loss: 0.3941 - val_accuracy: 0.9974 - val_loss: 0.2087
Epoch 2/50
1836/1836 ━━━━━━━━━━━━━━━━━━━━ 49s 26ms/step - accuracy: 0.9975 - loss: 0.1341 - val_accuracy: 0.9974 - val_loss: 0.0841
Epoch 3/50
1836/1836 ━━━━━━━━━━━━━━━━━━━━ 47s 26ms/step - accuracy: 0.9975 - loss: 0.0596 - val_accuracy: 0.9974 - val_loss: 0.0425
Epoch 4/50
1836/1836 ━━━━━━━━━━━━━━━━━━━━ 47s 26ms/step - accuracy: 0.9975 - loss: 0.0329 - val_accuracy: 0.9974 - val_loss: 0.0266
Epoch 5/50
1836/1836 ━━━━━━━━━━━━━━━━━━━━ 47s 26ms/step - accuracy: 0.9975 - loss: 0.0227 - val_accuracy: 0.9974 - val_loss: 0.0207
Epoch 6/50
1836/1836 ━━━━━━━━━━━━━━━━━━━━ 46s 25ms/step - accuracy: 0.9975 - loss: 0.0191 - val_accuracy: 0.9974 - val_loss: 0.0188
Epoch 7/50
1836/1836 ━━━━━━━━━━━━━━━━━━━━ 46s 25ms/step - accuracy: 0.9975 - loss: 0.0179 - val_accuracy: 0.9974 - val_loss: 0.0183
Epoch 8/50
1836/1836 ━━━━━━━━━━━━━━━━━━━━ 46s 25ms/step - accuracy: 0.9975 - loss: 0.0176 - val_accuracy: 0.9974 - val_loss: 0.0181
Epoch 9/50
1836/1836 ━━━━━━━━━━━━━━━━━━━━ 46s 25ms/step - accuracy: 0.9975 - loss: 0.0175 - val_accuracy: 0.9974 - val_loss: 0.0181
Epoch 10/50
1836/1836 ━━━━━━━━━━━━━━━━━━━━ 46s 25ms/step - accuracy: 0.9975 - loss: 0.0175 - val_accuracy: 0.9974 - val_loss: 0.0181
Epoch 11/50
1836/1836 ━━━━━━━━━━━━━━━━━━━━ 47s 26ms/step - accuracy: 0.9975 - loss: 0.0175 - val_accuracy: 0.9974 - val_loss: 0.0181
Epoch 12/50
1836/1836 ━━━━━━━━━━━━━━━━━━━━ 47s 25ms/step - accuracy: 0.9975 - loss: 0.0175 - val_accuracy: 0.9974 - val_loss: 0.0181
Epoch 13/50
1836/1836 ━━━━━━━━━━━━━━━━━━━━ 46s 25ms/step - accuracy: 0.9975 - loss: 0.0175 - val_accuracy: 0.9974 - val_loss: 0.0181
Epoch 14/50
1836/1836 ━━━━━━━━━━━━━━━━━━━━ 46s 25ms/step - accuracy: 0.9975 - loss: 0.0175 - val_accuracy: 0.9974 - val_loss: 0.0181
Epoch 15/50
1836/1836 ━━━━━━━━━━━━━━━━━━━━ 46s 25ms/step - accuracy: 0.9975 - loss: 0.0175 - val_accuracy: 0.9974 - val_loss: 0.0181
Epoch 16/50
1836/1836 ━━━━━━━━━━━━━━━━━━━━ 46s 25ms/step - accuracy: 0.9975 - loss: 0.0175 - val_accuracy: 0.9974 - val_loss: 0.0181
Epoch 17/50
1836/1836 ━━━━━━━━━━━━━━━━━━━━ 46s 25ms/step - accuracy: 0.9975 - loss: 0.0175 - val_accuracy: 0.9974 - val_loss: 0.0181
Epoch 18/50
1836/1836 ━━━━━━━━━━━━━━━━━━━━ 46s 25ms/step - accuracy: 0.9975 - loss: 0.0175 - val_accuracy: 0.9974 - val_loss: 0.0181
Epoch 19/50
1836/1836 ━━━━━━━━━━━━━━━━━━━━ 46s 25ms/step - accuracy: 0.9975 - loss: 0.0175 - val_accuracy: 0.9974 - val_loss: 0.0181
Epoch 20/50
1836/1836 ━━━━━━━━━━━━━━━━━━━━ 46s 25ms/step - accuracy: 0.9975 - loss: 0.0175 - val_accuracy: 0.9974 - val_loss: 0.0181
Epoch 21/50
1836/1836 ━━━━━━━━━━━━━━━━━━━━ 47s 25ms/step - accuracy: 0.9975 - loss: 0.0175 - val_accuracy: 0.9974 - val_loss: 0.0181
2025-10-31 19:56:09.347 | INFO     | src.ai_engine.ai_models:fit:685 - LSTM trained successfully.
2025-10-31 19:56:10.080 | INFO     | src.ai_engine.ai_models:fit:381 - Generating base model predictions for meta-model training...
2025-10-31 19:56:34.218 | INFO     | src.ai_engine.feature_engineering:create_sequences:261 - Creating sequences with length 50 from 65304 data points.
2025-10-31 19:56:35.033 | INFO     | src.ai_engine.feature_engineering:create_sequences:270 - Created 65254 sequences.
2040/2040 ━━━━━━━━━━━━━━━━━━━━ 181s 29ms/step
2025-10-31 20:17:57.671 | INFO     | src.ai_engine.ai_models:fit:396 - Training meta-model...
2025-10-31 20:18:03.921 | SUCCESS  | src.ai_engine.ai_models:fit:399 - Stacking Ensemble trained successfully.
2025-10-31 20:18:06.008 | SUCCESS  | __main__:main:167 - Final Ensemble model trained.
2025-10-31 20:18:06.405 | INFO     | __main__:main:171 - Saving models to 'models\PainX_400\1m'...
2025-10-31 20:18:19.371 | INFO     | src.ai_engine.ai_models:save:52 - Model RandomForest saved to models\PainX_400\1m\random_forest.pkl
2025-10-31 20:18:21.953 | INFO     | src.ai_engine.ai_models:save:52 - Model GradientBoosting saved to models\PainX_400\1m\gradient_boosting.pkl
2025-10-31 20:18:28.767 | INFO     | src.ai_engine.ai_models:save:731 - LSTM model saved to models\PainX_400\1m\lstm.keras, models\PainX_400\1m\lstm_scaler.pkl and marker file models\PainX_400\1m\lstm.pkl
2025-10-31 20:18:28.797 | INFO     | src.ai_engine.ai_models:save_all:463 - Meta-model saved to models\PainX_400\1m\meta_model.pkl
2025-10-31 20:18:28.822 | SUCCESS  | __main__:main:174 - --- Finished training for Symbol: PainX 400, Timeframe: 1m ---
2025-10-31 20:18:28.852 | INFO     | __main__:main:140 - --- Starting training for Symbol: PainX 400, Timeframe: 4h ---
2025-10-31 20:18:30.939 | SUCCESS  | __main__:main:148 - Loaded 1809 records.
2025-10-31 20:18:30.941 | INFO     | __main__:prepare_training_data:32 - Preparing data for training with Meta-Labeling...
2025-10-31 20:18:32.678 | DEBUG    | src.ai_engine.technical_indicators:calculate_all:47 - Calculated 63 technical indicators
2025-10-31 20:18:34.102 | DEBUG    | src.ai_engine.feature_engineering:extract_features:66 - Extracted 116 features
2025-10-31 20:18:34.120 | INFO     | __main__:prepare_training_data:39 - Generating signals from primary model (SimplePatternModel)...
2025-10-31 20:18:34.275 | WARNING  | src.ai_engine.feature_engineering:prepare_for_model:230 - Se perdieron todos los datos al eliminar los NaN. Se conservarán los datos rellenados.
2025-10-31 20:18:35.743 | INFO     | src.ai_engine.ai_models:calculate_optimal_threshold:549 - Calculated optimal threshold: 0.0046 (volatility: 0.0016, avg_movement: 0.0068)
2025-10-31 20:18:35.790 | INFO     | src.ai_engine.ai_models:create_meta_labels:577 - Creating meta-labels for secondary model...
2025-10-31 20:18:36.183 | INFO     | src.ai_engine.ai_models:create_meta_labels:629 - Meta-Label distribution - Profitable: 392 (41.4%), Unprofitable: 554 (58.6%)
2025-10-31 20:18:36.523 | WARNING  | src.ai_engine.feature_engineering:prepare_for_model:230 - Se perdieron todos los datos al eliminar los NaN. Se conservarán los datos rellenados.
2025-10-31 20:18:36.580 | INFO     | __main__:prepare_training_data:75 - Data preparation complete. Shape of X: (1332, 116), Shape of y: (1332,)
2025-10-31 20:18:37.742 | INFO     | src.ai_engine.feature_engineering:create_sequences:261 - Creating sequences with length 50 from 1332 data points.
2025-10-31 20:18:37.784 | INFO     | src.ai_engine.feature_engineering:create_sequences:270 - Created 1282 sequences.
2025-10-31 20:18:38.244 | INFO     | __main__:main:164 - Initializing and training Ensemble model...
2025-10-31 20:18:38.245 | INFO     | src.ai_engine.ai_models:__init__:304 - Initialized Stacking Ensemble with Logistic Regression as meta-model.
2025-10-31 20:18:41.340 | INFO     | src.ai_engine.ai_models:fit:359 - Creating LSTM model...
2025-10-31 20:18:41.342 | INFO     | src.ai_engine.ai_models:fit:364 - Training base models...
2025-10-31 20:18:41.386 | INFO     | src.ai_engine.ai_models:fit:373 - Training random_forest...
2025-10-31 20:18:50.402 | INFO     | src.ai_engine.ai_models:fit:98 - RandomForest trained successfully on 1332 samples with 2 classes
2025-10-31 20:18:50.447 | INFO     | src.ai_engine.ai_models:fit:373 - Training gradient_boosting...
2025-10-31 20:19:07.074 | INFO     | src.ai_engine.ai_models:fit:157 - GradientBoosting trained successfully on 1332 samples with 2 classes
2025-10-31 20:19:07.075 | INFO     | src.ai_engine.ai_models:fit:373 - Training pattern_based...
2025-10-31 20:19:07.076 | INFO     | src.ai_engine.ai_models:fit:373 - Training lstm...
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\keras\src\layers\rnn\rnn.py:199: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(**kwargs)
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1108: RuntimeWarning: invalid value encountered in divide
  updated_mean = (last_sum + new_sum) / updated_sample_count
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1113: RuntimeWarning: invalid value encountered in divide
  T = new_sum / new_sample_count
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1133: RuntimeWarning: invalid value encountered in divide
  new_unnormalized_variance -= correction**2 / new_sample_count
Epoch 1/50
37/37 ━━━━━━━━━━━━━━━━━━━━ 96s 238ms/step - accuracy: 0.7181 - loss: 0.6895 - val_accuracy: 0.5814 - val_loss: 0.6905
Epoch 2/50
37/37 ━━━━━━━━━━━━━━━━━━━━ 3s 78ms/step - accuracy: 0.7181 - loss: 0.6828 - val_accuracy: 0.5814 - val_loss: 0.6884
Epoch 3/50
37/37 ━━━━━━━━━━━━━━━━━━━━ 2s 45ms/step - accuracy: 0.7181 - loss: 0.6769 - val_accuracy: 0.5814 - val_loss: 0.6866
Epoch 4/50
37/37 ━━━━━━━━━━━━━━━━━━━━ 1s 28ms/step - accuracy: 0.7181 - loss: 0.6707 - val_accuracy: 0.5814 - val_loss: 0.6849
Epoch 5/50
37/37 ━━━━━━━━━━━━━━━━━━━━ 2s 43ms/step - accuracy: 0.7181 - loss: 0.6648 - val_accuracy: 0.5814 - val_loss: 0.6834
Epoch 6/50
37/37 ━━━━━━━━━━━━━━━━━━━━ 1s 32ms/step - accuracy: 0.7181 - loss: 0.6598 - val_accuracy: 0.5814 - val_loss: 0.6824
Epoch 7/50
37/37 ━━━━━━━━━━━━━━━━━━━━ 1s 28ms/step - accuracy: 0.7181 - loss: 0.6553 - val_accuracy: 0.5814 - val_loss: 0.6816
Epoch 8/50
37/37 ━━━━━━━━━━━━━━━━━━━━ 1s 31ms/step - accuracy: 0.7181 - loss: 0.6506 - val_accuracy: 0.5814 - val_loss: 0.6808
Epoch 9/50
37/37 ━━━━━━━━━━━━━━━━━━━━ 1s 30ms/step - accuracy: 0.7181 - loss: 0.6466 - val_accuracy: 0.5814 - val_loss: 0.6804
Epoch 10/50
37/37 ━━━━━━━━━━━━━━━━━━━━ 1s 33ms/step - accuracy: 0.7181 - loss: 0.6424 - val_accuracy: 0.5814 - val_loss: 0.6800
Epoch 11/50
37/37 ━━━━━━━━━━━━━━━━━━━━ 1s 26ms/step - accuracy: 0.7181 - loss: 0.6385 - val_accuracy: 0.5814 - val_loss: 0.6799
Epoch 12/50
37/37 ━━━━━━━━━━━━━━━━━━━━ 1s 28ms/step - accuracy: 0.7181 - loss: 0.6348 - val_accuracy: 0.5814 - val_loss: 0.6799
Epoch 13/50
37/37 ━━━━━━━━━━━━━━━━━━━━ 2s 41ms/step - accuracy: 0.7181 - loss: 0.6314 - val_accuracy: 0.5814 - val_loss: 0.6800
Epoch 14/50
37/37 ━━━━━━━━━━━━━━━━━━━━ 1s 36ms/step - accuracy: 0.7181 - loss: 0.6281 - val_accuracy: 0.5814 - val_loss: 0.6803
Epoch 15/50
37/37 ━━━━━━━━━━━━━━━━━━━━ 1s 26ms/step - accuracy: 0.7181 - loss: 0.6252 - val_accuracy: 0.5814 - val_loss: 0.6808
Epoch 16/50
37/37 ━━━━━━━━━━━━━━━━━━━━ 1s 28ms/step - accuracy: 0.7181 - loss: 0.6229 - val_accuracy: 0.5814 - val_loss: 0.6813
Epoch 17/50
37/37 ━━━━━━━━━━━━━━━━━━━━ 1s 27ms/step - accuracy: 0.7181 - loss: 0.6204 - val_accuracy: 0.5814 - val_loss: 0.6819
Epoch 18/50
37/37 ━━━━━━━━━━━━━━━━━━━━ 1s 27ms/step - accuracy: 0.7181 - loss: 0.6181 - val_accuracy: 0.5814 - val_loss: 0.6827
Epoch 19/50
37/37 ━━━━━━━━━━━━━━━━━━━━ 1s 29ms/step - accuracy: 0.7181 - loss: 0.6159 - val_accuracy: 0.5814 - val_loss: 0.6835
Epoch 20/50
37/37 ━━━━━━━━━━━━━━━━━━━━ 1s 28ms/step - accuracy: 0.7181 - loss: 0.6139 - val_accuracy: 0.5814 - val_loss: 0.6844
Epoch 21/50
37/37 ━━━━━━━━━━━━━━━━━━━━ 1s 27ms/step - accuracy: 0.7181 - loss: 0.6121 - val_accuracy: 0.5814 - val_loss: 0.6854
2025-10-31 20:21:23.605 | INFO     | src.ai_engine.ai_models:fit:685 - LSTM trained successfully.
2025-10-31 20:21:23.613 | INFO     | src.ai_engine.ai_models:fit:381 - Generating base model predictions for meta-model training...
2025-10-31 20:21:23.791 | INFO     | src.ai_engine.feature_engineering:create_sequences:261 - Creating sequences with length 50 from 1332 data points.
2025-10-31 20:21:23.841 | INFO     | src.ai_engine.feature_engineering:create_sequences:270 - Created 1282 sequences.
41/41 ━━━━━━━━━━━━━━━━━━━━ 7s 103ms/step
2025-10-31 20:21:31.414 | INFO     | src.ai_engine.ai_models:fit:396 - Training meta-model...
2025-10-31 20:21:31.435 | SUCCESS  | src.ai_engine.ai_models:fit:399 - Stacking Ensemble trained successfully.
2025-10-31 20:21:31.436 | SUCCESS  | __main__:main:167 - Final Ensemble model trained.
2025-10-31 20:21:31.436 | INFO     | __main__:main:171 - Saving models to 'models\PainX_400\4h'...
2025-10-31 20:21:32.047 | INFO     | src.ai_engine.ai_models:save:52 - Model RandomForest saved to models\PainX_400\4h\random_forest.pkl
2025-10-31 20:21:32.359 | INFO     | src.ai_engine.ai_models:save:52 - Model GradientBoosting saved to models\PainX_400\4h\gradient_boosting.pkl
2025-10-31 20:21:32.751 | INFO     | src.ai_engine.ai_models:save:731 - LSTM model saved to models\PainX_400\4h\lstm.keras, models\PainX_400\4h\lstm_scaler.pkl and marker file models\PainX_400\4h\lstm.pkl
2025-10-31 20:21:32.797 | INFO     | src.ai_engine.ai_models:save_all:463 - Meta-model saved to models\PainX_400\4h\meta_model.pkl
2025-10-31 20:21:32.799 | SUCCESS  | __main__:main:174 - --- Finished training for Symbol: PainX 400, Timeframe: 4h ---
2025-10-31 20:21:32.804 | INFO     | __main__:main:140 - --- Starting training for Symbol: PainX 400, Timeframe: 5m ---
2025-10-31 20:21:33.315 | SUCCESS  | __main__:main:148 - Loaded 86576 records.
2025-10-31 20:21:33.315 | INFO     | __main__:prepare_training_data:32 - Preparing data for training with Meta-Labeling...
2025-10-31 20:21:38.200 | DEBUG    | src.ai_engine.technical_indicators:calculate_all:47 - Calculated 63 technical indicators
2025-10-31 20:21:52.939 | DEBUG    | src.ai_engine.feature_engineering:extract_features:66 - Extracted 116 features
2025-10-31 20:21:52.941 | INFO     | __main__:prepare_training_data:39 - Generating signals from primary model (SimplePatternModel)...
2025-10-31 20:21:53.121 | WARNING  | src.ai_engine.feature_engineering:prepare_for_model:230 - Se perdieron todos los datos al eliminar los NaN. Se conservarán los datos rellenados.
2025-10-31 20:22:07.117 | INFO     | src.ai_engine.ai_models:calculate_optimal_threshold:549 - Calculated optimal threshold: 0.0010 (volatility: 0.0002, avg_movement: 0.0010)
2025-10-31 20:22:07.119 | INFO     | src.ai_engine.ai_models:create_meta_labels:577 - Creating meta-labels for secondary model...
2025-10-31 20:22:19.554 | INFO     | src.ai_engine.ai_models:create_meta_labels:629 - Meta-Label distribution - Profitable: 5616 (26.5%), Unprofitable: 15613 (73.5%)
2025-10-31 20:22:19.856 | WARNING  | src.ai_engine.feature_engineering:prepare_for_model:230 - Se perdieron todos los datos al eliminar los NaN. Se conservarán los datos rellenados.
2025-10-31 20:22:19.951 | INFO     | __main__:prepare_training_data:75 - Data preparation complete. Shape of X: (61561, 116), Shape of y: (61561,)
2025-10-31 20:22:20.069 | INFO     | src.ai_engine.feature_engineering:create_sequences:261 - Creating sequences with length 50 from 61561 data points.
2025-10-31 20:22:20.907 | INFO     | src.ai_engine.feature_engineering:create_sequences:270 - Created 61511 sequences.
2025-10-31 20:22:20.916 | INFO     | __main__:main:164 - Initializing and training Ensemble model...
2025-10-31 20:22:20.917 | INFO     | src.ai_engine.ai_models:__init__:304 - Initialized Stacking Ensemble with Logistic Regression as meta-model.
2025-10-31 20:22:21.042 | INFO     | src.ai_engine.ai_models:fit:359 - Creating LSTM model...
2025-10-31 20:22:21.043 | INFO     | src.ai_engine.ai_models:fit:364 - Training base models...
2025-10-31 20:22:21.168 | INFO     | src.ai_engine.ai_models:fit:373 - Training random_forest...
2025-10-31 20:22:46.248 | INFO     | src.ai_engine.ai_models:fit:98 - RandomForest trained successfully on 61561 samples with 2 classes
2025-10-31 20:22:46.250 | INFO     | src.ai_engine.ai_models:fit:373 - Training gradient_boosting...
2025-10-31 20:35:18.174 | INFO     | src.ai_engine.ai_models:fit:157 - GradientBoosting trained successfully on 61561 samples with 2 classes
2025-10-31 20:35:18.177 | INFO     | src.ai_engine.ai_models:fit:373 - Training pattern_based...
2025-10-31 20:35:18.177 | INFO     | src.ai_engine.ai_models:fit:373 - Training lstm...
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\keras\src\layers\rnn\rnn.py:199: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(**kwargs)
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1108: RuntimeWarning: invalid value encountered in divide
  updated_mean = (last_sum + new_sum) / updated_sample_count
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1113: RuntimeWarning: invalid value encountered in divide
  T = new_sum / new_sample_count
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1133: RuntimeWarning: invalid value encountered in divide
  new_unnormalized_variance -= correction**2 / new_sample_count
Epoch 1/50
1730/1730 ━━━━━━━━━━━━━━━━━━━━ 345s 44ms/step - accuracy: 0.9088 - loss: 0.4782 - val_accuracy: 0.9083 - val_loss: 0.3587
Epoch 2/50
1730/1730 ━━━━━━━━━━━━━━━━━━━━ 51s 29ms/step - accuracy: 0.9088 - loss: 0.3257 - val_accuracy: 0.9083 - val_loss: 0.3103
Epoch 3/50
1730/1730 ━━━━━━━━━━━━━━━━━━━━ 51s 28ms/step - accuracy: 0.9088 - loss: 0.3065 - val_accuracy: 0.9083 - val_loss: 0.3065
Epoch 4/50
1730/1730 ━━━━━━━━━━━━━━━━━━━━ 48s 28ms/step - accuracy: 0.9088 - loss: 0.3053 - val_accuracy: 0.9083 - val_loss: 0.3064
Epoch 5/50
1730/1730 ━━━━━━━━━━━━━━━━━━━━ 48s 27ms/step - accuracy: 0.9088 - loss: 0.3053 - val_accuracy: 0.9083 - val_loss: 0.3064
Epoch 6/50
1730/1730 ━━━━━━━━━━━━━━━━━━━━ 47s 27ms/step - accuracy: 0.9088 - loss: 0.3052 - val_accuracy: 0.9083 - val_loss: 0.3064
Epoch 7/50
1730/1730 ━━━━━━━━━━━━━━━━━━━━ 47s 27ms/step - accuracy: 0.9088 - loss: 0.3053 - val_accuracy: 0.9083 - val_loss: 0.3064
Epoch 8/50
1730/1730 ━━━━━━━━━━━━━━━━━━━━ 46s 27ms/step - accuracy: 0.9088 - loss: 0.3053 - val_accuracy: 0.9083 - val_loss: 0.3064
Epoch 9/50
1730/1730 ━━━━━━━━━━━━━━━━━━━━ 46s 27ms/step - accuracy: 0.9088 - loss: 0.3052 - val_accuracy: 0.9083 - val_loss: 0.3064
Epoch 10/50
1730/1730 ━━━━━━━━━━━━━━━━━━━━ 47s 27ms/step - accuracy: 0.9088 - loss: 0.3053 - val_accuracy: 0.9083 - val_loss: 0.3064
Epoch 11/50
1730/1730 ━━━━━━━━━━━━━━━━━━━━ 47s 27ms/step - accuracy: 0.9088 - loss: 0.3053 - val_accuracy: 0.9083 - val_loss: 0.3064
Epoch 12/50
1730/1730 ━━━━━━━━━━━━━━━━━━━━ 47s 27ms/step - accuracy: 0.9088 - loss: 0.3053 - val_accuracy: 0.9083 - val_loss: 0.3064
Epoch 13/50
1730/1730 ━━━━━━━━━━━━━━━━━━━━ 46s 27ms/step - accuracy: 0.9088 - loss: 0.3052 - val_accuracy: 0.9083 - val_loss: 0.3064
Epoch 14/50
1730/1730 ━━━━━━━━━━━━━━━━━━━━ 47s 27ms/step - accuracy: 0.9088 - loss: 0.3052 - val_accuracy: 0.9083 - val_loss: 0.3064
Epoch 15/50
1730/1730 ━━━━━━━━━━━━━━━━━━━━ 46s 27ms/step - accuracy: 0.9088 - loss: 0.3053 - val_accuracy: 0.9083 - val_loss: 0.3064
2025-10-31 21:41:12.753 | INFO     | src.ai_engine.ai_models:fit:685 - LSTM trained successfully.
2025-10-31 21:41:13.931 | INFO     | src.ai_engine.ai_models:fit:381 - Generating base model predictions for meta-model training...
2025-10-31 21:41:40.291 | INFO     | src.ai_engine.feature_engineering:create_sequences:261 - Creating sequences with length 50 from 61561 data points.
2025-10-31 21:41:41.340 | INFO     | src.ai_engine.feature_engineering:create_sequences:270 - Created 61511 sequences.
1923/1923 ━━━━━━━━━━━━━━━━━━━━ 171s 43ms/step
2025-10-31 21:56:25.073 | INFO     | src.ai_engine.ai_models:fit:396 - Training meta-model...
2025-10-31 21:56:29.442 | SUCCESS  | src.ai_engine.ai_models:fit:399 - Stacking Ensemble trained successfully.
2025-10-31 21:56:29.832 | SUCCESS  | __main__:main:167 - Final Ensemble model trained.
2025-10-31 21:56:29.857 | INFO     | __main__:main:171 - Saving models to 'models\PainX_400\5m'...
2025-10-31 21:56:39.310 | INFO     | src.ai_engine.ai_models:save:52 - Model RandomForest saved to models\PainX_400\5m\random_forest.pkl
2025-10-31 21:56:41.297 | INFO     | src.ai_engine.ai_models:save:52 - Model GradientBoosting saved to models\PainX_400\5m\gradient_boosting.pkl
2025-10-31 21:56:48.418 | INFO     | src.ai_engine.ai_models:save:731 - LSTM model saved to models\PainX_400\5m\lstm.keras, models\PainX_400\5m\lstm_scaler.pkl and marker file models\PainX_400\5m\lstm.pkl
2025-10-31 21:56:48.493 | INFO     | src.ai_engine.ai_models:save_all:463 - Meta-model saved to models\PainX_400\5m\meta_model.pkl
2025-10-31 21:56:48.507 | SUCCESS  | __main__:main:174 - --- Finished training for Symbol: PainX 400, Timeframe: 5m ---
2025-10-31 21:56:48.592 | INFO     | __main__:main:140 - --- Starting training for Symbol: PainX 600, Timeframe: 15m ---
2025-10-31 21:56:51.825 | SUCCESS  | __main__:main:148 - Loaded 28898 records.
2025-10-31 21:56:51.827 | INFO     | __main__:prepare_training_data:32 - Preparing data for training with Meta-Labeling...
2025-10-31 21:56:55.815 | DEBUG    | src.ai_engine.technical_indicators:calculate_all:47 - Calculated 63 technical indicators
2025-10-31 21:57:01.903 | DEBUG    | src.ai_engine.feature_engineering:extract_features:66 - Extracted 116 features
2025-10-31 21:57:01.906 | INFO     | __main__:prepare_training_data:39 - Generating signals from primary model (SimplePatternModel)...
2025-10-31 21:57:02.161 | WARNING  | src.ai_engine.feature_engineering:prepare_for_model:230 - Se perdieron todos los datos al eliminar los NaN. Se conservarán los datos rellenados.
2025-10-31 21:57:08.095 | INFO     | src.ai_engine.ai_models:calculate_optimal_threshold:549 - Calculated optimal threshold: 0.0011 (volatility: 0.0004, avg_movement: 0.0016)
2025-10-31 21:57:08.098 | INFO     | src.ai_engine.ai_models:create_meta_labels:577 - Creating meta-labels for secondary model...
2025-10-31 21:57:11.666 | INFO     | src.ai_engine.ai_models:create_meta_labels:629 - Meta-Label distribution - Profitable: 4614 (35.0%), Unprofitable: 8563 (65.0%)
2025-10-31 21:57:11.769 | WARNING  | src.ai_engine.feature_engineering:prepare_for_model:230 - Se perdieron todos los datos al eliminar los NaN. Se conservarán los datos rellenados.
2025-10-31 21:57:11.810 | INFO     | __main__:prepare_training_data:75 - Data preparation complete. Shape of X: (20561, 116), Shape of y: (20561,)
2025-10-31 21:57:12.180 | INFO     | src.ai_engine.feature_engineering:create_sequences:261 - Creating sequences with length 50 from 20561 data points.
2025-10-31 21:57:12.632 | INFO     | src.ai_engine.feature_engineering:create_sequences:270 - Created 20511 sequences.
2025-10-31 21:57:22.465 | INFO     | __main__:main:164 - Initializing and training Ensemble model...
2025-10-31 21:57:22.467 | INFO     | src.ai_engine.ai_models:__init__:304 - Initialized Stacking Ensemble with Logistic Regression as meta-model.
2025-10-31 21:57:23.464 | INFO     | src.ai_engine.ai_models:fit:359 - Creating LSTM model...
2025-10-31 21:57:23.466 | INFO     | src.ai_engine.ai_models:fit:364 - Training base models...
2025-10-31 21:57:23.534 | INFO     | src.ai_engine.ai_models:fit:373 - Training random_forest...
2025-10-31 21:57:35.553 | INFO     | src.ai_engine.ai_models:fit:98 - RandomForest trained successfully on 20561 samples with 2 classes
2025-10-31 21:57:35.555 | INFO     | src.ai_engine.ai_models:fit:373 - Training gradient_boosting...
2025-10-31 22:01:29.134 | INFO     | src.ai_engine.ai_models:fit:157 - GradientBoosting trained successfully on 20561 samples with 2 classes
2025-10-31 22:01:29.136 | INFO     | src.ai_engine.ai_models:fit:373 - Training pattern_based...
2025-10-31 22:01:29.137 | INFO     | src.ai_engine.ai_models:fit:373 - Training lstm...
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\keras\src\layers\rnn\rnn.py:199: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(**kwargs)
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1108: RuntimeWarning: invalid value encountered in divide
  updated_mean = (last_sum + new_sum) / updated_sample_count
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1113: RuntimeWarning: invalid value encountered in divide
  T = new_sum / new_sample_count
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1133: RuntimeWarning: invalid value encountered in divide
  new_unnormalized_variance -= correction**2 / new_sample_count
Epoch 1/50
577/577 ━━━━━━━━━━━━━━━━━━━━ 99s 41ms/step - accuracy: 0.7721 - loss: 0.6355 - val_accuracy: 0.8070 - val_loss: 0.5746
Epoch 2/50
577/577 ━━━━━━━━━━━━━━━━━━━━ 17s 29ms/step - accuracy: 0.7721 - loss: 0.5685 - val_accuracy: 0.8070 - val_loss: 0.5240
Epoch 3/50
577/577 ━━━━━━━━━━━━━━━━━━━━ 16s 28ms/step - accuracy: 0.7721 - loss: 0.5448 - val_accuracy: 0.8070 - val_loss: 0.5041
Epoch 4/50
577/577 ━━━━━━━━━━━━━━━━━━━━ 16s 28ms/step - accuracy: 0.7721 - loss: 0.5383 - val_accuracy: 0.8070 - val_loss: 0.4976
Epoch 5/50
577/577 ━━━━━━━━━━━━━━━━━━━━ 16s 27ms/step - accuracy: 0.7721 - loss: 0.5370 - val_accuracy: 0.8070 - val_loss: 0.4951
Epoch 6/50
577/577 ━━━━━━━━━━━━━━━━━━━━ 16s 28ms/step - accuracy: 0.7721 - loss: 0.5367 - val_accuracy: 0.8070 - val_loss: 0.4943
Epoch 7/50
577/577 ━━━━━━━━━━━━━━━━━━━━ 16s 27ms/step - accuracy: 0.7721 - loss: 0.5367 - val_accuracy: 0.8070 - val_loss: 0.4939
Epoch 8/50
577/577 ━━━━━━━━━━━━━━━━━━━━ 16s 27ms/step - accuracy: 0.7721 - loss: 0.5367 - val_accuracy: 0.8070 - val_loss: 0.4939
Epoch 9/50
577/577 ━━━━━━━━━━━━━━━━━━━━ 16s 27ms/step - accuracy: 0.7721 - loss: 0.5367 - val_accuracy: 0.8070 - val_loss: 0.4943
Epoch 10/50
577/577 ━━━━━━━━━━━━━━━━━━━━ 16s 27ms/step - accuracy: 0.7721 - loss: 0.5367 - val_accuracy: 0.8070 - val_loss: 0.4941
Epoch 11/50
577/577 ━━━━━━━━━━━━━━━━━━━━ 16s 27ms/step - accuracy: 0.7721 - loss: 0.5367 - val_accuracy: 0.8070 - val_loss: 0.4943
Epoch 12/50
577/577 ━━━━━━━━━━━━━━━━━━━━ 16s 28ms/step - accuracy: 0.7721 - loss: 0.5367 - val_accuracy: 0.8070 - val_loss: 0.4940
Epoch 13/50
577/577 ━━━━━━━━━━━━━━━━━━━━ 16s 27ms/step - accuracy: 0.7721 - loss: 0.5367 - val_accuracy: 0.8070 - val_loss: 0.4942
Epoch 14/50
577/577 ━━━━━━━━━━━━━━━━━━━━ 16s 27ms/step - accuracy: 0.7721 - loss: 0.5367 - val_accuracy: 0.8070 - val_loss: 0.4942
Epoch 15/50
577/577 ━━━━━━━━━━━━━━━━━━━━ 16s 27ms/step - accuracy: 0.7721 - loss: 0.5367 - val_accuracy: 0.8070 - val_loss: 0.4940
Epoch 16/50
577/577 ━━━━━━━━━━━━━━━━━━━━ 16s 27ms/step - accuracy: 0.7721 - loss: 0.5367 - val_accuracy: 0.8070 - val_loss: 0.4940
Epoch 17/50
577/577 ━━━━━━━━━━━━━━━━━━━━ 16s 27ms/step - accuracy: 0.7721 - loss: 0.5367 - val_accuracy: 0.8070 - val_loss: 0.4942
Epoch 18/50
577/577 ━━━━━━━━━━━━━━━━━━━━ 16s 27ms/step - accuracy: 0.7721 - loss: 0.5367 - val_accuracy: 0.8070 - val_loss: 0.4940
2025-10-31 22:07:56.991 | INFO     | src.ai_engine.ai_models:fit:685 - LSTM trained successfully.
2025-10-31 22:07:57.072 | INFO     | src.ai_engine.ai_models:fit:381 - Generating base model predictions for meta-model training...
2025-10-31 22:07:58.412 | INFO     | src.ai_engine.feature_engineering:create_sequences:261 - Creating sequences with length 50 from 20561 data points.
2025-10-31 22:07:58.645 | INFO     | src.ai_engine.feature_engineering:create_sequences:270 - Created 20511 sequences.
641/641 ━━━━━━━━━━━━━━━━━━━━ 11s 14ms/step
2025-10-31 22:08:11.297 | INFO     | src.ai_engine.ai_models:fit:396 - Training meta-model...
2025-10-31 22:08:11.313 | SUCCESS  | src.ai_engine.ai_models:fit:399 - Stacking Ensemble trained successfully.
2025-10-31 22:08:11.314 | SUCCESS  | __main__:main:167 - Final Ensemble model trained.
2025-10-31 22:08:11.315 | INFO     | __main__:main:171 - Saving models to 'models\PainX_600\15m'...
2025-10-31 22:08:11.652 | INFO     | src.ai_engine.ai_models:save:52 - Model RandomForest saved to models\PainX_600\15m\random_forest.pkl
2025-10-31 22:08:11.721 | INFO     | src.ai_engine.ai_models:save:52 - Model GradientBoosting saved to models\PainX_600\15m\gradient_boosting.pkl
2025-10-31 22:08:11.965 | INFO     | src.ai_engine.ai_models:save:731 - LSTM model saved to models\PainX_600\15m\lstm.keras, models\PainX_600\15m\lstm_scaler.pkl and marker file models\PainX_600\15m\lstm.pkl
2025-10-31 22:08:12.005 | INFO     | src.ai_engine.ai_models:save_all:463 - Meta-model saved to models\PainX_600\15m\meta_model.pkl
2025-10-31 22:08:12.006 | SUCCESS  | __main__:main:174 - --- Finished training for Symbol: PainX 600, Timeframe: 15m ---
2025-10-31 22:08:12.011 | INFO     | __main__:main:140 - --- Starting training for Symbol: PainX 600, Timeframe: 1d ---
2025-10-31 22:08:12.063 | SUCCESS  | __main__:main:148 - Loaded 302 records.
2025-10-31 22:08:12.065 | INFO     | __main__:prepare_training_data:32 - Preparing data for training with Meta-Labeling...
2025-10-31 22:08:12.132 | DEBUG    | src.ai_engine.technical_indicators:calculate_all:47 - Calculated 62 technical indicators
2025-10-31 22:08:12.188 | DEBUG    | src.ai_engine.feature_engineering:extract_features:66 - Extracted 116 features
2025-10-31 22:08:12.189 | INFO     | __main__:prepare_training_data:39 - Generating signals from primary model (SimplePatternModel)...
2025-10-31 22:08:12.193 | WARNING  | src.ai_engine.feature_engineering:prepare_for_model:230 - Se perdieron todos los datos al eliminar los NaN. Se conservarán los datos rellenados.
2025-10-31 22:08:12.244 | INFO     | src.ai_engine.ai_models:calculate_optimal_threshold:549 - Calculated optimal threshold: 0.0126 (volatility: 0.0035, avg_movement: 0.0176)
2025-10-31 22:08:12.245 | INFO     | src.ai_engine.ai_models:create_meta_labels:577 - Creating meta-labels for secondary model...
2025-10-31 22:08:12.284 | INFO     | src.ai_engine.ai_models:create_meta_labels:629 - Meta-Label distribution - Profitable: 80 (74.1%), Unprofitable: 28 (25.9%)
2025-10-31 22:08:12.289 | WARNING  | src.ai_engine.feature_engineering:prepare_for_model:230 - Se perdieron todos los datos al eliminar los NaN. Se conservarán los datos rellenados.
2025-10-31 22:08:12.294 | INFO     | __main__:prepare_training_data:75 - Data preparation complete. Shape of X: (185, 116), Shape of y: (185,)
2025-10-31 22:08:12.298 | INFO     | src.ai_engine.feature_engineering:create_sequences:261 - Creating sequences with length 50 from 185 data points.
2025-10-31 22:08:12.301 | INFO     | src.ai_engine.feature_engineering:create_sequences:270 - Created 135 sequences.
2025-10-31 22:08:12.392 | INFO     | __main__:main:164 - Initializing and training Ensemble model...
2025-10-31 22:08:12.393 | INFO     | src.ai_engine.ai_models:__init__:304 - Initialized Stacking Ensemble with Logistic Regression as meta-model.
2025-10-31 22:08:12.432 | INFO     | src.ai_engine.ai_models:fit:359 - Creating LSTM model...
2025-10-31 22:08:12.432 | INFO     | src.ai_engine.ai_models:fit:364 - Training base models...
2025-10-31 22:08:12.435 | INFO     | src.ai_engine.ai_models:fit:373 - Training random_forest...
2025-10-31 22:08:13.049 | INFO     | src.ai_engine.ai_models:fit:98 - RandomForest trained successfully on 185 samples with 2 classes
2025-10-31 22:08:13.049 | INFO     | src.ai_engine.ai_models:fit:373 - Training gradient_boosting...
2025-10-31 22:08:14.471 | INFO     | src.ai_engine.ai_models:fit:157 - GradientBoosting trained successfully on 185 samples with 2 classes
2025-10-31 22:08:14.471 | INFO     | src.ai_engine.ai_models:fit:373 - Training pattern_based...
2025-10-31 22:08:14.473 | INFO     | src.ai_engine.ai_models:fit:373 - Training lstm...
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\keras\src\layers\rnn\rnn.py:199: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(**kwargs)
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1108: RuntimeWarning: invalid value encountered in divide
  updated_mean = (last_sum + new_sum) / updated_sample_count
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1113: RuntimeWarning: invalid value encountered in divide
  T = new_sum / new_sample_count
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1133: RuntimeWarning: invalid value encountered in divide
  new_unnormalized_variance -= correction**2 / new_sample_count
Epoch 1/50
4/4 ━━━━━━━━━━━━━━━━━━━━ 80s 723ms/step - accuracy: 0.5372 - loss: 0.6932 - val_accuracy: 0.7143 - val_loss: 0.6925
Epoch 2/50
4/4 ━━━━━━━━━━━━━━━━━━━━ 1s 208ms/step - accuracy: 0.5372 - loss: 0.6930 - val_accuracy: 0.7143 - val_loss: 0.6921
Epoch 3/50
4/4 ━━━━━━━━━━━━━━━━━━━━ 1s 125ms/step - accuracy: 0.5372 - loss: 0.6930 - val_accuracy: 0.7143 - val_loss: 0.6919
Epoch 4/50
4/4 ━━━━━━━━━━━━━━━━━━━━ 0s 96ms/step - accuracy: 0.5372 - loss: 0.6929 - val_accuracy: 0.7143 - val_loss: 0.6915
Epoch 5/50
4/4 ━━━━━━━━━━━━━━━━━━━━ 0s 116ms/step - accuracy: 0.5372 - loss: 0.6928 - val_accuracy: 0.7143 - val_loss: 0.6911
Epoch 6/50
4/4 ━━━━━━━━━━━━━━━━━━━━ 0s 103ms/step - accuracy: 0.5372 - loss: 0.6928 - val_accuracy: 0.7143 - val_loss: 0.6907
Epoch 7/50
4/4 ━━━━━━━━━━━━━━━━━━━━ 0s 46ms/step - accuracy: 0.5372 - loss: 0.6927 - val_accuracy: 0.7143 - val_loss: 0.6903
Epoch 8/50
4/4 ━━━━━━━━━━━━━━━━━━━━ 0s 46ms/step - accuracy: 0.5372 - loss: 0.6927 - val_accuracy: 0.7143 - val_loss: 0.6899
Epoch 9/50
4/4 ━━━━━━━━━━━━━━━━━━━━ 0s 81ms/step - accuracy: 0.5372 - loss: 0.6926 - val_accuracy: 0.7143 - val_loss: 0.6895
Epoch 10/50
4/4 ━━━━━━━━━━━━━━━━━━━━ 0s 51ms/step - accuracy: 0.5372 - loss: 0.6925 - val_accuracy: 0.7143 - val_loss: 0.6892
Epoch 11/50
4/4 ━━━━━━━━━━━━━━━━━━━━ 0s 45ms/step - accuracy: 0.5372 - loss: 0.6925 - val_accuracy: 0.7143 - val_loss: 0.6888
Epoch 12/50
4/4 ━━━━━━━━━━━━━━━━━━━━ 0s 46ms/step - accuracy: 0.5372 - loss: 0.6924 - val_accuracy: 0.7143 - val_loss: 0.6884
Epoch 13/50
4/4 ━━━━━━━━━━━━━━━━━━━━ 0s 45ms/step - accuracy: 0.5372 - loss: 0.6924 - val_accuracy: 0.7143 - val_loss: 0.6880
Epoch 14/50
4/4 ━━━━━━━━━━━━━━━━━━━━ 0s 46ms/step - accuracy: 0.5372 - loss: 0.6923 - val_accuracy: 0.7143 - val_loss: 0.6877
Epoch 15/50
4/4 ━━━━━━━━━━━━━━━━━━━━ 0s 45ms/step - accuracy: 0.5372 - loss: 0.6923 - val_accuracy: 0.7143 - val_loss: 0.6873
Epoch 16/50
4/4 ━━━━━━━━━━━━━━━━━━━━ 0s 46ms/step - accuracy: 0.5372 - loss: 0.6922 - val_accuracy: 0.7143 - val_loss: 0.6870
Epoch 17/50
4/4 ━━━━━━━━━━━━━━━━━━━━ 0s 45ms/step - accuracy: 0.5372 - loss: 0.6922 - val_accuracy: 0.7143 - val_loss: 0.6867
Epoch 18/50
4/4 ━━━━━━━━━━━━━━━━━━━━ 0s 45ms/step - accuracy: 0.5372 - loss: 0.6921 - val_accuracy: 0.7143 - val_loss: 0.6865
Epoch 19/50
4/4 ━━━━━━━━━━━━━━━━━━━━ 0s 45ms/step - accuracy: 0.5372 - loss: 0.6921 - val_accuracy: 0.7143 - val_loss: 0.6862
Epoch 20/50
4/4 ━━━━━━━━━━━━━━━━━━━━ 0s 46ms/step - accuracy: 0.5372 - loss: 0.6921 - val_accuracy: 0.7143 - val_loss: 0.6858
Epoch 21/50
4/4 ━━━━━━━━━━━━━━━━━━━━ 0s 46ms/step - accuracy: 0.5372 - loss: 0.6920 - val_accuracy: 0.7143 - val_loss: 0.6855
Epoch 22/50
4/4 ━━━━━━━━━━━━━━━━━━━━ 0s 46ms/step - accuracy: 0.5372 - loss: 0.6920 - val_accuracy: 0.7143 - val_loss: 0.6853
Epoch 23/50
4/4 ━━━━━━━━━━━━━━━━━━━━ 0s 45ms/step - accuracy: 0.5372 - loss: 0.6919 - val_accuracy: 0.7143 - val_loss: 0.6851
Epoch 24/50
4/4 ━━━━━━━━━━━━━━━━━━━━ 0s 46ms/step - accuracy: 0.5372 - loss: 0.6919 - val_accuracy: 0.7143 - val_loss: 0.6849
Epoch 25/50
4/4 ━━━━━━━━━━━━━━━━━━━━ 0s 46ms/step - accuracy: 0.5372 - loss: 0.6919 - val_accuracy: 0.7143 - val_loss: 0.6845
Epoch 26/50
4/4 ━━━━━━━━━━━━━━━━━━━━ 0s 46ms/step - accuracy: 0.5372 - loss: 0.6918 - val_accuracy: 0.7143 - val_loss: 0.6842
Epoch 27/50
4/4 ━━━━━━━━━━━━━━━━━━━━ 0s 45ms/step - accuracy: 0.5372 - loss: 0.6918 - val_accuracy: 0.7143 - val_loss: 0.6840
Epoch 28/50
4/4 ━━━━━━━━━━━━━━━━━━━━ 0s 46ms/step - accuracy: 0.5372 - loss: 0.6917 - val_accuracy: 0.7143 - val_loss: 0.6837
Epoch 29/50
4/4 ━━━━━━━━━━━━━━━━━━━━ 0s 45ms/step - accuracy: 0.5372 - loss: 0.6917 - val_accuracy: 0.7143 - val_loss: 0.6835
Epoch 30/50
4/4 ━━━━━━━━━━━━━━━━━━━━ 0s 45ms/step - accuracy: 0.5372 - loss: 0.6917 - val_accuracy: 0.7143 - val_loss: 0.6832
Epoch 31/50
4/4 ━━━━━━━━━━━━━━━━━━━━ 0s 45ms/step - accuracy: 0.5372 - loss: 0.6916 - val_accuracy: 0.7143 - val_loss: 0.6830
Epoch 32/50
4/4 ━━━━━━━━━━━━━━━━━━━━ 0s 45ms/step - accuracy: 0.5372 - loss: 0.6916 - val_accuracy: 0.7143 - val_loss: 0.6829
Epoch 33/50
4/4 ━━━━━━━━━━━━━━━━━━━━ 0s 46ms/step - accuracy: 0.5372 - loss: 0.6916 - val_accuracy: 0.7143 - val_loss: 0.6825
Epoch 34/50
4/4 ━━━━━━━━━━━━━━━━━━━━ 0s 45ms/step - accuracy: 0.5372 - loss: 0.6916 - val_accuracy: 0.7143 - val_loss: 0.6823
Epoch 35/50
4/4 ━━━━━━━━━━━━━━━━━━━━ 0s 45ms/step - accuracy: 0.5372 - loss: 0.6916 - val_accuracy: 0.7143 - val_loss: 0.6820
Epoch 36/50
4/4 ━━━━━━━━━━━━━━━━━━━━ 0s 46ms/step - accuracy: 0.5372 - loss: 0.6915 - val_accuracy: 0.7143 - val_loss: 0.6817
Epoch 37/50
4/4 ━━━━━━━━━━━━━━━━━━━━ 0s 45ms/step - accuracy: 0.5372 - loss: 0.6915 - val_accuracy: 0.7143 - val_loss: 0.6815
Epoch 38/50
4/4 ━━━━━━━━━━━━━━━━━━━━ 0s 45ms/step - accuracy: 0.5372 - loss: 0.6915 - val_accuracy: 0.7143 - val_loss: 0.6813
Epoch 39/50
4/4 ━━━━━━━━━━━━━━━━━━━━ 0s 45ms/step - accuracy: 0.5372 - loss: 0.6914 - val_accuracy: 0.7143 - val_loss: 0.6811
Epoch 40/50
4/4 ━━━━━━━━━━━━━━━━━━━━ 0s 46ms/step - accuracy: 0.5372 - loss: 0.6914 - val_accuracy: 0.7143 - val_loss: 0.6808
Epoch 41/50
4/4 ━━━━━━━━━━━━━━━━━━━━ 0s 46ms/step - accuracy: 0.5372 - loss: 0.6914 - val_accuracy: 0.7143 - val_loss: 0.6806
Epoch 42/50
4/4 ━━━━━━━━━━━━━━━━━━━━ 0s 46ms/step - accuracy: 0.5372 - loss: 0.6913 - val_accuracy: 0.7143 - val_loss: 0.6804
Epoch 43/50
4/4 ━━━━━━━━━━━━━━━━━━━━ 0s 45ms/step - accuracy: 0.5372 - loss: 0.6913 - val_accuracy: 0.7143 - val_loss: 0.6802
Epoch 44/50
4/4 ━━━━━━━━━━━━━━━━━━━━ 0s 46ms/step - accuracy: 0.5372 - loss: 0.6913 - val_accuracy: 0.7143 - val_loss: 0.6799
Epoch 45/50
4/4 ━━━━━━━━━━━━━━━━━━━━ 0s 46ms/step - accuracy: 0.5372 - loss: 0.6913 - val_accuracy: 0.7143 - val_loss: 0.6797
Epoch 46/50
4/4 ━━━━━━━━━━━━━━━━━━━━ 0s 45ms/step - accuracy: 0.5372 - loss: 0.6913 - val_accuracy: 0.7143 - val_loss: 0.6795
Epoch 47/50
4/4 ━━━━━━━━━━━━━━━━━━━━ 0s 45ms/step - accuracy: 0.5372 - loss: 0.6912 - val_accuracy: 0.7143 - val_loss: 0.6794
Epoch 48/50
4/4 ━━━━━━━━━━━━━━━━━━━━ 0s 45ms/step - accuracy: 0.5372 - loss: 0.6912 - val_accuracy: 0.7143 - val_loss: 0.6791
Epoch 49/50
4/4 ━━━━━━━━━━━━━━━━━━━━ 0s 45ms/step - accuracy: 0.5372 - loss: 0.6912 - val_accuracy: 0.7143 - val_loss: 0.6789
Epoch 50/50
4/4 ━━━━━━━━━━━━━━━━━━━━ 0s 45ms/step - accuracy: 0.5372 - loss: 0.6912 - val_accuracy: 0.7143 - val_loss: 0.6786
2025-10-31 22:09:46.434 | INFO     | src.ai_engine.ai_models:fit:685 - LSTM trained successfully.
2025-10-31 22:09:46.435 | INFO     | src.ai_engine.ai_models:fit:381 - Generating base model predictions for meta-model training...
2025-10-31 22:09:46.450 | INFO     | src.ai_engine.feature_engineering:create_sequences:261 - Creating sequences with length 50 from 185 data points.
2025-10-31 22:09:46.452 | INFO     | src.ai_engine.feature_engineering:create_sequences:270 - Created 135 sequences.
5/5 ━━━━━━━━━━━━━━━━━━━━ 1s 178ms/step
2025-10-31 22:09:48.026 | INFO     | src.ai_engine.ai_models:fit:396 - Training meta-model...
2025-10-31 22:09:48.042 | SUCCESS  | src.ai_engine.ai_models:fit:399 - Stacking Ensemble trained successfully.
2025-10-31 22:09:48.043 | SUCCESS  | __main__:main:167 - Final Ensemble model trained.
2025-10-31 22:09:48.044 | INFO     | __main__:main:171 - Saving models to 'models\PainX_600\1d'...
2025-10-31 22:09:48.138 | INFO     | src.ai_engine.ai_models:save:52 - Model RandomForest saved to models\PainX_600\1d\random_forest.pkl
2025-10-31 22:09:48.220 | INFO     | src.ai_engine.ai_models:save:52 - Model GradientBoosting saved to models\PainX_600\1d\gradient_boosting.pkl
2025-10-31 22:09:48.326 | INFO     | src.ai_engine.ai_models:save:731 - LSTM model saved to models\PainX_600\1d\lstm.keras, models\PainX_600\1d\lstm_scaler.pkl and marker file models\PainX_600\1d\lstm.pkl
2025-10-31 22:09:48.327 | INFO     | src.ai_engine.ai_models:save_all:463 - Meta-model saved to models\PainX_600\1d\meta_model.pkl
2025-10-31 22:09:48.328 | SUCCESS  | __main__:main:174 - --- Finished training for Symbol: PainX 600, Timeframe: 1d ---
2025-10-31 22:09:48.331 | INFO     | __main__:main:140 - --- Starting training for Symbol: PainX 600, Timeframe: 1h ---
2025-10-31 22:09:48.440 | SUCCESS  | __main__:main:148 - Loaded 7227 records.
2025-10-31 22:09:48.440 | INFO     | __main__:prepare_training_data:32 - Preparing data for training with Meta-Labeling...
2025-10-31 22:09:48.895 | DEBUG    | src.ai_engine.technical_indicators:calculate_all:47 - Calculated 63 technical indicators
2025-10-31 22:09:50.156 | DEBUG    | src.ai_engine.feature_engineering:extract_features:66 - Extracted 116 features
2025-10-31 22:09:50.157 | INFO     | __main__:prepare_training_data:39 - Generating signals from primary model (SimplePatternModel)...
2025-10-31 22:09:50.177 | WARNING  | src.ai_engine.feature_engineering:prepare_for_model:230 - Se perdieron todos los datos al eliminar los NaN. Se conservarán los datos rellenados.
2025-10-31 22:09:51.349 | INFO     | src.ai_engine.ai_models:calculate_optimal_threshold:549 - Calculated optimal threshold: 0.0022 (volatility: 0.0008, avg_movement: 0.0032)
2025-10-31 22:09:51.350 | INFO     | src.ai_engine.ai_models:create_meta_labels:577 - Creating meta-labels for secondary model...
2025-10-31 22:09:52.194 | INFO     | src.ai_engine.ai_models:create_meta_labels:629 - Meta-Label distribution - Profitable: 1146 (35.3%), Unprofitable: 2098 (64.7%)
2025-10-31 22:09:52.220 | WARNING  | src.ai_engine.feature_engineering:prepare_for_model:230 - Se perdieron todos los datos al eliminar los NaN. Se conservarán los datos rellenados.
2025-10-31 22:09:52.229 | INFO     | __main__:prepare_training_data:75 - Data preparation complete. Shape of X: (5008, 116), Shape of y: (5008,)
2025-10-31 22:09:52.235 | INFO     | src.ai_engine.feature_engineering:create_sequences:261 - Creating sequences with length 50 from 5008 data points.
2025-10-31 22:09:52.296 | INFO     | src.ai_engine.feature_engineering:create_sequences:270 - Created 4958 sequences.
2025-10-31 22:09:52.298 | INFO     | __main__:main:164 - Initializing and training Ensemble model...
2025-10-31 22:09:52.301 | INFO     | src.ai_engine.ai_models:__init__:304 - Initialized Stacking Ensemble with Logistic Regression as meta-model.
2025-10-31 22:09:52.302 | INFO     | src.ai_engine.ai_models:fit:359 - Creating LSTM model...
2025-10-31 22:09:52.303 | INFO     | src.ai_engine.ai_models:fit:364 - Training base models...
2025-10-31 22:09:52.311 | INFO     | src.ai_engine.ai_models:fit:373 - Training random_forest...
2025-10-31 22:09:54.193 | INFO     | src.ai_engine.ai_models:fit:98 - RandomForest trained successfully on 5008 samples with 2 classes
2025-10-31 22:09:54.193 | INFO     | src.ai_engine.ai_models:fit:373 - Training gradient_boosting...
2025-10-31 22:10:43.703 | INFO     | src.ai_engine.ai_models:fit:157 - GradientBoosting trained successfully on 5008 samples with 2 classes
2025-10-31 22:10:43.704 | INFO     | src.ai_engine.ai_models:fit:373 - Training pattern_based...
2025-10-31 22:10:43.707 | INFO     | src.ai_engine.ai_models:fit:373 - Training lstm...
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\keras\src\layers\rnn\rnn.py:199: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(**kwargs)
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1108: RuntimeWarning: invalid value encountered in divide
  updated_mean = (last_sum + new_sum) / updated_sample_count
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1113: RuntimeWarning: invalid value encountered in divide
  T = new_sum / new_sample_count
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1133: RuntimeWarning: invalid value encountered in divide
  new_unnormalized_variance -= correction**2 / new_sample_count
Epoch 1/50
140/140 ━━━━━━━━━━━━━━━━━━━━ 29s 41ms/step - accuracy: 0.7658 - loss: 0.6765 - val_accuracy: 0.8085 - val_loss: 0.6547
Epoch 2/50
140/140 ━━━━━━━━━━━━━━━━━━━━ 4s 30ms/step - accuracy: 0.7658 - loss: 0.6466 - val_accuracy: 0.8085 - val_loss: 0.6229
Epoch 3/50
140/140 ━━━━━━━━━━━━━━━━━━━━ 4s 31ms/step - accuracy: 0.7658 - loss: 0.6226 - val_accuracy: 0.8085 - val_loss: 0.5967
Epoch 4/50
140/140 ━━━━━━━━━━━━━━━━━━━━ 4s 29ms/step - accuracy: 0.7658 - loss: 0.6036 - val_accuracy: 0.8085 - val_loss: 0.5754
Epoch 5/50
140/140 ━━━━━━━━━━━━━━━━━━━━ 4s 29ms/step - accuracy: 0.7658 - loss: 0.5887 - val_accuracy: 0.8085 - val_loss: 0.5584
Epoch 6/50
140/140 ━━━━━━━━━━━━━━━━━━━━ 4s 29ms/step - accuracy: 0.7658 - loss: 0.5772 - val_accuracy: 0.8085 - val_loss: 0.5447
Epoch 7/50
140/140 ━━━━━━━━━━━━━━━━━━━━ 4s 28ms/step - accuracy: 0.7658 - loss: 0.5683 - val_accuracy: 0.8085 - val_loss: 0.5336
Epoch 8/50
140/140 ━━━━━━━━━━━━━━━━━━━━ 7s 47ms/step - accuracy: 0.7658 - loss: 0.5615 - val_accuracy: 0.8085 - val_loss: 0.5247
Epoch 9/50
140/140 ━━━━━━━━━━━━━━━━━━━━ 4s 29ms/step - accuracy: 0.7658 - loss: 0.5564 - val_accuracy: 0.8085 - val_loss: 0.5176
Epoch 10/50
140/140 ━━━━━━━━━━━━━━━━━━━━ 4s 28ms/step - accuracy: 0.7658 - loss: 0.5528 - val_accuracy: 0.8085 - val_loss: 0.5122
Epoch 11/50
140/140 ━━━━━━━━━━━━━━━━━━━━ 4s 28ms/step - accuracy: 0.7658 - loss: 0.5501 - val_accuracy: 0.8085 - val_loss: 0.5080
Epoch 12/50
140/140 ━━━━━━━━━━━━━━━━━━━━ 4s 28ms/step - accuracy: 0.7658 - loss: 0.5482 - val_accuracy: 0.8085 - val_loss: 0.5048
Epoch 13/50
140/140 ━━━━━━━━━━━━━━━━━━━━ 4s 28ms/step - accuracy: 0.7658 - loss: 0.5469 - val_accuracy: 0.8085 - val_loss: 0.5022
Epoch 14/50
140/140 ━━━━━━━━━━━━━━━━━━━━ 4s 28ms/step - accuracy: 0.7658 - loss: 0.5460 - val_accuracy: 0.8085 - val_loss: 0.5003
Epoch 15/50
140/140 ━━━━━━━━━━━━━━━━━━━━ 4s 28ms/step - accuracy: 0.7658 - loss: 0.5454 - val_accuracy: 0.8085 - val_loss: 0.4986
Epoch 16/50
140/140 ━━━━━━━━━━━━━━━━━━━━ 4s 29ms/step - accuracy: 0.7658 - loss: 0.5450 - val_accuracy: 0.8085 - val_loss: 0.4975
Epoch 17/50
140/140 ━━━━━━━━━━━━━━━━━━━━ 4s 28ms/step - accuracy: 0.7658 - loss: 0.5447 - val_accuracy: 0.8085 - val_loss: 0.4966
Epoch 18/50
140/140 ━━━━━━━━━━━━━━━━━━━━ 4s 29ms/step - accuracy: 0.7658 - loss: 0.5446 - val_accuracy: 0.8085 - val_loss: 0.4959
Epoch 19/50
140/140 ━━━━━━━━━━━━━━━━━━━━ 4s 28ms/step - accuracy: 0.7658 - loss: 0.5445 - val_accuracy: 0.8085 - val_loss: 0.4954
Epoch 20/50
140/140 ━━━━━━━━━━━━━━━━━━━━ 4s 28ms/step - accuracy: 0.7658 - loss: 0.5444 - val_accuracy: 0.8085 - val_loss: 0.4951
Epoch 21/50
140/140 ━━━━━━━━━━━━━━━━━━━━ 4s 29ms/step - accuracy: 0.7658 - loss: 0.5444 - val_accuracy: 0.8085 - val_loss: 0.4948
Epoch 22/50
140/140 ━━━━━━━━━━━━━━━━━━━━ 4s 28ms/step - accuracy: 0.7658 - loss: 0.5444 - val_accuracy: 0.8085 - val_loss: 0.4944
Epoch 23/50
140/140 ━━━━━━━━━━━━━━━━━━━━ 4s 29ms/step - accuracy: 0.7658 - loss: 0.5444 - val_accuracy: 0.8085 - val_loss: 0.4942
Epoch 24/50
140/140 ━━━━━━━━━━━━━━━━━━━━ 4s 28ms/step - accuracy: 0.7658 - loss: 0.5443 - val_accuracy: 0.8085 - val_loss: 0.4942
Epoch 25/50
140/140 ━━━━━━━━━━━━━━━━━━━━ 4s 28ms/step - accuracy: 0.7658 - loss: 0.5444 - val_accuracy: 0.8085 - val_loss: 0.4939
Epoch 26/50
140/140 ━━━━━━━━━━━━━━━━━━━━ 4s 28ms/step - accuracy: 0.7658 - loss: 0.5443 - val_accuracy: 0.8085 - val_loss: 0.4940
Epoch 27/50
140/140 ━━━━━━━━━━━━━━━━━━━━ 4s 28ms/step - accuracy: 0.7658 - loss: 0.5443 - val_accuracy: 0.8085 - val_loss: 0.4940
Epoch 28/50
140/140 ━━━━━━━━━━━━━━━━━━━━ 4s 28ms/step - accuracy: 0.7658 - loss: 0.5443 - val_accuracy: 0.8085 - val_loss: 0.4938
Epoch 29/50
140/140 ━━━━━━━━━━━━━━━━━━━━ 4s 28ms/step - accuracy: 0.7658 - loss: 0.5443 - val_accuracy: 0.8085 - val_loss: 0.4938
Epoch 30/50
140/140 ━━━━━━━━━━━━━━━━━━━━ 4s 28ms/step - accuracy: 0.7658 - loss: 0.5443 - val_accuracy: 0.8085 - val_loss: 0.4938
Epoch 31/50
140/140 ━━━━━━━━━━━━━━━━━━━━ 4s 29ms/step - accuracy: 0.7658 - loss: 0.5443 - val_accuracy: 0.8085 - val_loss: 0.4938
Epoch 32/50
140/140 ━━━━━━━━━━━━━━━━━━━━ 4s 29ms/step - accuracy: 0.7658 - loss: 0.5443 - val_accuracy: 0.8085 - val_loss: 0.4938
Epoch 33/50
140/140 ━━━━━━━━━━━━━━━━━━━━ 4s 29ms/step - accuracy: 0.7658 - loss: 0.5443 - val_accuracy: 0.8085 - val_loss: 0.4938
Epoch 34/50
140/140 ━━━━━━━━━━━━━━━━━━━━ 4s 28ms/step - accuracy: 0.7658 - loss: 0.5443 - val_accuracy: 0.8085 - val_loss: 0.4938
Epoch 35/50
140/140 ━━━━━━━━━━━━━━━━━━━━ 4s 28ms/step - accuracy: 0.7658 - loss: 0.5443 - val_accuracy: 0.8085 - val_loss: 0.4939
Epoch 36/50
140/140 ━━━━━━━━━━━━━━━━━━━━ 4s 28ms/step - accuracy: 0.7658 - loss: 0.5443 - val_accuracy: 0.8085 - val_loss: 0.4939
Epoch 37/50
140/140 ━━━━━━━━━━━━━━━━━━━━ 4s 28ms/step - accuracy: 0.7658 - loss: 0.5443 - val_accuracy: 0.8085 - val_loss: 0.4938
Epoch 38/50
140/140 ━━━━━━━━━━━━━━━━━━━━ 4s 28ms/step - accuracy: 0.7658 - loss: 0.5443 - val_accuracy: 0.8085 - val_loss: 0.4939
Epoch 39/50
140/140 ━━━━━━━━━━━━━━━━━━━━ 4s 28ms/step - accuracy: 0.7658 - loss: 0.5443 - val_accuracy: 0.8085 - val_loss: 0.4937
Epoch 40/50
140/140 ━━━━━━━━━━━━━━━━━━━━ 4s 29ms/step - accuracy: 0.7658 - loss: 0.5443 - val_accuracy: 0.8085 - val_loss: 0.4939
Epoch 41/50
140/140 ━━━━━━━━━━━━━━━━━━━━ 4s 28ms/step - accuracy: 0.7658 - loss: 0.5443 - val_accuracy: 0.8085 - val_loss: 0.4938
Epoch 42/50
140/140 ━━━━━━━━━━━━━━━━━━━━ 4s 28ms/step - accuracy: 0.7658 - loss: 0.5443 - val_accuracy: 0.8085 - val_loss: 0.4939
Epoch 43/50
140/140 ━━━━━━━━━━━━━━━━━━━━ 4s 29ms/step - accuracy: 0.7658 - loss: 0.5443 - val_accuracy: 0.8085 - val_loss: 0.4938
Epoch 44/50
140/140 ━━━━━━━━━━━━━━━━━━━━ 4s 28ms/step - accuracy: 0.7658 - loss: 0.5443 - val_accuracy: 0.8085 - val_loss: 0.4938
Epoch 45/50
140/140 ━━━━━━━━━━━━━━━━━━━━ 4s 28ms/step - accuracy: 0.7658 - loss: 0.5443 - val_accuracy: 0.8085 - val_loss: 0.4937
Epoch 46/50
140/140 ━━━━━━━━━━━━━━━━━━━━ 4s 28ms/step - accuracy: 0.7658 - loss: 0.5443 - val_accuracy: 0.8085 - val_loss: 0.4937
Epoch 47/50
140/140 ━━━━━━━━━━━━━━━━━━━━ 4s 28ms/step - accuracy: 0.7658 - loss: 0.5443 - val_accuracy: 0.8085 - val_loss: 0.4937
Epoch 48/50
140/140 ━━━━━━━━━━━━━━━━━━━━ 4s 28ms/step - accuracy: 0.7658 - loss: 0.5444 - val_accuracy: 0.8085 - val_loss: 0.4939
Epoch 49/50
140/140 ━━━━━━━━━━━━━━━━━━━━ 4s 28ms/step - accuracy: 0.7658 - loss: 0.5443 - val_accuracy: 0.8085 - val_loss: 0.4939
Epoch 50/50
140/140 ━━━━━━━━━━━━━━━━━━━━ 4s 28ms/step - accuracy: 0.7658 - loss: 0.5443 - val_accuracy: 0.8085 - val_loss: 0.4938
2025-10-31 22:14:31.885 | INFO     | src.ai_engine.ai_models:fit:685 - LSTM trained successfully.
2025-10-31 22:14:31.892 | INFO     | src.ai_engine.ai_models:fit:381 - Generating base model predictions for meta-model training...
2025-10-31 22:14:32.222 | INFO     | src.ai_engine.feature_engineering:create_sequences:261 - Creating sequences with length 50 from 5008 data points.
2025-10-31 22:14:32.282 | INFO     | src.ai_engine.feature_engineering:create_sequences:270 - Created 4958 sequences.
155/155 ━━━━━━━━━━━━━━━━━━━━ 4s 21ms/step
2025-10-31 22:14:36.784 | INFO     | src.ai_engine.ai_models:fit:396 - Training meta-model...
2025-10-31 22:14:36.792 | SUCCESS  | src.ai_engine.ai_models:fit:399 - Stacking Ensemble trained successfully.
2025-10-31 22:14:36.793 | SUCCESS  | __main__:main:167 - Final Ensemble model trained.
2025-10-31 22:14:36.793 | INFO     | __main__:main:171 - Saving models to 'models\PainX_600\1h'...
2025-10-31 22:14:37.142 | INFO     | src.ai_engine.ai_models:save:52 - Model RandomForest saved to models\PainX_600\1h\random_forest.pkl
2025-10-31 22:14:37.466 | INFO     | src.ai_engine.ai_models:save:52 - Model GradientBoosting saved to models\PainX_600\1h\gradient_boosting.pkl
2025-10-31 22:14:37.618 | INFO     | src.ai_engine.ai_models:save:731 - LSTM model saved to models\PainX_600\1h\lstm.keras, models\PainX_600\1h\lstm_scaler.pkl and marker file models\PainX_600\1h\lstm.pkl
2025-10-31 22:14:37.621 | INFO     | src.ai_engine.ai_models:save_all:463 - Meta-model saved to models\PainX_600\1h\meta_model.pkl
2025-10-31 22:14:37.625 | SUCCESS  | __main__:main:174 - --- Finished training for Symbol: PainX 600, Timeframe: 1h ---
2025-10-31 22:14:37.627 | INFO     | __main__:main:140 - --- Starting training for Symbol: PainX 600, Timeframe: 1m ---
2025-10-31 22:14:38.031 | SUCCESS  | __main__:main:148 - Loaded 100001 records.
2025-10-31 22:14:38.031 | INFO     | __main__:prepare_training_data:32 - Preparing data for training with Meta-Labeling...
2025-10-31 22:14:43.514 | DEBUG    | src.ai_engine.technical_indicators:calculate_all:47 - Calculated 63 technical indicators
2025-10-31 22:15:00.266 | DEBUG    | src.ai_engine.feature_engineering:extract_features:66 - Extracted 116 features
2025-10-31 22:15:00.269 | INFO     | __main__:prepare_training_data:39 - Generating signals from primary model (SimplePatternModel)...
2025-10-31 22:15:00.479 | WARNING  | src.ai_engine.feature_engineering:prepare_for_model:230 - Se perdieron todos los datos al eliminar los NaN. Se conservarán los datos rellenados.
2025-10-31 22:15:16.543 | INFO     | src.ai_engine.ai_models:calculate_optimal_threshold:549 - Calculated optimal threshold: 0.0010 (volatility: 0.0001, avg_movement: 0.0004)
2025-10-31 22:15:16.545 | INFO     | src.ai_engine.ai_models:create_meta_labels:577 - Creating meta-labels for secondary model...
2025-10-31 22:15:30.126 | INFO     | src.ai_engine.ai_models:create_meta_labels:629 - Meta-Label distribution - Profitable: 59 (9.0%), Unprofitable: 599 (91.0%)
2025-10-31 22:15:30.385 | WARNING  | src.ai_engine.feature_engineering:prepare_for_model:230 - Se perdieron todos los datos al eliminar los NaN. Se conservarán los datos rellenados.
2025-10-31 22:15:30.488 | INFO     | __main__:prepare_training_data:75 - Data preparation complete. Shape of X: (60888, 116), Shape of y: (60888,)
2025-10-31 22:15:30.527 | INFO     | src.ai_engine.feature_engineering:create_sequences:261 - Creating sequences with length 50 from 60888 data points.
2025-10-31 22:15:31.277 | INFO     | src.ai_engine.feature_engineering:create_sequences:270 - Created 60838 sequences.
2025-10-31 22:15:31.294 | INFO     | __main__:main:164 - Initializing and training Ensemble model...
2025-10-31 22:15:31.295 | INFO     | src.ai_engine.ai_models:__init__:304 - Initialized Stacking Ensemble with Logistic Regression as meta-model.
2025-10-31 22:15:31.297 | INFO     | src.ai_engine.ai_models:fit:359 - Creating LSTM model...
2025-10-31 22:15:31.298 | INFO     | src.ai_engine.ai_models:fit:364 - Training base models...
2025-10-31 22:15:31.424 | INFO     | src.ai_engine.ai_models:fit:373 - Training random_forest...
2025-10-31 22:15:45.910 | INFO     | src.ai_engine.ai_models:fit:98 - RandomForest trained successfully on 60888 samples with 2 classes
2025-10-31 22:15:45.912 | INFO     | src.ai_engine.ai_models:fit:373 - Training gradient_boosting...
2025-10-31 22:25:41.158 | INFO     | src.ai_engine.ai_models:fit:157 - GradientBoosting trained successfully on 60888 samples with 2 classes
2025-10-31 22:25:41.162 | INFO     | src.ai_engine.ai_models:fit:373 - Training pattern_based...
2025-10-31 22:25:41.163 | INFO     | src.ai_engine.ai_models:fit:373 - Training lstm...
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\keras\src\layers\rnn\rnn.py:199: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(**kwargs)
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1108: RuntimeWarning: invalid value encountered in divide
  updated_mean = (last_sum + new_sum) / updated_sample_count
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1113: RuntimeWarning: invalid value encountered in divide
  T = new_sum / new_sample_count
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1133: RuntimeWarning: invalid value encountered in divide
  new_unnormalized_variance -= correction**2 / new_sample_count
Epoch 1/50
1712/1712 ━━━━━━━━━━━━━━━━━━━━ 319s 35ms/step - accuracy: 0.9990 - loss: 0.4063 - val_accuracy: 0.9993 - val_loss: 0.2215
Epoch 2/50
1712/1712 ━━━━━━━━━━━━━━━━━━━━ 50s 28ms/step - accuracy: 0.9990 - loss: 0.1436 - val_accuracy: 0.9993 - val_loss: 0.0887
Epoch 3/50
1712/1712 ━━━━━━━━━━━━━━━━━━━━ 48s 28ms/step - accuracy: 0.9990 - loss: 0.0623 - val_accuracy: 0.9993 - val_loss: 0.0411
Epoch 4/50
1712/1712 ━━━━━━━━━━━━━━━━━━━━ 47s 27ms/step - accuracy: 0.9990 - loss: 0.0311 - val_accuracy: 0.9993 - val_loss: 0.0212
Epoch 5/50
1712/1712 ━━━━━━━━━━━━━━━━━━━━ 46s 27ms/step - accuracy: 0.9990 - loss: 0.0177 - val_accuracy: 0.9993 - val_loss: 0.0123
Epoch 6/50
1712/1712 ━━━━━━━━━━━━━━━━━━━━ 47s 28ms/step - accuracy: 0.9990 - loss: 0.0118 - val_accuracy: 0.9993 - val_loss: 0.0084
Epoch 7/50
1712/1712 ━━━━━━━━━━━━━━━━━━━━ 47s 27ms/step - accuracy: 0.9990 - loss: 0.0094 - val_accuracy: 0.9993 - val_loss: 0.0068
Epoch 8/50
1712/1712 ━━━━━━━━━━━━━━━━━━━━ 46s 27ms/step - accuracy: 0.9990 - loss: 0.0085 - val_accuracy: 0.9993 - val_loss: 0.0061
Epoch 9/50
1712/1712 ━━━━━━━━━━━━━━━━━━━━ 46s 27ms/step - accuracy: 0.9990 - loss: 0.0081 - val_accuracy: 0.9993 - val_loss: 0.0058
Epoch 10/50
1712/1712 ━━━━━━━━━━━━━━━━━━━━ 46s 27ms/step - accuracy: 0.9990 - loss: 0.0080 - val_accuracy: 0.9993 - val_loss: 0.0057
Epoch 11/50
1712/1712 ━━━━━━━━━━━━━━━━━━━━ 46s 27ms/step - accuracy: 0.9990 - loss: 0.0080 - val_accuracy: 0.9993 - val_loss: 0.0056
Epoch 12/50
1712/1712 ━━━━━━━━━━━━━━━━━━━━ 47s 27ms/step - accuracy: 0.9990 - loss: 0.0080 - val_accuracy: 0.9993 - val_loss: 0.0056
Epoch 13/50
1712/1712 ━━━━━━━━━━━━━━━━━━━━ 46s 27ms/step - accuracy: 0.9990 - loss: 0.0079 - val_accuracy: 0.9993 - val_loss: 0.0056
Epoch 14/50
1712/1712 ━━━━━━━━━━━━━━━━━━━━ 47s 27ms/step - accuracy: 0.9990 - loss: 0.0079 - val_accuracy: 0.9993 - val_loss: 0.0056
Epoch 15/50
1712/1712 ━━━━━━━━━━━━━━━━━━━━ 48s 28ms/step - accuracy: 0.9990 - loss: 0.0079 - val_accuracy: 0.9993 - val_loss: 0.0056
Epoch 16/50
1712/1712 ━━━━━━━━━━━━━━━━━━━━ 46s 27ms/step - accuracy: 0.9990 - loss: 0.0079 - val_accuracy: 0.9993 - val_loss: 0.0056
Epoch 17/50
1712/1712 ━━━━━━━━━━━━━━━━━━━━ 46s 27ms/step - accuracy: 0.9990 - loss: 0.0079 - val_accuracy: 0.9993 - val_loss: 0.0056
Epoch 18/50
1712/1712 ━━━━━━━━━━━━━━━━━━━━ 46s 27ms/step - accuracy: 0.9990 - loss: 0.0079 - val_accuracy: 0.9993 - val_loss: 0.0055
Epoch 19/50
1712/1712 ━━━━━━━━━━━━━━━━━━━━ 46s 27ms/step - accuracy: 0.9990 - loss: 0.0079 - val_accuracy: 0.9993 - val_loss: 0.0055
Epoch 20/50
1712/1712 ━━━━━━━━━━━━━━━━━━━━ 46s 27ms/step - accuracy: 0.9990 - loss: 0.0079 - val_accuracy: 0.9993 - val_loss: 0.0055
Epoch 21/50
1712/1712 ━━━━━━━━━━━━━━━━━━━━ 47s 27ms/step - accuracy: 0.9990 - loss: 0.0079 - val_accuracy: 0.9993 - val_loss: 0.0055
Epoch 22/50
1712/1712 ━━━━━━━━━━━━━━━━━━━━ 46s 27ms/step - accuracy: 0.9990 - loss: 0.0079 - val_accuracy: 0.9993 - val_loss: 0.0055
Epoch 23/50
1712/1712 ━━━━━━━━━━━━━━━━━━━━ 46s 27ms/step - accuracy: 0.9990 - loss: 0.0079 - val_accuracy: 0.9993 - val_loss: 0.0055
Epoch 24/50
1712/1712 ━━━━━━━━━━━━━━━━━━━━ 47s 28ms/step - accuracy: 0.9990 - loss: 0.0079 - val_accuracy: 0.9993 - val_loss: 0.0055
Epoch 25/50
1712/1712 ━━━━━━━━━━━━━━━━━━━━ 46s 27ms/step - accuracy: 0.9990 - loss: 0.0079 - val_accuracy: 0.9993 - val_loss: 0.0055
Epoch 26/50
1712/1712 ━━━━━━━━━━━━━━━━━━━━ 46s 27ms/step - accuracy: 0.9990 - loss: 0.0079 - val_accuracy: 0.9993 - val_loss: 0.0055
Epoch 27/50
1712/1712 ━━━━━━━━━━━━━━━━━━━━ 46s 27ms/step - accuracy: 0.9990 - loss: 0.0079 - val_accuracy: 0.9993 - val_loss: 0.0055
Epoch 28/50
1712/1712 ━━━━━━━━━━━━━━━━━━━━ 46s 27ms/step - accuracy: 0.9990 - loss: 0.0079 - val_accuracy: 0.9993 - val_loss: 0.0055
Epoch 29/50
1712/1712 ━━━━━━━━━━━━━━━━━━━━ 46s 27ms/step - accuracy: 0.9990 - loss: 0.0079 - val_accuracy: 0.9993 - val_loss: 0.0055
Epoch 30/50
1712/1712 ━━━━━━━━━━━━━━━━━━━━ 46s 27ms/step - accuracy: 0.9990 - loss: 0.0079 - val_accuracy: 0.9993 - val_loss: 0.0055
Epoch 31/50
1712/1712 ━━━━━━━━━━━━━━━━━━━━ 46s 27ms/step - accuracy: 0.9990 - loss: 0.0079 - val_accuracy: 0.9993 - val_loss: 0.0055
Epoch 32/50
1712/1712 ━━━━━━━━━━━━━━━━━━━━ 46s 27ms/step - accuracy: 0.9990 - loss: 0.0079 - val_accuracy: 0.9993 - val_loss: 0.0055
Epoch 33/50
1712/1712 ━━━━━━━━━━━━━━━━━━━━ 46s 27ms/step - accuracy: 0.9990 - loss: 0.0079 - val_accuracy: 0.9993 - val_loss: 0.0055
Epoch 34/50
1712/1712 ━━━━━━━━━━━━━━━━━━━━ 46s 27ms/step - accuracy: 0.9990 - loss: 0.0079 - val_accuracy: 0.9993 - val_loss: 0.0055
Epoch 35/50
1712/1712 ━━━━━━━━━━━━━━━━━━━━ 46s 27ms/step - accuracy: 0.9990 - loss: 0.0079 - val_accuracy: 0.9993 - val_loss: 0.0055
2025-10-31 23:24:15.864 | INFO     | src.ai_engine.ai_models:fit:685 - LSTM trained successfully.
2025-10-31 23:24:16.649 | INFO     | src.ai_engine.ai_models:fit:381 - Generating base model predictions for meta-model training...
2025-10-31 23:24:45.157 | INFO     | src.ai_engine.feature_engineering:create_sequences:261 - Creating sequences with length 50 from 60888 data points.
2025-10-31 23:24:46.156 | INFO     | src.ai_engine.feature_engineering:create_sequences:270 - Created 60838 sequences.
1902/1902 ━━━━━━━━━━━━━━━━━━━━ 208s 35ms/step
2025-10-31 23:39:45.502 | INFO     | src.ai_engine.ai_models:fit:396 - Training meta-model...
2025-10-31 23:39:50.785 | SUCCESS  | src.ai_engine.ai_models:fit:399 - Stacking Ensemble trained successfully.
2025-10-31 23:39:51.451 | SUCCESS  | __main__:main:167 - Final Ensemble model trained.
2025-10-31 23:39:51.472 | INFO     | __main__:main:171 - Saving models to 'models\PainX_600\1m'...
2025-10-31 23:40:01.759 | INFO     | src.ai_engine.ai_models:save:52 - Model RandomForest saved to models\PainX_600\1m\random_forest.pkl
2025-10-31 23:40:04.540 | INFO     | src.ai_engine.ai_models:save:52 - Model GradientBoosting saved to models\PainX_600\1m\gradient_boosting.pkl
2025-10-31 23:40:13.536 | INFO     | src.ai_engine.ai_models:save:731 - LSTM model saved to models\PainX_600\1m\lstm.keras, models\PainX_600\1m\lstm_scaler.pkl and marker file models\PainX_600\1m\lstm.pkl
2025-10-31 23:40:13.751 | INFO     | src.ai_engine.ai_models:save_all:463 - Meta-model saved to models\PainX_600\1m\meta_model.pkl
2025-10-31 23:40:13.789 | SUCCESS  | __main__:main:174 - --- Finished training for Symbol: PainX 600, Timeframe: 1m ---
2025-10-31 23:40:13.796 | INFO     | __main__:main:140 - --- Starting training for Symbol: PainX 600, Timeframe: 4h ---
2025-10-31 23:40:16.707 | SUCCESS  | __main__:main:148 - Loaded 1809 records.
2025-10-31 23:40:16.709 | INFO     | __main__:prepare_training_data:32 - Preparing data for training with Meta-Labeling...
2025-10-31 23:40:18.493 | DEBUG    | src.ai_engine.technical_indicators:calculate_all:47 - Calculated 63 technical indicators
2025-10-31 23:40:20.059 | DEBUG    | src.ai_engine.feature_engineering:extract_features:66 - Extracted 116 features
2025-10-31 23:40:20.061 | INFO     | __main__:prepare_training_data:39 - Generating signals from primary model (SimplePatternModel)...
2025-10-31 23:40:20.233 | WARNING  | src.ai_engine.feature_engineering:prepare_for_model:230 - Se perdieron todos los datos al eliminar los NaN. Se conservarán los datos rellenados.
2025-10-31 23:40:22.104 | INFO     | src.ai_engine.ai_models:calculate_optimal_threshold:549 - Calculated optimal threshold: 0.0045 (volatility: 0.0015, avg_movement: 0.0063)
2025-10-31 23:40:22.106 | INFO     | src.ai_engine.ai_models:create_meta_labels:577 - Creating meta-labels for secondary model...
2025-10-31 23:40:22.385 | INFO     | src.ai_engine.ai_models:create_meta_labels:629 - Meta-Label distribution - Profitable: 261 (33.0%), Unprofitable: 530 (67.0%)
2025-10-31 23:40:22.630 | WARNING  | src.ai_engine.feature_engineering:prepare_for_model:230 - Se perdieron todos los datos al eliminar los NaN. Se conservarán los datos rellenados.
2025-10-31 23:40:22.736 | INFO     | __main__:prepare_training_data:75 - Data preparation complete. Shape of X: (1225, 116), Shape of y: (1225,)
2025-10-31 23:40:23.152 | INFO     | src.ai_engine.feature_engineering:create_sequences:261 - Creating sequences with length 50 from 1225 data points.
2025-10-31 23:40:23.294 | INFO     | src.ai_engine.feature_engineering:create_sequences:270 - Created 1175 sequences.
2025-10-31 23:40:23.922 | INFO     | __main__:main:164 - Initializing and training Ensemble model...
2025-10-31 23:40:23.923 | INFO     | src.ai_engine.ai_models:__init__:304 - Initialized Stacking Ensemble with Logistic Regression as meta-model.
2025-10-31 23:40:24.835 | INFO     | src.ai_engine.ai_models:fit:359 - Creating LSTM model...
2025-10-31 23:40:24.836 | INFO     | src.ai_engine.ai_models:fit:364 - Training base models...
2025-10-31 23:40:24.904 | INFO     | src.ai_engine.ai_models:fit:373 - Training random_forest...
2025-10-31 23:40:29.548 | INFO     | src.ai_engine.ai_models:fit:98 - RandomForest trained successfully on 1225 samples with 2 classes
2025-10-31 23:40:29.550 | INFO     | src.ai_engine.ai_models:fit:373 - Training gradient_boosting...
2025-10-31 23:40:44.612 | INFO     | src.ai_engine.ai_models:fit:157 - GradientBoosting trained successfully on 1225 samples with 2 classes
2025-10-31 23:40:44.612 | INFO     | src.ai_engine.ai_models:fit:373 - Training pattern_based...
2025-10-31 23:40:44.614 | INFO     | src.ai_engine.ai_models:fit:373 - Training lstm...
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\keras\src\layers\rnn\rnn.py:199: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(**kwargs)
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1108: RuntimeWarning: invalid value encountered in divide
  updated_mean = (last_sum + new_sum) / updated_sample_count
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1113: RuntimeWarning: invalid value encountered in divide
  T = new_sum / new_sample_count
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1133: RuntimeWarning: invalid value encountered in divide
  new_unnormalized_variance -= correction**2 / new_sample_count
Epoch 1/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 105s 258ms/step - accuracy: 0.7777 - loss: 0.6888 - val_accuracy: 0.8305 - val_loss: 0.6823
Epoch 2/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 2s 51ms/step - accuracy: 0.7777 - loss: 0.6798 - val_accuracy: 0.8305 - val_loss: 0.6720
Epoch 3/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 4s 76ms/step - accuracy: 0.7777 - loss: 0.6714 - val_accuracy: 0.8305 - val_loss: 0.6621
Epoch 4/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 2s 57ms/step - accuracy: 0.7777 - loss: 0.6636 - val_accuracy: 0.8305 - val_loss: 0.6524
Epoch 5/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 2s 47ms/step - accuracy: 0.7777 - loss: 0.6559 - val_accuracy: 0.8305 - val_loss: 0.6437
Epoch 6/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 37ms/step - accuracy: 0.7777 - loss: 0.6487 - val_accuracy: 0.8305 - val_loss: 0.6352
Epoch 7/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 2s 56ms/step - accuracy: 0.7777 - loss: 0.6419 - val_accuracy: 0.8305 - val_loss: 0.6268
Epoch 8/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 34ms/step - accuracy: 0.7777 - loss: 0.6353 - val_accuracy: 0.8305 - val_loss: 0.6189
Epoch 9/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 34ms/step - accuracy: 0.7777 - loss: 0.6296 - val_accuracy: 0.8305 - val_loss: 0.6123
Epoch 10/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 36ms/step - accuracy: 0.7777 - loss: 0.6239 - val_accuracy: 0.8305 - val_loss: 0.6049
Epoch 11/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 2s 48ms/step - accuracy: 0.7777 - loss: 0.6182 - val_accuracy: 0.8305 - val_loss: 0.5982
Epoch 12/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 31ms/step - accuracy: 0.7777 - loss: 0.6134 - val_accuracy: 0.8305 - val_loss: 0.5923
Epoch 13/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 28ms/step - accuracy: 0.7777 - loss: 0.6085 - val_accuracy: 0.8305 - val_loss: 0.5859
Epoch 14/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 30ms/step - accuracy: 0.7777 - loss: 0.6037 - val_accuracy: 0.8305 - val_loss: 0.5799
Epoch 15/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 30ms/step - accuracy: 0.7777 - loss: 0.5996 - val_accuracy: 0.8305 - val_loss: 0.5749
Epoch 16/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 33ms/step - accuracy: 0.7777 - loss: 0.5959 - val_accuracy: 0.8305 - val_loss: 0.5701
Epoch 17/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 39ms/step - accuracy: 0.7777 - loss: 0.5918 - val_accuracy: 0.8305 - val_loss: 0.5648
Epoch 18/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 30ms/step - accuracy: 0.7777 - loss: 0.5878 - val_accuracy: 0.8305 - val_loss: 0.5598
Epoch 19/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 31ms/step - accuracy: 0.7777 - loss: 0.5842 - val_accuracy: 0.8305 - val_loss: 0.5548
Epoch 20/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 29ms/step - accuracy: 0.7777 - loss: 0.5806 - val_accuracy: 0.8305 - val_loss: 0.5501
Epoch 21/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 29ms/step - accuracy: 0.7777 - loss: 0.5773 - val_accuracy: 0.8305 - val_loss: 0.5456
Epoch 22/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 29ms/step - accuracy: 0.7777 - loss: 0.5741 - val_accuracy: 0.8305 - val_loss: 0.5415
Epoch 23/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 31ms/step - accuracy: 0.7777 - loss: 0.5712 - val_accuracy: 0.8305 - val_loss: 0.5373
Epoch 24/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 30ms/step - accuracy: 0.7777 - loss: 0.5683 - val_accuracy: 0.8305 - val_loss: 0.5337
Epoch 25/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 29ms/step - accuracy: 0.7777 - loss: 0.5661 - val_accuracy: 0.8305 - val_loss: 0.5308
Epoch 26/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 29ms/step - accuracy: 0.7777 - loss: 0.5637 - val_accuracy: 0.8305 - val_loss: 0.5274
Epoch 27/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 29ms/step - accuracy: 0.7777 - loss: 0.5618 - val_accuracy: 0.8305 - val_loss: 0.5246
Epoch 28/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 29ms/step - accuracy: 0.7777 - loss: 0.5600 - val_accuracy: 0.8305 - val_loss: 0.5222
Epoch 29/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 30ms/step - accuracy: 0.7777 - loss: 0.5581 - val_accuracy: 0.8305 - val_loss: 0.5192
Epoch 30/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 29ms/step - accuracy: 0.7777 - loss: 0.5564 - val_accuracy: 0.8305 - val_loss: 0.5170
Epoch 31/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 29ms/step - accuracy: 0.7777 - loss: 0.5550 - val_accuracy: 0.8305 - val_loss: 0.5149
Epoch 32/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 29ms/step - accuracy: 0.7777 - loss: 0.5533 - val_accuracy: 0.8305 - val_loss: 0.5122
Epoch 33/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 29ms/step - accuracy: 0.7777 - loss: 0.5517 - val_accuracy: 0.8305 - val_loss: 0.5095
Epoch 34/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 29ms/step - accuracy: 0.7777 - loss: 0.5500 - val_accuracy: 0.8305 - val_loss: 0.5072
Epoch 35/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 29ms/step - accuracy: 0.7777 - loss: 0.5485 - val_accuracy: 0.8305 - val_loss: 0.5049
Epoch 36/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 29ms/step - accuracy: 0.7777 - loss: 0.5471 - val_accuracy: 0.8305 - val_loss: 0.5026
Epoch 37/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 28ms/step - accuracy: 0.7777 - loss: 0.5458 - val_accuracy: 0.8305 - val_loss: 0.5004
Epoch 38/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 30ms/step - accuracy: 0.7777 - loss: 0.5446 - val_accuracy: 0.8305 - val_loss: 0.4983
Epoch 39/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 30ms/step - accuracy: 0.7777 - loss: 0.5434 - val_accuracy: 0.8305 - val_loss: 0.4965
Epoch 40/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 29ms/step - accuracy: 0.7777 - loss: 0.5423 - val_accuracy: 0.8305 - val_loss: 0.4948
Epoch 41/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 32ms/step - accuracy: 0.7777 - loss: 0.5414 - val_accuracy: 0.8305 - val_loss: 0.4929
Epoch 42/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 29ms/step - accuracy: 0.7777 - loss: 0.5404 - val_accuracy: 0.8305 - val_loss: 0.4914
Epoch 43/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 29ms/step - accuracy: 0.7777 - loss: 0.5395 - val_accuracy: 0.8305 - val_loss: 0.4899
Epoch 44/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 33ms/step - accuracy: 0.7777 - loss: 0.5387 - val_accuracy: 0.8305 - val_loss: 0.4883
Epoch 45/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 29ms/step - accuracy: 0.7777 - loss: 0.5380 - val_accuracy: 0.8305 - val_loss: 0.4868
Epoch 46/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 29ms/step - accuracy: 0.7777 - loss: 0.5375 - val_accuracy: 0.8305 - val_loss: 0.4861
Epoch 47/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 29ms/step - accuracy: 0.7777 - loss: 0.5371 - val_accuracy: 0.8305 - val_loss: 0.4855
Epoch 48/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 28ms/step - accuracy: 0.7777 - loss: 0.5366 - val_accuracy: 0.8305 - val_loss: 0.4843
Epoch 49/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 29ms/step - accuracy: 0.7777 - loss: 0.5360 - val_accuracy: 0.8305 - val_loss: 0.4830
Epoch 50/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 29ms/step - accuracy: 0.7777 - loss: 0.5355 - val_accuracy: 0.8305 - val_loss: 0.4819
2025-10-31 23:43:36.612 | INFO     | src.ai_engine.ai_models:fit:685 - LSTM trained successfully.
2025-10-31 23:43:36.627 | INFO     | src.ai_engine.ai_models:fit:381 - Generating base model predictions for meta-model training...
2025-10-31 23:43:36.782 | INFO     | src.ai_engine.feature_engineering:create_sequences:261 - Creating sequences with length 50 from 1225 data points.
2025-10-31 23:43:36.834 | INFO     | src.ai_engine.feature_engineering:create_sequences:270 - Created 1175 sequences.
37/37 ━━━━━━━━━━━━━━━━━━━━ 7s 121ms/step
2025-10-31 23:43:44.788 | INFO     | src.ai_engine.ai_models:fit:396 - Training meta-model...
2025-10-31 23:43:44.795 | SUCCESS  | src.ai_engine.ai_models:fit:399 - Stacking Ensemble trained successfully.
2025-10-31 23:43:44.825 | SUCCESS  | __main__:main:167 - Final Ensemble model trained.
2025-10-31 23:43:44.832 | INFO     | __main__:main:171 - Saving models to 'models\PainX_600\4h'...
2025-10-31 23:43:45.376 | INFO     | src.ai_engine.ai_models:save:52 - Model RandomForest saved to models\PainX_600\4h\random_forest.pkl
2025-10-31 23:43:45.676 | INFO     | src.ai_engine.ai_models:save:52 - Model GradientBoosting saved to models\PainX_600\4h\gradient_boosting.pkl
2025-10-31 23:43:46.188 | INFO     | src.ai_engine.ai_models:save:731 - LSTM model saved to models\PainX_600\4h\lstm.keras, models\PainX_600\4h\lstm_scaler.pkl and marker file models\PainX_600\4h\lstm.pkl
2025-10-31 23:43:46.230 | INFO     | src.ai_engine.ai_models:save_all:463 - Meta-model saved to models\PainX_600\4h\meta_model.pkl
2025-10-31 23:43:46.232 | SUCCESS  | __main__:main:174 - --- Finished training for Symbol: PainX 600, Timeframe: 4h ---
2025-10-31 23:43:46.247 | INFO     | __main__:main:140 - --- Starting training for Symbol: PainX 600, Timeframe: 5m ---
2025-10-31 23:43:46.998 | SUCCESS  | __main__:main:148 - Loaded 86685 records.
2025-10-31 23:43:46.998 | INFO     | __main__:prepare_training_data:32 - Preparing data for training with Meta-Labeling...
2025-10-31 23:43:53.675 | DEBUG    | src.ai_engine.technical_indicators:calculate_all:47 - Calculated 63 technical indicators
2025-10-31 23:44:08.742 | DEBUG    | src.ai_engine.feature_engineering:extract_features:66 - Extracted 116 features
2025-10-31 23:44:08.744 | INFO     | __main__:prepare_training_data:39 - Generating signals from primary model (SimplePatternModel)...
2025-10-31 23:44:09.016 | WARNING  | src.ai_engine.feature_engineering:prepare_for_model:230 - Se perdieron todos los datos al eliminar los NaN. Se conservarán los datos rellenados.
2025-10-31 23:44:23.272 | INFO     | src.ai_engine.ai_models:calculate_optimal_threshold:549 - Calculated optimal threshold: 0.0010 (volatility: 0.0002, avg_movement: 0.0009)
2025-10-31 23:44:23.273 | INFO     | src.ai_engine.ai_models:create_meta_labels:577 - Creating meta-labels for secondary model...
2025-10-31 23:44:36.182 | INFO     | src.ai_engine.ai_models:create_meta_labels:629 - Meta-Label distribution - Profitable: 3869 (24.7%), Unprofitable: 11801 (75.3%)
2025-10-31 23:44:36.465 | WARNING  | src.ai_engine.feature_engineering:prepare_for_model:230 - Se perdieron todos los datos al eliminar los NaN. Se conservarán los datos rellenados.
2025-10-31 23:44:36.562 | INFO     | __main__:prepare_training_data:75 - Data preparation complete. Shape of X: (61803, 116), Shape of y: (61803,)
2025-10-31 23:44:36.597 | INFO     | src.ai_engine.feature_engineering:create_sequences:261 - Creating sequences with length 50 from 61803 data points.
2025-10-31 23:44:37.472 | INFO     | src.ai_engine.feature_engineering:create_sequences:270 - Created 61753 sequences.
2025-10-31 23:44:37.482 | INFO     | __main__:main:164 - Initializing and training Ensemble model...
2025-10-31 23:44:37.483 | INFO     | src.ai_engine.ai_models:__init__:304 - Initialized Stacking Ensemble with Logistic Regression as meta-model.
2025-10-31 23:44:37.503 | INFO     | src.ai_engine.ai_models:fit:359 - Creating LSTM model...
2025-10-31 23:44:37.503 | INFO     | src.ai_engine.ai_models:fit:364 - Training base models...
2025-10-31 23:44:37.622 | INFO     | src.ai_engine.ai_models:fit:373 - Training random_forest...
2025-10-31 23:45:00.671 | INFO     | src.ai_engine.ai_models:fit:98 - RandomForest trained successfully on 61803 samples with 2 classes
2025-10-31 23:45:00.674 | INFO     | src.ai_engine.ai_models:fit:373 - Training gradient_boosting...
2025-10-31 23:57:04.238 | INFO     | src.ai_engine.ai_models:fit:157 - GradientBoosting trained successfully on 61803 samples with 2 classes
2025-10-31 23:57:04.241 | INFO     | src.ai_engine.ai_models:fit:373 - Training pattern_based...
2025-10-31 23:57:04.241 | INFO     | src.ai_engine.ai_models:fit:373 - Training lstm...
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\keras\src\layers\rnn\rnn.py:199: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(**kwargs)
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1108: RuntimeWarning: invalid value encountered in divide
  updated_mean = (last_sum + new_sum) / updated_sample_count
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1113: RuntimeWarning: invalid value encountered in divide
  T = new_sum / new_sample_count
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1133: RuntimeWarning: invalid value encountered in divide
  new_unnormalized_variance -= correction**2 / new_sample_count
Epoch 1/50
1737/1737 ━━━━━━━━━━━━━━━━━━━━ 390s 42ms/step - accuracy: 0.9371 - loss: 0.4544 - val_accuracy: 0.9403 - val_loss: 0.3108
Epoch 2/50
1737/1737 ━━━━━━━━━━━━━━━━━━━━ 56s 32ms/step - accuracy: 0.9371 - loss: 0.2706 - val_accuracy: 0.9403 - val_loss: 0.2387
Epoch 3/50
1737/1737 ━━━━━━━━━━━━━━━━━━━━ 55s 31ms/step - accuracy: 0.9371 - loss: 0.2387 - val_accuracy: 0.9403 - val_loss: 0.2275
Epoch 4/50
1737/1737 ━━━━━━━━━━━━━━━━━━━━ 54s 31ms/step - accuracy: 0.9371 - loss: 0.2350 - val_accuracy: 0.9403 - val_loss: 0.2264
Epoch 5/50
1737/1737 ━━━━━━━━━━━━━━━━━━━━ 54s 31ms/step - accuracy: 0.9371 - loss: 0.2348 - val_accuracy: 0.9403 - val_loss: 0.2264
Epoch 6/50
1737/1737 ━━━━━━━━━━━━━━━━━━━━ 54s 31ms/step - accuracy: 0.9371 - loss: 0.2348 - val_accuracy: 0.9403 - val_loss: 0.2263
Epoch 7/50
1737/1737 ━━━━━━━━━━━━━━━━━━━━ 53s 31ms/step - accuracy: 0.9371 - loss: 0.2348 - val_accuracy: 0.9403 - val_loss: 0.2263
Epoch 8/50
1737/1737 ━━━━━━━━━━━━━━━━━━━━ 53s 31ms/step - accuracy: 0.9371 - loss: 0.2348 - val_accuracy: 0.9403 - val_loss: 0.2264
Epoch 9/50
1737/1737 ━━━━━━━━━━━━━━━━━━━━ 50s 29ms/step - accuracy: 0.9371 - loss: 0.2348 - val_accuracy: 0.9403 - val_loss: 0.2263
Epoch 10/50
1737/1737 ━━━━━━━━━━━━━━━━━━━━ 53s 31ms/step - accuracy: 0.9371 - loss: 0.2348 - val_accuracy: 0.9403 - val_loss: 0.2263
Epoch 11/50
1737/1737 ━━━━━━━━━━━━━━━━━━━━ 55s 31ms/step - accuracy: 0.9371 - loss: 0.2348 - val_accuracy: 0.9403 - val_loss: 0.2263
Epoch 12/50
1737/1737 ━━━━━━━━━━━━━━━━━━━━ 51s 29ms/step - accuracy: 0.9371 - loss: 0.2348 - val_accuracy: 0.9403 - val_loss: 0.2264
Epoch 13/50
1737/1737 ━━━━━━━━━━━━━━━━━━━━ 85s 31ms/step - accuracy: 0.9371 - loss: 0.2348 - val_accuracy: 0.9403 - val_loss: 0.2264
Epoch 14/50
1737/1737 ━━━━━━━━━━━━━━━━━━━━ 55s 32ms/step - accuracy: 0.9371 - loss: 0.2348 - val_accuracy: 0.9403 - val_loss: 0.2264
Epoch 15/50
1737/1737 ━━━━━━━━━━━━━━━━━━━━ 50s 29ms/step - accuracy: 0.9371 - loss: 0.2348 - val_accuracy: 0.9403 - val_loss: 0.2263
Epoch 16/50
1737/1737 ━━━━━━━━━━━━━━━━━━━━ 51s 29ms/step - accuracy: 0.9371 - loss: 0.2348 - val_accuracy: 0.9403 - val_loss: 0.2263
Epoch 17/50
1737/1737 ━━━━━━━━━━━━━━━━━━━━ 54s 31ms/step - accuracy: 0.9371 - loss: 0.2348 - val_accuracy: 0.9403 - val_loss: 0.2264
Epoch 18/50
1737/1737 ━━━━━━━━━━━━━━━━━━━━ 54s 31ms/step - accuracy: 0.9371 - loss: 0.2348 - val_accuracy: 0.9403 - val_loss: 0.2263
Epoch 19/50
1737/1737 ━━━━━━━━━━━━━━━━━━━━ 50s 29ms/step - accuracy: 0.9371 - loss: 0.2348 - val_accuracy: 0.9403 - val_loss: 0.2264
2025-11-01 00:48:21.303 | INFO     | src.ai_engine.ai_models:fit:685 - LSTM trained successfully.
2025-11-01 00:48:22.375 | INFO     | src.ai_engine.ai_models:fit:381 - Generating base model predictions for meta-model training...
2025-11-01 00:48:51.428 | INFO     | src.ai_engine.feature_engineering:create_sequences:261 - Creating sequences with length 50 from 61803 data points.
2025-11-01 00:48:52.302 | INFO     | src.ai_engine.feature_engineering:create_sequences:270 - Created 61753 sequences.
1930/1930 ━━━━━━━━━━━━━━━━━━━━ 210s 39ms/step
2025-11-01 01:04:54.894 | INFO     | src.ai_engine.ai_models:fit:396 - Training meta-model...
2025-11-01 01:05:00.276 | SUCCESS  | src.ai_engine.ai_models:fit:399 - Stacking Ensemble trained successfully.
2025-11-01 01:05:00.903 | SUCCESS  | __main__:main:167 - Final Ensemble model trained.
2025-11-01 01:05:01.026 | INFO     | __main__:main:171 - Saving models to 'models\PainX_600\5m'...
2025-11-01 01:05:12.915 | INFO     | src.ai_engine.ai_models:save:52 - Model RandomForest saved to models\PainX_600\5m\random_forest.pkl
2025-11-01 01:05:15.477 | INFO     | src.ai_engine.ai_models:save:52 - Model GradientBoosting saved to models\PainX_600\5m\gradient_boosting.pkl
2025-11-01 01:05:23.001 | INFO     | src.ai_engine.ai_models:save:731 - LSTM model saved to models\PainX_600\5m\lstm.keras, models\PainX_600\5m\lstm_scaler.pkl and marker file models\PainX_600\5m\lstm.pkl
2025-11-01 01:05:23.031 | INFO     | src.ai_engine.ai_models:save_all:463 - Meta-model saved to models\PainX_600\5m\meta_model.pkl
2025-11-01 01:05:23.055 | SUCCESS  | __main__:main:174 - --- Finished training for Symbol: PainX 600, Timeframe: 5m ---
2025-11-01 01:05:23.091 | INFO     | __main__:main:140 - --- Starting training for Symbol: PainX 800, Timeframe: 15m ---
2025-11-01 01:05:25.981 | SUCCESS  | __main__:main:148 - Loaded 28898 records.
2025-11-01 01:05:25.983 | INFO     | __main__:prepare_training_data:32 - Preparing data for training with Meta-Labeling...
2025-11-01 01:05:31.094 | DEBUG    | src.ai_engine.technical_indicators:calculate_all:47 - Calculated 63 technical indicators
2025-11-01 01:05:38.361 | DEBUG    | src.ai_engine.feature_engineering:extract_features:66 - Extracted 116 features
2025-11-01 01:05:38.401 | INFO     | __main__:prepare_training_data:39 - Generating signals from primary model (SimplePatternModel)...
2025-11-01 01:05:38.566 | WARNING  | src.ai_engine.feature_engineering:prepare_for_model:230 - Se perdieron todos los datos al eliminar los NaN. Se conservarán los datos rellenados.
2025-11-01 01:05:44.714 | INFO     | src.ai_engine.ai_models:calculate_optimal_threshold:549 - Calculated optimal threshold: 0.0010 (volatility: 0.0003, avg_movement: 0.0011)
2025-11-01 01:05:44.715 | INFO     | src.ai_engine.ai_models:create_meta_labels:577 - Creating meta-labels for secondary model...
2025-11-01 01:05:48.776 | INFO     | src.ai_engine.ai_models:create_meta_labels:629 - Meta-Label distribution - Profitable: 2224 (28.0%), Unprofitable: 5709 (72.0%)
2025-11-01 01:05:48.925 | WARNING  | src.ai_engine.feature_engineering:prepare_for_model:230 - Se perdieron todos los datos al eliminar los NaN. Se conservarán los datos rellenados.
2025-11-01 01:05:48.989 | INFO     | __main__:prepare_training_data:75 - Data preparation complete. Shape of X: (20430, 116), Shape of y: (20430,)
2025-11-01 01:05:49.460 | INFO     | src.ai_engine.feature_engineering:create_sequences:261 - Creating sequences with length 50 from 20430 data points.
2025-11-01 01:05:50.083 | INFO     | src.ai_engine.feature_engineering:create_sequences:270 - Created 20380 sequences.
2025-11-01 01:05:51.955 | INFO     | __main__:main:164 - Initializing and training Ensemble model...
2025-11-01 01:05:51.956 | INFO     | src.ai_engine.ai_models:__init__:304 - Initialized Stacking Ensemble with Logistic Regression as meta-model.
2025-11-01 01:05:55.665 | INFO     | src.ai_engine.ai_models:fit:359 - Creating LSTM model...
2025-11-01 01:05:55.667 | INFO     | src.ai_engine.ai_models:fit:364 - Training base models...
2025-11-01 01:05:55.745 | INFO     | src.ai_engine.ai_models:fit:373 - Training random_forest...
2025-11-01 01:06:09.438 | INFO     | src.ai_engine.ai_models:fit:98 - RandomForest trained successfully on 20430 samples with 2 classes
2025-11-01 01:06:09.442 | INFO     | src.ai_engine.ai_models:fit:373 - Training gradient_boosting...
2025-11-01 01:10:14.328 | INFO     | src.ai_engine.ai_models:fit:157 - GradientBoosting trained successfully on 20430 samples with 2 classes
2025-11-01 01:10:14.330 | INFO     | src.ai_engine.ai_models:fit:373 - Training pattern_based...
2025-11-01 01:10:14.364 | INFO     | src.ai_engine.ai_models:fit:373 - Training lstm...
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\keras\src\layers\rnn\rnn.py:199: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(**kwargs)
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1108: RuntimeWarning: invalid value encountered in divide
  updated_mean = (last_sum + new_sum) / updated_sample_count
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1113: RuntimeWarning: invalid value encountered in divide
  T = new_sum / new_sample_count
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1133: RuntimeWarning: invalid value encountered in divide
  new_unnormalized_variance -= correction**2 / new_sample_count
Epoch 1/50
574/574 ━━━━━━━━━━━━━━━━━━━━ 127s 50ms/step - accuracy: 0.8891 - loss: 0.6007 - val_accuracy: 0.9073 - val_loss: 0.5147
Epoch 2/50
574/574 ━━━━━━━━━━━━━━━━━━━━ 18s 31ms/step - accuracy: 0.8891 - loss: 0.4745 - val_accuracy: 0.9073 - val_loss: 0.4170
Epoch 3/50
574/574 ━━━━━━━━━━━━━━━━━━━━ 18s 31ms/step - accuracy: 0.8891 - loss: 0.4083 - val_accuracy: 0.9073 - val_loss: 0.3645
Epoch 4/50
574/574 ━━━━━━━━━━━━━━━━━━━━ 18s 31ms/step - accuracy: 0.8891 - loss: 0.3750 - val_accuracy: 0.9073 - val_loss: 0.3368
Epoch 5/50
574/574 ━━━━━━━━━━━━━━━━━━━━ 19s 33ms/step - accuracy: 0.8891 - loss: 0.3591 - val_accuracy: 0.9073 - val_loss: 0.3229
Epoch 6/50
574/574 ━━━━━━━━━━━━━━━━━━━━ 40s 70ms/step - accuracy: 0.8891 - loss: 0.3523 - val_accuracy: 0.9073 - val_loss: 0.3162
Epoch 7/50
574/574 ━━━━━━━━━━━━━━━━━━━━ 19s 33ms/step - accuracy: 0.8891 - loss: 0.3496 - val_accuracy: 0.9073 - val_loss: 0.3131
Epoch 8/50
574/574 ━━━━━━━━━━━━━━━━━━━━ 18s 31ms/step - accuracy: 0.8891 - loss: 0.3488 - val_accuracy: 0.9073 - val_loss: 0.3117
Epoch 9/50
574/574 ━━━━━━━━━━━━━━━━━━━━ 18s 31ms/step - accuracy: 0.8891 - loss: 0.3486 - val_accuracy: 0.9073 - val_loss: 0.3110
Epoch 10/50
574/574 ━━━━━━━━━━━━━━━━━━━━ 18s 31ms/step - accuracy: 0.8891 - loss: 0.3485 - val_accuracy: 0.9073 - val_loss: 0.3109
Epoch 11/50
574/574 ━━━━━━━━━━━━━━━━━━━━ 17s 30ms/step - accuracy: 0.8891 - loss: 0.3485 - val_accuracy: 0.9073 - val_loss: 0.3109
Epoch 12/50
574/574 ━━━━━━━━━━━━━━━━━━━━ 19s 32ms/step - accuracy: 0.8891 - loss: 0.3485 - val_accuracy: 0.9073 - val_loss: 0.3107
Epoch 13/50
574/574 ━━━━━━━━━━━━━━━━━━━━ 18s 31ms/step - accuracy: 0.8891 - loss: 0.3485 - val_accuracy: 0.9073 - val_loss: 0.3105
Epoch 14/50
574/574 ━━━━━━━━━━━━━━━━━━━━ 18s 31ms/step - accuracy: 0.8891 - loss: 0.3485 - val_accuracy: 0.9073 - val_loss: 0.3107
Epoch 15/50
574/574 ━━━━━━━━━━━━━━━━━━━━ 17s 29ms/step - accuracy: 0.8891 - loss: 0.3485 - val_accuracy: 0.9073 - val_loss: 0.3106
Epoch 16/50
574/574 ━━━━━━━━━━━━━━━━━━━━ 18s 32ms/step - accuracy: 0.8891 - loss: 0.3485 - val_accuracy: 0.9073 - val_loss: 0.3107
Epoch 17/50
574/574 ━━━━━━━━━━━━━━━━━━━━ 17s 30ms/step - accuracy: 0.8891 - loss: 0.3485 - val_accuracy: 0.9073 - val_loss: 0.3106
Epoch 18/50
574/574 ━━━━━━━━━━━━━━━━━━━━ 19s 33ms/step - accuracy: 0.8891 - loss: 0.3485 - val_accuracy: 0.9073 - val_loss: 0.3105
Epoch 19/50
574/574 ━━━━━━━━━━━━━━━━━━━━ 18s 31ms/step - accuracy: 0.8891 - loss: 0.3485 - val_accuracy: 0.9073 - val_loss: 0.3107
Epoch 20/50
574/574 ━━━━━━━━━━━━━━━━━━━━ 17s 30ms/step - accuracy: 0.8891 - loss: 0.3485 - val_accuracy: 0.9073 - val_loss: 0.3107
Epoch 21/50
574/574 ━━━━━━━━━━━━━━━━━━━━ 18s 31ms/step - accuracy: 0.8891 - loss: 0.3485 - val_accuracy: 0.9073 - val_loss: 0.3106
Epoch 22/50
574/574 ━━━━━━━━━━━━━━━━━━━━ 17s 30ms/step - accuracy: 0.8891 - loss: 0.3485 - val_accuracy: 0.9073 - val_loss: 0.3106
Epoch 23/50
574/574 ━━━━━━━━━━━━━━━━━━━━ 19s 33ms/step - accuracy: 0.8891 - loss: 0.3485 - val_accuracy: 0.9073 - val_loss: 0.3106
Epoch 24/50
574/574 ━━━━━━━━━━━━━━━━━━━━ 18s 32ms/step - accuracy: 0.8891 - loss: 0.3485 - val_accuracy: 0.9073 - val_loss: 0.3105
Epoch 25/50
574/574 ━━━━━━━━━━━━━━━━━━━━ 18s 31ms/step - accuracy: 0.8891 - loss: 0.3485 - val_accuracy: 0.9073 - val_loss: 0.3107
Epoch 26/50
574/574 ━━━━━━━━━━━━━━━━━━━━ 17s 30ms/step - accuracy: 0.8891 - loss: 0.3485 - val_accuracy: 0.9073 - val_loss: 0.3107
Epoch 27/50
574/574 ━━━━━━━━━━━━━━━━━━━━ 18s 31ms/step - accuracy: 0.8891 - loss: 0.3485 - val_accuracy: 0.9073 - val_loss: 0.3107
Epoch 28/50
574/574 ━━━━━━━━━━━━━━━━━━━━ 18s 31ms/step - accuracy: 0.8891 - loss: 0.3485 - val_accuracy: 0.9073 - val_loss: 0.3106
2025-11-01 01:20:58.039 | INFO     | src.ai_engine.ai_models:fit:685 - LSTM trained successfully.
2025-11-01 01:20:58.118 | INFO     | src.ai_engine.ai_models:fit:381 - Generating base model predictions for meta-model training...
2025-11-01 01:20:59.462 | INFO     | src.ai_engine.feature_engineering:create_sequences:261 - Creating sequences with length 50 from 20430 data points.
2025-11-01 01:20:59.698 | INFO     | src.ai_engine.feature_engineering:create_sequences:270 - Created 20380 sequences.
637/637 ━━━━━━━━━━━━━━━━━━━━ 14s 16ms/step
2025-11-01 01:21:16.609 | INFO     | src.ai_engine.ai_models:fit:396 - Training meta-model...
2025-11-01 01:21:16.624 | SUCCESS  | src.ai_engine.ai_models:fit:399 - Stacking Ensemble trained successfully.
2025-11-01 01:21:16.625 | SUCCESS  | __main__:main:167 - Final Ensemble model trained.
2025-11-01 01:21:16.626 | INFO     | __main__:main:171 - Saving models to 'models\PainX_800\15m'...
2025-11-01 01:21:17.127 | INFO     | src.ai_engine.ai_models:save:52 - Model RandomForest saved to models\PainX_800\15m\random_forest.pkl
2025-11-01 01:21:17.260 | INFO     | src.ai_engine.ai_models:save:52 - Model GradientBoosting saved to models\PainX_800\15m\gradient_boosting.pkl
2025-11-01 01:21:17.440 | INFO     | src.ai_engine.ai_models:save:731 - LSTM model saved to models\PainX_800\15m\lstm.keras, models\PainX_800\15m\lstm_scaler.pkl and marker file models\PainX_800\15m\lstm.pkl
2025-11-01 01:21:17.444 | INFO     | src.ai_engine.ai_models:save_all:463 - Meta-model saved to models\PainX_800\15m\meta_model.pkl
2025-11-01 01:21:17.445 | SUCCESS  | __main__:main:174 - --- Finished training for Symbol: PainX 800, Timeframe: 15m ---
2025-11-01 01:21:17.446 | INFO     | __main__:main:140 - --- Starting training for Symbol: PainX 800, Timeframe: 1d ---
2025-11-01 01:21:17.502 | SUCCESS  | __main__:main:148 - Loaded 302 records.
2025-11-01 01:21:17.504 | INFO     | __main__:prepare_training_data:32 - Preparing data for training with Meta-Labeling...
2025-11-01 01:21:17.605 | DEBUG    | src.ai_engine.technical_indicators:calculate_all:47 - Calculated 62 technical indicators
2025-11-01 01:21:17.662 | DEBUG    | src.ai_engine.feature_engineering:extract_features:66 - Extracted 116 features
2025-11-01 01:21:17.681 | INFO     | __main__:prepare_training_data:39 - Generating signals from primary model (SimplePatternModel)...
2025-11-01 01:21:17.685 | WARNING  | src.ai_engine.feature_engineering:prepare_for_model:230 - Se perdieron todos los datos al eliminar los NaN. Se conservarán los datos rellenados.
2025-11-01 01:21:17.823 | INFO     | src.ai_engine.ai_models:calculate_optimal_threshold:549 - Calculated optimal threshold: 0.0079 (volatility: 0.0025, avg_movement: 0.0113)
2025-11-01 01:21:17.824 | INFO     | src.ai_engine.ai_models:create_meta_labels:577 - Creating meta-labels for secondary model...
2025-11-01 01:21:17.863 | INFO     | src.ai_engine.ai_models:create_meta_labels:629 - Meta-Label distribution - Profitable: 48 (45.3%), Unprofitable: 58 (54.7%)
2025-11-01 01:21:17.869 | WARNING  | src.ai_engine.feature_engineering:prepare_for_model:230 - Se perdieron todos los datos al eliminar los NaN. Se conservarán los datos rellenados.
2025-11-01 01:21:17.872 | INFO     | __main__:prepare_training_data:75 - Data preparation complete. Shape of X: (188, 116), Shape of y: (188,)
2025-11-01 01:21:17.877 | INFO     | src.ai_engine.feature_engineering:create_sequences:261 - Creating sequences with length 50 from 188 data points.
2025-11-01 01:21:17.880 | INFO     | src.ai_engine.feature_engineering:create_sequences:270 - Created 138 sequences.
2025-11-01 01:21:17.942 | INFO     | __main__:main:164 - Initializing and training Ensemble model...
2025-11-01 01:21:17.943 | INFO     | src.ai_engine.ai_models:__init__:304 - Initialized Stacking Ensemble with Logistic Regression as meta-model.
2025-11-01 01:21:18.116 | INFO     | src.ai_engine.ai_models:fit:359 - Creating LSTM model...
2025-11-01 01:21:18.118 | INFO     | src.ai_engine.ai_models:fit:364 - Training base models...
2025-11-01 01:21:18.126 | INFO     | src.ai_engine.ai_models:fit:373 - Training random_forest...
2025-11-01 01:21:18.752 | INFO     | src.ai_engine.ai_models:fit:98 - RandomForest trained successfully on 188 samples with 2 classes
2025-11-01 01:21:18.752 | INFO     | src.ai_engine.ai_models:fit:373 - Training gradient_boosting...
2025-11-01 01:21:20.315 | INFO     | src.ai_engine.ai_models:fit:157 - GradientBoosting trained successfully on 188 samples with 2 classes
2025-11-01 01:21:20.316 | INFO     | src.ai_engine.ai_models:fit:373 - Training pattern_based...
2025-11-01 01:21:20.317 | INFO     | src.ai_engine.ai_models:fit:373 - Training lstm...
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\keras\src\layers\rnn\rnn.py:199: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(**kwargs)
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1108: RuntimeWarning: invalid value encountered in divide
  updated_mean = (last_sum + new_sum) / updated_sample_count
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1113: RuntimeWarning: invalid value encountered in divide
  T = new_sum / new_sample_count
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1133: RuntimeWarning: invalid value encountered in divide
  new_unnormalized_variance -= correction**2 / new_sample_count
Epoch 1/50
4/4 ━━━━━━━━━━━━━━━━━━━━ 43s 1s/step - accuracy: 0.7661 - loss: 0.6928 - val_accuracy: 1.0000 - val_loss: 0.6912
Epoch 2/50
4/4 ━━━━━━━━━━━━━━━━━━━━ 1s 199ms/step - accuracy: 0.7661 - loss: 0.6917 - val_accuracy: 1.0000 - val_loss: 0.6892
Epoch 3/50
4/4 ━━━━━━━━━━━━━━━━━━━━ 1s 162ms/step - accuracy: 0.7661 - loss: 0.6908 - val_accuracy: 1.0000 - val_loss: 0.6872
Epoch 4/50
4/4 ━━━━━━━━━━━━━━━━━━━━ 0s 105ms/step - accuracy: 0.7661 - loss: 0.6896 - val_accuracy: 1.0000 - val_loss: 0.6853
Epoch 5/50
4/4 ━━━━━━━━━━━━━━━━━━━━ 0s 95ms/step - accuracy: 0.7661 - loss: 0.6886 - val_accuracy: 1.0000 - val_loss: 0.6834
Epoch 6/50
4/4 ━━━━━━━━━━━━━━━━━━━━ 0s 101ms/step - accuracy: 0.7661 - loss: 0.6876 - val_accuracy: 1.0000 - val_loss: 0.6815
Epoch 7/50
4/4 ━━━━━━━━━━━━━━━━━━━━ 0s 49ms/step - accuracy: 0.7661 - loss: 0.6866 - val_accuracy: 1.0000 - val_loss: 0.6795
Epoch 8/50
4/4 ━━━━━━━━━━━━━━━━━━━━ 0s 88ms/step - accuracy: 0.7661 - loss: 0.6856 - val_accuracy: 1.0000 - val_loss: 0.6776
Epoch 9/50
4/4 ━━━━━━━━━━━━━━━━━━━━ 0s 93ms/step - accuracy: 0.7661 - loss: 0.6845 - val_accuracy: 1.0000 - val_loss: 0.6757
Epoch 10/50
4/4 ━━━━━━━━━━━━━━━━━━━━ 0s 47ms/step - accuracy: 0.7661 - loss: 0.6835 - val_accuracy: 1.0000 - val_loss: 0.6738
Epoch 11/50
4/4 ━━━━━━━━━━━━━━━━━━━━ 0s 48ms/step - accuracy: 0.7661 - loss: 0.6826 - val_accuracy: 1.0000 - val_loss: 0.6718
Epoch 12/50
4/4 ━━━━━━━━━━━━━━━━━━━━ 0s 47ms/step - accuracy: 0.7661 - loss: 0.6815 - val_accuracy: 1.0000 - val_loss: 0.6700
Epoch 13/50
4/4 ━━━━━━━━━━━━━━━━━━━━ 0s 48ms/step - accuracy: 0.7661 - loss: 0.6806 - val_accuracy: 1.0000 - val_loss: 0.6681
Epoch 14/50
4/4 ━━━━━━━━━━━━━━━━━━━━ 0s 48ms/step - accuracy: 0.7661 - loss: 0.6796 - val_accuracy: 1.0000 - val_loss: 0.6662
Epoch 15/50
4/4 ━━━━━━━━━━━━━━━━━━━━ 0s 73ms/step - accuracy: 0.7661 - loss: 0.6786 - val_accuracy: 1.0000 - val_loss: 0.6644
Epoch 16/50
4/4 ━━━━━━━━━━━━━━━━━━━━ 0s 48ms/step - accuracy: 0.7661 - loss: 0.6776 - val_accuracy: 1.0000 - val_loss: 0.6625
Epoch 17/50
4/4 ━━━━━━━━━━━━━━━━━━━━ 0s 48ms/step - accuracy: 0.7661 - loss: 0.6768 - val_accuracy: 1.0000 - val_loss: 0.6606
Epoch 18/50
4/4 ━━━━━━━━━━━━━━━━━━━━ 0s 49ms/step - accuracy: 0.7661 - loss: 0.6758 - val_accuracy: 1.0000 - val_loss: 0.6588
Epoch 19/50
4/4 ━━━━━━━━━━━━━━━━━━━━ 0s 49ms/step - accuracy: 0.7661 - loss: 0.6748 - val_accuracy: 1.0000 - val_loss: 0.6570
Epoch 20/50
4/4 ━━━━━━━━━━━━━━━━━━━━ 0s 48ms/step - accuracy: 0.7661 - loss: 0.6739 - val_accuracy: 1.0000 - val_loss: 0.6552
Epoch 21/50
4/4 ━━━━━━━━━━━━━━━━━━━━ 0s 48ms/step - accuracy: 0.7661 - loss: 0.6730 - val_accuracy: 1.0000 - val_loss: 0.6534
Epoch 22/50
4/4 ━━━━━━━━━━━━━━━━━━━━ 0s 48ms/step - accuracy: 0.7661 - loss: 0.6720 - val_accuracy: 1.0000 - val_loss: 0.6516
Epoch 23/50
4/4 ━━━━━━━━━━━━━━━━━━━━ 0s 48ms/step - accuracy: 0.7661 - loss: 0.6711 - val_accuracy: 1.0000 - val_loss: 0.6498
Epoch 24/50
4/4 ━━━━━━━━━━━━━━━━━━━━ 0s 48ms/step - accuracy: 0.7661 - loss: 0.6701 - val_accuracy: 1.0000 - val_loss: 0.6480
Epoch 25/50
4/4 ━━━━━━━━━━━━━━━━━━━━ 0s 49ms/step - accuracy: 0.7661 - loss: 0.6693 - val_accuracy: 1.0000 - val_loss: 0.6463
Epoch 26/50
4/4 ━━━━━━━━━━━━━━━━━━━━ 0s 49ms/step - accuracy: 0.7661 - loss: 0.6684 - val_accuracy: 1.0000 - val_loss: 0.6444
Epoch 27/50
4/4 ━━━━━━━━━━━━━━━━━━━━ 0s 48ms/step - accuracy: 0.7661 - loss: 0.6675 - val_accuracy: 1.0000 - val_loss: 0.6426
Epoch 28/50
4/4 ━━━━━━━━━━━━━━━━━━━━ 0s 49ms/step - accuracy: 0.7661 - loss: 0.6666 - val_accuracy: 1.0000 - val_loss: 0.6409
Epoch 29/50
4/4 ━━━━━━━━━━━━━━━━━━━━ 0s 49ms/step - accuracy: 0.7661 - loss: 0.6657 - val_accuracy: 1.0000 - val_loss: 0.6391
Epoch 30/50
4/4 ━━━━━━━━━━━━━━━━━━━━ 0s 49ms/step - accuracy: 0.7661 - loss: 0.6648 - val_accuracy: 1.0000 - val_loss: 0.6374
Epoch 31/50
4/4 ━━━━━━━━━━━━━━━━━━━━ 0s 49ms/step - accuracy: 0.7661 - loss: 0.6639 - val_accuracy: 1.0000 - val_loss: 0.6357
Epoch 32/50
4/4 ━━━━━━━━━━━━━━━━━━━━ 0s 50ms/step - accuracy: 0.7661 - loss: 0.6631 - val_accuracy: 1.0000 - val_loss: 0.6339
Epoch 33/50
4/4 ━━━━━━━━━━━━━━━━━━━━ 0s 48ms/step - accuracy: 0.7661 - loss: 0.6622 - val_accuracy: 1.0000 - val_loss: 0.6322
Epoch 34/50
4/4 ━━━━━━━━━━━━━━━━━━━━ 0s 50ms/step - accuracy: 0.7661 - loss: 0.6613 - val_accuracy: 1.0000 - val_loss: 0.6305
Epoch 35/50
4/4 ━━━━━━━━━━━━━━━━━━━━ 0s 49ms/step - accuracy: 0.7661 - loss: 0.6605 - val_accuracy: 1.0000 - val_loss: 0.6287
Epoch 36/50
4/4 ━━━━━━━━━━━━━━━━━━━━ 0s 49ms/step - accuracy: 0.7661 - loss: 0.6596 - val_accuracy: 1.0000 - val_loss: 0.6270
Epoch 37/50
4/4 ━━━━━━━━━━━━━━━━━━━━ 0s 59ms/step - accuracy: 0.7661 - loss: 0.6588 - val_accuracy: 1.0000 - val_loss: 0.6253
Epoch 38/50
4/4 ━━━━━━━━━━━━━━━━━━━━ 0s 49ms/step - accuracy: 0.7661 - loss: 0.6579 - val_accuracy: 1.0000 - val_loss: 0.6237
Epoch 39/50
4/4 ━━━━━━━━━━━━━━━━━━━━ 0s 49ms/step - accuracy: 0.7661 - loss: 0.6571 - val_accuracy: 1.0000 - val_loss: 0.6220
Epoch 40/50
4/4 ━━━━━━━━━━━━━━━━━━━━ 0s 48ms/step - accuracy: 0.7661 - loss: 0.6563 - val_accuracy: 1.0000 - val_loss: 0.6203
Epoch 41/50
4/4 ━━━━━━━━━━━━━━━━━━━━ 0s 49ms/step - accuracy: 0.7661 - loss: 0.6555 - val_accuracy: 1.0000 - val_loss: 0.6186
Epoch 42/50
4/4 ━━━━━━━━━━━━━━━━━━━━ 0s 48ms/step - accuracy: 0.7661 - loss: 0.6546 - val_accuracy: 1.0000 - val_loss: 0.6170
Epoch 43/50
4/4 ━━━━━━━━━━━━━━━━━━━━ 0s 47ms/step - accuracy: 0.7661 - loss: 0.6539 - val_accuracy: 1.0000 - val_loss: 0.6153
Epoch 44/50
4/4 ━━━━━━━━━━━━━━━━━━━━ 0s 49ms/step - accuracy: 0.7661 - loss: 0.6530 - val_accuracy: 1.0000 - val_loss: 0.6137
Epoch 45/50
4/4 ━━━━━━━━━━━━━━━━━━━━ 0s 49ms/step - accuracy: 0.7661 - loss: 0.6521 - val_accuracy: 1.0000 - val_loss: 0.6121
Epoch 46/50
4/4 ━━━━━━━━━━━━━━━━━━━━ 0s 50ms/step - accuracy: 0.7661 - loss: 0.6514 - val_accuracy: 1.0000 - val_loss: 0.6105
Epoch 47/50
4/4 ━━━━━━━━━━━━━━━━━━━━ 0s 49ms/step - accuracy: 0.7661 - loss: 0.6505 - val_accuracy: 1.0000 - val_loss: 0.6089
Epoch 48/50
4/4 ━━━━━━━━━━━━━━━━━━━━ 0s 49ms/step - accuracy: 0.7661 - loss: 0.6498 - val_accuracy: 1.0000 - val_loss: 0.6073
Epoch 49/50
4/4 ━━━━━━━━━━━━━━━━━━━━ 0s 48ms/step - accuracy: 0.7661 - loss: 0.6490 - val_accuracy: 1.0000 - val_loss: 0.6057
Epoch 50/50
4/4 ━━━━━━━━━━━━━━━━━━━━ 0s 49ms/step - accuracy: 0.7661 - loss: 0.6483 - val_accuracy: 1.0000 - val_loss: 0.6041
2025-11-01 01:22:16.704 | INFO     | src.ai_engine.ai_models:fit:685 - LSTM trained successfully.
2025-11-01 01:22:16.705 | INFO     | src.ai_engine.ai_models:fit:381 - Generating base model predictions for meta-model training...
2025-11-01 01:22:16.721 | INFO     | src.ai_engine.feature_engineering:create_sequences:261 - Creating sequences with length 50 from 188 data points.
2025-11-01 01:22:16.737 | INFO     | src.ai_engine.feature_engineering:create_sequences:270 - Created 138 sequences.
5/5 ━━━━━━━━━━━━━━━━━━━━ 5s 691ms/step
2025-11-01 01:22:22.579 | INFO     | src.ai_engine.ai_models:fit:396 - Training meta-model...
2025-11-01 01:22:22.599 | SUCCESS  | src.ai_engine.ai_models:fit:399 - Stacking Ensemble trained successfully.
2025-11-01 01:22:22.601 | SUCCESS  | __main__:main:167 - Final Ensemble model trained.
2025-11-01 01:22:22.602 | INFO     | __main__:main:171 - Saving models to 'models\PainX_800\1d'...
2025-11-01 01:22:22.820 | INFO     | src.ai_engine.ai_models:save:52 - Model RandomForest saved to models\PainX_800\1d\random_forest.pkl
2025-11-01 01:22:22.937 | INFO     | src.ai_engine.ai_models:save:52 - Model GradientBoosting saved to models\PainX_800\1d\gradient_boosting.pkl
2025-11-01 01:22:23.100 | INFO     | src.ai_engine.ai_models:save:731 - LSTM model saved to models\PainX_800\1d\lstm.keras, models\PainX_800\1d\lstm_scaler.pkl and marker file models\PainX_800\1d\lstm.pkl
2025-11-01 01:22:23.104 | INFO     | src.ai_engine.ai_models:save_all:463 - Meta-model saved to models\PainX_800\1d\meta_model.pkl
2025-11-01 01:22:23.107 | SUCCESS  | __main__:main:174 - --- Finished training for Symbol: PainX 800, Timeframe: 1d ---
2025-11-01 01:22:23.109 | INFO     | __main__:main:140 - --- Starting training for Symbol: PainX 800, Timeframe: 1h ---
2025-11-01 01:22:23.194 | SUCCESS  | __main__:main:148 - Loaded 7227 records.
2025-11-01 01:22:23.195 | INFO     | __main__:prepare_training_data:32 - Preparing data for training with Meta-Labeling...
2025-11-01 01:22:23.852 | DEBUG    | src.ai_engine.technical_indicators:calculate_all:47 - Calculated 63 technical indicators
2025-11-01 01:22:25.104 | DEBUG    | src.ai_engine.feature_engineering:extract_features:66 - Extracted 116 features
2025-11-01 01:22:25.105 | INFO     | __main__:prepare_training_data:39 - Generating signals from primary model (SimplePatternModel)...
2025-11-01 01:22:25.125 | WARNING  | src.ai_engine.feature_engineering:prepare_for_model:230 - Se perdieron todos los datos al eliminar los NaN. Se conservarán los datos rellenados.
2025-11-01 01:22:26.266 | INFO     | src.ai_engine.ai_models:calculate_optimal_threshold:549 - Calculated optimal threshold: 0.0015 (volatility: 0.0005, avg_movement: 0.0021)
2025-11-01 01:22:26.266 | INFO     | src.ai_engine.ai_models:create_meta_labels:577 - Creating meta-labels for secondary model...
2025-11-01 01:22:27.145 | INFO     | src.ai_engine.ai_models:create_meta_labels:629 - Meta-Label distribution - Profitable: 1123 (33.8%), Unprofitable: 2204 (66.2%)
2025-11-01 01:22:27.171 | WARNING  | src.ai_engine.feature_engineering:prepare_for_model:230 - Se perdieron todos los datos al eliminar los NaN. Se conservarán los datos rellenados.
2025-11-01 01:22:27.182 | INFO     | __main__:prepare_training_data:75 - Data preparation complete. Shape of X: (5096, 116), Shape of y: (5096,)
2025-11-01 01:22:27.187 | INFO     | src.ai_engine.feature_engineering:create_sequences:261 - Creating sequences with length 50 from 5096 data points.
2025-11-01 01:22:27.250 | INFO     | src.ai_engine.feature_engineering:create_sequences:270 - Created 5046 sequences.
2025-11-01 01:22:27.252 | INFO     | __main__:main:164 - Initializing and training Ensemble model...
2025-11-01 01:22:27.253 | INFO     | src.ai_engine.ai_models:__init__:304 - Initialized Stacking Ensemble with Logistic Regression as meta-model.
2025-11-01 01:22:27.281 | INFO     | src.ai_engine.ai_models:fit:359 - Creating LSTM model...
2025-11-01 01:22:27.281 | INFO     | src.ai_engine.ai_models:fit:364 - Training base models...
2025-11-01 01:22:27.291 | INFO     | src.ai_engine.ai_models:fit:373 - Training random_forest...
2025-11-01 01:22:29.197 | INFO     | src.ai_engine.ai_models:fit:98 - RandomForest trained successfully on 5096 samples with 2 classes
2025-11-01 01:22:29.198 | INFO     | src.ai_engine.ai_models:fit:373 - Training gradient_boosting...
2025-11-01 01:23:20.370 | INFO     | src.ai_engine.ai_models:fit:157 - GradientBoosting trained successfully on 5096 samples with 2 classes
2025-11-01 01:23:20.371 | INFO     | src.ai_engine.ai_models:fit:373 - Training pattern_based...
2025-11-01 01:23:20.372 | INFO     | src.ai_engine.ai_models:fit:373 - Training lstm...
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\keras\src\layers\rnn\rnn.py:199: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(**kwargs)
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1108: RuntimeWarning: invalid value encountered in divide
  updated_mean = (last_sum + new_sum) / updated_sample_count
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1113: RuntimeWarning: invalid value encountered in divide
  T = new_sum / new_sample_count
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1133: RuntimeWarning: invalid value encountered in divide
  new_unnormalized_variance -= correction**2 / new_sample_count
Epoch 1/50
142/142 ━━━━━━━━━━━━━━━━━━━━ 22s 53ms/step - accuracy: 0.7743 - loss: 0.6754 - val_accuracy: 0.8079 - val_loss: 0.6539
Epoch 2/50
142/142 ━━━━━━━━━━━━━━━━━━━━ 5s 35ms/step - accuracy: 0.7743 - loss: 0.6442 - val_accuracy: 0.8079 - val_loss: 0.6217
Epoch 3/50
142/142 ━━━━━━━━━━━━━━━━━━━━ 5s 33ms/step - accuracy: 0.7743 - loss: 0.6189 - val_accuracy: 0.8079 - val_loss: 0.5954
Epoch 4/50
142/142 ━━━━━━━━━━━━━━━━━━━━ 5s 34ms/step - accuracy: 0.7743 - loss: 0.5987 - val_accuracy: 0.8079 - val_loss: 0.5740
Epoch 5/50
142/142 ━━━━━━━━━━━━━━━━━━━━ 5s 34ms/step - accuracy: 0.7743 - loss: 0.5828 - val_accuracy: 0.8079 - val_loss: 0.5564
Epoch 6/50
142/142 ━━━━━━━━━━━━━━━━━━━━ 5s 34ms/step - accuracy: 0.7743 - loss: 0.5703 - val_accuracy: 0.8079 - val_loss: 0.5427
Epoch 7/50
142/142 ━━━━━━━━━━━━━━━━━━━━ 5s 35ms/step - accuracy: 0.7743 - loss: 0.5607 - val_accuracy: 0.8079 - val_loss: 0.5317
Epoch 8/50
142/142 ━━━━━━━━━━━━━━━━━━━━ 5s 32ms/step - accuracy: 0.7743 - loss: 0.5534 - val_accuracy: 0.8079 - val_loss: 0.5227
Epoch 9/50
142/142 ━━━━━━━━━━━━━━━━━━━━ 4s 31ms/step - accuracy: 0.7743 - loss: 0.5479 - val_accuracy: 0.8079 - val_loss: 0.5160
Epoch 10/50
142/142 ━━━━━━━━━━━━━━━━━━━━ 5s 32ms/step - accuracy: 0.7743 - loss: 0.5438 - val_accuracy: 0.8079 - val_loss: 0.5105
Epoch 11/50
142/142 ━━━━━━━━━━━━━━━━━━━━ 5s 32ms/step - accuracy: 0.7743 - loss: 0.5408 - val_accuracy: 0.8079 - val_loss: 0.5065
Epoch 12/50
142/142 ━━━━━━━━━━━━━━━━━━━━ 5s 32ms/step - accuracy: 0.7743 - loss: 0.5387 - val_accuracy: 0.8079 - val_loss: 0.5032
Epoch 13/50
142/142 ━━━━━━━━━━━━━━━━━━━━ 4s 31ms/step - accuracy: 0.7743 - loss: 0.5372 - val_accuracy: 0.8079 - val_loss: 0.5006
Epoch 14/50
142/142 ━━━━━━━━━━━━━━━━━━━━ 4s 30ms/step - accuracy: 0.7743 - loss: 0.5361 - val_accuracy: 0.8079 - val_loss: 0.4988
Epoch 15/50
142/142 ━━━━━━━━━━━━━━━━━━━━ 5s 33ms/step - accuracy: 0.7743 - loss: 0.5354 - val_accuracy: 0.8079 - val_loss: 0.4972
Epoch 16/50
142/142 ━━━━━━━━━━━━━━━━━━━━ 5s 32ms/step - accuracy: 0.7743 - loss: 0.5349 - val_accuracy: 0.8079 - val_loss: 0.4962
Epoch 17/50
142/142 ━━━━━━━━━━━━━━━━━━━━ 4s 31ms/step - accuracy: 0.7743 - loss: 0.5346 - val_accuracy: 0.8079 - val_loss: 0.4953
Epoch 18/50
142/142 ━━━━━━━━━━━━━━━━━━━━ 5s 33ms/step - accuracy: 0.7743 - loss: 0.5344 - val_accuracy: 0.8079 - val_loss: 0.4947
Epoch 19/50
142/142 ━━━━━━━━━━━━━━━━━━━━ 5s 33ms/step - accuracy: 0.7743 - loss: 0.5343 - val_accuracy: 0.8079 - val_loss: 0.4941
Epoch 20/50
142/142 ━━━━━━━━━━━━━━━━━━━━ 5s 34ms/step - accuracy: 0.7743 - loss: 0.5342 - val_accuracy: 0.8079 - val_loss: 0.4938
Epoch 21/50
142/142 ━━━━━━━━━━━━━━━━━━━━ 5s 32ms/step - accuracy: 0.7743 - loss: 0.5342 - val_accuracy: 0.8079 - val_loss: 0.4934
Epoch 22/50
142/142 ━━━━━━━━━━━━━━━━━━━━ 5s 33ms/step - accuracy: 0.7743 - loss: 0.5341 - val_accuracy: 0.8079 - val_loss: 0.4933
Epoch 23/50
142/142 ━━━━━━━━━━━━━━━━━━━━ 4s 30ms/step - accuracy: 0.7743 - loss: 0.5341 - val_accuracy: 0.8079 - val_loss: 0.4932
Epoch 24/50
142/142 ━━━━━━━━━━━━━━━━━━━━ 5s 34ms/step - accuracy: 0.7743 - loss: 0.5341 - val_accuracy: 0.8079 - val_loss: 0.4930
Epoch 25/50
142/142 ━━━━━━━━━━━━━━━━━━━━ 5s 32ms/step - accuracy: 0.7743 - loss: 0.5341 - val_accuracy: 0.8079 - val_loss: 0.4928
Epoch 26/50
142/142 ━━━━━━━━━━━━━━━━━━━━ 4s 30ms/step - accuracy: 0.7743 - loss: 0.5341 - val_accuracy: 0.8079 - val_loss: 0.4927
Epoch 27/50
142/142 ━━━━━━━━━━━━━━━━━━━━ 5s 34ms/step - accuracy: 0.7743 - loss: 0.5341 - val_accuracy: 0.8079 - val_loss: 0.4927
Epoch 28/50
142/142 ━━━━━━━━━━━━━━━━━━━━ 5s 33ms/step - accuracy: 0.7743 - loss: 0.5341 - val_accuracy: 0.8079 - val_loss: 0.4928
Epoch 29/50
142/142 ━━━━━━━━━━━━━━━━━━━━ 5s 34ms/step - accuracy: 0.7743 - loss: 0.5341 - val_accuracy: 0.8079 - val_loss: 0.4927
Epoch 30/50
142/142 ━━━━━━━━━━━━━━━━━━━━ 4s 31ms/step - accuracy: 0.7743 - loss: 0.5341 - val_accuracy: 0.8079 - val_loss: 0.4927
Epoch 31/50
142/142 ━━━━━━━━━━━━━━━━━━━━ 5s 34ms/step - accuracy: 0.7743 - loss: 0.5341 - val_accuracy: 0.8079 - val_loss: 0.4927
Epoch 32/50
142/142 ━━━━━━━━━━━━━━━━━━━━ 4s 31ms/step - accuracy: 0.7743 - loss: 0.5341 - val_accuracy: 0.8079 - val_loss: 0.4926
Epoch 33/50
142/142 ━━━━━━━━━━━━━━━━━━━━ 4s 32ms/step - accuracy: 0.7743 - loss: 0.5341 - val_accuracy: 0.8079 - val_loss: 0.4926
Epoch 34/50
142/142 ━━━━━━━━━━━━━━━━━━━━ 5s 34ms/step - accuracy: 0.7743 - loss: 0.5341 - val_accuracy: 0.8079 - val_loss: 0.4926
Epoch 35/50
142/142 ━━━━━━━━━━━━━━━━━━━━ 5s 33ms/step - accuracy: 0.7743 - loss: 0.5341 - val_accuracy: 0.8079 - val_loss: 0.4926
Epoch 36/50
142/142 ━━━━━━━━━━━━━━━━━━━━ 5s 34ms/step - accuracy: 0.7743 - loss: 0.5341 - val_accuracy: 0.8079 - val_loss: 0.4926
Epoch 37/50
142/142 ━━━━━━━━━━━━━━━━━━━━ 4s 30ms/step - accuracy: 0.7743 - loss: 0.5341 - val_accuracy: 0.8079 - val_loss: 0.4926
Epoch 38/50
142/142 ━━━━━━━━━━━━━━━━━━━━ 4s 31ms/step - accuracy: 0.7743 - loss: 0.5341 - val_accuracy: 0.8079 - val_loss: 0.4925
Epoch 39/50
142/142 ━━━━━━━━━━━━━━━━━━━━ 5s 34ms/step - accuracy: 0.7743 - loss: 0.5341 - val_accuracy: 0.8079 - val_loss: 0.4926
Epoch 40/50
142/142 ━━━━━━━━━━━━━━━━━━━━ 5s 32ms/step - accuracy: 0.7743 - loss: 0.5341 - val_accuracy: 0.8079 - val_loss: 0.4927
Epoch 41/50
142/142 ━━━━━━━━━━━━━━━━━━━━ 5s 32ms/step - accuracy: 0.7743 - loss: 0.5341 - val_accuracy: 0.8079 - val_loss: 0.4927
Epoch 42/50
142/142 ━━━━━━━━━━━━━━━━━━━━ 5s 32ms/step - accuracy: 0.7743 - loss: 0.5341 - val_accuracy: 0.8079 - val_loss: 0.4926
Epoch 43/50
142/142 ━━━━━━━━━━━━━━━━━━━━ 5s 32ms/step - accuracy: 0.7743 - loss: 0.5341 - val_accuracy: 0.8079 - val_loss: 0.4927
Epoch 44/50
142/142 ━━━━━━━━━━━━━━━━━━━━ 4s 31ms/step - accuracy: 0.7743 - loss: 0.5341 - val_accuracy: 0.8079 - val_loss: 0.4926
Epoch 45/50
142/142 ━━━━━━━━━━━━━━━━━━━━ 5s 34ms/step - accuracy: 0.7743 - loss: 0.5341 - val_accuracy: 0.8079 - val_loss: 0.4926
Epoch 46/50
142/142 ━━━━━━━━━━━━━━━━━━━━ 5s 33ms/step - accuracy: 0.7743 - loss: 0.5341 - val_accuracy: 0.8079 - val_loss: 0.4926
Epoch 47/50
142/142 ━━━━━━━━━━━━━━━━━━━━ 5s 32ms/step - accuracy: 0.7743 - loss: 0.5341 - val_accuracy: 0.8079 - val_loss: 0.4926
Epoch 48/50
142/142 ━━━━━━━━━━━━━━━━━━━━ 5s 33ms/step - accuracy: 0.7743 - loss: 0.5341 - val_accuracy: 0.8079 - val_loss: 0.4926
2025-11-01 01:27:21.761 | INFO     | src.ai_engine.ai_models:fit:685 - LSTM trained successfully.
2025-11-01 01:27:21.768 | INFO     | src.ai_engine.ai_models:fit:381 - Generating base model predictions for meta-model training...
2025-11-01 01:27:22.099 | INFO     | src.ai_engine.feature_engineering:create_sequences:261 - Creating sequences with length 50 from 5096 data points.
2025-11-01 01:27:22.158 | INFO     | src.ai_engine.feature_engineering:create_sequences:270 - Created 5046 sequences.
158/158 ━━━━━━━━━━━━━━━━━━━━ 3s 15ms/step
2025-11-01 01:27:25.797 | INFO     | src.ai_engine.ai_models:fit:396 - Training meta-model...
2025-11-01 01:27:25.805 | SUCCESS  | src.ai_engine.ai_models:fit:399 - Stacking Ensemble trained successfully.
2025-11-01 01:27:25.806 | SUCCESS  | __main__:main:167 - Final Ensemble model trained.
2025-11-01 01:27:25.806 | INFO     | __main__:main:171 - Saving models to 'models\PainX_800\1h'...
2025-11-01 01:27:25.897 | INFO     | src.ai_engine.ai_models:save:52 - Model RandomForest saved to models\PainX_800\1h\random_forest.pkl
2025-11-01 01:27:25.951 | INFO     | src.ai_engine.ai_models:save:52 - Model GradientBoosting saved to models\PainX_800\1h\gradient_boosting.pkl
2025-11-01 01:27:26.063 | INFO     | src.ai_engine.ai_models:save:731 - LSTM model saved to models\PainX_800\1h\lstm.keras, models\PainX_800\1h\lstm_scaler.pkl and marker file models\PainX_800\1h\lstm.pkl
2025-11-01 01:27:26.082 | INFO     | src.ai_engine.ai_models:save_all:463 - Meta-model saved to models\PainX_800\1h\meta_model.pkl
2025-11-01 01:27:26.084 | SUCCESS  | __main__:main:174 - --- Finished training for Symbol: PainX 800, Timeframe: 1h ---
2025-11-01 01:27:26.085 | INFO     | __main__:main:140 - --- Starting training for Symbol: PainX 800, Timeframe: 1m ---
2025-11-01 01:27:26.496 | SUCCESS  | __main__:main:148 - Loaded 100001 records.
2025-11-01 01:27:26.496 | INFO     | __main__:prepare_training_data:32 - Preparing data for training with Meta-Labeling...
2025-11-01 01:27:31.994 | DEBUG    | src.ai_engine.technical_indicators:calculate_all:47 - Calculated 63 technical indicators
2025-11-01 01:27:48.674 | DEBUG    | src.ai_engine.feature_engineering:extract_features:66 - Extracted 116 features
2025-11-01 01:27:48.676 | INFO     | __main__:prepare_training_data:39 - Generating signals from primary model (SimplePatternModel)...
2025-11-01 01:27:48.884 | WARNING  | src.ai_engine.feature_engineering:prepare_for_model:230 - Se perdieron todos los datos al eliminar los NaN. Se conservarán los datos rellenados.
2025-11-01 01:28:04.731 | INFO     | src.ai_engine.ai_models:calculate_optimal_threshold:549 - Calculated optimal threshold: 0.0010 (volatility: 0.0001, avg_movement: 0.0002)
2025-11-01 01:28:04.733 | INFO     | src.ai_engine.ai_models:create_meta_labels:577 - Creating meta-labels for secondary model...
2025-11-01 01:28:17.522 | INFO     | src.ai_engine.ai_models:create_meta_labels:629 - Meta-Label distribution - Profitable: 2 (2.4%), Unprofitable: 80 (97.6%)
2025-11-01 01:28:17.749 | WARNING  | src.ai_engine.feature_engineering:prepare_for_model:230 - Se perdieron todos los datos al eliminar los NaN. Se conservarán los datos rellenados.
2025-11-01 01:28:17.839 | INFO     | __main__:prepare_training_data:75 - Data preparation complete. Shape of X: (57231, 116), Shape of y: (57231,)
2025-11-01 01:28:17.910 | INFO     | src.ai_engine.feature_engineering:create_sequences:261 - Creating sequences with length 50 from 57231 data points.
2025-11-01 01:28:18.571 | INFO     | src.ai_engine.feature_engineering:create_sequences:270 - Created 57181 sequences.
2025-11-01 01:28:18.586 | INFO     | __main__:main:164 - Initializing and training Ensemble model...
2025-11-01 01:28:18.588 | INFO     | src.ai_engine.ai_models:__init__:304 - Initialized Stacking Ensemble with Logistic Regression as meta-model.
2025-11-01 01:28:18.605 | INFO     | src.ai_engine.ai_models:fit:359 - Creating LSTM model...
2025-11-01 01:28:18.605 | INFO     | src.ai_engine.ai_models:fit:364 - Training base models...
2025-11-01 01:28:18.702 | INFO     | src.ai_engine.ai_models:fit:373 - Training random_forest...
2025-11-01 01:28:18.849 | ERROR    | src.ai_engine.ai_models:fit:379 - Error training random_forest: Requesting 3-fold cross-validation but provided less than 3 examples for at least one class.
2025-11-01 01:28:18.853 | INFO     | src.ai_engine.ai_models:fit:373 - Training gradient_boosting...
2025-11-01 01:28:19.025 | ERROR    | src.ai_engine.ai_models:fit:379 - Error training gradient_boosting: Requesting 3-fold cross-validation but provided less than 3 examples for at least one class.
2025-11-01 01:28:19.027 | INFO     | src.ai_engine.ai_models:fit:373 - Training pattern_based...
2025-11-01 01:28:19.028 | INFO     | src.ai_engine.ai_models:fit:373 - Training lstm...
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\keras\src\layers\rnn\rnn.py:199: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(**kwargs)
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1108: RuntimeWarning: invalid value encountered in divide
  updated_mean = (last_sum + new_sum) / updated_sample_count
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1113: RuntimeWarning: invalid value encountered in divide
  T = new_sum / new_sample_count
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1133: RuntimeWarning: invalid value encountered in divide
  new_unnormalized_variance -= correction**2 / new_sample_count
Epoch 1/50
1609/1609 ━━━━━━━━━━━━━━━━━━━━ 305s 41ms/step - accuracy: 1.0000 - loss: 0.4167 - val_accuracy: 1.0000 - val_loss: 0.2345
Epoch 2/50
1609/1609 ━━━━━━━━━━━━━━━━━━━━ 52s 32ms/step - accuracy: 1.0000 - loss: 0.1534 - val_accuracy: 1.0000 - val_loss: 0.0964
Epoch 3/50
1609/1609 ━━━━━━━━━━━━━━━━━━━━ 50s 31ms/step - accuracy: 1.0000 - loss: 0.0668 - val_accuracy: 1.0000 - val_loss: 0.0445
Epoch 4/50
1609/1609 ━━━━━━━━━━━━━━━━━━━━ 50s 31ms/step - accuracy: 1.0000 - loss: 0.0318 - val_accuracy: 1.0000 - val_loss: 0.0217
Epoch 5/50
1609/1609 ━━━━━━━━━━━━━━━━━━━━ 49s 31ms/step - accuracy: 1.0000 - loss: 0.0158 - val_accuracy: 1.0000 - val_loss: 0.0109
Epoch 6/50
1609/1609 ━━━━━━━━━━━━━━━━━━━━ 47s 29ms/step - accuracy: 1.0000 - loss: 0.0081 - val_accuracy: 1.0000 - val_loss: 0.0055
Epoch 7/50
1609/1609 ━━━━━━━━━━━━━━━━━━━━ 49s 31ms/step - accuracy: 1.0000 - loss: 0.0042 - val_accuracy: 1.0000 - val_loss: 0.0028
Epoch 8/50
1609/1609 ━━━━━━━━━━━━━━━━━━━━ 49s 31ms/step - accuracy: 1.0000 - loss: 0.0023 - val_accuracy: 1.0000 - val_loss: 0.0015
Epoch 9/50
1609/1609 ━━━━━━━━━━━━━━━━━━━━ 49s 31ms/step - accuracy: 1.0000 - loss: 0.0014 - val_accuracy: 1.0000 - val_loss: 7.9468e-04
Epoch 10/50
1609/1609 ━━━━━━━━━━━━━━━━━━━━ 47s 29ms/step - accuracy: 1.0000 - loss: 9.0239e-04 - val_accuracy: 1.0000 - val_loss: 4.6467e-04
Epoch 11/50
1609/1609 ━━━━━━━━━━━━━━━━━━━━ 51s 31ms/step - accuracy: 1.0000 - loss: 6.8464e-04 - val_accuracy: 1.0000 - val_loss: 3.0513e-04
Epoch 12/50
1609/1609 ━━━━━━━━━━━━━━━━━━━━ 45s 28ms/step - accuracy: 1.0000 - loss: 5.7769e-04 - val_accuracy: 1.0000 - val_loss: 2.1508e-04
Epoch 13/50
1609/1609 ━━━━━━━━━━━━━━━━━━━━ 49s 31ms/step - accuracy: 1.0000 - loss: 5.2614e-04 - val_accuracy: 1.0000 - val_loss: 1.7452e-04
Epoch 14/50
1609/1609 ━━━━━━━━━━━━━━━━━━━━ 49s 30ms/step - accuracy: 1.0000 - loss: 4.9807e-04 - val_accuracy: 1.0000 - val_loss: 1.3262e-04
Epoch 15/50
1609/1609 ━━━━━━━━━━━━━━━━━━━━ 49s 30ms/step - accuracy: 1.0000 - loss: 4.7512e-04 - val_accuracy: 1.0000 - val_loss: 1.1848e-04
Epoch 16/50
1609/1609 ━━━━━━━━━━━━━━━━━━━━ 50s 31ms/step - accuracy: 1.0000 - loss: 4.6518e-04 - val_accuracy: 1.0000 - val_loss: 1.0192e-04
Epoch 17/50
1609/1609 ━━━━━━━━━━━━━━━━━━━━ 49s 30ms/step - accuracy: 1.0000 - loss: 4.5683e-04 - val_accuracy: 1.0000 - val_loss: 9.3286e-05
Epoch 18/50
1609/1609 ━━━━━━━━━━━━━━━━━━━━ 46s 29ms/step - accuracy: 1.0000 - loss: 4.5177e-04 - val_accuracy: 1.0000 - val_loss: 8.4399e-05
Epoch 19/50
1609/1609 ━━━━━━━━━━━━━━━━━━━━ 47s 29ms/step - accuracy: 1.0000 - loss: 4.4760e-04 - val_accuracy: 1.0000 - val_loss: 7.8225e-05
Epoch 20/50
1609/1609 ━━━━━━━━━━━━━━━━━━━━ 49s 31ms/step - accuracy: 1.0000 - loss: 4.4490e-04 - val_accuracy: 1.0000 - val_loss: 7.0182e-05
Epoch 21/50
1609/1609 ━━━━━━━━━━━━━━━━━━━━ 49s 31ms/step - accuracy: 1.0000 - loss: 4.4142e-04 - val_accuracy: 1.0000 - val_loss: 6.6746e-05
Epoch 22/50
1609/1609 ━━━━━━━━━━━━━━━━━━━━ 49s 31ms/step - accuracy: 1.0000 - loss: 4.4015e-04 - val_accuracy: 1.0000 - val_loss: 6.3074e-05
Epoch 23/50
1609/1609 ━━━━━━━━━━━━━━━━━━━━ 49s 30ms/step - accuracy: 1.0000 - loss: 4.3868e-04 - val_accuracy: 1.0000 - val_loss: 6.0298e-05
Epoch 24/50
1609/1609 ━━━━━━━━━━━━━━━━━━━━ 49s 31ms/step - accuracy: 1.0000 - loss: 4.3822e-04 - val_accuracy: 1.0000 - val_loss: 5.6209e-05
Epoch 25/50
1609/1609 ━━━━━━━━━━━━━━━━━━━━ 46s 28ms/step - accuracy: 1.0000 - loss: 4.3664e-04 - val_accuracy: 1.0000 - val_loss: 5.4440e-05
Epoch 26/50
1609/1609 ━━━━━━━━━━━━━━━━━━━━ 49s 31ms/step - accuracy: 1.0000 - loss: 4.3622e-04 - val_accuracy: 1.0000 - val_loss: 5.2639e-05
Epoch 27/50
1609/1609 ━━━━━━━━━━━━━━━━━━━━ 49s 30ms/step - accuracy: 1.0000 - loss: 4.3558e-04 - val_accuracy: 1.0000 - val_loss: 5.0984e-05
Epoch 28/50
1609/1609 ━━━━━━━━━━━━━━━━━━━━ 47s 29ms/step - accuracy: 1.0000 - loss: 4.3585e-04 - val_accuracy: 1.0000 - val_loss: 4.8274e-05
Epoch 29/50
1609/1609 ━━━━━━━━━━━━━━━━━━━━ 49s 31ms/step - accuracy: 1.0000 - loss: 4.3511e-04 - val_accuracy: 1.0000 - val_loss: 4.6979e-05
Epoch 30/50
1609/1609 ━━━━━━━━━━━━━━━━━━━━ 48s 30ms/step - accuracy: 1.0000 - loss: 4.3466e-04 - val_accuracy: 1.0000 - val_loss: 4.6181e-05
Epoch 31/50
1609/1609 ━━━━━━━━━━━━━━━━━━━━ 49s 31ms/step - accuracy: 1.0000 - loss: 4.3468e-04 - val_accuracy: 1.0000 - val_loss: 4.5058e-05
Epoch 32/50
1609/1609 ━━━━━━━━━━━━━━━━━━━━ 49s 31ms/step - accuracy: 1.0000 - loss: 4.3451e-04 - val_accuracy: 1.0000 - val_loss: 4.4071e-05
Epoch 33/50
1609/1609 ━━━━━━━━━━━━━━━━━━━━ 49s 30ms/step - accuracy: 1.0000 - loss: 4.3431e-04 - val_accuracy: 1.0000 - val_loss: 4.3311e-05
Epoch 34/50
1609/1609 ━━━━━━━━━━━━━━━━━━━━ 49s 31ms/step - accuracy: 1.0000 - loss: 4.3415e-04 - val_accuracy: 1.0000 - val_loss: 4.2650e-05
Epoch 35/50
1609/1609 ━━━━━━━━━━━━━━━━━━━━ 49s 30ms/step - accuracy: 1.0000 - loss: 4.3404e-04 - val_accuracy: 1.0000 - val_loss: 4.1907e-05
Epoch 36/50
1609/1609 ━━━━━━━━━━━━━━━━━━━━ 49s 31ms/step - accuracy: 1.0000 - loss: 4.3395e-04 - val_accuracy: 1.0000 - val_loss: 4.1186e-05
Epoch 37/50
1609/1609 ━━━━━━━━━━━━━━━━━━━━ 50s 31ms/step - accuracy: 1.0000 - loss: 4.3421e-04 - val_accuracy: 1.0000 - val_loss: 4.0266e-05
Epoch 38/50
1609/1609 ━━━━━━━━━━━━━━━━━━━━ 49s 31ms/step - accuracy: 1.0000 - loss: 4.3393e-04 - val_accuracy: 1.0000 - val_loss: 3.9797e-05
Epoch 39/50
1609/1609 ━━━━━━━━━━━━━━━━━━━━ 47s 29ms/step - accuracy: 1.0000 - loss: 4.3396e-04 - val_accuracy: 1.0000 - val_loss: 3.9204e-05
Epoch 40/50
1609/1609 ━━━━━━━━━━━━━━━━━━━━ 49s 31ms/step - accuracy: 1.0000 - loss: 4.3394e-04 - val_accuracy: 1.0000 - val_loss: 3.8669e-05
Epoch 41/50
1609/1609 ━━━━━━━━━━━━━━━━━━━━ 49s 30ms/step - accuracy: 1.0000 - loss: 4.3407e-04 - val_accuracy: 1.0000 - val_loss: 3.8130e-05
Epoch 42/50
1609/1609 ━━━━━━━━━━━━━━━━━━━━ 48s 30ms/step - accuracy: 1.0000 - loss: 4.3416e-04 - val_accuracy: 1.0000 - val_loss: 3.7658e-05
Epoch 43/50
1609/1609 ━━━━━━━━━━━━━━━━━━━━ 49s 30ms/step - accuracy: 1.0000 - loss: 4.3411e-04 - val_accuracy: 1.0000 - val_loss: 3.7332e-05
Epoch 44/50
1609/1609 ━━━━━━━━━━━━━━━━━━━━ 49s 31ms/step - accuracy: 1.0000 - loss: 4.3391e-04 - val_accuracy: 1.0000 - val_loss: 3.7045e-05
Epoch 45/50
1609/1609 ━━━━━━━━━━━━━━━━━━━━ 49s 30ms/step - accuracy: 1.0000 - loss: 4.3426e-04 - val_accuracy: 1.0000 - val_loss: 3.6474e-05
Epoch 46/50
1609/1609 ━━━━━━━━━━━━━━━━━━━━ 49s 31ms/step - accuracy: 1.0000 - loss: 4.3424e-04 - val_accuracy: 1.0000 - val_loss: 3.6126e-05
Epoch 47/50
1609/1609 ━━━━━━━━━━━━━━━━━━━━ 49s 31ms/step - accuracy: 1.0000 - loss: 4.3412e-04 - val_accuracy: 1.0000 - val_loss: 3.5947e-05
Epoch 48/50
1609/1609 ━━━━━━━━━━━━━━━━━━━━ 49s 31ms/step - accuracy: 1.0000 - loss: 4.3387e-04 - val_accuracy: 1.0000 - val_loss: 3.5558e-05
Epoch 49/50
1609/1609 ━━━━━━━━━━━━━━━━━━━━ 48s 30ms/step - accuracy: 1.0000 - loss: 4.3412e-04 - val_accuracy: 1.0000 - val_loss: 3.5323e-05
Epoch 50/50
1609/1609 ━━━━━━━━━━━━━━━━━━━━ 47s 29ms/step - accuracy: 1.0000 - loss: 4.3437e-04 - val_accuracy: 1.0000 - val_loss: 3.4886e-05
2025-11-01 02:37:30.712 | INFO     | src.ai_engine.ai_models:fit:685 - LSTM trained successfully.
2025-11-01 02:37:31.629 | INFO     | src.ai_engine.ai_models:fit:381 - Generating base model predictions for meta-model training...
2025-11-01 02:39:48.354 | INFO     | src.ai_engine.feature_engineering:create_sequences:261 - Creating sequences with length 50 from 57231 data points.
2025-11-01 02:39:49.036 | INFO     | src.ai_engine.feature_engineering:create_sequences:270 - Created 57181 sequences.
1787/1787 ━━━━━━━━━━━━━━━━━━━━ 255s 57ms/step
2025-11-01 02:57:06.602 | INFO     | src.ai_engine.ai_models:fit:396 - Training meta-model...
2025-11-01 02:57:17.424 | SUCCESS  | src.ai_engine.ai_models:fit:399 - Stacking Ensemble trained successfully.
2025-11-01 02:57:18.243 | SUCCESS  | __main__:main:167 - Final Ensemble model trained.
2025-11-01 02:57:18.352 | INFO     | __main__:main:171 - Saving models to 'models\PainX_800\1m'...
2025-11-01 02:57:20.001 | INFO     | src.ai_engine.ai_models:save:52 - Model RandomForest saved to models\PainX_800\1m\random_forest.pkl
2025-11-01 02:57:20.232 | INFO     | src.ai_engine.ai_models:save:52 - Model GradientBoosting saved to models\PainX_800\1m\gradient_boosting.pkl
2025-11-01 02:57:32.175 | INFO     | src.ai_engine.ai_models:save:731 - LSTM model saved to models\PainX_800\1m\lstm.keras, models\PainX_800\1m\lstm_scaler.pkl and marker file models\PainX_800\1m\lstm.pkl
2025-11-01 02:57:32.348 | INFO     | src.ai_engine.ai_models:save_all:463 - Meta-model saved to models\PainX_800\1m\meta_model.pkl
2025-11-01 02:57:32.424 | SUCCESS  | __main__:main:174 - --- Finished training for Symbol: PainX 800, Timeframe: 1m ---
2025-11-01 02:57:32.488 | INFO     | __main__:main:140 - --- Starting training for Symbol: PainX 800, Timeframe: 4h ---
2025-11-01 02:57:36.649 | SUCCESS  | __main__:main:148 - Loaded 1809 records.
2025-11-01 02:57:36.651 | INFO     | __main__:prepare_training_data:32 - Preparing data for training with Meta-Labeling...
2025-11-01 02:57:40.074 | DEBUG    | src.ai_engine.technical_indicators:calculate_all:47 - Calculated 63 technical indicators
2025-11-01 02:57:42.923 | DEBUG    | src.ai_engine.feature_engineering:extract_features:66 - Extracted 116 features
2025-11-01 02:57:42.955 | INFO     | __main__:prepare_training_data:39 - Generating signals from primary model (SimplePatternModel)...
2025-11-01 02:57:43.195 | WARNING  | src.ai_engine.feature_engineering:prepare_for_model:230 - Se perdieron todos los datos al eliminar los NaN. Se conservarán los datos rellenados.
2025-11-01 02:57:47.413 | INFO     | src.ai_engine.ai_models:calculate_optimal_threshold:549 - Calculated optimal threshold: 0.0031 (volatility: 0.0010, avg_movement: 0.0044)
2025-11-01 02:57:47.415 | INFO     | src.ai_engine.ai_models:create_meta_labels:577 - Creating meta-labels for secondary model...
2025-11-01 02:57:47.705 | INFO     | src.ai_engine.ai_models:create_meta_labels:629 - Meta-Label distribution - Profitable: 324 (43.7%), Unprofitable: 417 (56.3%)
2025-11-01 02:57:48.117 | WARNING  | src.ai_engine.feature_engineering:prepare_for_model:230 - Se perdieron todos los datos al eliminar los NaN. Se conservarán los datos rellenados.
2025-11-01 02:57:48.205 | INFO     | __main__:prepare_training_data:75 - Data preparation complete. Shape of X: (1254, 116), Shape of y: (1254,)
2025-11-01 02:57:48.975 | INFO     | src.ai_engine.feature_engineering:create_sequences:261 - Creating sequences with length 50 from 1254 data points.
2025-11-01 02:57:49.163 | INFO     | src.ai_engine.feature_engineering:create_sequences:270 - Created 1204 sequences.
2025-11-01 02:57:49.838 | INFO     | __main__:main:164 - Initializing and training Ensemble model...
2025-11-01 02:57:49.888 | INFO     | src.ai_engine.ai_models:__init__:304 - Initialized Stacking Ensemble with Logistic Regression as meta-model.
2025-11-01 02:57:49.967 | INFO     | src.ai_engine.ai_models:fit:359 - Creating LSTM model...
2025-11-01 02:57:49.981 | INFO     | src.ai_engine.ai_models:fit:364 - Training base models...
2025-11-01 02:57:50.049 | INFO     | src.ai_engine.ai_models:fit:373 - Training random_forest...
2025-11-01 02:58:05.078 | INFO     | src.ai_engine.ai_models:fit:98 - RandomForest trained successfully on 1254 samples with 2 classes
2025-11-01 02:58:05.080 | INFO     | src.ai_engine.ai_models:fit:373 - Training gradient_boosting...
2025-11-01 02:58:26.171 | INFO     | src.ai_engine.ai_models:fit:157 - GradientBoosting trained successfully on 1254 samples with 2 classes
2025-11-01 02:58:26.173 | INFO     | src.ai_engine.ai_models:fit:373 - Training pattern_based...
2025-11-01 02:58:26.209 | INFO     | src.ai_engine.ai_models:fit:373 - Training lstm...
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\keras\src\layers\rnn\rnn.py:199: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(**kwargs)
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1108: RuntimeWarning: invalid value encountered in divide
  updated_mean = (last_sum + new_sum) / updated_sample_count
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1113: RuntimeWarning: invalid value encountered in divide
  T = new_sum / new_sample_count
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1133: RuntimeWarning: invalid value encountered in divide
  new_unnormalized_variance -= correction**2 / new_sample_count
Epoch 1/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 218s 493ms/step - accuracy: 0.7258 - loss: 0.6897 - val_accuracy: 0.7851 - val_loss: 0.6842
Epoch 2/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 3s 78ms/step - accuracy: 0.7258 - loss: 0.6827 - val_accuracy: 0.7851 - val_loss: 0.6756
Epoch 3/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 2s 66ms/step - accuracy: 0.7258 - loss: 0.6762 - val_accuracy: 0.7851 - val_loss: 0.6673
Epoch 4/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 2s 51ms/step - accuracy: 0.7258 - loss: 0.6699 - val_accuracy: 0.7851 - val_loss: 0.6596
Epoch 5/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 2s 54ms/step - accuracy: 0.7258 - loss: 0.6641 - val_accuracy: 0.7851 - val_loss: 0.6520
Epoch 6/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 38ms/step - accuracy: 0.7258 - loss: 0.6586 - val_accuracy: 0.7851 - val_loss: 0.6450
Epoch 7/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 2s 43ms/step - accuracy: 0.7258 - loss: 0.6534 - val_accuracy: 0.7851 - val_loss: 0.6382
Epoch 8/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 42ms/step - accuracy: 0.7258 - loss: 0.6485 - val_accuracy: 0.7851 - val_loss: 0.6319
Epoch 9/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 2s 55ms/step - accuracy: 0.7258 - loss: 0.6440 - val_accuracy: 0.7851 - val_loss: 0.6260
Epoch 10/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 43ms/step - accuracy: 0.7258 - loss: 0.6398 - val_accuracy: 0.7851 - val_loss: 0.6202
Epoch 11/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 41ms/step - accuracy: 0.7258 - loss: 0.6358 - val_accuracy: 0.7851 - val_loss: 0.6148
Epoch 12/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 2s 40ms/step - accuracy: 0.7258 - loss: 0.6320 - val_accuracy: 0.7851 - val_loss: 0.6099
Epoch 13/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 2s 46ms/step - accuracy: 0.7258 - loss: 0.6286 - val_accuracy: 0.7851 - val_loss: 0.6050
Epoch 14/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 34ms/step - accuracy: 0.7258 - loss: 0.6253 - val_accuracy: 0.7851 - val_loss: 0.6006
Epoch 15/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 34ms/step - accuracy: 0.7258 - loss: 0.6223 - val_accuracy: 0.7851 - val_loss: 0.5962
Epoch 16/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 41ms/step - accuracy: 0.7258 - loss: 0.6195 - val_accuracy: 0.7851 - val_loss: 0.5921
Epoch 17/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 42ms/step - accuracy: 0.7258 - loss: 0.6168 - val_accuracy: 0.7851 - val_loss: 0.5883
Epoch 18/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 34ms/step - accuracy: 0.7258 - loss: 0.6144 - val_accuracy: 0.7851 - val_loss: 0.5845
Epoch 19/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 35ms/step - accuracy: 0.7258 - loss: 0.6121 - val_accuracy: 0.7851 - val_loss: 0.5812
Epoch 20/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 34ms/step - accuracy: 0.7258 - loss: 0.6100 - val_accuracy: 0.7851 - val_loss: 0.5779
Epoch 21/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 40ms/step - accuracy: 0.7258 - loss: 0.6081 - val_accuracy: 0.7851 - val_loss: 0.5749
Epoch 22/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 40ms/step - accuracy: 0.7258 - loss: 0.6063 - val_accuracy: 0.7851 - val_loss: 0.5722
Epoch 23/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 2s 43ms/step - accuracy: 0.7258 - loss: 0.6047 - val_accuracy: 0.7851 - val_loss: 0.5694
Epoch 24/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 35ms/step - accuracy: 0.7258 - loss: 0.6031 - val_accuracy: 0.7851 - val_loss: 0.5672
Epoch 25/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 33ms/step - accuracy: 0.7258 - loss: 0.6017 - val_accuracy: 0.7851 - val_loss: 0.5646
Epoch 26/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 40ms/step - accuracy: 0.7258 - loss: 0.6004 - val_accuracy: 0.7851 - val_loss: 0.5626
Epoch 27/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 34ms/step - accuracy: 0.7258 - loss: 0.5992 - val_accuracy: 0.7851 - val_loss: 0.5604
Epoch 28/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 34ms/step - accuracy: 0.7258 - loss: 0.5981 - val_accuracy: 0.7851 - val_loss: 0.5585
Epoch 29/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 34ms/step - accuracy: 0.7258 - loss: 0.5972 - val_accuracy: 0.7851 - val_loss: 0.5564
Epoch 30/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 33ms/step - accuracy: 0.7258 - loss: 0.5962 - val_accuracy: 0.7851 - val_loss: 0.5547
Epoch 31/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 35ms/step - accuracy: 0.7258 - loss: 0.5954 - val_accuracy: 0.7851 - val_loss: 0.5533
Epoch 32/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 38ms/step - accuracy: 0.7258 - loss: 0.5946 - val_accuracy: 0.7851 - val_loss: 0.5517
Epoch 33/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 36ms/step - accuracy: 0.7258 - loss: 0.5939 - val_accuracy: 0.7851 - val_loss: 0.5503
Epoch 34/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 33ms/step - accuracy: 0.7258 - loss: 0.5933 - val_accuracy: 0.7851 - val_loss: 0.5490
Epoch 35/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 34ms/step - accuracy: 0.7258 - loss: 0.5927 - val_accuracy: 0.7851 - val_loss: 0.5477
Epoch 36/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 37ms/step - accuracy: 0.7258 - loss: 0.5922 - val_accuracy: 0.7851 - val_loss: 0.5464
Epoch 37/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 34ms/step - accuracy: 0.7258 - loss: 0.5916 - val_accuracy: 0.7851 - val_loss: 0.5454
Epoch 38/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 32ms/step - accuracy: 0.7258 - loss: 0.5912 - val_accuracy: 0.7851 - val_loss: 0.5444
Epoch 39/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 35ms/step - accuracy: 0.7258 - loss: 0.5908 - val_accuracy: 0.7851 - val_loss: 0.5434
Epoch 40/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 35ms/step - accuracy: 0.7258 - loss: 0.5904 - val_accuracy: 0.7851 - val_loss: 0.5425
Epoch 41/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 34ms/step - accuracy: 0.7258 - loss: 0.5901 - val_accuracy: 0.7851 - val_loss: 0.5415
Epoch 42/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 34ms/step - accuracy: 0.7258 - loss: 0.5898 - val_accuracy: 0.7851 - val_loss: 0.5408
Epoch 43/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 34ms/step - accuracy: 0.7258 - loss: 0.5896 - val_accuracy: 0.7851 - val_loss: 0.5400
Epoch 44/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 34ms/step - accuracy: 0.7258 - loss: 0.5893 - val_accuracy: 0.7851 - val_loss: 0.5394
Epoch 45/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 34ms/step - accuracy: 0.7258 - loss: 0.5891 - val_accuracy: 0.7851 - val_loss: 0.5386
Epoch 46/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 34ms/step - accuracy: 0.7258 - loss: 0.5890 - val_accuracy: 0.7851 - val_loss: 0.5380
Epoch 47/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 34ms/step - accuracy: 0.7258 - loss: 0.5888 - val_accuracy: 0.7851 - val_loss: 0.5376
Epoch 48/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 34ms/step - accuracy: 0.7258 - loss: 0.5886 - val_accuracy: 0.7851 - val_loss: 0.5370
Epoch 49/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 34ms/step - accuracy: 0.7258 - loss: 0.5885 - val_accuracy: 0.7851 - val_loss: 0.5364
Epoch 50/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 35ms/step - accuracy: 0.7258 - loss: 0.5884 - val_accuracy: 0.7851 - val_loss: 0.5361
2025-11-01 03:03:23.350 | INFO     | src.ai_engine.ai_models:fit:685 - LSTM trained successfully.
2025-11-01 03:03:23.364 | INFO     | src.ai_engine.ai_models:fit:381 - Generating base model predictions for meta-model training...
2025-11-01 03:03:23.614 | INFO     | src.ai_engine.feature_engineering:create_sequences:261 - Creating sequences with length 50 from 1254 data points.
2025-11-01 03:03:24.002 | INFO     | src.ai_engine.feature_engineering:create_sequences:270 - Created 1204 sequences.
38/38 ━━━━━━━━━━━━━━━━━━━━ 13s 180ms/step
2025-11-01 03:03:38.477 | INFO     | src.ai_engine.ai_models:fit:396 - Training meta-model...
2025-11-01 03:03:38.557 | SUCCESS  | src.ai_engine.ai_models:fit:399 - Stacking Ensemble trained successfully.
2025-11-01 03:03:38.590 | SUCCESS  | __main__:main:167 - Final Ensemble model trained.
2025-11-01 03:03:38.592 | INFO     | __main__:main:171 - Saving models to 'models\PainX_800\4h'...
2025-11-01 03:03:39.971 | INFO     | src.ai_engine.ai_models:save:52 - Model RandomForest saved to models\PainX_800\4h\random_forest.pkl
2025-11-01 03:03:40.854 | INFO     | src.ai_engine.ai_models:save:52 - Model GradientBoosting saved to models\PainX_800\4h\gradient_boosting.pkl
2025-11-01 03:03:41.239 | INFO     | src.ai_engine.ai_models:save:731 - LSTM model saved to models\PainX_800\4h\lstm.keras, models\PainX_800\4h\lstm_scaler.pkl and marker file models\PainX_800\4h\lstm.pkl
2025-11-01 03:03:41.266 | INFO     | src.ai_engine.ai_models:save_all:463 - Meta-model saved to models\PainX_800\4h\meta_model.pkl
2025-11-01 03:03:41.267 | SUCCESS  | __main__:main:174 - --- Finished training for Symbol: PainX 800, Timeframe: 4h ---
2025-11-01 03:03:41.272 | INFO     | __main__:main:140 - --- Starting training for Symbol: PainX 800, Timeframe: 5m ---
2025-11-01 03:03:42.872 | SUCCESS  | __main__:main:148 - Loaded 86685 records.
2025-11-01 03:03:42.873 | INFO     | __main__:prepare_training_data:32 - Preparing data for training with Meta-Labeling...
2025-11-01 03:03:50.008 | DEBUG    | src.ai_engine.technical_indicators:calculate_all:47 - Calculated 63 technical indicators
2025-11-01 03:04:05.098 | DEBUG    | src.ai_engine.feature_engineering:extract_features:66 - Extracted 116 features
2025-11-01 03:04:05.103 | INFO     | __main__:prepare_training_data:39 - Generating signals from primary model (SimplePatternModel)...
2025-11-01 03:04:05.393 | WARNING  | src.ai_engine.feature_engineering:prepare_for_model:230 - Se perdieron todos los datos al eliminar los NaN. Se conservarán los datos rellenados.
2025-11-01 03:04:19.573 | INFO     | src.ai_engine.ai_models:calculate_optimal_threshold:549 - Calculated optimal threshold: 0.0010 (volatility: 0.0001, avg_movement: 0.0006)
2025-11-01 03:04:19.574 | INFO     | src.ai_engine.ai_models:create_meta_labels:577 - Creating meta-labels for secondary model...
2025-11-01 03:04:33.352 | INFO     | src.ai_engine.ai_models:create_meta_labels:629 - Meta-Label distribution - Profitable: 483 (12.3%), Unprofitable: 3451 (87.7%)
2025-11-01 03:04:33.684 | WARNING  | src.ai_engine.feature_engineering:prepare_for_model:230 - Se perdieron todos los datos al eliminar los NaN. Se conservarán los datos rellenados.
2025-11-01 03:04:33.787 | INFO     | __main__:prepare_training_data:75 - Data preparation complete. Shape of X: (61442, 116), Shape of y: (61442,)
2025-11-01 03:04:33.924 | INFO     | src.ai_engine.feature_engineering:create_sequences:261 - Creating sequences with length 50 from 61442 data points.
2025-11-01 03:04:35.905 | INFO     | src.ai_engine.feature_engineering:create_sequences:270 - Created 61392 sequences.
2025-11-01 03:04:35.915 | INFO     | __main__:main:164 - Initializing and training Ensemble model...
2025-11-01 03:04:35.917 | INFO     | src.ai_engine.ai_models:__init__:304 - Initialized Stacking Ensemble with Logistic Regression as meta-model.
2025-11-01 03:04:35.947 | INFO     | src.ai_engine.ai_models:fit:359 - Creating LSTM model...
2025-11-01 03:04:35.947 | INFO     | src.ai_engine.ai_models:fit:364 - Training base models...
2025-11-01 03:04:36.056 | INFO     | src.ai_engine.ai_models:fit:373 - Training random_forest...
2025-11-01 03:04:55.998 | INFO     | src.ai_engine.ai_models:fit:98 - RandomForest trained successfully on 61442 samples with 2 classes
2025-11-01 03:04:56.039 | INFO     | src.ai_engine.ai_models:fit:373 - Training gradient_boosting...
2025-11-01 03:17:02.161 | INFO     | src.ai_engine.ai_models:fit:157 - GradientBoosting trained successfully on 61442 samples with 2 classes
2025-11-01 03:17:02.164 | INFO     | src.ai_engine.ai_models:fit:373 - Training pattern_based...
2025-11-01 03:17:02.165 | INFO     | src.ai_engine.ai_models:fit:373 - Training lstm...
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\keras\src\layers\rnn\rnn.py:199: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(**kwargs)
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1108: RuntimeWarning: invalid value encountered in divide
  updated_mean = (last_sum + new_sum) / updated_sample_count
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1113: RuntimeWarning: invalid value encountered in divide
  T = new_sum / new_sample_count
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1133: RuntimeWarning: invalid value encountered in divide
  new_unnormalized_variance -= correction**2 / new_sample_count
Epoch 1/50
1727/1727 ━━━━━━━━━━━━━━━━━━━━ 335s 47ms/step - accuracy: 0.9923 - loss: 0.4096 - val_accuracy: 0.9909 - val_loss: 0.2322
Epoch 2/50
1727/1727 ━━━━━━━━━━━━━━━━━━━━ 62s 36ms/step - accuracy: 0.9923 - loss: 0.1564 - val_accuracy: 0.9909 - val_loss: 0.1097
Epoch 3/50
1727/1727 ━━━━━━━━━━━━━━━━━━━━ 62s 35ms/step - accuracy: 0.9923 - loss: 0.0826 - val_accuracy: 0.9909 - val_loss: 0.0700
Epoch 4/50
1727/1727 ━━━━━━━━━━━━━━━━━━━━ 55s 32ms/step - accuracy: 0.9923 - loss: 0.0571 - val_accuracy: 0.9909 - val_loss: 0.0564
Epoch 5/50
1727/1727 ━━━━━━━━━━━━━━━━━━━━ 56s 32ms/step - accuracy: 0.9923 - loss: 0.0483 - val_accuracy: 0.9909 - val_loss: 0.0526
Epoch 6/50
1727/1727 ━━━━━━━━━━━━━━━━━━━━ 57s 33ms/step - accuracy: 0.9923 - loss: 0.0459 - val_accuracy: 0.9909 - val_loss: 0.0519
Epoch 7/50
1727/1727 ━━━━━━━━━━━━━━━━━━━━ 55s 32ms/step - accuracy: 0.9923 - loss: 0.0454 - val_accuracy: 0.9909 - val_loss: 0.0519
Epoch 8/50
1727/1727 ━━━━━━━━━━━━━━━━━━━━ 56s 32ms/step - accuracy: 0.9923 - loss: 0.0453 - val_accuracy: 0.9909 - val_loss: 0.0520
Epoch 9/50
1727/1727 ━━━━━━━━━━━━━━━━━━━━ 52s 30ms/step - accuracy: 0.9923 - loss: 0.0453 - val_accuracy: 0.9909 - val_loss: 0.0520
Epoch 10/50
1727/1727 ━━━━━━━━━━━━━━━━━━━━ 56s 32ms/step - accuracy: 0.9923 - loss: 0.0453 - val_accuracy: 0.9909 - val_loss: 0.0520
Epoch 11/50
1727/1727 ━━━━━━━━━━━━━━━━━━━━ 61s 36ms/step - accuracy: 0.9923 - loss: 0.0453 - val_accuracy: 0.9909 - val_loss: 0.0520
Epoch 12/50
1727/1727 ━━━━━━━━━━━━━━━━━━━━ 60s 35ms/step - accuracy: 0.9923 - loss: 0.0453 - val_accuracy: 0.9909 - val_loss: 0.0520
Epoch 13/50
1727/1727 ━━━━━━━━━━━━━━━━━━━━ 60s 35ms/step - accuracy: 0.9923 - loss: 0.0453 - val_accuracy: 0.9909 - val_loss: 0.0521
Epoch 14/50
1727/1727 ━━━━━━━━━━━━━━━━━━━━ 60s 35ms/step - accuracy: 0.9923 - loss: 0.0453 - val_accuracy: 0.9909 - val_loss: 0.0520
Epoch 15/50
1727/1727 ━━━━━━━━━━━━━━━━━━━━ 60s 35ms/step - accuracy: 0.9923 - loss: 0.0453 - val_accuracy: 0.9909 - val_loss: 0.0520
Epoch 16/50
1727/1727 ━━━━━━━━━━━━━━━━━━━━ 82s 35ms/step - accuracy: 0.9923 - loss: 0.0453 - val_accuracy: 0.9909 - val_loss: 0.0520
2025-11-01 03:57:07.408 | INFO     | src.ai_engine.ai_models:fit:685 - LSTM trained successfully.
2025-11-01 03:57:08.615 | INFO     | src.ai_engine.ai_models:fit:381 - Generating base model predictions for meta-model training...
2025-11-01 03:57:41.190 | INFO     | src.ai_engine.feature_engineering:create_sequences:261 - Creating sequences with length 50 from 61442 data points.
2025-11-01 03:57:42.456 | INFO     | src.ai_engine.feature_engineering:create_sequences:270 - Created 61392 sequences.
1919/1919 ━━━━━━━━━━━━━━━━━━━━ 204s 41ms/step
2025-11-01 04:11:21.621 | INFO     | src.ai_engine.ai_models:fit:396 - Training meta-model...
2025-11-01 04:11:32.147 | SUCCESS  | src.ai_engine.ai_models:fit:399 - Stacking Ensemble trained successfully.
2025-11-01 04:11:32.656 | SUCCESS  | __main__:main:167 - Final Ensemble model trained.
2025-11-01 04:11:32.733 | INFO     | __main__:main:171 - Saving models to 'models\PainX_800\5m'...
2025-11-01 04:11:44.728 | INFO     | src.ai_engine.ai_models:save:52 - Model RandomForest saved to models\PainX_800\5m\random_forest.pkl
2025-11-01 04:11:50.329 | INFO     | src.ai_engine.ai_models:save:52 - Model GradientBoosting saved to models\PainX_800\5m\gradient_boosting.pkl
2025-11-01 04:12:00.148 | INFO     | src.ai_engine.ai_models:save:731 - LSTM model saved to models\PainX_800\5m\lstm.keras, models\PainX_800\5m\lstm_scaler.pkl and marker file models\PainX_800\5m\lstm.pkl
2025-11-01 04:12:00.274 | INFO     | src.ai_engine.ai_models:save_all:463 - Meta-model saved to models\PainX_800\5m\meta_model.pkl
2025-11-01 04:12:00.304 | SUCCESS  | __main__:main:174 - --- Finished training for Symbol: PainX 800, Timeframe: 5m ---
2025-11-01 04:12:00.397 | INFO     | __main__:main:140 - --- Starting training for Symbol: PainX 999, Timeframe: 15m ---
2025-11-01 04:12:04.885 | SUCCESS  | __main__:main:148 - Loaded 28898 records.
2025-11-01 04:12:04.887 | INFO     | __main__:prepare_training_data:32 - Preparing data for training with Meta-Labeling...
2025-11-01 04:12:10.694 | DEBUG    | src.ai_engine.technical_indicators:calculate_all:47 - Calculated 63 technical indicators
2025-11-01 04:12:23.215 | DEBUG    | src.ai_engine.feature_engineering:extract_features:66 - Extracted 116 features
2025-11-01 04:12:23.219 | INFO     | __main__:prepare_training_data:39 - Generating signals from primary model (SimplePatternModel)...
2025-11-01 04:12:23.817 | WARNING  | src.ai_engine.feature_engineering:prepare_for_model:230 - Se perdieron todos los datos al eliminar los NaN. Se conservarán los datos rellenados.
2025-11-01 04:12:33.819 | INFO     | src.ai_engine.ai_models:calculate_optimal_threshold:549 - Calculated optimal threshold: 0.0012 (volatility: 0.0004, avg_movement: 0.0017)
2025-11-01 04:12:33.823 | INFO     | src.ai_engine.ai_models:create_meta_labels:577 - Creating meta-labels for secondary model...
2025-11-01 04:12:37.415 | INFO     | src.ai_engine.ai_models:create_meta_labels:629 - Meta-Label distribution - Profitable: 4517 (36.2%), Unprofitable: 7947 (63.8%)
2025-11-01 04:12:37.622 | WARNING  | src.ai_engine.feature_engineering:prepare_for_model:230 - Se perdieron todos los datos al eliminar los NaN. Se conservarán los datos rellenados.
2025-11-01 04:12:37.777 | INFO     | __main__:prepare_training_data:75 - Data preparation complete. Shape of X: (20202, 116), Shape of y: (20202,)
2025-11-01 04:12:38.308 | INFO     | src.ai_engine.feature_engineering:create_sequences:261 - Creating sequences with length 50 from 20202 data points.
2025-11-01 04:12:38.826 | INFO     | src.ai_engine.feature_engineering:create_sequences:270 - Created 20152 sequences.
2025-11-01 04:12:39.376 | INFO     | __main__:main:164 - Initializing and training Ensemble model...
2025-11-01 04:12:39.440 | INFO     | src.ai_engine.ai_models:__init__:304 - Initialized Stacking Ensemble with Logistic Regression as meta-model.
2025-11-01 04:12:40.772 | INFO     | src.ai_engine.ai_models:fit:359 - Creating LSTM model...
2025-11-01 04:12:40.773 | INFO     | src.ai_engine.ai_models:fit:364 - Training base models...
2025-11-01 04:12:40.811 | INFO     | src.ai_engine.ai_models:fit:373 - Training random_forest...
2025-11-01 04:12:55.407 | INFO     | src.ai_engine.ai_models:fit:98 - RandomForest trained successfully on 20202 samples with 2 classes
2025-11-01 04:12:55.409 | INFO     | src.ai_engine.ai_models:fit:373 - Training gradient_boosting...
2025-11-01 04:16:45.523 | INFO     | src.ai_engine.ai_models:fit:157 - GradientBoosting trained successfully on 20202 samples with 2 classes
2025-11-01 04:16:45.525 | INFO     | src.ai_engine.ai_models:fit:373 - Training pattern_based...
2025-11-01 04:16:45.568 | INFO     | src.ai_engine.ai_models:fit:373 - Training lstm...
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\keras\src\layers\rnn\rnn.py:199: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(**kwargs)
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1108: RuntimeWarning: invalid value encountered in divide
  updated_mean = (last_sum + new_sum) / updated_sample_count
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1113: RuntimeWarning: invalid value encountered in divide
  T = new_sum / new_sample_count
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1133: RuntimeWarning: invalid value encountered in divide
  new_unnormalized_variance -= correction**2 / new_sample_count
Epoch 1/50
567/567 ━━━━━━━━━━━━━━━━━━━━ 174s 55ms/step - accuracy: 0.7770 - loss: 0.6336 - val_accuracy: 0.7654 - val_loss: 0.5943
Epoch 2/50
567/567 ━━━━━━━━━━━━━━━━━━━━ 22s 38ms/step - accuracy: 0.7770 - loss: 0.5648 - val_accuracy: 0.7654 - val_loss: 0.5574
Epoch 3/50
567/567 ━━━━━━━━━━━━━━━━━━━━ 21s 37ms/step - accuracy: 0.7770 - loss: 0.5400 - val_accuracy: 0.7654 - val_loss: 0.5468
Epoch 4/50
567/567 ━━━━━━━━━━━━━━━━━━━━ 21s 36ms/step - accuracy: 0.7770 - loss: 0.5327 - val_accuracy: 0.7654 - val_loss: 0.5449
Epoch 5/50
567/567 ━━━━━━━━━━━━━━━━━━━━ 20s 36ms/step - accuracy: 0.7770 - loss: 0.5310 - val_accuracy: 0.7654 - val_loss: 0.5449
Epoch 6/50
567/567 ━━━━━━━━━━━━━━━━━━━━ 20s 36ms/step - accuracy: 0.7770 - loss: 0.5307 - val_accuracy: 0.7654 - val_loss: 0.5450
Epoch 7/50
567/567 ━━━━━━━━━━━━━━━━━━━━ 21s 36ms/step - accuracy: 0.7770 - loss: 0.5307 - val_accuracy: 0.7654 - val_loss: 0.5451
Epoch 8/50
567/567 ━━━━━━━━━━━━━━━━━━━━ 21s 36ms/step - accuracy: 0.7770 - loss: 0.5307 - val_accuracy: 0.7654 - val_loss: 0.5452
Epoch 9/50
567/567 ━━━━━━━━━━━━━━━━━━━━ 20s 36ms/step - accuracy: 0.7770 - loss: 0.5307 - val_accuracy: 0.7654 - val_loss: 0.5452
Epoch 10/50
567/567 ━━━━━━━━━━━━━━━━━━━━ 21s 36ms/step - accuracy: 0.7770 - loss: 0.5307 - val_accuracy: 0.7654 - val_loss: 0.5452
Epoch 11/50
567/567 ━━━━━━━━━━━━━━━━━━━━ 20s 36ms/step - accuracy: 0.7770 - loss: 0.5307 - val_accuracy: 0.7654 - val_loss: 0.5452
Epoch 12/50
567/567 ━━━━━━━━━━━━━━━━━━━━ 21s 36ms/step - accuracy: 0.7770 - loss: 0.5307 - val_accuracy: 0.7654 - val_loss: 0.5453
Epoch 13/50
567/567 ━━━━━━━━━━━━━━━━━━━━ 20s 36ms/step - accuracy: 0.7770 - loss: 0.5307 - val_accuracy: 0.7654 - val_loss: 0.5452
Epoch 14/50
567/567 ━━━━━━━━━━━━━━━━━━━━ 20s 36ms/step - accuracy: 0.7770 - loss: 0.5307 - val_accuracy: 0.7654 - val_loss: 0.5452
2025-11-01 04:24:20.775 | INFO     | src.ai_engine.ai_models:fit:685 - LSTM trained successfully.
2025-11-01 04:24:20.853 | INFO     | src.ai_engine.ai_models:fit:381 - Generating base model predictions for meta-model training...
2025-11-01 04:24:22.198 | INFO     | src.ai_engine.feature_engineering:create_sequences:261 - Creating sequences with length 50 from 20202 data points.
2025-11-01 04:24:22.433 | INFO     | src.ai_engine.feature_engineering:create_sequences:270 - Created 20152 sequences.
630/630 ━━━━━━━━━━━━━━━━━━━━ 16s 20ms/step
2025-11-01 04:24:41.004 | INFO     | src.ai_engine.ai_models:fit:396 - Training meta-model...
2025-11-01 04:24:41.018 | SUCCESS  | src.ai_engine.ai_models:fit:399 - Stacking Ensemble trained successfully.
2025-11-01 04:24:41.020 | SUCCESS  | __main__:main:167 - Final Ensemble model trained.
2025-11-01 04:24:41.021 | INFO     | __main__:main:171 - Saving models to 'models\PainX_999\15m'...
2025-11-01 04:24:41.670 | INFO     | src.ai_engine.ai_models:save:52 - Model RandomForest saved to models\PainX_999\15m\random_forest.pkl
2025-11-01 04:24:41.775 | INFO     | src.ai_engine.ai_models:save:52 - Model GradientBoosting saved to models\PainX_999\15m\gradient_boosting.pkl
2025-11-01 04:24:42.285 | INFO     | src.ai_engine.ai_models:save:731 - LSTM model saved to models\PainX_999\15m\lstm.keras, models\PainX_999\15m\lstm_scaler.pkl and marker file models\PainX_999\15m\lstm.pkl
2025-11-01 04:24:42.289 | INFO     | src.ai_engine.ai_models:save_all:463 - Meta-model saved to models\PainX_999\15m\meta_model.pkl
2025-11-01 04:24:42.292 | SUCCESS  | __main__:main:174 - --- Finished training for Symbol: PainX 999, Timeframe: 15m ---
2025-11-01 04:24:42.294 | INFO     | __main__:main:140 - --- Starting training for Symbol: PainX 999, Timeframe: 1d ---
2025-11-01 04:24:42.425 | SUCCESS  | __main__:main:148 - Loaded 302 records.
2025-11-01 04:24:42.426 | INFO     | __main__:prepare_training_data:32 - Preparing data for training with Meta-Labeling...
2025-11-01 04:24:42.584 | DEBUG    | src.ai_engine.technical_indicators:calculate_all:47 - Calculated 62 technical indicators
2025-11-01 04:24:42.895 | DEBUG    | src.ai_engine.feature_engineering:extract_features:66 - Extracted 116 features
2025-11-01 04:24:42.896 | INFO     | __main__:prepare_training_data:39 - Generating signals from primary model (SimplePatternModel)...
2025-11-01 04:24:42.902 | WARNING  | src.ai_engine.feature_engineering:prepare_for_model:230 - Se perdieron todos los datos al eliminar los NaN. Se conservarán los datos rellenados.
2025-11-01 04:24:42.961 | INFO     | src.ai_engine.ai_models:calculate_optimal_threshold:549 - Calculated optimal threshold: 0.0117 (volatility: 0.0038, avg_movement: 0.0166)
2025-11-01 04:24:42.962 | INFO     | src.ai_engine.ai_models:create_meta_labels:577 - Creating meta-labels for secondary model...
2025-11-01 04:24:42.996 | INFO     | src.ai_engine.ai_models:create_meta_labels:629 - Meta-Label distribution - Profitable: 72 (59.5%), Unprofitable: 49 (40.5%)
2025-11-01 04:24:43.029 | WARNING  | src.ai_engine.feature_engineering:prepare_for_model:230 - Se perdieron todos los datos al eliminar los NaN. Se conservarán los datos rellenados.
2025-11-01 04:24:43.078 | INFO     | __main__:prepare_training_data:75 - Data preparation complete. Shape of X: (193, 116), Shape of y: (193,)
2025-11-01 04:24:43.090 | INFO     | src.ai_engine.feature_engineering:create_sequences:261 - Creating sequences with length 50 from 193 data points.
2025-11-01 04:24:43.096 | INFO     | src.ai_engine.feature_engineering:create_sequences:270 - Created 143 sequences.
2025-11-01 04:24:43.166 | INFO     | __main__:main:164 - Initializing and training Ensemble model...
2025-11-01 04:24:43.166 | INFO     | src.ai_engine.ai_models:__init__:304 - Initialized Stacking Ensemble with Logistic Regression as meta-model.
2025-11-01 04:24:43.214 | INFO     | src.ai_engine.ai_models:fit:359 - Creating LSTM model...
2025-11-01 04:24:43.215 | INFO     | src.ai_engine.ai_models:fit:364 - Training base models...
2025-11-01 04:24:43.218 | INFO     | src.ai_engine.ai_models:fit:373 - Training random_forest...
2025-11-01 04:24:44.487 | INFO     | src.ai_engine.ai_models:fit:98 - RandomForest trained successfully on 193 samples with 2 classes
2025-11-01 04:24:44.488 | INFO     | src.ai_engine.ai_models:fit:373 - Training gradient_boosting...
2025-11-01 04:24:46.375 | INFO     | src.ai_engine.ai_models:fit:157 - GradientBoosting trained successfully on 193 samples with 2 classes
2025-11-01 04:24:46.375 | INFO     | src.ai_engine.ai_models:fit:373 - Training pattern_based...
2025-11-01 04:24:46.377 | INFO     | src.ai_engine.ai_models:fit:373 - Training lstm...
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\keras\src\layers\rnn\rnn.py:199: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(**kwargs)
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1108: RuntimeWarning: invalid value encountered in divide
  updated_mean = (last_sum + new_sum) / updated_sample_count
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1113: RuntimeWarning: invalid value encountered in divide
  T = new_sum / new_sample_count
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1133: RuntimeWarning: invalid value encountered in divide
  new_unnormalized_variance -= correction**2 / new_sample_count
Epoch 1/50
4/4 ━━━━━━━━━━━━━━━━━━━━ 47s 2s/step - accuracy: 0.5703 - loss: 0.6931 - val_accuracy: 0.8667 - val_loss: 0.6924
Epoch 2/50
4/4 ━━━━━━━━━━━━━━━━━━━━ 1s 201ms/step - accuracy: 0.5703 - loss: 0.6929 - val_accuracy: 0.8667 - val_loss: 0.6912
Epoch 3/50
4/4 ━━━━━━━━━━━━━━━━━━━━ 0s 95ms/step - accuracy: 0.5703 - loss: 0.6927 - val_accuracy: 0.8667 - val_loss: 0.6900
Epoch 4/50
4/4 ━━━━━━━━━━━━━━━━━━━━ 1s 186ms/step - accuracy: 0.5703 - loss: 0.6925 - val_accuracy: 0.8667 - val_loss: 0.6888
Epoch 5/50
4/4 ━━━━━━━━━━━━━━━━━━━━ 1s 121ms/step - accuracy: 0.5703 - loss: 0.6923 - val_accuracy: 0.8667 - val_loss: 0.6878
Epoch 6/50
4/4 ━━━━━━━━━━━━━━━━━━━━ 0s 116ms/step - accuracy: 0.5703 - loss: 0.6920 - val_accuracy: 0.8667 - val_loss: 0.6869
Epoch 7/50
4/4 ━━━━━━━━━━━━━━━━━━━━ 0s 105ms/step - accuracy: 0.5703 - loss: 0.6919 - val_accuracy: 0.8667 - val_loss: 0.6859
Epoch 8/50
4/4 ━━━━━━━━━━━━━━━━━━━━ 0s 83ms/step - accuracy: 0.5703 - loss: 0.6917 - val_accuracy: 0.8667 - val_loss: 0.6850
Epoch 9/50
4/4 ━━━━━━━━━━━━━━━━━━━━ 0s 50ms/step - accuracy: 0.5703 - loss: 0.6916 - val_accuracy: 0.8667 - val_loss: 0.6840
Epoch 10/50
4/4 ━━━━━━━━━━━━━━━━━━━━ 0s 51ms/step - accuracy: 0.5703 - loss: 0.6914 - val_accuracy: 0.8667 - val_loss: 0.6829
Epoch 11/50
4/4 ━━━━━━━━━━━━━━━━━━━━ 0s 55ms/step - accuracy: 0.5703 - loss: 0.6912 - val_accuracy: 0.8667 - val_loss: 0.6820
Epoch 12/50
4/4 ━━━━━━━━━━━━━━━━━━━━ 0s 74ms/step - accuracy: 0.5703 - loss: 0.6910 - val_accuracy: 0.8667 - val_loss: 0.6811
Epoch 13/50
4/4 ━━━━━━━━━━━━━━━━━━━━ 0s 50ms/step - accuracy: 0.5703 - loss: 0.6909 - val_accuracy: 0.8667 - val_loss: 0.6802
Epoch 14/50
4/4 ━━━━━━━━━━━━━━━━━━━━ 0s 51ms/step - accuracy: 0.5703 - loss: 0.6907 - val_accuracy: 0.8667 - val_loss: 0.6793
Epoch 15/50
4/4 ━━━━━━━━━━━━━━━━━━━━ 0s 61ms/step - accuracy: 0.5703 - loss: 0.6906 - val_accuracy: 0.8667 - val_loss: 0.6784
Epoch 16/50
4/4 ━━━━━━━━━━━━━━━━━━━━ 0s 50ms/step - accuracy: 0.5703 - loss: 0.6904 - val_accuracy: 0.8667 - val_loss: 0.6775
Epoch 17/50
4/4 ━━━━━━━━━━━━━━━━━━━━ 0s 52ms/step - accuracy: 0.5703 - loss: 0.6903 - val_accuracy: 0.8667 - val_loss: 0.6765
Epoch 18/50
4/4 ━━━━━━━━━━━━━━━━━━━━ 0s 51ms/step - accuracy: 0.5703 - loss: 0.6901 - val_accuracy: 0.8667 - val_loss: 0.6756
Epoch 19/50
4/4 ━━━━━━━━━━━━━━━━━━━━ 0s 51ms/step - accuracy: 0.5703 - loss: 0.6900 - val_accuracy: 0.8667 - val_loss: 0.6747
Epoch 20/50
4/4 ━━━━━━━━━━━━━━━━━━━━ 0s 59ms/step - accuracy: 0.5703 - loss: 0.6899 - val_accuracy: 0.8667 - val_loss: 0.6737
Epoch 21/50
4/4 ━━━━━━━━━━━━━━━━━━━━ 0s 51ms/step - accuracy: 0.5703 - loss: 0.6897 - val_accuracy: 0.8667 - val_loss: 0.6729
Epoch 22/50
4/4 ━━━━━━━━━━━━━━━━━━━━ 0s 51ms/step - accuracy: 0.5703 - loss: 0.6895 - val_accuracy: 0.8667 - val_loss: 0.6721
Epoch 23/50
4/4 ━━━━━━━━━━━━━━━━━━━━ 0s 50ms/step - accuracy: 0.5703 - loss: 0.6894 - val_accuracy: 0.8667 - val_loss: 0.6713
Epoch 24/50
4/4 ━━━━━━━━━━━━━━━━━━━━ 0s 56ms/step - accuracy: 0.5703 - loss: 0.6893 - val_accuracy: 0.8667 - val_loss: 0.6704
Epoch 25/50
4/4 ━━━━━━━━━━━━━━━━━━━━ 0s 51ms/step - accuracy: 0.5703 - loss: 0.6892 - val_accuracy: 0.8667 - val_loss: 0.6696
Epoch 26/50
4/4 ━━━━━━━━━━━━━━━━━━━━ 0s 59ms/step - accuracy: 0.5703 - loss: 0.6890 - val_accuracy: 0.8667 - val_loss: 0.6688
Epoch 27/50
4/4 ━━━━━━━━━━━━━━━━━━━━ 0s 52ms/step - accuracy: 0.5703 - loss: 0.6889 - val_accuracy: 0.8667 - val_loss: 0.6680
Epoch 28/50
4/4 ━━━━━━━━━━━━━━━━━━━━ 0s 52ms/step - accuracy: 0.5703 - loss: 0.6888 - val_accuracy: 0.8667 - val_loss: 0.6672
Epoch 29/50
4/4 ━━━━━━━━━━━━━━━━━━━━ 0s 50ms/step - accuracy: 0.5703 - loss: 0.6887 - val_accuracy: 0.8667 - val_loss: 0.6663
Epoch 30/50
4/4 ━━━━━━━━━━━━━━━━━━━━ 0s 51ms/step - accuracy: 0.5703 - loss: 0.6885 - val_accuracy: 0.8667 - val_loss: 0.6656
Epoch 31/50
4/4 ━━━━━━━━━━━━━━━━━━━━ 0s 51ms/step - accuracy: 0.5703 - loss: 0.6884 - val_accuracy: 0.8667 - val_loss: 0.6649
Epoch 32/50
4/4 ━━━━━━━━━━━━━━━━━━━━ 0s 51ms/step - accuracy: 0.5703 - loss: 0.6883 - val_accuracy: 0.8667 - val_loss: 0.6642
Epoch 33/50
4/4 ━━━━━━━━━━━━━━━━━━━━ 0s 53ms/step - accuracy: 0.5703 - loss: 0.6882 - val_accuracy: 0.8667 - val_loss: 0.6633
Epoch 34/50
4/4 ━━━━━━━━━━━━━━━━━━━━ 0s 51ms/step - accuracy: 0.5703 - loss: 0.6881 - val_accuracy: 0.8667 - val_loss: 0.6625
Epoch 35/50
4/4 ━━━━━━━━━━━━━━━━━━━━ 0s 51ms/step - accuracy: 0.5703 - loss: 0.6880 - val_accuracy: 0.8667 - val_loss: 0.6618
Epoch 36/50
4/4 ━━━━━━━━━━━━━━━━━━━━ 0s 50ms/step - accuracy: 0.5703 - loss: 0.6879 - val_accuracy: 0.8667 - val_loss: 0.6611
Epoch 37/50
4/4 ━━━━━━━━━━━━━━━━━━━━ 0s 52ms/step - accuracy: 0.5703 - loss: 0.6878 - val_accuracy: 0.8667 - val_loss: 0.6603
Epoch 38/50
4/4 ━━━━━━━━━━━━━━━━━━━━ 0s 51ms/step - accuracy: 0.5703 - loss: 0.6877 - val_accuracy: 0.8667 - val_loss: 0.6596
Epoch 39/50
4/4 ━━━━━━━━━━━━━━━━━━━━ 0s 81ms/step - accuracy: 0.5703 - loss: 0.6876 - val_accuracy: 0.8667 - val_loss: 0.6588
Epoch 40/50
4/4 ━━━━━━━━━━━━━━━━━━━━ 0s 50ms/step - accuracy: 0.5703 - loss: 0.6875 - val_accuracy: 0.8667 - val_loss: 0.6581
Epoch 41/50
4/4 ━━━━━━━━━━━━━━━━━━━━ 0s 52ms/step - accuracy: 0.5703 - loss: 0.6874 - val_accuracy: 0.8667 - val_loss: 0.6574
Epoch 42/50
4/4 ━━━━━━━━━━━━━━━━━━━━ 0s 60ms/step - accuracy: 0.5703 - loss: 0.6873 - val_accuracy: 0.8667 - val_loss: 0.6567
Epoch 43/50
4/4 ━━━━━━━━━━━━━━━━━━━━ 0s 51ms/step - accuracy: 0.5703 - loss: 0.6872 - val_accuracy: 0.8667 - val_loss: 0.6559
Epoch 44/50
4/4 ━━━━━━━━━━━━━━━━━━━━ 0s 50ms/step - accuracy: 0.5703 - loss: 0.6871 - val_accuracy: 0.8667 - val_loss: 0.6554
Epoch 45/50
4/4 ━━━━━━━━━━━━━━━━━━━━ 0s 52ms/step - accuracy: 0.5703 - loss: 0.6870 - val_accuracy: 0.8667 - val_loss: 0.6547
Epoch 46/50
4/4 ━━━━━━━━━━━━━━━━━━━━ 0s 50ms/step - accuracy: 0.5703 - loss: 0.6870 - val_accuracy: 0.8667 - val_loss: 0.6540
Epoch 47/50
4/4 ━━━━━━━━━━━━━━━━━━━━ 0s 50ms/step - accuracy: 0.5703 - loss: 0.6868 - val_accuracy: 0.8667 - val_loss: 0.6534
Epoch 48/50
4/4 ━━━━━━━━━━━━━━━━━━━━ 0s 60ms/step - accuracy: 0.5703 - loss: 0.6868 - val_accuracy: 0.8667 - val_loss: 0.6528
Epoch 49/50
4/4 ━━━━━━━━━━━━━━━━━━━━ 0s 51ms/step - accuracy: 0.5703 - loss: 0.6867 - val_accuracy: 0.8667 - val_loss: 0.6522
Epoch 50/50
4/4 ━━━━━━━━━━━━━━━━━━━━ 0s 50ms/step - accuracy: 0.5703 - loss: 0.6866 - val_accuracy: 0.8667 - val_loss: 0.6516
2025-11-01 04:25:48.741 | INFO     | src.ai_engine.ai_models:fit:685 - LSTM trained successfully.
2025-11-01 04:25:48.742 | INFO     | src.ai_engine.ai_models:fit:381 - Generating base model predictions for meta-model training...
2025-11-01 04:25:48.830 | INFO     | src.ai_engine.feature_engineering:create_sequences:261 - Creating sequences with length 50 from 193 data points.
2025-11-01 04:25:48.838 | INFO     | src.ai_engine.feature_engineering:create_sequences:270 - Created 143 sequences.
5/5 ━━━━━━━━━━━━━━━━━━━━ 33s 128ms/step
2025-11-01 04:26:22.701 | INFO     | src.ai_engine.ai_models:fit:396 - Training meta-model...
2025-11-01 04:26:22.731 | SUCCESS  | src.ai_engine.ai_models:fit:399 - Stacking Ensemble trained successfully.
2025-11-01 04:26:22.733 | SUCCESS  | __main__:main:167 - Final Ensemble model trained.
2025-11-01 04:26:22.735 | INFO     | __main__:main:171 - Saving models to 'models\PainX_999\1d'...
2025-11-01 04:26:22.968 | INFO     | src.ai_engine.ai_models:save:52 - Model RandomForest saved to models\PainX_999\1d\random_forest.pkl
2025-11-01 04:26:23.074 | INFO     | src.ai_engine.ai_models:save:52 - Model GradientBoosting saved to models\PainX_999\1d\gradient_boosting.pkl
2025-11-01 04:26:23.385 | INFO     | src.ai_engine.ai_models:save:731 - LSTM model saved to models\PainX_999\1d\lstm.keras, models\PainX_999\1d\lstm_scaler.pkl and marker file models\PainX_999\1d\lstm.pkl
2025-11-01 04:26:23.389 | INFO     | src.ai_engine.ai_models:save_all:463 - Meta-model saved to models\PainX_999\1d\meta_model.pkl
2025-11-01 04:26:23.392 | SUCCESS  | __main__:main:174 - --- Finished training for Symbol: PainX 999, Timeframe: 1d ---
2025-11-01 04:26:23.394 | INFO     | __main__:main:140 - --- Starting training for Symbol: PainX 999, Timeframe: 1h ---
2025-11-01 04:26:23.481 | SUCCESS  | __main__:main:148 - Loaded 7227 records.
2025-11-01 04:26:23.482 | INFO     | __main__:prepare_training_data:32 - Preparing data for training with Meta-Labeling...
2025-11-01 04:26:23.955 | DEBUG    | src.ai_engine.technical_indicators:calculate_all:47 - Calculated 63 technical indicators
2025-11-01 04:26:25.201 | DEBUG    | src.ai_engine.feature_engineering:extract_features:66 - Extracted 116 features
2025-11-01 04:26:25.202 | INFO     | __main__:prepare_training_data:39 - Generating signals from primary model (SimplePatternModel)...
2025-11-01 04:26:25.221 | WARNING  | src.ai_engine.feature_engineering:prepare_for_model:230 - Se perdieron todos los datos al eliminar los NaN. Se conservarán los datos rellenados.
2025-11-01 04:26:26.389 | INFO     | src.ai_engine.ai_models:calculate_optimal_threshold:549 - Calculated optimal threshold: 0.0024 (volatility: 0.0008, avg_movement: 0.0034)
2025-11-01 04:26:26.390 | INFO     | src.ai_engine.ai_models:create_meta_labels:577 - Creating meta-labels for secondary model...
2025-11-01 04:26:27.257 | INFO     | src.ai_engine.ai_models:create_meta_labels:629 - Meta-Label distribution - Profitable: 1086 (32.7%), Unprofitable: 2236 (67.3%)
2025-11-01 04:26:27.282 | WARNING  | src.ai_engine.feature_engineering:prepare_for_model:230 - Se perdieron todos los datos al eliminar los NaN. Se conservarán los datos rellenados.
2025-11-01 04:26:27.293 | INFO     | __main__:prepare_training_data:75 - Data preparation complete. Shape of X: (5046, 116), Shape of y: (5046,)
2025-11-01 04:26:27.297 | INFO     | src.ai_engine.feature_engineering:create_sequences:261 - Creating sequences with length 50 from 5046 data points.
2025-11-01 04:26:27.355 | INFO     | src.ai_engine.feature_engineering:create_sequences:270 - Created 4996 sequences.
2025-11-01 04:26:27.357 | INFO     | __main__:main:164 - Initializing and training Ensemble model...
2025-11-01 04:26:27.358 | INFO     | src.ai_engine.ai_models:__init__:304 - Initialized Stacking Ensemble with Logistic Regression as meta-model.
2025-11-01 04:26:27.362 | INFO     | src.ai_engine.ai_models:fit:359 - Creating LSTM model...
2025-11-01 04:26:27.362 | INFO     | src.ai_engine.ai_models:fit:364 - Training base models...
2025-11-01 04:26:27.370 | INFO     | src.ai_engine.ai_models:fit:373 - Training random_forest...
2025-11-01 04:26:29.323 | INFO     | src.ai_engine.ai_models:fit:98 - RandomForest trained successfully on 5046 samples with 2 classes
2025-11-01 04:26:29.323 | INFO     | src.ai_engine.ai_models:fit:373 - Training gradient_boosting...
2025-11-01 04:27:20.363 | INFO     | src.ai_engine.ai_models:fit:157 - GradientBoosting trained successfully on 5046 samples with 2 classes
2025-11-01 04:27:20.364 | INFO     | src.ai_engine.ai_models:fit:373 - Training pattern_based...
2025-11-01 04:27:20.365 | INFO     | src.ai_engine.ai_models:fit:373 - Training lstm...
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\keras\src\layers\rnn\rnn.py:199: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(**kwargs)
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1108: RuntimeWarning: invalid value encountered in divide
  updated_mean = (last_sum + new_sum) / updated_sample_count
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1113: RuntimeWarning: invalid value encountered in divide
  T = new_sum / new_sample_count
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1133: RuntimeWarning: invalid value encountered in divide
  new_unnormalized_variance -= correction**2 / new_sample_count
Epoch 1/50
141/141 ━━━━━━━━━━━━━━━━━━━━ 55s 75ms/step - accuracy: 0.7834 - loss: 0.6747 - val_accuracy: 0.7760 - val_loss: 0.6581
Epoch 2/50
141/141 ━━━━━━━━━━━━━━━━━━━━ 6s 43ms/step - accuracy: 0.7834 - loss: 0.6421 - val_accuracy: 0.7760 - val_loss: 0.6297
Epoch 3/50
141/141 ━━━━━━━━━━━━━━━━━━━━ 6s 38ms/step - accuracy: 0.7834 - loss: 0.6156 - val_accuracy: 0.7760 - val_loss: 0.6070
Epoch 4/50
141/141 ━━━━━━━━━━━━━━━━━━━━ 5s 38ms/step - accuracy: 0.7834 - loss: 0.5944 - val_accuracy: 0.7760 - val_loss: 0.5885
Epoch 5/50
141/141 ━━━━━━━━━━━━━━━━━━━━ 6s 40ms/step - accuracy: 0.7834 - loss: 0.5774 - val_accuracy: 0.7760 - val_loss: 0.5745
Epoch 6/50
141/141 ━━━━━━━━━━━━━━━━━━━━ 5s 37ms/step - accuracy: 0.7834 - loss: 0.5640 - val_accuracy: 0.7760 - val_loss: 0.5631
Epoch 7/50
141/141 ━━━━━━━━━━━━━━━━━━━━ 5s 37ms/step - accuracy: 0.7834 - loss: 0.5535 - val_accuracy: 0.7760 - val_loss: 0.5546
Epoch 8/50
141/141 ━━━━━━━━━━━━━━━━━━━━ 5s 38ms/step - accuracy: 0.7834 - loss: 0.5454 - val_accuracy: 0.7760 - val_loss: 0.5481
Epoch 9/50
141/141 ━━━━━━━━━━━━━━━━━━━━ 5s 37ms/step - accuracy: 0.7834 - loss: 0.5392 - val_accuracy: 0.7760 - val_loss: 0.5432
Epoch 10/50
141/141 ━━━━━━━━━━━━━━━━━━━━ 5s 37ms/step - accuracy: 0.7834 - loss: 0.5346 - val_accuracy: 0.7760 - val_loss: 0.5397
Epoch 11/50
141/141 ━━━━━━━━━━━━━━━━━━━━ 5s 36ms/step - accuracy: 0.7834 - loss: 0.5311 - val_accuracy: 0.7760 - val_loss: 0.5370
Epoch 12/50
141/141 ━━━━━━━━━━━━━━━━━━━━ 5s 36ms/step - accuracy: 0.7834 - loss: 0.5286 - val_accuracy: 0.7760 - val_loss: 0.5352
Epoch 13/50
141/141 ━━━━━━━━━━━━━━━━━━━━ 5s 37ms/step - accuracy: 0.7834 - loss: 0.5267 - val_accuracy: 0.7760 - val_loss: 0.5340
Epoch 14/50
141/141 ━━━━━━━━━━━━━━━━━━━━ 5s 37ms/step - accuracy: 0.7834 - loss: 0.5254 - val_accuracy: 0.7760 - val_loss: 0.5331
Epoch 15/50
141/141 ━━━━━━━━━━━━━━━━━━━━ 5s 36ms/step - accuracy: 0.7834 - loss: 0.5245 - val_accuracy: 0.7760 - val_loss: 0.5326
Epoch 16/50
141/141 ━━━━━━━━━━━━━━━━━━━━ 5s 37ms/step - accuracy: 0.7834 - loss: 0.5238 - val_accuracy: 0.7760 - val_loss: 0.5322
Epoch 17/50
141/141 ━━━━━━━━━━━━━━━━━━━━ 5s 37ms/step - accuracy: 0.7834 - loss: 0.5234 - val_accuracy: 0.7760 - val_loss: 0.5321
Epoch 18/50
141/141 ━━━━━━━━━━━━━━━━━━━━ 5s 37ms/step - accuracy: 0.7834 - loss: 0.5231 - val_accuracy: 0.7760 - val_loss: 0.5320
Epoch 19/50
141/141 ━━━━━━━━━━━━━━━━━━━━ 5s 37ms/step - accuracy: 0.7834 - loss: 0.5229 - val_accuracy: 0.7760 - val_loss: 0.5319
Epoch 20/50
141/141 ━━━━━━━━━━━━━━━━━━━━ 5s 37ms/step - accuracy: 0.7834 - loss: 0.5228 - val_accuracy: 0.7760 - val_loss: 0.5319
Epoch 21/50
141/141 ━━━━━━━━━━━━━━━━━━━━ 5s 36ms/step - accuracy: 0.7834 - loss: 0.5228 - val_accuracy: 0.7760 - val_loss: 0.5319
Epoch 22/50
141/141 ━━━━━━━━━━━━━━━━━━━━ 5s 36ms/step - accuracy: 0.7834 - loss: 0.5227 - val_accuracy: 0.7760 - val_loss: 0.5320
Epoch 23/50
141/141 ━━━━━━━━━━━━━━━━━━━━ 5s 36ms/step - accuracy: 0.7834 - loss: 0.5227 - val_accuracy: 0.7760 - val_loss: 0.5320
Epoch 24/50
141/141 ━━━━━━━━━━━━━━━━━━━━ 5s 36ms/step - accuracy: 0.7834 - loss: 0.5227 - val_accuracy: 0.7760 - val_loss: 0.5320
Epoch 25/50
141/141 ━━━━━━━━━━━━━━━━━━━━ 5s 36ms/step - accuracy: 0.7834 - loss: 0.5227 - val_accuracy: 0.7760 - val_loss: 0.5320
Epoch 26/50
141/141 ━━━━━━━━━━━━━━━━━━━━ 5s 36ms/step - accuracy: 0.7834 - loss: 0.5226 - val_accuracy: 0.7760 - val_loss: 0.5320
Epoch 27/50
141/141 ━━━━━━━━━━━━━━━━━━━━ 5s 37ms/step - accuracy: 0.7834 - loss: 0.5227 - val_accuracy: 0.7760 - val_loss: 0.5320
Epoch 28/50
141/141 ━━━━━━━━━━━━━━━━━━━━ 5s 36ms/step - accuracy: 0.7834 - loss: 0.5226 - val_accuracy: 0.7760 - val_loss: 0.5320
Epoch 29/50
141/141 ━━━━━━━━━━━━━━━━━━━━ 5s 37ms/step - accuracy: 0.7834 - loss: 0.5227 - val_accuracy: 0.7760 - val_loss: 0.5321
Epoch 30/50
141/141 ━━━━━━━━━━━━━━━━━━━━ 5s 36ms/step - accuracy: 0.7834 - loss: 0.5226 - val_accuracy: 0.7760 - val_loss: 0.5321
2025-11-01 04:30:49.495 | INFO     | src.ai_engine.ai_models:fit:685 - LSTM trained successfully.
2025-11-01 04:30:49.505 | INFO     | src.ai_engine.ai_models:fit:381 - Generating base model predictions for meta-model training...
2025-11-01 04:30:49.921 | INFO     | src.ai_engine.feature_engineering:create_sequences:261 - Creating sequences with length 50 from 5046 data points.
2025-11-01 04:30:49.978 | INFO     | src.ai_engine.feature_engineering:create_sequences:270 - Created 4996 sequences.
157/157 ━━━━━━━━━━━━━━━━━━━━ 8s 40ms/step
2025-11-01 04:30:58.899 | INFO     | src.ai_engine.ai_models:fit:396 - Training meta-model...
2025-11-01 04:30:58.906 | SUCCESS  | src.ai_engine.ai_models:fit:399 - Stacking Ensemble trained successfully.
2025-11-01 04:30:58.907 | SUCCESS  | __main__:main:167 - Final Ensemble model trained.
2025-11-01 04:30:58.908 | INFO     | __main__:main:171 - Saving models to 'models\PainX_999\1h'...
2025-11-01 04:30:59.314 | INFO     | src.ai_engine.ai_models:save:52 - Model RandomForest saved to models\PainX_999\1h\random_forest.pkl
2025-11-01 04:30:59.408 | INFO     | src.ai_engine.ai_models:save:52 - Model GradientBoosting saved to models\PainX_999\1h\gradient_boosting.pkl
2025-11-01 04:30:59.472 | INFO     | src.ai_engine.ai_models:save:731 - LSTM model saved to models\PainX_999\1h\lstm.keras, models\PainX_999\1h\lstm_scaler.pkl and marker file models\PainX_999\1h\lstm.pkl
2025-11-01 04:30:59.473 | INFO     | src.ai_engine.ai_models:save_all:463 - Meta-model saved to models\PainX_999\1h\meta_model.pkl
2025-11-01 04:30:59.474 | SUCCESS  | __main__:main:174 - --- Finished training for Symbol: PainX 999, Timeframe: 1h ---
2025-11-01 04:30:59.566 | INFO     | __main__:main:140 - --- Starting training for Symbol: PainX 999, Timeframe: 1m ---
2025-11-01 04:31:00.159 | SUCCESS  | __main__:main:148 - Loaded 100001 records.
2025-11-01 04:31:00.160 | INFO     | __main__:prepare_training_data:32 - Preparing data for training with Meta-Labeling...
2025-11-01 04:31:05.803 | DEBUG    | src.ai_engine.technical_indicators:calculate_all:47 - Calculated 63 technical indicators
2025-11-01 04:31:22.562 | DEBUG    | src.ai_engine.feature_engineering:extract_features:66 - Extracted 116 features
2025-11-01 04:31:22.565 | INFO     | __main__:prepare_training_data:39 - Generating signals from primary model (SimplePatternModel)...
2025-11-01 04:31:22.771 | WARNING  | src.ai_engine.feature_engineering:prepare_for_model:230 - Se perdieron todos los datos al eliminar los NaN. Se conservarán los datos rellenados.
2025-11-01 04:31:38.582 | INFO     | src.ai_engine.ai_models:calculate_optimal_threshold:549 - Calculated optimal threshold: 0.0010 (volatility: 0.0001, avg_movement: 0.0004)
2025-11-01 04:31:38.584 | INFO     | src.ai_engine.ai_models:create_meta_labels:577 - Creating meta-labels for secondary model...
2025-11-01 04:31:50.637 | INFO     | src.ai_engine.ai_models:create_meta_labels:629 - Meta-Label distribution - Profitable: 92 (11.2%), Unprofitable: 731 (88.8%)
2025-11-01 04:31:50.879 | WARNING  | src.ai_engine.feature_engineering:prepare_for_model:230 - Se perdieron todos los datos al eliminar los NaN. Se conservarán los datos rellenados.
2025-11-01 04:31:50.973 | INFO     | __main__:prepare_training_data:75 - Data preparation complete. Shape of X: (54167, 116), Shape of y: (54167,)
2025-11-01 04:31:51.008 | INFO     | src.ai_engine.feature_engineering:create_sequences:261 - Creating sequences with length 50 from 54167 data points.
2025-11-01 04:31:51.627 | INFO     | src.ai_engine.feature_engineering:create_sequences:270 - Created 54117 sequences.
2025-11-01 04:31:51.642 | INFO     | __main__:main:164 - Initializing and training Ensemble model...
2025-11-01 04:31:51.643 | INFO     | src.ai_engine.ai_models:__init__:304 - Initialized Stacking Ensemble with Logistic Regression as meta-model.
2025-11-01 04:31:51.676 | INFO     | src.ai_engine.ai_models:fit:359 - Creating LSTM model...
2025-11-01 04:31:51.676 | INFO     | src.ai_engine.ai_models:fit:364 - Training base models...
2025-11-01 04:31:51.781 | INFO     | src.ai_engine.ai_models:fit:373 - Training random_forest...
2025-11-01 04:32:04.206 | INFO     | src.ai_engine.ai_models:fit:98 - RandomForest trained successfully on 54167 samples with 2 classes
2025-11-01 04:32:04.209 | INFO     | src.ai_engine.ai_models:fit:373 - Training gradient_boosting...
2025-11-01 04:41:07.557 | INFO     | src.ai_engine.ai_models:fit:157 - GradientBoosting trained successfully on 54167 samples with 2 classes
2025-11-01 04:41:07.561 | INFO     | src.ai_engine.ai_models:fit:373 - Training pattern_based...
2025-11-01 04:41:07.562 | INFO     | src.ai_engine.ai_models:fit:373 - Training lstm...
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\keras\src\layers\rnn\rnn.py:199: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(**kwargs)
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1108: RuntimeWarning: invalid value encountered in divide
  updated_mean = (last_sum + new_sum) / updated_sample_count
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1113: RuntimeWarning: invalid value encountered in divide
  T = new_sum / new_sample_count
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1133: RuntimeWarning: invalid value encountered in divide
  new_unnormalized_variance -= correction**2 / new_sample_count
Epoch 1/50
1523/1523 ━━━━━━━━━━━━━━━━━━━━ 245s 45ms/step - accuracy: 0.9983 - loss: 0.4280 - val_accuracy: 0.9987 - val_loss: 0.2491
Epoch 2/50
1523/1523 ━━━━━━━━━━━━━━━━━━━━ 57s 37ms/step - accuracy: 0.9983 - loss: 0.1677 - val_accuracy: 0.9987 - val_loss: 0.1086
Epoch 3/50
1523/1523 ━━━━━━━━━━━━━━━━━━━━ 57s 37ms/step - accuracy: 0.9983 - loss: 0.0790 - val_accuracy: 0.9987 - val_loss: 0.0546
Epoch 4/50
1523/1523 ━━━━━━━━━━━━━━━━━━━━ 55s 36ms/step - accuracy: 0.9983 - loss: 0.0426 - val_accuracy: 0.9987 - val_loss: 0.0307
Epoch 5/50
1523/1523 ━━━━━━━━━━━━━━━━━━━━ 55s 36ms/step - accuracy: 0.9983 - loss: 0.0262 - val_accuracy: 0.9987 - val_loss: 0.0194
Epoch 6/50
1523/1523 ━━━━━━━━━━━━━━━━━━━━ 56s 36ms/step - accuracy: 0.9983 - loss: 0.0185 - val_accuracy: 0.9987 - val_loss: 0.0141
Epoch 7/50
1523/1523 ━━━━━━━━━━━━━━━━━━━━ 55s 36ms/step - accuracy: 0.9983 - loss: 0.0150 - val_accuracy: 0.9987 - val_loss: 0.0117
Epoch 8/50
1523/1523 ━━━━━━━━━━━━━━━━━━━━ 55s 36ms/step - accuracy: 0.9983 - loss: 0.0136 - val_accuracy: 0.9987 - val_loss: 0.0107
Epoch 9/50
1523/1523 ━━━━━━━━━━━━━━━━━━━━ 55s 36ms/step - accuracy: 0.9983 - loss: 0.0131 - val_accuracy: 0.9987 - val_loss: 0.0103
Epoch 10/50
1523/1523 ━━━━━━━━━━━━━━━━━━━━ 60s 39ms/step - accuracy: 0.9983 - loss: 0.0130 - val_accuracy: 0.9987 - val_loss: 0.0102
Epoch 11/50
1523/1523 ━━━━━━━━━━━━━━━━━━━━ 55s 36ms/step - accuracy: 0.9983 - loss: 0.0129 - val_accuracy: 0.9987 - val_loss: 0.0101
Epoch 12/50
1523/1523 ━━━━━━━━━━━━━━━━━━━━ 55s 36ms/step - accuracy: 0.9983 - loss: 0.0129 - val_accuracy: 0.9987 - val_loss: 0.0100
Epoch 13/50
1523/1523 ━━━━━━━━━━━━━━━━━━━━ 54s 36ms/step - accuracy: 0.9983 - loss: 0.0128 - val_accuracy: 0.9987 - val_loss: 0.0100
Epoch 14/50
1523/1523 ━━━━━━━━━━━━━━━━━━━━ 61s 40ms/step - accuracy: 0.9983 - loss: 0.0128 - val_accuracy: 0.9987 - val_loss: 0.0100
Epoch 15/50
1523/1523 ━━━━━━━━━━━━━━━━━━━━ 54s 35ms/step - accuracy: 0.9983 - loss: 0.0128 - val_accuracy: 0.9987 - val_loss: 0.0100
Epoch 16/50
1523/1523 ━━━━━━━━━━━━━━━━━━━━ 55s 36ms/step - accuracy: 0.9983 - loss: 0.0128 - val_accuracy: 0.9987 - val_loss: 0.0100
Epoch 17/50
1523/1523 ━━━━━━━━━━━━━━━━━━━━ 54s 36ms/step - accuracy: 0.9983 - loss: 0.0128 - val_accuracy: 0.9987 - val_loss: 0.0100
Epoch 18/50
1523/1523 ━━━━━━━━━━━━━━━━━━━━ 55s 36ms/step - accuracy: 0.9983 - loss: 0.0128 - val_accuracy: 0.9987 - val_loss: 0.0100
Epoch 19/50
1523/1523 ━━━━━━━━━━━━━━━━━━━━ 54s 36ms/step - accuracy: 0.9983 - loss: 0.0128 - val_accuracy: 0.9987 - val_loss: 0.0100
Epoch 20/50
1523/1523 ━━━━━━━━━━━━━━━━━━━━ 54s 36ms/step - accuracy: 0.9983 - loss: 0.0128 - val_accuracy: 0.9987 - val_loss: 0.0100
Epoch 21/50
1523/1523 ━━━━━━━━━━━━━━━━━━━━ 55s 36ms/step - accuracy: 0.9983 - loss: 0.0128 - val_accuracy: 0.9987 - val_loss: 0.0100
Epoch 22/50
1523/1523 ━━━━━━━━━━━━━━━━━━━━ 54s 35ms/step - accuracy: 0.9983 - loss: 0.0128 - val_accuracy: 0.9987 - val_loss: 0.0100
Epoch 23/50
1523/1523 ━━━━━━━━━━━━━━━━━━━━ 55s 36ms/step - accuracy: 0.9983 - loss: 0.0128 - val_accuracy: 0.9987 - val_loss: 0.0100
Epoch 24/50
1523/1523 ━━━━━━━━━━━━━━━━━━━━ 54s 36ms/step - accuracy: 0.9983 - loss: 0.0128 - val_accuracy: 0.9987 - val_loss: 0.0100
Epoch 25/50
1523/1523 ━━━━━━━━━━━━━━━━━━━━ 55s 36ms/step - accuracy: 0.9983 - loss: 0.0128 - val_accuracy: 0.9987 - val_loss: 0.0100
Epoch 26/50
1523/1523 ━━━━━━━━━━━━━━━━━━━━ 82s 36ms/step - accuracy: 0.9983 - loss: 0.0128 - val_accuracy: 0.9987 - val_loss: 0.0100
Epoch 27/50
1523/1523 ━━━━━━━━━━━━━━━━━━━━ 55s 36ms/step - accuracy: 0.9983 - loss: 0.0128 - val_accuracy: 0.9987 - val_loss: 0.0100
Epoch 28/50
1523/1523 ━━━━━━━━━━━━━━━━━━━━ 55s 36ms/step - accuracy: 0.9983 - loss: 0.0128 - val_accuracy: 0.9987 - val_loss: 0.0100
Epoch 29/50
1523/1523 ━━━━━━━━━━━━━━━━━━━━ 55s 36ms/step - accuracy: 0.9983 - loss: 0.0128 - val_accuracy: 0.9987 - val_loss: 0.0100
Epoch 30/50
1523/1523 ━━━━━━━━━━━━━━━━━━━━ 54s 36ms/step - accuracy: 0.9983 - loss: 0.0128 - val_accuracy: 0.9987 - val_loss: 0.0100
Epoch 31/50
1523/1523 ━━━━━━━━━━━━━━━━━━━━ 55s 36ms/step - accuracy: 0.9983 - loss: 0.0128 - val_accuracy: 0.9987 - val_loss: 0.0100
Epoch 32/50
1523/1523 ━━━━━━━━━━━━━━━━━━━━ 55s 36ms/step - accuracy: 0.9983 - loss: 0.0128 - val_accuracy: 0.9987 - val_loss: 0.0100
Epoch 33/50
1523/1523 ━━━━━━━━━━━━━━━━━━━━ 54s 35ms/step - accuracy: 0.9983 - loss: 0.0128 - val_accuracy: 0.9987 - val_loss: 0.0100
Epoch 34/50
1523/1523 ━━━━━━━━━━━━━━━━━━━━ 54s 36ms/step - accuracy: 0.9983 - loss: 0.0128 - val_accuracy: 0.9987 - val_loss: 0.0100
Epoch 35/50
1523/1523 ━━━━━━━━━━━━━━━━━━━━ 54s 36ms/step - accuracy: 0.9983 - loss: 0.0128 - val_accuracy: 0.9987 - val_loss: 0.0100
Epoch 36/50
1523/1523 ━━━━━━━━━━━━━━━━━━━━ 68s 45ms/step - accuracy: 0.9983 - loss: 0.0128 - val_accuracy: 0.9987 - val_loss: 0.0100
Epoch 37/50
1523/1523 ━━━━━━━━━━━━━━━━━━━━ 55s 36ms/step - accuracy: 0.9983 - loss: 0.0128 - val_accuracy: 0.9987 - val_loss: 0.0100
Epoch 38/50
1523/1523 ━━━━━━━━━━━━━━━━━━━━ 54s 36ms/step - accuracy: 0.9983 - loss: 0.0128 - val_accuracy: 0.9987 - val_loss: 0.0100
Epoch 39/50
1523/1523 ━━━━━━━━━━━━━━━━━━━━ 89s 59ms/step - accuracy: 0.9983 - loss: 0.0128 - val_accuracy: 0.9987 - val_loss: 0.0100
2025-11-01 05:27:51.442 | INFO     | src.ai_engine.ai_models:fit:685 - LSTM trained successfully.
2025-11-01 05:27:52.205 | INFO     | src.ai_engine.ai_models:fit:381 - Generating base model predictions for meta-model training...
2025-11-01 05:28:00.071 | INFO     | src.ai_engine.feature_engineering:create_sequences:261 - Creating sequences with length 50 from 54167 data points.
2025-11-01 05:28:00.774 | INFO     | src.ai_engine.feature_engineering:create_sequences:270 - Created 54117 sequences.
1692/1692 ━━━━━━━━━━━━━━━━━━━━ 167s 39ms/step
2025-11-01 05:43:44.749 | INFO     | src.ai_engine.ai_models:fit:396 - Training meta-model...
2025-11-01 05:43:51.512 | SUCCESS  | src.ai_engine.ai_models:fit:399 - Stacking Ensemble trained successfully.
2025-11-01 05:43:52.634 | SUCCESS  | __main__:main:167 - Final Ensemble model trained.
2025-11-01 05:43:52.853 | INFO     | __main__:main:171 - Saving models to 'models\PainX_999\1m'...
2025-11-01 05:43:59.040 | INFO     | src.ai_engine.ai_models:save:52 - Model RandomForest saved to models\PainX_999\1m\random_forest.pkl
2025-11-01 05:44:01.048 | INFO     | src.ai_engine.ai_models:save:52 - Model GradientBoosting saved to models\PainX_999\1m\gradient_boosting.pkl
2025-11-01 05:44:09.515 | INFO     | src.ai_engine.ai_models:save:731 - LSTM model saved to models\PainX_999\1m\lstm.keras, models\PainX_999\1m\lstm_scaler.pkl and marker file models\PainX_999\1m\lstm.pkl
2025-11-01 05:44:09.591 | INFO     | src.ai_engine.ai_models:save_all:463 - Meta-model saved to models\PainX_999\1m\meta_model.pkl
2025-11-01 05:44:09.592 | SUCCESS  | __main__:main:174 - --- Finished training for Symbol: PainX 999, Timeframe: 1m ---
2025-11-01 05:44:09.648 | INFO     | __main__:main:140 - --- Starting training for Symbol: PainX 999, Timeframe: 4h ---
2025-11-01 05:44:12.951 | SUCCESS  | __main__:main:148 - Loaded 1809 records.
2025-11-01 05:44:12.953 | INFO     | __main__:prepare_training_data:32 - Preparing data for training with Meta-Labeling...
2025-11-01 05:44:16.381 | DEBUG    | src.ai_engine.technical_indicators:calculate_all:47 - Calculated 63 technical indicators
2025-11-01 05:44:18.244 | DEBUG    | src.ai_engine.feature_engineering:extract_features:66 - Extracted 116 features
2025-11-01 05:44:18.246 | INFO     | __main__:prepare_training_data:39 - Generating signals from primary model (SimplePatternModel)...
2025-11-01 05:44:18.446 | WARNING  | src.ai_engine.feature_engineering:prepare_for_model:230 - Se perdieron todos los datos al eliminar los NaN. Se conservarán los datos rellenados.
2025-11-01 05:44:19.827 | INFO     | src.ai_engine.ai_models:calculate_optimal_threshold:549 - Calculated optimal threshold: 0.0048 (volatility: 0.0015, avg_movement: 0.0068)
2025-11-01 05:44:19.827 | INFO     | src.ai_engine.ai_models:create_meta_labels:577 - Creating meta-labels for secondary model...
2025-11-01 05:44:20.061 | INFO     | src.ai_engine.ai_models:create_meta_labels:629 - Meta-Label distribution - Profitable: 342 (41.9%), Unprofitable: 475 (58.1%)
2025-11-01 05:44:20.415 | WARNING  | src.ai_engine.feature_engineering:prepare_for_model:230 - Se perdieron todos los datos al eliminar los NaN. Se conservarán los datos rellenados.
2025-11-01 05:44:20.465 | INFO     | __main__:prepare_training_data:75 - Data preparation complete. Shape of X: (1240, 116), Shape of y: (1240,)
2025-11-01 05:44:20.806 | INFO     | src.ai_engine.feature_engineering:create_sequences:261 - Creating sequences with length 50 from 1240 data points.
2025-11-01 05:44:20.858 | INFO     | src.ai_engine.feature_engineering:create_sequences:270 - Created 1190 sequences.
2025-11-01 05:44:21.316 | INFO     | __main__:main:164 - Initializing and training Ensemble model...
2025-11-01 05:44:21.366 | INFO     | src.ai_engine.ai_models:__init__:304 - Initialized Stacking Ensemble with Logistic Regression as meta-model.
2025-11-01 05:44:22.325 | INFO     | src.ai_engine.ai_models:fit:359 - Creating LSTM model...
2025-11-01 05:44:22.343 | INFO     | src.ai_engine.ai_models:fit:364 - Training base models...
2025-11-01 05:44:22.373 | INFO     | src.ai_engine.ai_models:fit:373 - Training random_forest...
2025-11-01 05:44:30.383 | INFO     | src.ai_engine.ai_models:fit:98 - RandomForest trained successfully on 1240 samples with 2 classes
2025-11-01 05:44:30.386 | INFO     | src.ai_engine.ai_models:fit:373 - Training gradient_boosting...
2025-11-01 05:44:44.796 | INFO     | src.ai_engine.ai_models:fit:157 - GradientBoosting trained successfully on 1240 samples with 2 classes
2025-11-01 05:44:44.796 | INFO     | src.ai_engine.ai_models:fit:373 - Training pattern_based...
2025-11-01 05:44:44.797 | INFO     | src.ai_engine.ai_models:fit:373 - Training lstm...
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\keras\src\layers\rnn\rnn.py:199: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(**kwargs)
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1108: RuntimeWarning: invalid value encountered in divide
  updated_mean = (last_sum + new_sum) / updated_sample_count
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1113: RuntimeWarning: invalid value encountered in divide
  T = new_sum / new_sample_count
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1133: RuntimeWarning: invalid value encountered in divide
  new_unnormalized_variance -= correction**2 / new_sample_count
Epoch 1/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 47s 216ms/step - accuracy: 0.7227 - loss: 0.6895 - val_accuracy: 0.7563 - val_loss: 0.6848
Epoch 2/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 3s 77ms/step - accuracy: 0.7227 - loss: 0.6826 - val_accuracy: 0.7563 - val_loss: 0.6770
Epoch 3/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 2s 50ms/step - accuracy: 0.7227 - loss: 0.6762 - val_accuracy: 0.7563 - val_loss: 0.6697
Epoch 4/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 2s 46ms/step - accuracy: 0.7227 - loss: 0.6701 - val_accuracy: 0.7563 - val_loss: 0.6630
Epoch 5/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 2s 44ms/step - accuracy: 0.7227 - loss: 0.6645 - val_accuracy: 0.7563 - val_loss: 0.6563
Epoch 6/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 2s 44ms/step - accuracy: 0.7227 - loss: 0.6591 - val_accuracy: 0.7563 - val_loss: 0.6503
Epoch 7/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 41ms/step - accuracy: 0.7227 - loss: 0.6541 - val_accuracy: 0.7563 - val_loss: 0.6443
Epoch 8/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 38ms/step - accuracy: 0.7227 - loss: 0.6494 - val_accuracy: 0.7563 - val_loss: 0.6390
Epoch 9/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 40ms/step - accuracy: 0.7227 - loss: 0.6449 - val_accuracy: 0.7563 - val_loss: 0.6340
Epoch 10/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 40ms/step - accuracy: 0.7227 - loss: 0.6409 - val_accuracy: 0.7563 - val_loss: 0.6288
Epoch 11/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 37ms/step - accuracy: 0.7227 - loss: 0.6369 - val_accuracy: 0.7563 - val_loss: 0.6241
Epoch 12/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 37ms/step - accuracy: 0.7227 - loss: 0.6332 - val_accuracy: 0.7563 - val_loss: 0.6199
Epoch 13/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 39ms/step - accuracy: 0.7227 - loss: 0.6299 - val_accuracy: 0.7563 - val_loss: 0.6159
Epoch 14/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 38ms/step - accuracy: 0.7227 - loss: 0.6266 - val_accuracy: 0.7563 - val_loss: 0.6120
Epoch 15/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 39ms/step - accuracy: 0.7227 - loss: 0.6237 - val_accuracy: 0.7563 - val_loss: 0.6084
Epoch 16/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 37ms/step - accuracy: 0.7227 - loss: 0.6210 - val_accuracy: 0.7563 - val_loss: 0.6049
Epoch 17/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 37ms/step - accuracy: 0.7227 - loss: 0.6184 - val_accuracy: 0.7563 - val_loss: 0.6018
Epoch 18/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 37ms/step - accuracy: 0.7227 - loss: 0.6161 - val_accuracy: 0.7563 - val_loss: 0.5988
Epoch 19/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 38ms/step - accuracy: 0.7227 - loss: 0.6139 - val_accuracy: 0.7563 - val_loss: 0.5961
Epoch 20/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 37ms/step - accuracy: 0.7227 - loss: 0.6120 - val_accuracy: 0.7563 - val_loss: 0.5932
Epoch 21/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 37ms/step - accuracy: 0.7227 - loss: 0.6100 - val_accuracy: 0.7563 - val_loss: 0.5911
Epoch 22/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 37ms/step - accuracy: 0.7227 - loss: 0.6084 - val_accuracy: 0.7563 - val_loss: 0.5886
Epoch 23/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 2s 46ms/step - accuracy: 0.7227 - loss: 0.6067 - val_accuracy: 0.7563 - val_loss: 0.5866
Epoch 24/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 41ms/step - accuracy: 0.7227 - loss: 0.6053 - val_accuracy: 0.7563 - val_loss: 0.5845
Epoch 25/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 37ms/step - accuracy: 0.7227 - loss: 0.6039 - val_accuracy: 0.7563 - val_loss: 0.5827
Epoch 26/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 37ms/step - accuracy: 0.7227 - loss: 0.6027 - val_accuracy: 0.7563 - val_loss: 0.5810
Epoch 27/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 38ms/step - accuracy: 0.7227 - loss: 0.6015 - val_accuracy: 0.7563 - val_loss: 0.5794
Epoch 28/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 37ms/step - accuracy: 0.7227 - loss: 0.6004 - val_accuracy: 0.7563 - val_loss: 0.5779
Epoch 29/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 38ms/step - accuracy: 0.7227 - loss: 0.5995 - val_accuracy: 0.7563 - val_loss: 0.5763
Epoch 30/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 37ms/step - accuracy: 0.7227 - loss: 0.5986 - val_accuracy: 0.7563 - val_loss: 0.5750
Epoch 31/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 37ms/step - accuracy: 0.7227 - loss: 0.5978 - val_accuracy: 0.7563 - val_loss: 0.5739
Epoch 32/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 38ms/step - accuracy: 0.7227 - loss: 0.5971 - val_accuracy: 0.7563 - val_loss: 0.5726
Epoch 33/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 37ms/step - accuracy: 0.7227 - loss: 0.5964 - val_accuracy: 0.7563 - val_loss: 0.5718
Epoch 34/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 37ms/step - accuracy: 0.7227 - loss: 0.5958 - val_accuracy: 0.7563 - val_loss: 0.5708
Epoch 35/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 37ms/step - accuracy: 0.7227 - loss: 0.5953 - val_accuracy: 0.7563 - val_loss: 0.5699
Epoch 36/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 37ms/step - accuracy: 0.7227 - loss: 0.5948 - val_accuracy: 0.7563 - val_loss: 0.5691
Epoch 37/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 37ms/step - accuracy: 0.7227 - loss: 0.5943 - val_accuracy: 0.7563 - val_loss: 0.5682
Epoch 38/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 37ms/step - accuracy: 0.7227 - loss: 0.5939 - val_accuracy: 0.7563 - val_loss: 0.5675
Epoch 39/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 37ms/step - accuracy: 0.7227 - loss: 0.5935 - val_accuracy: 0.7563 - val_loss: 0.5669
Epoch 40/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 37ms/step - accuracy: 0.7227 - loss: 0.5932 - val_accuracy: 0.7563 - val_loss: 0.5662
Epoch 41/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 38ms/step - accuracy: 0.7227 - loss: 0.5929 - val_accuracy: 0.7563 - val_loss: 0.5655
Epoch 42/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 38ms/step - accuracy: 0.7227 - loss: 0.5926 - val_accuracy: 0.7563 - val_loss: 0.5650
Epoch 43/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 37ms/step - accuracy: 0.7227 - loss: 0.5923 - val_accuracy: 0.7563 - val_loss: 0.5645
Epoch 44/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 38ms/step - accuracy: 0.7227 - loss: 0.5921 - val_accuracy: 0.7563 - val_loss: 0.5640
Epoch 45/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 37ms/step - accuracy: 0.7227 - loss: 0.5919 - val_accuracy: 0.7563 - val_loss: 0.5636
Epoch 46/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 37ms/step - accuracy: 0.7227 - loss: 0.5917 - val_accuracy: 0.7563 - val_loss: 0.5632
Epoch 47/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 37ms/step - accuracy: 0.7227 - loss: 0.5916 - val_accuracy: 0.7563 - val_loss: 0.5629
Epoch 48/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 37ms/step - accuracy: 0.7227 - loss: 0.5915 - val_accuracy: 0.7563 - val_loss: 0.5625
Epoch 49/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 38ms/step - accuracy: 0.7227 - loss: 0.5914 - val_accuracy: 0.7563 - val_loss: 0.5623
Epoch 50/50
34/34 ━━━━━━━━━━━━━━━━━━━━ 1s 38ms/step - accuracy: 0.7227 - loss: 0.5912 - val_accuracy: 0.7563 - val_loss: 0.5619
2025-11-01 05:46:46.390 | INFO     | src.ai_engine.ai_models:fit:685 - LSTM trained successfully.
2025-11-01 05:46:46.397 | INFO     | src.ai_engine.ai_models:fit:381 - Generating base model predictions for meta-model training...
2025-11-01 05:46:46.720 | INFO     | src.ai_engine.feature_engineering:create_sequences:261 - Creating sequences with length 50 from 1240 data points.
2025-11-01 05:46:46.750 | INFO     | src.ai_engine.feature_engineering:create_sequences:270 - Created 1190 sequences.
38/38 ━━━━━━━━━━━━━━━━━━━━ 2s 41ms/step
2025-11-01 05:46:49.732 | INFO     | src.ai_engine.ai_models:fit:396 - Training meta-model...
2025-11-01 05:46:49.744 | SUCCESS  | src.ai_engine.ai_models:fit:399 - Stacking Ensemble trained successfully.
2025-11-01 05:46:49.745 | SUCCESS  | __main__:main:167 - Final Ensemble model trained.
2025-11-01 05:46:49.746 | INFO     | __main__:main:171 - Saving models to 'models\PainX_999\4h'...
2025-11-01 05:46:50.207 | INFO     | src.ai_engine.ai_models:save:52 - Model RandomForest saved to models\PainX_999\4h\random_forest.pkl
2025-11-01 05:46:50.303 | INFO     | src.ai_engine.ai_models:save:52 - Model GradientBoosting saved to models\PainX_999\4h\gradient_boosting.pkl
2025-11-01 05:46:50.485 | INFO     | src.ai_engine.ai_models:save:731 - LSTM model saved to models\PainX_999\4h\lstm.keras, models\PainX_999\4h\lstm_scaler.pkl and marker file models\PainX_999\4h\lstm.pkl
2025-11-01 05:46:50.504 | INFO     | src.ai_engine.ai_models:save_all:463 - Meta-model saved to models\PainX_999\4h\meta_model.pkl
2025-11-01 05:46:50.505 | SUCCESS  | __main__:main:174 - --- Finished training for Symbol: PainX 999, Timeframe: 4h ---
2025-11-01 05:46:50.529 | INFO     | __main__:main:140 - --- Starting training for Symbol: PainX 999, Timeframe: 5m ---
2025-11-01 05:46:51.094 | SUCCESS  | __main__:main:148 - Loaded 86684 records.
2025-11-01 05:46:51.096 | INFO     | __main__:prepare_training_data:32 - Preparing data for training with Meta-Labeling...
2025-11-01 05:46:56.106 | DEBUG    | src.ai_engine.technical_indicators:calculate_all:47 - Calculated 63 technical indicators
2025-11-01 05:47:11.107 | DEBUG    | src.ai_engine.feature_engineering:extract_features:66 - Extracted 116 features
2025-11-01 05:47:11.108 | INFO     | __main__:prepare_training_data:39 - Generating signals from primary model (SimplePatternModel)...
2025-11-01 05:47:11.290 | WARNING  | src.ai_engine.feature_engineering:prepare_for_model:230 - Se perdieron todos los datos al eliminar los NaN. Se conservarán los datos rellenados.
2025-11-01 05:47:26.682 | INFO     | src.ai_engine.ai_models:calculate_optimal_threshold:549 - Calculated optimal threshold: 0.0010 (volatility: 0.0002, avg_movement: 0.0010)
2025-11-01 05:47:26.684 | INFO     | src.ai_engine.ai_models:create_meta_labels:577 - Creating meta-labels for secondary model...
2025-11-01 05:47:39.366 | INFO     | src.ai_engine.ai_models:create_meta_labels:629 - Meta-Label distribution - Profitable: 3620 (22.2%), Unprofitable: 12717 (77.8%)
2025-11-01 05:47:39.585 | WARNING  | src.ai_engine.feature_engineering:prepare_for_model:230 - Se perdieron todos los datos al eliminar los NaN. Se conservarán los datos rellenados.
2025-11-01 05:47:39.713 | INFO     | __main__:prepare_training_data:75 - Data preparation complete. Shape of X: (60378, 116), Shape of y: (60378,)
2025-11-01 05:47:39.906 | INFO     | src.ai_engine.feature_engineering:create_sequences:261 - Creating sequences with length 50 from 60378 data points.
2025-11-01 05:47:40.749 | INFO     | src.ai_engine.feature_engineering:create_sequences:270 - Created 60328 sequences.
2025-11-01 05:47:40.758 | INFO     | __main__:main:164 - Initializing and training Ensemble model...
2025-11-01 05:47:40.759 | INFO     | src.ai_engine.ai_models:__init__:304 - Initialized Stacking Ensemble with Logistic Regression as meta-model.
2025-11-01 05:47:40.781 | INFO     | src.ai_engine.ai_models:fit:359 - Creating LSTM model...
2025-11-01 05:47:40.781 | INFO     | src.ai_engine.ai_models:fit:364 - Training base models...
2025-11-01 05:47:40.883 | INFO     | src.ai_engine.ai_models:fit:373 - Training random_forest...
2025-11-01 05:48:03.622 | INFO     | src.ai_engine.ai_models:fit:98 - RandomForest trained successfully on 60378 samples with 2 classes
2025-11-01 05:48:03.625 | INFO     | src.ai_engine.ai_models:fit:373 - Training gradient_boosting...
2025-11-01 05:59:40.662 | INFO     | src.ai_engine.ai_models:fit:157 - GradientBoosting trained successfully on 60378 samples with 2 classes
2025-11-01 07:43:34.765 | INFO     | src.ai_engine.ai_models:fit:373 - Training pattern_based...
2025-11-01 07:43:35.043 | INFO     | src.ai_engine.ai_models:fit:373 - Training lstm...
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\keras\src\layers\rnn\rnn.py:199: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(**kwargs)
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1108: RuntimeWarning: invalid value encountered in divide
  updated_mean = (last_sum + new_sum) / updated_sample_count
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1113: RuntimeWarning: invalid value encountered in divide
  T = new_sum / new_sample_count
C:\Users\wille\AppData\Roaming\Python\Python313\site-packages\sklearn\utils\extmath.py:1133: RuntimeWarning: invalid value encountered in divide
  new_unnormalized_variance -= correction**2 / new_sample_count
Epoch 1/50
1697/1697 ━━━━━━━━━━━━━━━━━━━━ 586s 54ms/step - accuracy: 0.9399 - loss: 0.4562 - val_accuracy: 0.9410 - val_loss: 0.3134
Epoch 2/50
1697/1697 ━━━━━━━━━━━━━━━━━━━━ 66s 39ms/step - accuracy: 0.9399 - loss: 0.2675 - val_accuracy: 0.9410 - val_loss: 0.2378
Epoch 3/50
1697/1697 ━━━━━━━━━━━━━━━━━━━━ 65s 38ms/step - accuracy: 0.9399 - loss: 0.2322 - val_accuracy: 0.9410 - val_loss: 0.2255
Epoch 4/50
1697/1697 ━━━━━━━━━━━━━━━━━━━━ 66s 38ms/step - accuracy: 0.9399 - loss: 0.2275 - val_accuracy: 0.9410 - val_loss: 0.2243
Epoch 5/50
1697/1697 ━━━━━━━━━━━━━━━━━━━━ 64s 38ms/step - accuracy: 0.9399 - loss: 0.2273 - val_accuracy: 0.9410 - val_loss: 0.2243
Epoch 6/50
1697/1697 ━━━━━━━━━━━━━━━━━━━━ 64s 37ms/step - accuracy: 0.9399 - loss: 0.2273 - val_accuracy: 0.9410 - val_loss: 0.2242
Epoch 7/50
1697/1697 ━━━━━━━━━━━━━━━━━━━━ 65s 38ms/step - accuracy: 0.9399 - loss: 0.2273 - val_accuracy: 0.9410 - val_loss: 0.2242
Epoch 8/50
1697/1697 ━━━━━━━━━━━━━━━━━━━━ 65s 38ms/step - accuracy: 0.9399 - loss: 0.2273 - val_accuracy: 0.9410 - val_loss: 0.2243
Epoch 9/50
1697/1697 ━━━━━━━━━━━━━━━━━━━━ 70s 41ms/step - accuracy: 0.9399 - loss: 0.2273 - val_accuracy: 0.9410 - val_loss: 0.2242
Epoch 10/50
1697/1697 ━━━━━━━━━━━━━━━━━━━━ 65s 38ms/step - accuracy: 0.9399 - loss: 0.2273 - val_accuracy: 0.9410 - val_loss: 0.2242
Epoch 11/50
1697/1697 ━━━━━━━━━━━━━━━━━━━━ 64s 38ms/step - accuracy: 0.9399 - loss: 0.2273 - val_accuracy: 0.9410 - val_loss: 0.2242
Epoch 12/50
1697/1697 ━━━━━━━━━━━━━━━━━━━━ 64s 38ms/step - accuracy: 0.9399 - loss: 0.2272 - val_accuracy: 0.9410 - val_loss: 0.2242
Epoch 13/50
1697/1697 ━━━━━━━━━━━━━━━━━━━━ 64s 37ms/step - accuracy: 0.9399 - loss: 0.2273 - val_accuracy: 0.9410 - val_loss: 0.2242
Epoch 14/50
1697/1697 ━━━━━━━━━━━━━━━━━━━━ 64s 37ms/step - accuracy: 0.9399 - loss: 0.2273 - val_accuracy: 0.9410 - val_loss: 0.2242
Epoch 15/50
1697/1697 ━━━━━━━━━━━━━━━━━━━━ 63s 37ms/step - accuracy: 0.9399 - loss: 0.2273 - val_accuracy: 0.9410 - val_loss: 0.2242
Epoch 16/50
1697/1697 ━━━━━━━━━━━━━━━━━━━━ 65s 38ms/step - accuracy: 0.9399 - loss: 0.2273 - val_accuracy: 0.9410 - val_loss: 0.2242
Epoch 17/50
1697/1697 ━━━━━━━━━━━━━━━━━━━━ 64s 38ms/step - accuracy: 0.9399 - loss: 0.2273 - val_accuracy: 0.9410 - val_loss: 0.2242
2025-11-01 08:47:22.868 | INFO     | src.ai_engine.ai_models:fit:685 - LSTM trained successfully.
2025-11-01 08:47:23.700 | INFO     | src.ai_engine.ai_models:fit:381 - Generating base model predictions for meta-model training...
2025-11-01 08:47:53.475 | INFO     | src.ai_engine.feature_engineering:create_sequences:261 - Creating sequences with length 50 from 60378 data points.
2025-11-01 08:47:54.452 | INFO     | src.ai_engine.feature_engineering:create_sequences:270 - Created 60328 sequences.
1886/1886 ━━━━━━━━━━━━━━━━━━━━ 178s 31ms/step
2025-11-01 09:16:56.773 | INFO     | src.ai_engine.ai_models:fit:396 - Training meta-model...
2025-11-01 09:17:13.289 | SUCCESS  | src.ai_engine.ai_models:fit:399 - Stacking Ensemble trained successfully.
2025-11-01 09:17:14.133 | SUCCESS  | __main__:main:167 - Final Ensemble model trained.
2025-11-01 09:17:14.177 | INFO     | __main__:main:171 - Saving models to 'models\PainX_999\5m'...
2025-11-01 09:17:30.430 | INFO     | src.ai_engine.ai_models:save:52 - Model RandomForest saved to models\PainX_999\5m\random_forest.pkl
2025-11-01 09:17:33.256 | INFO     | src.ai_engine.ai_models:save:52 - Model GradientBoosting saved to models\PainX_999\5m\gradient_boosting.pkl
2025-11-01 09:17:44.959 | INFO     | src.ai_engine.ai_models:save:731 - LSTM model saved to models\PainX_999\5m\lstm.keras, models\PainX_999\5m\lstm_scaler.pkl and marker file models\PainX_999\5m\lstm.pkl
2025-11-01 09:17:44.976 | INFO     | src.ai_engine.ai_models:save_all:463 - Meta-model saved to models\PainX_999\5m\meta_model.pkl
2025-11-01 09:17:44.978 | SUCCESS  | __main__:main:174 - --- Finished training for Symbol: PainX 999, Timeframe: 5m ---
2025-11-01 09:17:45.003 | INFO     | __main__:main:180 - ============================== AI Model Training Finished for All Files ==============================
